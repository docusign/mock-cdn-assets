/*! For license information please see 1fe-bundle.js.LICENSE.txt */
System.register(["React","ReactDOM","antd","1feContext"],(function(__WEBPACK_DYNAMIC_EXPORT__,__system_context__){var __WEBPACK_EXTERNAL_MODULE__1302__={},__WEBPACK_EXTERNAL_MODULE__4946__={},__WEBPACK_EXTERNAL_MODULE__4876__={},__WEBPACK_EXTERNAL_MODULE__1826__={};return Object.defineProperty(__WEBPACK_EXTERNAL_MODULE__1302__,"__esModule",{value:!0}),{setters:[function(t){Object.keys(t).forEach((function(e){__WEBPACK_EXTERNAL_MODULE__1302__[e]=t[e]}))},function(t){__WEBPACK_EXTERNAL_MODULE__4946__.unstable_batchedUpdates=t.unstable_batchedUpdates},function(t){__WEBPACK_EXTERNAL_MODULE__4876__.Button=t.Button,__WEBPACK_EXTERNAL_MODULE__4876__.Input=t.Input,__WEBPACK_EXTERNAL_MODULE__4876__.Modal=t.Modal,__WEBPACK_EXTERNAL_MODULE__4876__.Table=t.Table,__WEBPACK_EXTERNAL_MODULE__4876__.Typography=t.Typography},function(t){__WEBPACK_EXTERNAL_MODULE__1826__.platformProps=t.platformProps}],execute:function(){__WEBPACK_DYNAMIC_EXPORT__(function(){var __webpack_modules__={41:function(t,e,i){"use strict";function n(t,e,i){var n="";return i.split(" ").forEach((function(i){void 0!==t[i]?e.push(t[i]+";"):i&&(n+=i+" ")})),n}i.d(e,{Rk:function(){return n},SF:function(){return s},sk:function(){return o}});var s=function(t,e,i){var n=t.key+"-"+e.name;!1===i&&void 0===t.registered[n]&&(t.registered[n]=e.styles)},o=function(t,e,i){s(t,e,i);var n=t.key+"-"+e.name;if(void 0===t.inserted[e.name]){var o=e;do{t.insert(e===o?"."+n:"",o,t.sheet,!0),o=o.next}while(void 0!==o)}}},126:function(t,e,i){const n=i(358).y;e.w=function(t){if(t||(t=1),!i.y.meta||!i.y.meta.url)throw console.error("__system_context__",i.y),Error("systemjs-webpack-interop was provided an unknown SystemJS context. Expected context.meta.url, but none was provided");i.p=n(i.y.meta.url,t)}},251:function(t,e){e.read=function(t,e,i,n,s){var o,r,l=8*s-n-1,a=(1<<l)-1,h=a>>1,c=-7,d=i?s-1:0,u=i?-1:1,f=t[e+d];for(d+=u,o=f&(1<<-c)-1,f>>=-c,c+=l;c>0;o=256*o+t[e+d],d+=u,c-=8);for(r=o&(1<<-c)-1,o>>=-c,c+=n;c>0;r=256*r+t[e+d],d+=u,c-=8);if(0===o)o=1-h;else{if(o===a)return r?NaN:1/0*(f?-1:1);r+=Math.pow(2,n),o-=h}return(f?-1:1)*r*Math.pow(2,o-n)},e.write=function(t,e,i,n,s,o){var r,l,a,h=8*o-s-1,c=(1<<h)-1,d=c>>1,u=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,r=c):(r=Math.floor(Math.log(e)/Math.LN2),e*(a=Math.pow(2,-r))<1&&(r--,a*=2),(e+=r+d>=1?u/a:u*Math.pow(2,1-d))*a>=2&&(r++,a/=2),r+d>=c?(l=0,r=c):r+d>=1?(l=(e*a-1)*Math.pow(2,s),r+=d):(l=e*Math.pow(2,d-1)*Math.pow(2,s),r=0));s>=8;t[i+f]=255&l,f+=p,l/=256,s-=8);for(r=r<<s|l,h+=s;h>0;t[i+f]=255&r,f+=p,r/=256,h-=8);t[i+f-p]|=128*g}},358:function(t,e,i){e.y=function(t,e){var i=document.createElement("a");i.href=t;for(var n="/"===i.pathname[0]?i.pathname:"/"+i.pathname,s=0,o=n.length;s!==e&&o>=0;)"/"===n[--o]&&s++;if(s!==e)throw Error("systemjs-webpack-interop: rootDirectoryLevel ("+e+") is greater than the number of directories ("+s+") in the URL path "+t);var r=n.slice(0,o+1);return i.protocol+"//"+i.host+r};Number.isInteger},540:function(t){"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},1020:function(t,e,i){"use strict";var n=i(1302),s=Symbol.for("react.element"),o=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function h(t,e,i){var n,o={},h=null,c=null;for(n in void 0!==i&&(h=""+i),void 0!==e.key&&(h=""+e.key),void 0!==e.ref&&(c=e.ref),e)r.call(e,n)&&!a.hasOwnProperty(n)&&(o[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps)void 0===o[n]&&(o[n]=e[n]);return{$$typeof:s,type:t,key:h,ref:c,props:o,_owner:l.current}}e.Fragment=o,e.jsx=h,e.jsxs=h},1081:function(t,e,i){"use strict";function n(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];var o,r=0,l={memoizeOptions:void 0},a=n.pop();if("object"==typeof a&&(l=a,a=n.pop()),"function"!=typeof a)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof a+"]");var h=l.memoizeOptions,c=void 0===h?i:h,d=Array.isArray(c)?c:[c],u=function(t){var e=Array.isArray(t[0])?t[0]:t;if(!e.every((function(t){return"function"==typeof t}))){var i=e.map((function(t){return"function"==typeof t?"function "+(t.name||"unnamed")+"()":typeof t})).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+i+"]")}return e}(n),f=t.apply(void 0,[function(){return r++,a.apply(null,arguments)}].concat(d)),p=t((function(){for(var t=[],e=u.length,i=0;i<e;i++)t.push(u[i].apply(null,arguments));return o=f.apply(null,t)}));return Object.assign(p,{resultFunc:a,memoizedResultFunc:f,dependencies:u,lastResult:function(){return o},recomputations:function(){return r},resetRecomputations:function(){return r=0}}),p}}i.d(e,{Ad:function(){return n},Mz:function(){return s}});var s=n(i(6234).UI)},1113:function(t){"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},1287:function(t,e,i){"use strict";i.d(e,{s:function(){return o}});var n=i(1302),s=!!n.useInsertionEffect&&n.useInsertionEffect,o=s||function(t){return t()};s||n.useLayoutEffect},1302:function(t){"use strict";t.exports=__WEBPACK_EXTERNAL_MODULE__1302__},1601:function(t){"use strict";t.exports=function(t){return t[1]}},1712:function(t,e,i){"use strict";i.d(e,{Ep:function(){return r},Iv:function(){return p},Mb:function(){return o},OO:function(){return a},Xj:function(){return f},bh:function(){return u},vo:function(){return l}});var n=i(1081),s=i(9889),o=function(t){return t.app},r=(0,n.Mz)(o,(function(t){return t.activeWidgetUrl})),l=(0,n.Mz)(o,(function(t){return t.activeWidgetProps})),a=(0,n.Mz)(o,(function(t){return t.tickTock})),h=s.xI.getSelectors(),c=h.selectAll,d=h.selectById,u=function(t){return c(o(t))},f=((0,n.Mz)(u,(function(t){return t.filter((function(t){return Boolean(t.route)}))})),function(t){var e;return d(o(t),null!==(e=o(t).activeWidgetUrl)&&void 0!==e?e:"")}),p=(0,n.Mz)(o,(function(t){return{isLoading:t.loading,error:t.error}}))},1826:function(t){"use strict";t.exports=__WEBPACK_EXTERNAL_MODULE__1826__},1934:function(t,e,i){"use strict";i.d(e,{Ep:function(){return s.Ep},Iv:function(){return s.Iv},Mb:function(){return s.Mb},OO:function(){return s.OO},Xj:function(){return s.Xj},cX:function(){return n.cX},tR:function(){return n.tR},vo:function(){return s.vo}});var n=i(9889),s=i(1712)},2011:function(t,e,i){"use strict";i.d(e,{az:function(){return c},VP:function(){return v},fI:function(){return O},EY:function(){return w}});var n,s,o=i(2639);function r(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var l,a,h,c=o.A.div(n||(n=r(["\n  margin: ",";\n  padding: ",";\n  width: ",";\n  height: ",";\n  min-width: ",";\n  min-height: ",";\n  max-width: ",";\n  max-height: ",";\n  overflow: ",";\n  position: ",";\n  border: ",";\n  ",";\n"])),(function(t){return t.margin}),(function(t){return t.padding}),(function(t){return t.width}),(function(t){return t.height}),(function(t){return t.minWidth}),(function(t){return t.minHeight}),(function(t){return t.maxWidth}),(function(t){return t.maxHeight}),(function(t){return t.overflow}),(function(t){return t.position}),(function(t){return t.border}),(function(t){return t["data-qa"]&&"data-qa=".concat(t["data-qa"])}));function d(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(0,o.A)(c)(s||(s=r(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: ",";\n  height: ",";\n"])),(function(t){var e;return null!==(e=t.width)&&void 0!==e?e:"100%"}),(function(t){var e;return null!==(e=t.height)&&void 0!==e?e:"100%"}));var u,f,p,g=(0,o.A)(c)(l||(l=d(["\n  justify-self: ",";\n  align-self: ",";\n  flex: ",";\n  width: ",";\n  height: ",";\n"])),(function(t){return t.justify}),(function(t){return t.align}),(function(t){var e;return null!==(e=t.flex)&&void 0!==e?e:"1"}),(function(t){var e;return null!==(e=t.width)&&void 0!==e?e:"100%"}),(function(t){var e;return null!==(e=t.height)&&void 0!==e?e:"100%"})),m=function(t){return t.Flex=g,t},O=m((0,o.A)(c)(a||(a=d(["\n  display: flex;\n  flex-direction: row;\n  justify-content: ",";\n  align-items: ",";\n  gap: ",";\n  flex-wrap: ",";\n  width: ",";\n  height: ",";\n"])),(function(t){return t.justify}),(function(t){return t.align}),(function(t){return t.gap}),(function(t){return t.wrap}),(function(t){var e;return null!==(e=t.width)&&void 0!==e?e:"100%"}),(function(t){var e;return null!==(e=t.height)&&void 0!==e?e:"100%"}))),v=m((0,o.A)(c)(h||(h=d(["\n  display: flex;\n  flex-direction: column;\n  justify-content: ",";\n  align-items: ",";\n  gap: ",";\n  width: ",";\n  height: ",";\n"])),(function(t){return t.justify}),(function(t){return t.align}),(function(t){return t.gap}),(function(t){var e;return null!==(e=t.width)&&void 0!==e?e:"100%"}),(function(t){var e;return null!==(e=t.height)&&void 0!==e?e:"100%"}))),w=o.A.div(u||(f=["\n  margin: ",";\n  padding: ",";\n  overflow: ",";\n  color: ",";\n  ",";\n"],p||(p=f.slice(0)),u=Object.freeze(Object.defineProperties(f,{raw:{value:Object.freeze(p)}}))),(function(t){var e;return null!==(e=t.margin)&&void 0!==e?e:0}),(function(t){var e;return null!==(e=t.padding)&&void 0!==e?e:0}),(function(t){return t.overflow}),(function(t){return t.color}),(function(t){return t["data-qa"]&&"data-qa=".concat(t["data-qa"])}))},2162:function(t,e,i){"use strict";var n=i(1302),s=i(9888),o="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},r=s.useSyncExternalStore,l=n.useRef,a=n.useEffect,h=n.useMemo,c=n.useDebugValue;e.useSyncExternalStoreWithSelector=function(t,e,i,n,s){var d=l(null);if(null===d.current){var u={hasValue:!1,value:null};d.current=u}else u=d.current;d=h((function(){function t(t){if(!a){if(a=!0,r=t,t=n(t),void 0!==s&&u.hasValue){var e=u.value;if(s(e,t))return l=e}return l=t}if(e=l,o(r,t))return e;var i=n(t);return void 0!==s&&s(e,i)?(r=t,e):(r=t,l=i)}var r,l,a=!1,h=void 0===i?null:i;return[function(){return t(e())},null===h?void 0:function(){return t(h())}]}),[e,i,n,s]);var f=r(t,d[0],d[1]);return a((function(){u.hasValue=!0,u.value=f}),[f]),c(f),f}},2445:function(t,e,i){"use strict";i.d(e,{FD:function(){return l},FK:function(){return o},Y:function(){return r}});var n=i(4848),s=i(4684),o=(i(1302),i(5655),i(4146),i(3174),i(1287),n.Fragment),r=function(t,e,i){return s.h.call(e,"css")?n.jsx(s.E,(0,s.c)(t,e),i):n.jsx(t,e,i)},l=function(t,e,i){return s.h.call(e,"css")?n.jsxs(s.E,(0,s.c)(t,e),i):n.jsxs(t,e,i)}},2639:function(t,e,i){"use strict";function n(){return n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},n.apply(null,arguments)}i.d(e,{A:function(){return m}});var s=i(4684),o=i(3174),r=i(1287),l=i(41),a=i(1302),h=i(6289),c=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,d=(0,h.A)((function(t){return c.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91})),u=function(t){return"theme"!==t},f=function(t){return"string"==typeof t&&t.charCodeAt(0)>96?d:u},p=function(t,e,i){var n;if(e){var s=e.shouldForwardProp;n=t.__emotion_forwardProp&&s?function(e){return t.__emotion_forwardProp(e)&&s(e)}:s}return"function"!=typeof n&&i&&(n=t.__emotion_forwardProp),n},g=function(t){var e=t.cache,i=t.serialized,n=t.isStringTag;return(0,l.SF)(e,i,n),(0,r.s)((function(){return(0,l.sk)(e,i,n)})),null},m=function t(e,i){var r,h,c=e.__emotion_real===e,d=c&&e.__emotion_base||e;void 0!==i&&(r=i.label,h=i.target);var u=p(e,i,c),m=u||f(d),O=!m("as");return function(){var v=arguments,w=c&&void 0!==e.__emotion_styles?e.__emotion_styles.slice(0):[];if(void 0!==r&&w.push("label:"+r+";"),null==v[0]||void 0===v[0].raw)w.push.apply(w,v);else{var b=v[0];w.push(b[0]);for(var y=v.length,S=1;S<y;S++)w.push(v[S],b[S])}var x=(0,s.w)((function(t,e,i){var n=O&&t.as||d,r="",c=[],p=t;if(null==t.theme){for(var v in p={},t)p[v]=t[v];p.theme=a.useContext(s.T)}"string"==typeof t.className?r=(0,l.Rk)(e.registered,c,t.className):null!=t.className&&(r=t.className+" ");var b=(0,o.J)(w.concat(c),e.registered,p);r+=e.key+"-"+b.name,void 0!==h&&(r+=" "+h);var y=O&&void 0===u?f(n):m,S={};for(var x in t)O&&"as"===x||y(x)&&(S[x]=t[x]);return S.className=r,i&&(S.ref=i),a.createElement(a.Fragment,null,a.createElement(g,{cache:e,serialized:b,isStringTag:"string"==typeof n}),a.createElement(n,S))}));return x.displayName=void 0!==r?r:"Styled("+("string"==typeof d?d:d.displayName||d.name||"Component")+")",x.defaultProps=e.defaultProps,x.__emotion_real=x,x.__emotion_base=d,x.__emotion_styles=w,x.__emotion_forwardProp=u,Object.defineProperty(x,"toString",{value:function(){return"."+h}}),x.withComponent=function(e,s){return t(e,n({},i,s,{shouldForwardProp:p(x,s,!0)})).apply(void 0,w)},x}}.bind(null);["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(t){m[t]=m(t)}))},2694:function(t,e,i){"use strict";var n=i(6925);function s(){}function o(){}o.resetWarningCache=s,t.exports=function(){function t(t,e,i,s,o,r){if(r!==n){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function e(){return t}t.isRequired=t;var i={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:s};return i.PropTypes=i,i}},2799:function(t,e){"use strict";Symbol.for("react.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.server_context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.suspense_list"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.for("react.offscreen");Symbol.for("react.module.reference")},2861:function(t,e,i){var n=i(8287),s=n.Buffer;function o(t,e){for(var i in t)e[i]=t[i]}function r(t,e,i){return s(t,e,i)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?t.exports=n:(o(n,e),e.Buffer=r),r.prototype=Object.create(s.prototype),o(s,r),r.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return s(t,e,i)},r.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=s(t);return void 0!==e?"string"==typeof i?n.fill(e,i):n.fill(e):n.fill(0),n},r.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return s(t)},r.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return n.SlowBuffer(t)}},3072:function(t,e){"use strict";var i="function"==typeof Symbol&&Symbol.for,n=i?Symbol.for("react.element"):60103,s=i?Symbol.for("react.portal"):60106,o=i?Symbol.for("react.fragment"):60107,r=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,a=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,c=i?Symbol.for("react.async_mode"):60111,d=i?Symbol.for("react.concurrent_mode"):60111,u=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,p=i?Symbol.for("react.suspense_list"):60120,g=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,O=i?Symbol.for("react.block"):60121,v=i?Symbol.for("react.fundamental"):60117,w=i?Symbol.for("react.responder"):60118,b=i?Symbol.for("react.scope"):60119;function y(t){if("object"==typeof t&&null!==t){var e=t.$$typeof;switch(e){case n:switch(t=t.type){case c:case d:case o:case l:case r:case f:return t;default:switch(t=t&&t.$$typeof){case h:case u:case m:case g:case a:return t;default:return e}}case s:return e}}}function S(t){return y(t)===d}e.AsyncMode=c,e.ConcurrentMode=d,e.ContextConsumer=h,e.ContextProvider=a,e.Element=n,e.ForwardRef=u,e.Fragment=o,e.Lazy=m,e.Memo=g,e.Portal=s,e.Profiler=l,e.StrictMode=r,e.Suspense=f,e.isAsyncMode=function(t){return S(t)||y(t)===c},e.isConcurrentMode=S,e.isContextConsumer=function(t){return y(t)===h},e.isContextProvider=function(t){return y(t)===a},e.isElement=function(t){return"object"==typeof t&&null!==t&&t.$$typeof===n},e.isForwardRef=function(t){return y(t)===u},e.isFragment=function(t){return y(t)===o},e.isLazy=function(t){return y(t)===m},e.isMemo=function(t){return y(t)===g},e.isPortal=function(t){return y(t)===s},e.isProfiler=function(t){return y(t)===l},e.isStrictMode=function(t){return y(t)===r},e.isSuspense=function(t){return y(t)===f},e.isValidElementType=function(t){return"string"==typeof t||"function"==typeof t||t===o||t===d||t===l||t===r||t===f||t===p||"object"==typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===g||t.$$typeof===a||t.$$typeof===h||t.$$typeof===u||t.$$typeof===v||t.$$typeof===w||t.$$typeof===b||t.$$typeof===O)},e.typeOf=y},3077:function(t,e,i){"use strict";i.d(e,{Z:function(){return c}});var n=i(6432);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function o(){o=function(){return e};var t,e={},i=Object.prototype,n=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},l=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",h=r.toStringTag||"@@toStringTag";function c(t,e,i,n){return Object.defineProperty(t,e,{value:i,enumerable:!n,configurable:!n,writable:!n})}try{c({},"")}catch(t){c=function(t,e,i){return t[e]=i}}function d(e,i,n,s){var o=i&&i.prototype instanceof p?i:p,r=Object.create(o.prototype);return c(r,"_invoke",function(e,i,n){var s=1;return function(o,r){if(3===s)throw Error("Generator is already running");if(4===s){if("throw"===o)throw r;return{value:t,done:!0}}for(n.method=o,n.arg=r;;){var l=n.delegate;if(l){var a=x(l,n);if(a){if(a===f)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(1===s)throw s=4,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=3;var h=u(e,i,n);if("normal"===h.type){if(s=n.done?4:2,h.arg===f)continue;return{value:h.arg,done:n.done}}"throw"===h.type&&(s=4,n.method="throw",n.arg=h.arg)}}}(e,n,new C(s||[])),!0),r}function u(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}e.wrap=d;var f={};function p(){}function g(){}function m(){}var O={};c(O,l,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(A([])));w&&w!==i&&n.call(w,l)&&(O=w);var b=m.prototype=p.prototype=Object.create(O);function y(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function i(o,r,l,a){var h=u(t[o],t,r);if("throw"!==h.type){var c=h.arg,d=c.value;return d&&"object"==s(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){i("next",t,l,a)}),(function(t){i("throw",t,l,a)})):e.resolve(d).then((function(t){c.value=t,l(c)}),(function(t){return i("throw",t,l,a)}))}a(h.arg)}var o;c(this,"_invoke",(function(t,n){function s(){return new e((function(e,s){i(t,n,e,s)}))}return o=o?o.then(s,s):s()}),!0)}function x(e,i){var n=i.method,s=e.i[n];if(s===t)return i.delegate=null,"throw"===n&&e.i.return&&(i.method="return",i.arg=t,x(e,i),"throw"===i.method)||"return"!==n&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=u(s,e.i,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,f;var r=o.arg;return r?r.done?(i[e.r]=r.value,i.next=e.n,"return"!==i.method&&(i.method="next",i.arg=t),i.delegate=null,f):r:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,f)}function k(t){this.tryEntries.push(t)}function M(e){var i=e[4]||{};i.type="normal",i.arg=t,e[4]=i}function C(t){this.tryEntries=[[-1]],t.forEach(k,this),this.reset(!0)}function A(e){if(null!=e){var i=e[l];if(i)return i.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function i(){for(;++o<e.length;)if(n.call(e,o))return i.value=e[o],i.done=!1,i;return i.value=t,i.done=!0,i};return r.next=r}}throw new TypeError(s(e)+" is not iterable")}return g.prototype=m,c(b,"constructor",m),c(m,"constructor",g),g.displayName=c(m,h,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,h,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},y(S.prototype),c(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,i,n,s,o){void 0===o&&(o=Promise);var r=new S(d(t,i,n,s),o);return e.isGeneratorFunction(i)?r:r.next().then((function(t){return t.done?t.value:r.next()}))},y(b),c(b,h,"Generator"),c(b,l,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),i=[];for(var n in e)i.unshift(n);return function t(){for(;i.length;)if((n=i.pop())in e)return t.value=n,t.done=!1,t;return t.done=!0,t}},e.values=A,C.prototype={constructor:C,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var i=this;function n(t){r.type="throw",r.arg=e,i.next=t}for(var s=i.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],r=o[4],l=this.prev,a=o[1],h=o[2];if(-1===o[0])return n("end"),!1;if(!a&&!h)throw Error("try statement without catch or finally");if(null!=o[0]&&o[0]<=l){if(l<a)return this.method="next",this.arg=t,n(a),!0;if(l<h)return n(h),!1}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n[0]>-1&&n[0]<=this.prev&&this.prev<n[2]){var s=n;break}}s&&("break"===t||"continue"===t)&&s[0]<=e&&e<=s[2]&&(s=null);var o=s?s[4]:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s[2],f):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i[2]===t)return this.complete(i[4],i[3]),M(i),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i[0]===t){var n=i[4];if("throw"===n.type){var s=n.arg;M(i)}return s}}throw Error("illegal catch attempt")},delegateYield:function(e,i,n){return this.delegate={i:A(e),r:i,n:n},"next"===this.method&&(this.arg=t),f}},e}function r(t,e,i,n,s,o,r){try{var l=t[o](r),a=l.value}catch(t){return void i(t)}l.done?e(a):Promise.resolve(a).then(n,s)}function l(t){return function(){var e=this,i=arguments;return new Promise((function(n,s){var o=t.apply(e,i);function l(t){r(o,n,s,l,a,"next",t)}function a(t){r(o,n,s,l,a,"throw",t)}l(void 0)}))}}var a=function(){var t=l(o().mark((function t(){var e,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/version");case 2:return e=t.sent,t.next=5,e.json();case 5:return i=t.sent.configs.widgetConfig,t.abrupt("return",i);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),h=(0,n.zD)("app/refreshWidgets",function(){var t=l(o().mark((function t(e,i){var n,s,r,l,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.dispatch,t.prev=1,t.next=4,a();case 4:return n=t.sent,s=new URLSearchParams(window.location.search),r=s.get("widgetId")||s.get("widget"),l=n.find((function(t){return t.widgetId===r})),h=function(){var t,e;return l&&l.widgetId?null===(e=window.importMapOverrides)||void 0===e||null===(e=e.getOverrideMap())||void 0===e?void 0:e.imports[l.widgetId]:null!==(t=s.get("widgetUrl"))&&void 0!==t?t:r},t.abrupt("return",[n,h()]);case 12:throw t.prev=12,t.t0=t.catch(1),console.error(t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(e,i){return t.apply(this,arguments)}}()),c={loadWidgets:h}},3174:function(t,e,i){"use strict";i.d(e,{J:function(){return m}});var n={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},s=i(6289),o=!1,r=/[A-Z]|^ms/g,l=/_EMO_([^_]+?)_([^]*?)_EMO_/g,a=function(t){return 45===t.charCodeAt(1)},h=function(t){return null!=t&&"boolean"!=typeof t},c=(0,s.A)((function(t){return a(t)?t:t.replace(r,"-$&").toLowerCase()})),d=function(t,e){switch(t){case"animation":case"animationName":if("string"==typeof e)return e.replace(l,(function(t,e,i){return p={name:e,styles:i,next:p},e}))}return 1===n[t]||a(t)||"number"!=typeof e||0===e?e:e+"px"},u="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function f(t,e,i){if(null==i)return"";var n=i;if(void 0!==n.__emotion_styles)return n;switch(typeof i){case"boolean":return"";case"object":var s=i;if(1===s.anim)return p={name:s.name,styles:s.styles,next:p},s.name;var r=i;if(void 0!==r.styles){var l=r.next;if(void 0!==l)for(;void 0!==l;)p={name:l.name,styles:l.styles,next:p},l=l.next;return r.styles+";"}return function(t,e,i){var n="";if(Array.isArray(i))for(var s=0;s<i.length;s++)n+=f(t,e,i[s])+";";else for(var r in i){var l=i[r];if("object"!=typeof l){var a=l;null!=e&&void 0!==e[a]?n+=r+"{"+e[a]+"}":h(a)&&(n+=c(r)+":"+d(r,a)+";")}else{if("NO_COMPONENT_SELECTOR"===r&&o)throw new Error(u);if(!Array.isArray(l)||"string"!=typeof l[0]||null!=e&&void 0!==e[l[0]]){var p=f(t,e,l);switch(r){case"animation":case"animationName":n+=c(r)+":"+p+";";break;default:n+=r+"{"+p+"}"}}else for(var g=0;g<l.length;g++)h(l[g])&&(n+=c(r)+":"+d(r,l[g])+";")}}return n}(t,e,i);case"function":if(void 0!==t){var a=p,g=i(t);return p=a,f(t,e,g)}}var m=i;if(null==e)return m;var O=e[m];return void 0!==O?O:m}var p,g=/label:\s*([^\s;{]+)\s*(;|$)/g;function m(t,e,i){if(1===t.length&&"object"==typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var n=!0,s="";p=void 0;var o=t[0];null==o||void 0===o.raw?(n=!1,s+=f(i,e,o)):s+=o[0];for(var r=1;r<t.length;r++)s+=f(i,e,t[r]),n&&(s+=o[r]);g.lastIndex=0;for(var l,a="";null!==(l=g.exec(s));)a+="-"+l[1];var h=function(t){for(var e,i=0,n=0,s=t.length;s>=4;++n,s-=4)e=1540483477*(65535&(e=255&t.charCodeAt(n)|(255&t.charCodeAt(++n))<<8|(255&t.charCodeAt(++n))<<16|(255&t.charCodeAt(++n))<<24))+(59797*(e>>>16)<<16),i=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&i)+(59797*(i>>>16)<<16);switch(s){case 3:i^=(255&t.charCodeAt(n+2))<<16;case 2:i^=(255&t.charCodeAt(n+1))<<8;case 1:i=1540483477*(65535&(i^=255&t.charCodeAt(n)))+(59797*(i>>>16)<<16)}return(((i=1540483477*(65535&(i^=i>>>13))+(59797*(i>>>16)<<16))^i>>>15)>>>0).toString(36)}(s)+a;return{name:h,styles:s,next:p}}},3209:function(t,e,i){"use strict";var n=65536,s=i(2861).Buffer,o=i.g.crypto||i.g.msCrypto;o&&o.getRandomValues?t.exports=function(t,e){if(t>4294967295)throw new RangeError("requested too many random bytes");var i=s.allocUnsafe(t);if(t>0)if(t>n)for(var r=0;r<t;r+=n)o.getRandomValues(i.slice(r,r+n));else o.getRandomValues(i);return"function"==typeof e?process.nextTick((function(){e(null,i)})):i}:t.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}},3380:function(t,e,i){"use strict";i.d(e,{h:function(){return E}});var n=i(2445),s=i(2639),o=i(1302);const r=(0,o.createContext)(null),l={didCatch:!1,error:null};class a extends o.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=l}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(null!==t){for(var e,i,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];null===(e=(i=this.props).onReset)||void 0===e||e.call(i,{args:s,reason:"imperative-api"}),this.setState(l)}}componentDidCatch(t,e){var i,n;null===(i=(n=this.props).onError)||void 0===i||i.call(n,t,e)}componentDidUpdate(t,e){const{didCatch:i}=this.state,{resetKeys:n}=this.props;var s,o;i&&null!==e.error&&function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.length!==e.length||t.some(((t,i)=>!Object.is(t,e[i])))}(t.resetKeys,n)&&(null===(s=(o=this.props).onReset)||void 0===s||s.call(o,{next:n,prev:t.resetKeys,reason:"keys"}),this.setState(l))}render(){const{children:t,fallbackRender:e,FallbackComponent:i,fallback:n}=this.props,{didCatch:s,error:l}=this.state;let a=t;if(s){const t={error:l,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof e)a=e(t);else if(i)a=(0,o.createElement)(i,t);else{if(void 0===n)throw l;a=n}}return(0,o.createElement)(r.Provider,{value:{didCatch:s,error:l,resetErrorBoundary:this.resetErrorBoundary}},a)}}var h=i(4386),c=i(4876);function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,s,o,r,l=[],a=!0,h=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;a=!1}else for(;!(a=(n=o.call(i)).done)&&(l.push(n.value),l.length!==e);a=!0);}catch(t){h=!0,s=t}finally{try{if(!a&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(h)throw s}}return l}}(t,e)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?u(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var f,p,g,m,O=/^(.*?):\s*/,v=function(t){return t instanceof Error?t.message:String(t)},w=function(t){if(t instanceof Error){var e=t.stack;if(e){var i=e.match(O);if(i)return i[1]}}return"Error"},b=i(2011),y=i(5872),S=i(9994),x=i(1934);function k(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var M=s.A.p(f||(f=k(["\n  font-family:\n    ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono',\n    'Roboto Mono', 'Oxygen Mono', 'Ubuntu Monospace', 'Source Code Pro',\n    'Fira Mono', 'Droid Sans Mono', 'Courier New', monospace;\n  color: ",";\n  font-weight: 600;\n  padding: 0;\n  margin: 0;\n"])),(function(t){return"error"===t.type?"#DB3939":"#191823"})),C=s.A.p(p||(p=k(["\n  margin: 0;\n  padding: "," 0 0 0;\n"])),"16px"),A=s.A.pre(g||(g=k(["\n  white-space: pre-wrap;\n  font-family:\n    ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono',\n    'Roboto Mono', 'Oxygen Mono', 'Ubuntu Monospace', 'Source Code Pro',\n    'Fira Mono', 'Droid Sans Mono', 'Courier New', monospace;\n"]))),T="24px",P=(0,s.A)(b.az)(m||(m=k(["\n  padding: ",";\n  borderradius: ",";\n  background: ",";\n"])),T,"2px","#ebeff3"),D=function(t){var e=t.error,i=t.resetErrorBoundary,s=(0,y.W)(),o=(0,S.jL)(),r=function(t){var e,i=function(t){if(t instanceof Error){var e=t.stack;if(e){var i=e.match(/at\s+(.*)\s+\((.*):(\d+):(\d+)\)/);if(i){var n=d(i,5),s=n[1],o=n[2],r=n[3],l=n[4];return{file:o.trim(),widget:s.trim(),location:"".concat(r.trim(),":").concat(l.trim())}}var a=e.match(/at\s+()(.*):(\d+):(\d+)/);if(a){var h=d(a,5),c=h[1],u=h[2],f=h[3],p=h[4];return{file:u.trim(),widget:c.trim(),location:"".concat(f.trim(),":").concat(p.trim())}}}}return{file:"",location:"",widget:""}}(t),n=i.file,s=i.location,o=i.widget;return{type:w(t),message:v(t),file:n,location:s,widget:o,stack:t instanceof Error&&null!==(e=t.stack)&&void 0!==e?e:""}}(e),l=function(){null==i||i(),o(x.tR.renderWidget())};return(0,n.FD)(b.VP,{gap:T,children:[(0,n.Y)(P,{children:(0,n.FD)(b.fI,{css:{alignContent:"center"},children:[(0,n.FD)(b.VP,{justify:"center",children:[(0,n.Y)(M,{"data-qa":"bathtub.error.type",type:"error",children:r.type}),(0,n.Y)("h2",{"data-qa":"bathtub.error.heading",children:s("Bathtub.Renderer.HelpFailedHeader")}),(0,n.Y)(C,{children:s("Bathtub.Renderer.HelpFailed")})]}),(0,n.Y)(h.A,{keyName:"cmd+esc",onKeyDown:l,children:(0,n.Y)(c.Button,{onClick:l,children:s("Bathtub.Renderer.HelpFailedAction")})})]})}),(0,n.Y)(P,{children:(0,n.FD)(b.fI,{css:{alignContent:"center"},children:[(0,n.FD)(b.fI.Flex,{flex:"1",justify:"center",children:[(0,n.Y)(M,{"data-qa":"bathtub.error.message",type:"error",children:r.message}),(0,n.Y)(M,{"data-qa":"bathtub.error.location",type:"info",children:s("Bathtub.Renderer.HelpFailureLocation",{WIDGET:r.widget,LOCATION:r.location})})]}),(0,n.Y)("a",{href:"".concat(r.file),target:"_blank",children:s("Bathtub.Renderer.HelpFailureOpenFile")})]})}),(0,n.Y)(b.VP.Flex,{flex:"1",children:(0,n.FD)(P,{children:[(0,n.Y)("h3",{"data-qa":"bathtub.error.stackHeading",children:s("Bathtub.Renderer.HelpFailureStackTrace")}),(0,n.Y)(A,{children:r.stack})]})})]})},E=function(t){var e=t.children;return(0,n.Y)(a,{FallbackComponent:D,children:e})}},3404:function(t,e,i){"use strict";t.exports=i(3072)},3459:function(t,e,i){"use strict";var n=i(3209),s=function(){for(var t=n(16),e="",i=0;i<16;++i)e+=t[i].toString(16);return e}(),o=new RegExp('(\\\\)?"@__(F|R|D|M|S|A|U|I|B|L)-'+s+'-(\\d+)__@"',"g"),r=/\{\s*\[native code\]\s*\}/g,l=/function.*?\(/,a=/.*?=>.*?/,h=/[<>\/\u2028\u2029]/g,c=["*","async"],d={"<":"\\u003C",">":"\\u003E","/":"\\u002F","\u2028":"\\u2028","\u2029":"\\u2029"};function u(t){return d[t]}t.exports=function t(e,i){i||(i={}),"number"!=typeof i&&"string"!=typeof i||(i={space:i});var n,d=[],f=[],p=[],g=[],m=[],O=[],v=[],w=[],b=[],y=[];return i.ignoreFunction&&"function"==typeof e&&(e=void 0),void 0===e?String(e):(n=i.isJSON&&!i.space?JSON.stringify(e):JSON.stringify(e,i.isJSON?null:function(t,e){if(i.ignoreFunction&&function(t){var e=[];for(var i in t)"function"==typeof t[i]&&e.push(i);for(var n=0;n<e.length;n++)delete t[e[n]]}(e),!e&&void 0!==e&&e!==BigInt(0))return e;var n=this[t],o=typeof n;if("object"===o){if(n instanceof RegExp)return"@__R-"+s+"-"+(f.push(n)-1)+"__@";if(n instanceof Date)return"@__D-"+s+"-"+(p.push(n)-1)+"__@";if(n instanceof Map)return"@__M-"+s+"-"+(g.push(n)-1)+"__@";if(n instanceof Set)return"@__S-"+s+"-"+(m.push(n)-1)+"__@";if(n instanceof Array&&n.filter((function(){return!0})).length!==n.length)return"@__A-"+s+"-"+(O.push(n)-1)+"__@";if(n instanceof URL)return"@__L-"+s+"-"+(y.push(n)-1)+"__@"}return"function"===o?"@__F-"+s+"-"+(d.push(n)-1)+"__@":"undefined"===o?"@__U-"+s+"-"+(v.push(n)-1)+"__@":"number"!==o||isNaN(n)||isFinite(n)?"bigint"===o?"@__B-"+s+"-"+(b.push(n)-1)+"__@":e:"@__I-"+s+"-"+(w.push(n)-1)+"__@"},i.space),"string"!=typeof n?String(n):(!0!==i.unsafe&&(n=n.replace(h,u)),0===d.length&&0===f.length&&0===p.length&&0===g.length&&0===m.length&&0===O.length&&0===v.length&&0===w.length&&0===b.length&&0===y.length?n:n.replace(o,(function(e,n,s,o){return n?e:"D"===s?'new Date("'+p[o].toISOString()+'")':"R"===s?"new RegExp("+t(f[o].source)+', "'+f[o].flags+'")':"M"===s?"new Map("+t(Array.from(g[o].entries()),i)+")":"S"===s?"new Set("+t(Array.from(m[o].values()),i)+")":"A"===s?"Array.prototype.slice.call("+t(Object.assign({length:O[o].length},O[o]),i)+")":"U"===s?"undefined":"I"===s?w[o]:"B"===s?'BigInt("'+b[o]+'")':"L"===s?"new URL("+t(y[o].toString(),i)+")":function(t){var e=t.toString();if(r.test(e))throw new TypeError("Serializing native function: "+t.name);if(l.test(e))return e;if(a.test(e))return e;var i=e.indexOf("("),n=e.substr(0,i).trim().split(" ").filter((function(t){return t.length>0}));return n.filter((function(t){return-1===c.indexOf(t)})).length>0?(n.indexOf("async")>-1?"async ":"")+"function"+(n.join("").indexOf("*")>-1?"*":"")+e.substr(i):e}(d[o])}))))}},3561:function(t,e,i){"use strict";i.d(e,{Kq:function(){return S},bN:function(){return T},wA:function(){return C},d4:function(){return v}});var n=i(9888),s=i(9242),o=i(4946);let r=function(t){t()};const l=()=>r;var a=i(1302);const h=Symbol.for("react-redux-context"),c="undefined"!=typeof globalThis?globalThis:{};function d(){var t;if(!a.createContext)return{};const e=null!=(t=c[h])?t:c[h]=new Map;let i=e.get(a.createContext);return i||(i=a.createContext(null),e.set(a.createContext,i)),i}const u=d();function f(t=u){return function(){return(0,a.useContext)(t)}}const p=f();let g=()=>{throw new Error("uSES not initialized!")};const m=(t,e)=>t===e;function O(t=u){const e=t===u?p:f(t);return function(t,i={}){const{equalityFn:n=m,stabilityCheck:s,noopCheck:o}="function"==typeof i?{equalityFn:i}:i,{store:r,subscription:l,getServerState:h,stabilityCheck:c,noopCheck:d}=e(),u=((0,a.useRef)(!0),(0,a.useCallback)({[t.name](e){return t(e)}}[t.name],[t,c,s])),f=g(l.addNestedSub,r.getState,h||r.getState,u,n);return(0,a.useDebugValue)(f),f}}const v=O();i(4146),i(4363);const w={notify(){},get:()=>[]};const b="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?a.useLayoutEffect:a.useEffect;let y=null;var S=function({store:t,context:e,children:i,serverState:n,stabilityCheck:s="once",noopCheck:o="once"}){const r=a.useMemo((()=>{const e=function(t,e){let i,n=w,s=0,o=!1;function r(){c.onStateChange&&c.onStateChange()}function a(){s++,i||(i=e?e.addNestedSub(r):t.subscribe(r),n=function(){const t=l();let e=null,i=null;return{clear(){e=null,i=null},notify(){t((()=>{let t=e;for(;t;)t.callback(),t=t.next}))},get(){let t=[],i=e;for(;i;)t.push(i),i=i.next;return t},subscribe(t){let n=!0,s=i={callback:t,next:null,prev:i};return s.prev?s.prev.next=s:e=s,function(){n&&null!==e&&(n=!1,s.next?s.next.prev=s.prev:i=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}())}function h(){s--,i&&0===s&&(i(),i=void 0,n.clear(),n=w)}const c={addNestedSub:function(t){a();const e=n.subscribe(t);let i=!1;return()=>{i||(i=!0,e(),h())}},notifyNestedSubs:function(){n.notify()},handleChangeWrapper:r,isSubscribed:function(){return o},trySubscribe:function(){o||(o=!0,a())},tryUnsubscribe:function(){o&&(o=!1,h())},getListeners:()=>n};return c}(t);return{store:t,subscription:e,getServerState:n?()=>n:void 0,stabilityCheck:s,noopCheck:o}}),[t,n,s,o]),h=a.useMemo((()=>t.getState()),[t]);b((()=>{const{subscription:e}=r;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),h!==t.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}}),[r,h]);const c=e||u;return a.createElement(c.Provider,{value:r},i)};function x(t=u){const e=t===u?p:f(t);return function(){const{store:t}=e();return t}}const k=x();function M(t=u){const e=t===u?k:x(t);return function(){return e().dispatch}}const C=M();function A(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function T(t,e){if(A(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;const i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(let n=0;n<i.length;n++)if(!Object.prototype.hasOwnProperty.call(e,i[n])||!A(t[i[n]],e[i[n]]))return!1;return!0}var P,D;P=s.useSyncExternalStoreWithSelector,g=P,(t=>{y=t})(n.useSyncExternalStore),D=o.unstable_batchedUpdates,r=D},4146:function(t,e,i){"use strict";var n=i(3404),s={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};function a(t){return n.isMemo(t)?r:l[t.$$typeof]||s}l[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l[n.Memo]=r;var h=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,u=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;t.exports=function t(e,i,n){if("string"!=typeof i){if(p){var s=f(i);s&&s!==p&&t(e,s,n)}var r=c(i);d&&(r=r.concat(d(i)));for(var l=a(e),g=a(i),m=0;m<r.length;++m){var O=r[m];if(!(o[O]||n&&n[O]||g&&g[O]||l&&l[O])){var v=u(i,O);try{h(e,O,v)}catch(t){}}}}return e}},4363:function(t,e,i){"use strict";i(2799)},4386:function(t,e,i){"use strict";i.d(e,{A:function(){return P}});var n=i(1302),s=i(5556);const o="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function r(t,e,i,n){t.addEventListener?t.addEventListener(e,i,n):t.attachEvent&&t.attachEvent("on".concat(e),i)}function l(t,e,i,n){t.removeEventListener?t.removeEventListener(e,i,n):t.detachEvent&&t.detachEvent("on".concat(e),i)}function a(t,e){const i=e.slice(0,e.length-1);for(let e=0;e<i.length;e++)i[e]=t[i[e].toLowerCase()];return i}function h(t){"string"!=typeof t&&(t="");const e=(t=t.replace(/\s/g,"")).split(",");let i=e.lastIndexOf("");for(;i>=0;)e[i-1]+=",",e.splice(i,1),i=e.lastIndexOf("");return e}const c={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":o?173:189,"=":o?61:187,";":o?59:186,"'":222,"[":219,"]":221,"\\":220},d={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},f={16:!1,18:!1,17:!1,91:!1},p={};for(let t=1;t<20;t++)c["f".concat(t)]=111+t;let g=[],m=null,O="all";const v=new Map,w=t=>c[t.toLowerCase()]||d[t.toLowerCase()]||t.toUpperCase().charCodeAt(0);function b(t){O=t||"all"}function y(){return O||"all"}function S(t){if(void 0===t)Object.keys(p).forEach((t=>{Array.isArray(p[t])&&p[t].forEach((t=>x(t))),delete p[t]})),A(null);else if(Array.isArray(t))t.forEach((t=>{t.key&&x(t)}));else if("object"==typeof t)t.key&&x(t);else if("string"==typeof t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];let[s,o]=i;"function"==typeof s&&(o=s,s=""),x({key:t,scope:s,method:o,splitKey:"+"})}}const x=t=>{let{key:e,scope:i,method:n,splitKey:s="+"}=t;h(e).forEach((t=>{const e=t.split(s),o=e.length,r=e[o-1],l="*"===r?"*":w(r);if(!p[l])return;i||(i=y());const h=o>1?a(d,e):[],c=[];p[l]=p[l].filter((t=>{const e=(!n||t.method===n)&&t.scope===i&&function(t,e){const i=t.length>=e.length?t:e,n=t.length>=e.length?e:t;let s=!0;for(let t=0;t<i.length;t++)-1===n.indexOf(i[t])&&(s=!1);return s}(t.mods,h);return e&&c.push(t.element),!e})),c.forEach((t=>A(t)))}))};function k(t,e,i,n){if(e.element!==n)return;let s;if(e.scope===i||"all"===e.scope){s=e.mods.length>0;for(const t in f)Object.prototype.hasOwnProperty.call(f,t)&&(!f[t]&&e.mods.indexOf(+t)>-1||f[t]&&-1===e.mods.indexOf(+t))&&(s=!1);(0!==e.mods.length||f[16]||f[18]||f[17]||f[91])&&!s&&"*"!==e.shortcut||(e.keys=[],e.keys=e.keys.concat(g),!1===e.method(t,e)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function M(t,e){const i=p["*"];let n=t.keyCode||t.which||t.charCode;if(!C.filter.call(this,t))return;if(93!==n&&224!==n||(n=91),-1===g.indexOf(n)&&229!==n&&g.push(n),["metaKey","ctrlKey","altKey","shiftKey"].forEach((e=>{const i=u[e];t[e]&&-1===g.indexOf(i)?g.push(i):!t[e]&&g.indexOf(i)>-1?g.splice(g.indexOf(i),1):"metaKey"===e&&t[e]&&(g=g.filter((t=>t in u||t===n)))})),n in f){f[n]=!0;for(const e in d)if(Object.prototype.hasOwnProperty.call(d,e)){const i=u[d[e]];C[e]=t[i]}if(!i)return}for(const e in f)Object.prototype.hasOwnProperty.call(f,e)&&(f[e]=t[u[e]]);t.getModifierState&&(!t.altKey||t.ctrlKey)&&t.getModifierState("AltGraph")&&(-1===g.indexOf(17)&&g.push(17),-1===g.indexOf(18)&&g.push(18),f[17]=!0,f[18]=!0);const s=y();if(i)for(let n=0;n<i.length;n++)i[n].scope===s&&("keydown"===t.type&&i[n].keydown||"keyup"===t.type&&i[n].keyup)&&k(t,i[n],s,e);if(!(n in p))return;const o=p[n],r=o.length;for(let i=0;i<r;i++)if(("keydown"===t.type&&o[i].keydown||"keyup"===t.type&&o[i].keyup)&&o[i].key){const n=o[i],{splitKey:r}=n,l=n.key.split(r),a=[];for(let t=0;t<l.length;t++)a.push(w(l[t]));a.sort().join("")===g.sort().join("")&&k(t,n,s,e)}}function C(t,e,i){g=[];const n=h(t);let s=[],o="all",l=document,c=0,u=!1,O=!0,b="+",y=!1,x=!1;for(void 0===i&&"function"==typeof e&&(i=e),"[object Object]"===Object.prototype.toString.call(e)&&(e.scope&&(o=e.scope),e.element&&(l=e.element),e.keyup&&(u=e.keyup),void 0!==e.keydown&&(O=e.keydown),void 0!==e.capture&&(y=e.capture),"string"==typeof e.splitKey&&(b=e.splitKey),!0===e.single&&(x=!0)),"string"==typeof e&&(o=e),x&&S(t,o);c<n.length;c++)s=[],(t=n[c].split(b)).length>1&&(s=a(d,t)),(t="*"===(t=t[t.length-1])?"*":w(t))in p||(p[t]=[]),p[t].push({keyup:u,keydown:O,scope:o,mods:s,shortcut:n[c],method:i,key:n[c],splitKey:b,element:l});if(void 0!==l&&window){if(!v.has(l)){const t=function(){return M(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,l)},e=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;M(t,l),function(t){let e=t.keyCode||t.which||t.charCode;const i=g.indexOf(e);if(i>=0&&g.splice(i,1),t.key&&"meta"===t.key.toLowerCase()&&g.splice(0,g.length),93!==e&&224!==e||(e=91),e in f){f[e]=!1;for(const t in d)d[t]===e&&(C[t]=!1)}}(t)};v.set(l,{keydownListener:t,keyupListenr:e,capture:y}),r(l,"keydown",t,y),r(l,"keyup",e,y)}if(!m){const t=()=>{g=[]};m={listener:t,capture:y},r(window,"focus",t,y)}}}function A(t){const e=Object.values(p).flat();if(e.findIndex((e=>{let{element:i}=e;return i===t}))<0){const{keydownListener:e,keyupListenr:i,capture:n}=v.get(t)||{};e&&i&&(l(t,"keyup",i,n),l(t,"keydown",e,n),v.delete(t))}if((e.length<=0||v.size<=0)&&(Object.keys(v).forEach((t=>{const{keydownListener:e,keyupListenr:i,capture:n}=v.get(t)||{};e&&i&&(l(t,"keyup",i,n),l(t,"keydown",e,n),v.delete(t))})),v.clear(),Object.keys(p).forEach((t=>delete p[t])),m)){const{listener:t,capture:e}=m;l(window,"focus",t,e),m=null}}const T={getPressedKeyString:function(){return g.map((t=>{return e=t,Object.keys(c).find((t=>c[t]===e))||(t=>Object.keys(d).find((e=>d[e]===t)))(t)||String.fromCharCode(t);var e}))},setScope:b,getScope:y,deleteScope:function(t,e){let i,n;t||(t=y());for(const e in p)if(Object.prototype.hasOwnProperty.call(p,e))for(i=p[e],n=0;n<i.length;)i[n].scope===t?i.splice(n,1).forEach((t=>{let{element:e}=t;return A(e)})):n++;y()===t&&b(e||"all")},getPressedKeyCodes:function(){return g.slice(0)},getAllKeyCodes:function(){const t=[];return Object.keys(p).forEach((e=>{p[e].forEach((e=>{let{key:i,scope:n,mods:s,shortcut:o}=e;t.push({scope:n,shortcut:o,mods:s,keys:i.split("+").map((t=>w(t)))})}))})),t},isPressed:function(t){return"string"==typeof t&&(t=w(t)),-1!==g.indexOf(t)},filter:function(t){const e=t.target||t.srcElement,{tagName:i}=e;let n=!0;const s="INPUT"===i&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(s||"TEXTAREA"===i||"SELECT"===i)&&!e.readOnly)&&(n=!1),n},trigger:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(p).forEach((i=>{p[i].filter((i=>i.scope===e&&i.shortcut===t)).forEach((t=>{t&&t.method&&t.method()}))}))},unbind:S,keyMap:c,modifier:d,modifierMap:u};for(const t in T)Object.prototype.hasOwnProperty.call(T,t)&&(C[t]=T[t]);if("undefined"!=typeof window){const t=window.hotkeys;C.noConflict=e=>(e&&window.hotkeys===C&&(window.hotkeys=t),C),window.hotkeys=C}class P extends n.default.Component{constructor(t){super(t),this.isKeyDown=!1,this.handle=void 0,this.onKeyDown=this.onKeyDown.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.handleKeyUpEvent=this.handleKeyUpEvent.bind(this),this.handle={}}componentDidMount(){var{filter:t,splitKey:e}=this.props;t&&(C.filter=t),C.unbind(this.props.keyName),C(this.props.keyName,{splitKey:e},this.onKeyDown),document&&document.body.addEventListener("keyup",this.handleKeyUpEvent)}componentWillUnmount(){C.unbind(this.props.keyName),this.isKeyDown=!0,this.handle={},document&&document.body.removeEventListener("keyup",this.handleKeyUpEvent)}onKeyUp(t,e){var{onKeyUp:i,disabled:n}=this.props;!n&&i&&i(e.shortcut,t,e)}onKeyDown(t,e){var{onKeyDown:i,allowRepeat:n,disabled:s}=this.props;this.isKeyDown&&!n||(this.isKeyDown=!0,this.handle=e,!s&&i&&i(e.shortcut,t,e))}handleKeyUpEvent(t){this.isKeyDown&&(this.isKeyDown=!1,this.props.keyName&&this.props.keyName.indexOf(this.handle.shortcut)<0||(this.onKeyUp(t,this.handle),this.handle={}))}render(){return this.props.children||null}}P.defaultProps={filter(t){var e=t.target||t.srcElement,i=e.tagName;return!(e.isContentEditable||"INPUT"===i||"SELECT"===i||"TEXTAREA"===i)}},P.propTypes={keyName:s.string,filter:s.func,onKeyDown:s.func,onKeyUp:s.func,disabled:s.bool,splitKey:s.string}},4684:function(t,e,i){"use strict";i.d(e,{E:function(){return g},T:function(){return c},c:function(){return f},h:function(){return d},w:function(){return h}});var n=i(1302),s=i(5655),o=i(41),r=i(3174),l=i(1287),a=n.createContext("undefined"!=typeof HTMLElement?(0,s.A)({key:"css"}):null),h=(a.Provider,function(t){return(0,n.forwardRef)((function(e,i){var s=(0,n.useContext)(a);return t(e,s,i)}))}),c=n.createContext({}),d={}.hasOwnProperty,u="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",f=function(t,e){var i={};for(var n in e)d.call(e,n)&&(i[n]=e[n]);return i[u]=t,i},p=function(t){var e=t.cache,i=t.serialized,n=t.isStringTag;return(0,o.SF)(e,i,n),(0,l.s)((function(){return(0,o.sk)(e,i,n)})),null},g=h((function(t,e,i){var s=t.css;"string"==typeof s&&void 0!==e.registered[s]&&(s=e.registered[s]);var l=t[u],a=[s],h="";"string"==typeof t.className?h=(0,o.Rk)(e.registered,a,t.className):null!=t.className&&(h=t.className+" ");var f=(0,r.J)(a,void 0,n.useContext(c));h+=e.key+"-"+f.name;var g={};for(var m in t)d.call(t,m)&&"css"!==m&&m!==u&&(g[m]=t[m]);return g.className=h,i&&(g.ref=i),n.createElement(n.Fragment,null,n.createElement(p,{cache:e,serialized:f,isStringTag:"string"==typeof l}),n.createElement(l,g))}))},4848:function(t,e,i){"use strict";t.exports=i(1020)},4876:function(t){"use strict";t.exports=__WEBPACK_EXTERNAL_MODULE__4876__},4946:function(t){"use strict";t.exports=__WEBPACK_EXTERNAL_MODULE__4946__},5056:function(t,e,i){"use strict";t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},5072:function(t){"use strict";var e=[];function i(t){for(var i=-1,n=0;n<e.length;n++)if(e[n].identifier===t){i=n;break}return i}function n(t,n){for(var o={},r=[],l=0;l<t.length;l++){var a=t[l],h=n.base?a[0]+n.base:a[0],c=o[h]||0,d="".concat(h," ").concat(c);o[h]=c+1;var u=i(d),f={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==u)e[u].references++,e[u].updater(f);else{var p=s(f,n);n.byIndex=l,e.splice(l,0,{identifier:d,updater:p,references:1})}r.push(d)}return r}function s(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,s){var o=n(t=t||[],s=s||{});return function(t){t=t||[];for(var r=0;r<o.length;r++){var l=i(o[r]);e[l].references--}for(var a=n(t,s),h=0;h<o.length;h++){var c=i(o[h]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=a}}},5391:function(t,e,i){"use strict";i.d(e,{No:function(){return a},nG:function(){return l}});var n=i(6432),s=i(1081),o=i(1712),r=(0,n.Z0)({initialState:{filters:[]},name:"widgetBrowser",reducers:{applyFilters:function(t,e){t.filters=e.payload}}}),l={selectFilteredWidgets:(0,s.Mz)([o.bh],(function(t){return t}))},a=(r.actions,r.reducer)},5556:function(t,e,i){t.exports=i(2694)()},5655:function(t,e,i){"use strict";i.d(e,{A:function(){return nt}});var n=function(){function t(t){var e=this;this._insertTag=function(t){var i;i=0===e.tags.length?e.insertionPoint?e.insertionPoint.nextSibling:e.prepend?e.container.firstChild:e.before:e.tags[e.tags.length-1].nextSibling,e.container.insertBefore(t,i),e.tags.push(t)},this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(t){t.forEach(this._insertTag)},e.insert=function(t){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}(this));var e=this.tags[this.tags.length-1];if(this.isSpeedy){var i=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(e);try{i.insertRule(t,i.cssRules.length)}catch(t){}}else e.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach((function(t){var e;return null==(e=t.parentNode)?void 0:e.removeChild(t)})),this.tags=[],this.ctr=0},t}(),s=Math.abs,o=String.fromCharCode,r=Object.assign;function l(t){return t.trim()}function a(t,e,i){return t.replace(e,i)}function h(t,e){return t.indexOf(e)}function c(t,e){return 0|t.charCodeAt(e)}function d(t,e,i){return t.slice(e,i)}function u(t){return t.length}function f(t){return t.length}function p(t,e){return e.push(t),t}var g=1,m=1,O=0,v=0,w=0,b="";function y(t,e,i,n,s,o,r){return{value:t,root:e,parent:i,type:n,props:s,children:o,line:g,column:m,length:r,return:""}}function S(t,e){return r(y("",null,null,"",null,null,0),t,{length:-t.length},e)}function x(){return w=v>0?c(b,--v):0,m--,10===w&&(m=1,g--),w}function k(){return w=v<O?c(b,v++):0,m++,10===w&&(m=1,g++),w}function M(){return c(b,v)}function C(){return v}function A(t,e){return d(b,t,e)}function T(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function P(t){return g=m=1,O=u(b=t),v=0,[]}function D(t){return b="",t}function E(t){return l(A(v-1,B(91===t?t+2:40===t?t+1:t)))}function R(t){for(;(w=M())&&w<33;)k();return T(t)>2||T(w)>3?"":" "}function Q(t,e){for(;--e&&k()&&!(w<48||w>102||w>57&&w<65||w>70&&w<97););return A(t,C()+(e<6&&32==M()&&32==k()))}function B(t){for(;k();)switch(w){case t:return v;case 34:case 39:34!==t&&39!==t&&B(w);break;case 40:41===t&&B(t);break;case 92:k()}return v}function L(t,e){for(;k()&&t+w!==57&&(t+w!==84||47!==M()););return"/*"+A(e,v-1)+"*"+o(47===t?t:k())}function $(t){for(;!T(M());)k();return A(t,v)}var _="-ms-",V="-moz-",N="-webkit-",W="comm",H="rule",q="decl",F="@keyframes";function z(t,e){for(var i="",n=f(t),s=0;s<n;s++)i+=e(t[s],s,t,e)||"";return i}function I(t,e,i,n){switch(t.type){case"@layer":if(t.children.length)break;case"@import":case q:return t.return=t.return||t.value;case W:return"";case F:return t.return=t.value+"{"+z(t.children,n)+"}";case H:t.value=t.props.join(",")}return u(i=z(t.children,n))?t.return=t.value+"{"+i+"}":""}function Z(t){return D(X("",null,null,null,[""],t=P(t),0,[0],t))}function X(t,e,i,n,s,r,l,d,f){for(var g=0,m=0,O=l,v=0,w=0,b=0,y=1,S=1,A=1,T=0,P="",D=s,B=r,_=n,V=P;S;)switch(b=T,T=k()){case 40:if(108!=b&&58==c(V,O-1)){-1!=h(V+=a(E(T),"&","&\f"),"&\f")&&(A=-1);break}case 34:case 39:case 91:V+=E(T);break;case 9:case 10:case 13:case 32:V+=R(b);break;case 92:V+=Q(C()-1,7);continue;case 47:switch(M()){case 42:case 47:p(Y(L(k(),C()),e,i),f);break;default:V+="/"}break;case 123*y:d[g++]=u(V)*A;case 125*y:case 59:case 0:switch(T){case 0:case 125:S=0;case 59+m:-1==A&&(V=a(V,/\f/g,"")),w>0&&u(V)-O&&p(w>32?U(V+";",n,i,O-1):U(a(V," ","")+";",n,i,O-2),f);break;case 59:V+=";";default:if(p(_=j(V,e,i,g,m,s,d,P,D=[],B=[],O),r),123===T)if(0===m)X(V,e,_,_,D,r,O,d,B);else switch(99===v&&110===c(V,3)?100:v){case 100:case 108:case 109:case 115:X(t,_,_,n&&p(j(t,_,_,0,0,s,d,P,s,D=[],O),B),s,B,O,d,n?D:B);break;default:X(V,_,_,_,[""],B,0,d,B)}}g=m=w=0,y=A=1,P=V="",O=l;break;case 58:O=1+u(V),w=b;default:if(y<1)if(123==T)--y;else if(125==T&&0==y++&&125==x())continue;switch(V+=o(T),T*y){case 38:A=m>0?1:(V+="\f",-1);break;case 44:d[g++]=(u(V)-1)*A,A=1;break;case 64:45===M()&&(V+=E(k())),v=M(),m=O=u(P=V+=$(C())),T++;break;case 45:45===b&&2==u(V)&&(y=0)}}return r}function j(t,e,i,n,o,r,h,c,u,p,g){for(var m=o-1,O=0===o?r:[""],v=f(O),w=0,b=0,S=0;w<n;++w)for(var x=0,k=d(t,m+1,m=s(b=h[w])),M=t;x<v;++x)(M=l(b>0?O[x]+" "+k:a(k,/&\f/g,O[x])))&&(u[S++]=M);return y(t,e,i,0===o?H:c,u,p,g)}function Y(t,e,i){return y(t,e,i,W,o(w),d(t,2,-2),0)}function U(t,e,i,n){return y(t,e,i,q,d(t,0,n),d(t,n+1,-1),n)}var K=function(t,e,i){for(var n=0,s=0;n=s,s=M(),38===n&&12===s&&(e[i]=1),!T(s);)k();return A(t,v)},G=new WeakMap,J=function(t){if("rule"===t.type&&t.parent&&!(t.length<1)){for(var e=t.value,i=t.parent,n=t.column===i.column&&t.line===i.line;"rule"!==i.type;)if(!(i=i.parent))return;if((1!==t.props.length||58===e.charCodeAt(0)||G.get(i))&&!n){G.set(t,!0);for(var s=[],r=function(t,e){return D(function(t,e){var i=-1,n=44;do{switch(T(n)){case 0:38===n&&12===M()&&(e[i]=1),t[i]+=K(v-1,e,i);break;case 2:t[i]+=E(n);break;case 4:if(44===n){t[++i]=58===M()?"&\f":"",e[i]=t[i].length;break}default:t[i]+=o(n)}}while(n=k());return t}(P(t),e))}(e,s),l=i.props,a=0,h=0;a<r.length;a++)for(var c=0;c<l.length;c++,h++)t.props[h]=s[a]?r[a].replace(/&\f/g,l[c]):l[c]+" "+r[a]}}},tt=function(t){if("decl"===t.type){var e=t.value;108===e.charCodeAt(0)&&98===e.charCodeAt(2)&&(t.return="",t.value="")}};function et(t,e){switch(function(t,e){return 45^c(t,0)?(((e<<2^c(t,0))<<2^c(t,1))<<2^c(t,2))<<2^c(t,3):0}(t,e)){case 5103:return N+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return N+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return N+t+V+t+_+t+t;case 6828:case 4268:return N+t+_+t+t;case 6165:return N+t+_+"flex-"+t+t;case 5187:return N+t+a(t,/(\w+).+(:[^]+)/,N+"box-$1$2"+_+"flex-$1$2")+t;case 5443:return N+t+_+"flex-item-"+a(t,/flex-|-self/,"")+t;case 4675:return N+t+_+"flex-line-pack"+a(t,/align-content|flex-|-self/,"")+t;case 5548:return N+t+_+a(t,"shrink","negative")+t;case 5292:return N+t+_+a(t,"basis","preferred-size")+t;case 6060:return N+"box-"+a(t,"-grow","")+N+t+_+a(t,"grow","positive")+t;case 4554:return N+a(t,/([^-])(transform)/g,"$1"+N+"$2")+t;case 6187:return a(a(a(t,/(zoom-|grab)/,N+"$1"),/(image-set)/,N+"$1"),t,"")+t;case 5495:case 3959:return a(t,/(image-set\([^]*)/,N+"$1$`$1");case 4968:return a(a(t,/(.+:)(flex-)?(.*)/,N+"box-pack:$3"+_+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+N+t+t;case 4095:case 3583:case 4068:case 2532:return a(t,/(.+)-inline(.+)/,N+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(u(t)-1-e>6)switch(c(t,e+1)){case 109:if(45!==c(t,e+4))break;case 102:return a(t,/(.+:)(.+)-([^]+)/,"$1"+N+"$2-$3$1"+V+(108==c(t,e+3)?"$3":"$2-$3"))+t;case 115:return~h(t,"stretch")?et(a(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(115!==c(t,e+1))break;case 6444:switch(c(t,u(t)-3-(~h(t,"!important")&&10))){case 107:return a(t,":",":"+N)+t;case 101:return a(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+N+(45===c(t,14)?"inline-":"")+"box$3$1"+N+"$2$3$1"+_+"$2box$3")+t}break;case 5936:switch(c(t,e+11)){case 114:return N+t+_+a(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return N+t+_+a(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return N+t+_+a(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return N+t+_+t+t}return t}var it=[function(t,e,i,n){if(t.length>-1&&!t.return)switch(t.type){case q:t.return=et(t.value,t.length);break;case F:return z([S(t,{value:a(t.value,"@","@"+N)})],n);case H:if(t.length)return function(t,e){return t.map(e).join("")}(t.props,(function(e){switch(function(t){return(t=/(::plac\w+|:read-\w+)/.exec(t))?t[0]:t}(e)){case":read-only":case":read-write":return z([S(t,{props:[a(e,/:(read-\w+)/,":-moz-$1")]})],n);case"::placeholder":return z([S(t,{props:[a(e,/:(plac\w+)/,":"+N+"input-$1")]}),S(t,{props:[a(e,/:(plac\w+)/,":-moz-$1")]}),S(t,{props:[a(e,/:(plac\w+)/,_+"input-$1")]})],n)}return""}))}}],nt=function(t){var e=t.key;if("css"===e){var i=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(i,(function(t){-1!==t.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(t),t.setAttribute("data-s",""))}))}var s,o,r=t.stylisPlugins||it,l={},a=[];s=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+e+' "]'),(function(t){for(var e=t.getAttribute("data-emotion").split(" "),i=1;i<e.length;i++)l[e[i]]=!0;a.push(t)}));var h,c,d,u,p=[I,(u=function(t){h.insert(t)},function(t){t.root||(t=t.return)&&u(t)})],g=(c=[J,tt].concat(r,p),d=f(c),function(t,e,i,n){for(var s="",o=0;o<d;o++)s+=c[o](t,e,i,n)||"";return s});o=function(t,e,i,n){h=i,z(Z(t?t+"{"+e.styles+"}":e.styles),g),n&&(m.inserted[e.name]=!0)};var m={key:e,sheet:new n({key:e,container:s,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:l,registered:{},insert:o};return m.sheet.hydrate(a),m}},5872:function(t,e,i){"use strict";i.d(e,{W:function(){return s}});var n={Bathtub:{Header:{SkipLink:{translation:"Skip to main",instruction:"Link to the main content of the page"},Waffle:{translation:"Widget switcher",instruction:"Button to switch between widgets"},Docs:{translation:"1FE Docs",instruction:"Button to link to the 1FE Docs"},Help:{translation:"Help",instruction:"Button to open the help slack channel"},Reset:{translation:"Reset",instruction:"Button to reset the widget"},Render:{translation:"Render",instruction:"Button to render the widget"},Editor:{translation:"Widget props",instruction:"Button to open the widget props"},Variant:{translation:"Variant",instruction:"Button to open the variant switcher"},VariantDefault:{translation:"Default",instruction:"Button to switch to the default widget"}},App:{Loading:{translation:"Loading...",instruction:"Loading message when the environment is loading"}},PropEditor:{Title:{translation:"Widget props",instruction:"Title of the property editor"},Update:{translation:"Update",instruction:"Button to update the widget props"},ValidationError:{translation:"There is a problem with props. Check the console for more information.",instruction:"Error message to users when props object is not valid."}},Renderer:{Help:{translation:"Select a <code>widget</code> from the waffle menu to get started. Or you can add the <code>widgetUrl</code> query parameter to the URL to load a specific widget.",instruction:"Help message when no widget is selected"},HelpAction:{translation:"Select a widget",instruction:"Title of the help message"},HelpHeader:{translation:"Welcome to 1FE Bathtub!",instruction:"Header of the help message"},HelpFailed:{translation:"We tried loading the widget and failed. Press the CLEAN button to reset the bathtub.",instruction:"Message when the widget fails to load"},HelpFailedHeader:{translation:"Yikes! We couldn't load the widget.",instruction:"Message when the widget fails to load"},HelpFailedAction:{translation:"Clean",instruction:"Button to clean the bathtub"},HelpFailureLocation:{translation:"{{WIDGET}}:{{LOCATION}}",instruction:"The error message and location joined with :"},HelpFailureOpenFile:{translation:"Open in browser",instruction:"Button to open the file where the error occurred"},HelpFailureStackTrace:{translation:"Stack trace",instruction:"Heading for the stack trace"}},Switcher:{SearchLabel:{translation:"Select a widget",instruction:"Label for the search input"},SearchPlaceholder:{translation:"@1fe/widget-starter-kit",instruction:"Placeholder for the search input"},SwitcherTitle:{translation:"Widget switcher",instruction:"Title of the widget switcher"},UrlSwitcherLabel:{translation:"Enter a widget url",instruction:"Label of the widget switcher"},QuickLinksLabel:{translation:"Quick load:",instruction:"Label of the quick links"},Apply:{translation:"Apply",instruction:"Button to apply new url from the widget switcher"},SwitcherPlaceholder:{translation:"http://localhost:8081/js/1fe-bundle.js",instruction:"Placeholder of the widget switcher"},OrLabel:{translation:"OR",instruction:"Text that separates the widget switcher and the widget url switcher"}},Shortcuts:{Title:{translation:"Shortcuts",instruction:"Title of the shortcuts widget"},Copy:{translation:"Copy",instruction:"Button to copy the shortcut"},CopyShortcut:{translation:"CTRL+SHIFT+C",instruction:"Shortcut to trigger the copy action"},OpenSwitcher:{translation:"Open widget switcher",instruction:"Button to open the widget switcher"},OpenSwitcherShortcut:{translation:"Ctrl+/",instruction:"Shortcut to trigger the widget switcher"},OpenEditor:{translation:"Open props editor",instruction:"Button to open the widget props"},OpenEditorShortcut:{translation:"Ctrl+P",instruction:"Shortcut to trigger the widget props"},Reset:{translation:"Reset",instruction:"Button to reset the widget"},ResetShortcut:{translation:"Ctrl+R",instruction:"Shortcut to reload the widget"},Clean:{translation:"Clean (on error)",instruction:"Button to clean the bathtub"},CleanShortcut:{translation:"CMD+ESC",instruction:"Shortcut to clean the bathtub"}}},PluginBrowser:{ColumnHeaders:{Name:{translation:"Plugin",instruction:"Column header for the plugin name"},VersionInt:{translation:"Version: Int",instruction:"Column header for the plugin version in the integration environment"},VersionStage:{translation:"Version: Stage",instruction:"Column header for the plugin version in the staging environment"},VersionDemo:{translation:"Version: Demo",instruction:"Column header for the plugin version in the demo environment"},VersionProd:{translation:"Version: Prod",instruction:"Column header for the plugin version in the production environment"},Route:{translation:"Route",instruction:"Column header for the plugin route"},Auth:{translation:"Authentication Enabled",instruction:"Column header for the plugin authentication required"},Launch:{translation:"Launch",instruction:"Column header for the plugin open button"}}},WidgetBrowser:{Root:{Title:{translation:"Widget Browser",instruction:"Title of the widget browser"},PreviewTag:{translation:"Preview",instruction:"Tag for the preview button"}},Menu:{Actions:{translation:"More Actions - {{widget_name}}",instruction:"Button to open the actions menu for a widget"},PipelineHeader:{translation:"Pipelines",instruction:"Header for the pipeline menu"},AzureDevOps:{translation:"ADO Project",instruction:"Button to open the ADO project"},BundleAnalysis:{translation:"Bundle Analysis",instruction:"Button to open the bundle analysis"},Pipeline:{translation:"Pipeline",instruction:"Button to open the pipeline"},Rollback:{translation:"Rollback",instruction:"Button to rollback the widget"},ConfigurationHeader:{translation:"Configs",instruction:"Header for the configuration menu"},ConfigurationInt:{translation:"Integration",instruction:"Button to open the widget integration configuration"},ConfigurationStage:{translation:"Stage",instruction:"Button to open the widget stage configuration"},ConfigurationDemo:{translation:"Demo",instruction:"Button to open the widget demo configuration"},ConfigurationProd:{translation:"Production",instruction:"Button to open the widget prod configuration"},Team:{translation:"Contact",instruction:"Button to contact the widget owner"},CreatedDate:{translation:"Created {{date}}",instruction:"Description of the widget creation date"}},Links:{Repository:{translation:"Repository - {{widget_name}}",instruction:"Link to the widget repository"},Configuration:{translation:"Configuration",instruction:"Link to the widget configuration"},Bathtub:{translation:"Launch {{widget_name}}",instruction:"Link to the widget in the bathtub"},Version:{translation:"{{version_number}} - {{widget_name}}",instruction:"Link showing the version number with the widget name added for additional context"}},Columns:{Id:{translation:"Id",instruction:"Column header for Id"},Name:{translation:"NAME",instruction:"Column header for Name"},Links:{translation:"LINKS",instruction:"Column header for Links"},Route:{translation:"ROUTE",instruction:"Column header for Route"},Authentication:{translation:"AUTHENTICATION",instruction:"Column header for Authentication"},Integration:{translation:"INTEGRATION",instruction:"Column header for Integration"},Stage:{translation:"STAGE",instruction:"Column header for Stage"},Demo:{translation:"DEMO",instruction:"Column header for Demo"},Prod:{translation:"PROD",instruction:"Column header for Prod"},Action:{translation:"ACTION",instruction:"Column header for Action"}}},DataTable:{Footer:{AccessibilityText:{translation:"Pagination",instruction:"Accessibility text for the pagination"}}}},s=function(){return function(t,e){return t.split(".").reduce((function(t,e){return null==t?void 0:t[e]}),n).translation}}},6234:function(t,e,i){"use strict";i.d(e,{UI:function(){return o}});var n="NOT_FOUND",s=function(t,e){return t===e};function o(t,e){var i,o,r="object"==typeof e?e:{equalityCheck:e},l=r.equalityCheck,a=void 0===l?s:l,h=r.maxSize,c=void 0===h?1:h,d=r.resultEqualityCheck,u=function(t){return function(e,i){if(null===e||null===i||e.length!==i.length)return!1;for(var n=e.length,s=0;s<n;s++)if(!t(e[s],i[s]))return!1;return!0}}(a),f=1===c?(i=u,{get:function(t){return o&&i(o.key,t)?o.value:n},put:function(t,e){o={key:t,value:e}},getEntries:function(){return o?[o]:[]},clear:function(){o=void 0}}):function(t,e){var i=[];function s(t){var s=i.findIndex((function(i){return e(t,i.key)}));if(s>-1){var o=i[s];return s>0&&(i.splice(s,1),i.unshift(o)),o.value}return n}return{get:s,put:function(e,o){s(e)===n&&(i.unshift({key:e,value:o}),i.length>t&&i.pop())},getEntries:function(){return i},clear:function(){i=[]}}}(c,u);function p(){var e=f.get(arguments);if(e===n){if(e=t.apply(null,arguments),d){var i=f.getEntries().find((function(t){return d(t.value,e)}));i&&(e=i.value)}f.put(arguments,e)}return e}return p.clearCache=function(){return f.clear()},p}},6289:function(t,e,i){"use strict";function n(t){var e=Object.create(null);return function(i){return void 0===e[i]&&(e[i]=t(i)),e[i]}}i.d(e,{A:function(){return n}})},6314:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,n,s,o){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(n)for(var l=0;l<this.length;l++){var a=this[l][0];null!=a&&(r[a]=!0)}for(var h=0;h<t.length;h++){var c=[].concat(t[h]);n&&r[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),s&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=s):c[4]="".concat(s)),e.push(c))}},e}},6432:function(t,e,i){"use strict";function n(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+t+(i.length?" "+i.map((function(t){return"'"+t+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function s(t){return!!t&&!!t[z]}function o(t){var e;return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;var i=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return i===Object||"function"==typeof i&&Function.toString.call(i)===I}(t)||Array.isArray(t)||!!t[F]||!!(null===(e=t.constructor)||void 0===e?void 0:e[F])||d(t)||u(t))}function r(t,e,i){void 0===i&&(i=!1),0===l(t)?(i?Object.keys:Z)(t).forEach((function(n){i&&"symbol"==typeof n||e(n,t[n],t)})):t.forEach((function(i,n){return e(n,i,t)}))}function l(t){var e=t[z];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:d(t)?2:u(t)?3:0}function a(t,e){return 2===l(t)?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function h(t,e,i){var n=l(t);2===n?t.set(e,i):3===n?t.add(i):t[e]=i}function c(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function d(t){return N&&t instanceof Map}function u(t){return W&&t instanceof Set}function f(t){return t.o||t.t}function p(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=X(t);delete e[z];for(var i=Z(e),n=0;n<i.length;n++){var s=i[n],o=e[s];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Object.getPrototypeOf(t),e)}function g(t,e){return void 0===e&&(e=!1),O(t)||s(t)||!o(t)||(l(t)>1&&(t.set=t.add=t.clear=t.delete=m),Object.freeze(t),e&&r(t,(function(t,e){return g(e,!0)}),!0)),t}function m(){n(2)}function O(t){return null==t||"object"!=typeof t||Object.isFrozen(t)}function v(t){var e=j[t];return e||n(18,t),e}function w(){return _}function b(t,e){e&&(v("Patches"),t.u=[],t.s=[],t.v=e)}function y(t){S(t),t.p.forEach(k),t.p=null}function S(t){t===_&&(_=t.l)}function x(t){return _={p:[],l:_,h:t,m:!0,_:0}}function k(t){var e=t[z];0===e.i||1===e.i?e.j():e.g=!0}function M(t,e){e._=e.p.length;var i=e.p[0],s=void 0!==t&&t!==i;return e.h.O||v("ES5").S(e,t,s),s?(i[z].P&&(y(e),n(4)),o(t)&&(t=C(e,t),e.l||T(e,t)),e.u&&v("Patches").M(i[z].t,t,e.u,e.s)):t=C(e,i,[]),y(e),e.u&&e.v(e.u,e.s),t!==q?t:void 0}function C(t,e,i){if(O(e))return e;var n=e[z];if(!n)return r(e,(function(s,o){return A(t,n,e,s,o,i)}),!0),e;if(n.A!==t)return e;if(!n.P)return T(t,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var s=4===n.i||5===n.i?n.o=p(n.k):n.o,o=s,l=!1;3===n.i&&(o=new Set(s),s.clear(),l=!0),r(o,(function(e,o){return A(t,n,s,e,o,i,l)})),T(t,s,!1),i&&t.u&&v("Patches").N(n,i,t.u,t.s)}return n.o}function A(t,e,i,n,r,l,c){if(s(r)){var d=C(t,r,l&&e&&3!==e.i&&!a(e.R,n)?l.concat(n):void 0);if(h(i,n,d),!s(d))return;t.m=!1}else c&&i.add(r);if(o(r)&&!O(r)){if(!t.h.D&&t._<1)return;C(t,r),e&&e.A.l||T(t,r)}}function T(t,e,i){void 0===i&&(i=!1),!t.l&&t.h.D&&t.m&&g(e,i)}function P(t,e){var i=t[z];return(i?f(i):t)[e]}function D(t,e){if(e in t)for(var i=Object.getPrototypeOf(t);i;){var n=Object.getOwnPropertyDescriptor(i,e);if(n)return n;i=Object.getPrototypeOf(i)}}function E(t){t.P||(t.P=!0,t.l&&E(t.l))}function R(t){t.o||(t.o=p(t.t))}function Q(t,e,i){var n=d(e)?v("MapSet").F(e,i):u(e)?v("MapSet").T(e,i):t.O?function(t,e){var i=Array.isArray(t),n={i:i?1:0,A:e?e.A:w(),P:!1,I:!1,R:{},l:e,t:t,k:null,o:null,j:null,C:!1},s=n,o=Y;i&&(s=[n],o=U);var r=Proxy.revocable(s,o),l=r.revoke,a=r.proxy;return n.k=a,n.j=l,a}(e,i):v("ES5").J(e,i);return(i?i.A:w()).p.push(n),n}function B(t){return s(t)||n(22,t),function t(e){if(!o(e))return e;var i,n=e[z],s=l(e);if(n){if(!n.P&&(n.i<4||!v("ES5").K(n)))return n.t;n.I=!0,i=L(e,s),n.I=!1}else i=L(e,s);return r(i,(function(e,s){n&&function(t,e){return 2===l(t)?t.get(e):t[e]}(n.t,e)===s||h(i,e,t(s))})),3===s?new Set(i):i}(t)}function L(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return p(t)}i.d(e,{U1:function(){return Bt},zD:function(){return Yt},pU:function(){return zt},Z0:function(){return Vt}});var $,_,V="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),N="undefined"!=typeof Map,W="undefined"!=typeof Set,H="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,q=V?Symbol.for("immer-nothing"):(($={})["immer-nothing"]=!0,$),F=V?Symbol.for("immer-draftable"):"__$immer_draftable",z=V?Symbol.for("immer-state"):"__$immer_state",I=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),Z="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,X=Object.getOwnPropertyDescriptors||function(t){var e={};return Z(t).forEach((function(i){e[i]=Object.getOwnPropertyDescriptor(t,i)})),e},j={},Y={get:function(t,e){if(e===z)return t;var i=f(t);if(!a(i,e))return function(t,e,i){var n,s=D(e,i);return s?"value"in s?s.value:null===(n=s.get)||void 0===n?void 0:n.call(t.k):void 0}(t,i,e);var n=i[e];return t.I||!o(n)?n:n===P(t.t,e)?(R(t),t.o[e]=Q(t.A.h,n,t)):n},has:function(t,e){return e in f(t)},ownKeys:function(t){return Reflect.ownKeys(f(t))},set:function(t,e,i){var n=D(f(t),e);if(null==n?void 0:n.set)return n.set.call(t.k,i),!0;if(!t.P){var s=P(f(t),e),o=null==s?void 0:s[z];if(o&&o.t===i)return t.o[e]=i,t.R[e]=!1,!0;if(c(i,s)&&(void 0!==i||a(t.t,e)))return!0;R(t),E(t)}return t.o[e]===i&&(void 0!==i||e in t.o)||Number.isNaN(i)&&Number.isNaN(t.o[e])||(t.o[e]=i,t.R[e]=!0),!0},deleteProperty:function(t,e){return void 0!==P(t.t,e)||e in t.t?(t.R[e]=!1,R(t),E(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var i=f(t),n=Reflect.getOwnPropertyDescriptor(i,e);return n?{writable:!0,configurable:1!==t.i||"length"!==e,enumerable:n.enumerable,value:i[e]}:n},defineProperty:function(){n(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){n(12)}},U={};r(Y,(function(t,e){U[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}})),U.deleteProperty=function(t,e){return U.set.call(this,t,e,void 0)},U.set=function(t,e,i){return Y.set.call(this,t[0],e,i,t[0])};var K=function(){function t(t){var e=this;this.O=H,this.D=!0,this.produce=function(t,i,s){if("function"==typeof t&&"function"!=typeof i){var r=i;i=t;var l=e;return function(t){var e=this;void 0===t&&(t=r);for(var n=arguments.length,s=Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return l.produce(t,(function(t){var n;return(n=i).call.apply(n,[e,t].concat(s))}))}}var a;if("function"!=typeof i&&n(6),void 0!==s&&"function"!=typeof s&&n(7),o(t)){var h=x(e),c=Q(e,t,void 0),d=!0;try{a=i(c),d=!1}finally{d?y(h):S(h)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(t){return b(h,s),M(t,h)}),(function(t){throw y(h),t})):(b(h,s),M(a,h))}if(!t||"object"!=typeof t){if(void 0===(a=i(t))&&(a=t),a===q&&(a=void 0),e.D&&g(a,!0),s){var u=[],f=[];v("Patches").M(t,a,u,f),s(u,f)}return a}n(21,t)},this.produceWithPatches=function(t,i){if("function"==typeof t)return function(i){for(var n=arguments.length,s=Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return e.produceWithPatches(i,(function(e){return t.apply(void 0,[e].concat(s))}))};var n,s,o=e.produce(t,i,(function(t,e){n=t,s=e}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(t){return[t,n,s]})):[o,n,s]},"boolean"==typeof(null==t?void 0:t.useProxies)&&this.setUseProxies(t.useProxies),"boolean"==typeof(null==t?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze)}var e=t.prototype;return e.createDraft=function(t){o(t)||n(8),s(t)&&(t=B(t));var e=x(this),i=Q(this,t,void 0);return i[z].C=!0,S(e),i},e.finishDraft=function(t,e){var i=(t&&t[z]).A;return b(i,e),M(void 0,i)},e.setAutoFreeze=function(t){this.D=t},e.setUseProxies=function(t){t&&!H&&n(20),this.O=t},e.applyPatches=function(t,e){var i;for(i=e.length-1;i>=0;i--){var n=e[i];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}i>-1&&(e=e.slice(i+1));var o=v("Patches").$;return s(t)?o(t,e):this.produce(t,(function(t){return o(t,e)}))},t}(),G=new K,J=G.produce,tt=(G.produceWithPatches.bind(G),G.setAutoFreeze.bind(G),G.setUseProxies.bind(G),G.applyPatches.bind(G),G.createDraft.bind(G),G.finishDraft.bind(G),J),et=i(1081);function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function nt(t,e,i){return(e=function(t){var e=function(t){if("object"!=it(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=it(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==it(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function st(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function ot(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?st(Object(i),!0).forEach((function(e){nt(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):st(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function rt(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var lt="function"==typeof Symbol&&Symbol.observable||"@@observable",at=function(){return Math.random().toString(36).substring(7).split("").join(".")},ht={INIT:"@@redux/INIT"+at(),REPLACE:"@@redux/REPLACE"+at(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+at()}};function ct(t,e,i){var n;if("function"==typeof e&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error(rt(0));if("function"==typeof e&&void 0===i&&(i=e,e=void 0),void 0!==i){if("function"!=typeof i)throw new Error(rt(1));return i(ct)(t,e)}if("function"!=typeof t)throw new Error(rt(2));var s=t,o=e,r=[],l=r,a=!1;function h(){l===r&&(l=r.slice())}function c(){if(a)throw new Error(rt(3));return o}function d(t){if("function"!=typeof t)throw new Error(rt(4));if(a)throw new Error(rt(5));var e=!0;return h(),l.push(t),function(){if(e){if(a)throw new Error(rt(6));e=!1,h();var i=l.indexOf(t);l.splice(i,1),r=null}}}function u(t){if(!function(t){if("object"!=typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}(t))throw new Error(rt(7));if(void 0===t.type)throw new Error(rt(8));if(a)throw new Error(rt(9));try{a=!0,o=s(o,t)}finally{a=!1}for(var e=r=l,i=0;i<e.length;i++)(0,e[i])();return t}return u({type:ht.INIT}),(n={dispatch:u,subscribe:d,getState:c,replaceReducer:function(t){if("function"!=typeof t)throw new Error(rt(10));s=t,u({type:ht.REPLACE})}})[lt]=function(){var t,e=d;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new Error(rt(11));function i(){t.next&&t.next(c())}return i(),{unsubscribe:e(i)}}})[lt]=function(){return this},t},n}function dt(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}function ut(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(t){return function(){var i=t.apply(void 0,arguments),n=function(){throw new Error(rt(15))},s={getState:i.getState,dispatch:function(){return n.apply(void 0,arguments)}},o=e.map((function(t){return t(s)}));return n=dt.apply(void 0,o)(i.dispatch),ot(ot({},i),{},{dispatch:n})}}}function ft(t){return function(e){var i=e.dispatch,n=e.getState;return function(e){return function(s){return"function"==typeof s?s(i,n,t):e(s)}}}}var pt=ft();pt.withExtraArgument=ft;var gt,mt=pt,Ot=(gt=function(t,e){return gt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},gt(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}gt(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),vt=function(t,e){for(var i=0,n=e.length,s=t.length;i<n;i++,s++)t[s]=e[i];return t},wt=Object.defineProperty,bt=Object.defineProperties,yt=Object.getOwnPropertyDescriptors,St=Object.getOwnPropertySymbols,xt=Object.prototype.hasOwnProperty,kt=Object.prototype.propertyIsEnumerable,Mt=function(t,e,i){return e in t?wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i},Ct=function(t,e){for(var i in e||(e={}))xt.call(e,i)&&Mt(t,i,e[i]);if(St)for(var n=0,s=St(e);n<s.length;n++)i=s[n],kt.call(e,i)&&Mt(t,i,e[i]);return t},At=function(t,e){return bt(t,yt(e))},Tt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=et.Mz.apply(void 0,t);return function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return i.apply(void 0,vt([s(t)?B(t):t],e))}},Pt="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?dt:dt.apply(null,arguments)};function Dt(t){if("object"!=typeof t||null===t)return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;for(var i=e;null!==Object.getPrototypeOf(i);)i=Object.getPrototypeOf(i);return e===i}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var Et=function(t){function e(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var s=t.apply(this,i)||this;return Object.setPrototypeOf(s,e.prototype),s}return Ot(e,t),Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return t.prototype.concat.apply(this,e)},e.prototype.prepend=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return 1===t.length&&Array.isArray(t[0])?new(e.bind.apply(e,vt([void 0],t[0].concat(this)))):new(e.bind.apply(e,vt([void 0],t.concat(this))))},e}(Array);function Rt(t){return o(t)?tt(t,(function(){})):t}var Qt=!0;function Bt(t){var e,i=function(t){return function(t){void 0===t&&(t={});var e=t.thunk,i=void 0===e||e,n=(t.immutableCheck,t.serializableCheck,new Et);return i&&(function(t){return"boolean"==typeof t}(i)?n.push(mt):n.push(mt.withExtraArgument(i.extraArgument))),n}(t)},n=t||{},s=n.reducer,o=void 0===s?void 0:s,r=n.middleware,l=void 0===r?i():r,a=n.devTools,h=void 0===a||a,c=n.preloadedState,d=void 0===c?void 0:c,u=n.enhancers,f=void 0===u?void 0:u;if("function"==typeof o)e=o;else{if(!Dt(o))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');e=function(t){for(var e=Object.keys(t),i={},n=0;n<e.length;n++){var s=e[n];"function"==typeof t[s]&&(i[s]=t[s])}var o,r=Object.keys(i);try{!function(t){Object.keys(t).forEach((function(e){var i=t[e];if(void 0===i(void 0,{type:ht.INIT}))throw new Error(rt(12));if(void 0===i(void 0,{type:ht.PROBE_UNKNOWN_ACTION()}))throw new Error(rt(13))}))}(i)}catch(t){o=t}return function(t,e){if(void 0===t&&(t={}),o)throw o;for(var n=!1,s={},l=0;l<r.length;l++){var a=r[l],h=i[a],c=t[a],d=h(c,e);if(void 0===d)throw e&&e.type,new Error(rt(14));s[a]=d,n=n||d!==c}return(n=n||r.length!==Object.keys(t).length)?s:t}}(o)}var p=l;if("function"==typeof p&&(p=p(i),!Qt&&!Array.isArray(p)))throw new Error("when using a middleware builder function, an array of middleware must be returned");if(!Qt&&p.some((function(t){return"function"!=typeof t})))throw new Error("each middleware provided to configureStore must be a function");var g=ut.apply(void 0,p),m=dt;h&&(m=Pt(Ct({trace:!Qt},"object"==typeof h&&h)));var O=[g];return Array.isArray(f)?O=vt([g],f):"function"==typeof f&&(O=f(O)),ct(e,d,m.apply(void 0,O))}function Lt(t,e){function i(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];if(e){var s=e.apply(void 0,i);if(!s)throw new Error("prepareAction did not return an object");return Ct(Ct({type:t,payload:s.payload},"meta"in s&&{meta:s.meta}),"error"in s&&{error:s.error})}return{type:t,payload:i[0]}}return i.toString=function(){return""+t},i.type=t,i.match=function(e){return e.type===t},i}function $t(t){return["type","payload","error","meta"].indexOf(t)>-1}function _t(t){var e,i={},n=[],s={addCase:function(t,e){var n="string"==typeof t?t:t.type;if(n in i)throw new Error("addCase cannot be called with two reducers for the same action type");return i[n]=e,s},addMatcher:function(t,e){return n.push({matcher:t,reducer:e}),s},addDefaultCase:function(t){return e=t,s}};return t(s),[i,n,e]}function Vt(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");var i,n="function"==typeof t.initialState?t.initialState:Rt(t.initialState),r=t.reducers||{},l=Object.keys(r),a={},h={},c={};function d(){var e="function"==typeof t.extraReducers?_t(t.extraReducers):[t.extraReducers],i=e[0],r=void 0===i?{}:i,l=e[1],a=void 0===l?[]:l,c=e[2],d=void 0===c?void 0:c,u=Ct(Ct({},r),h);return function(t,e,i){void 0===i&&(i=[]);var n,r=_t(e),l=r[0],a=r[1],h=r[2];if(function(t){return"function"==typeof t}(t))n=function(){return Rt(t())};else{var c=Rt(t);n=function(){return c}}function d(t,e){void 0===t&&(t=n());var i=vt([l[e.type]],a.filter((function(t){return(0,t.matcher)(e)})).map((function(t){return t.reducer})));return 0===i.filter((function(t){return!!t})).length&&(i=[h]),i.reduce((function(t,i){if(i){var n;if(s(t))return void 0===(n=i(t,e))?t:n;if(o(t))return tt(t,(function(t){return i(t,e)}));if(void 0===(n=i(t,e))){if(null===t)return t;throw Error("A case reducer on a non-draftable value must not return undefined")}return n}return t}),t)}return d.getInitialState=n,d}(n,(function(t){for(var e in u)t.addCase(e,u[e]);for(var i=0,n=a;i<n.length;i++){var s=n[i];t.addMatcher(s.matcher,s.reducer)}d&&t.addDefaultCase(d)}))}return l.forEach((function(t){var i,n,s=r[t],o=e+"/"+t;"reducer"in s?(i=s.reducer,n=s.prepare):i=s,a[t]=i,h[o]=i,c[t]=n?Lt(o,n):Lt(o)})),{name:e,reducer:function(t,e){return i||(i=d()),i(t,e)},actions:c,caseReducers:a,getInitialState:function(){return i||(i=d()),i.getInitialState()}}}function Nt(t){return function(e,i){var n=function(e){var n;Dt(n=i)&&"string"==typeof n.type&&Object.keys(n).every($t)?t(i.payload,e):t(i,e)};return s(e)?(n(e),e):tt(e,n)}}function Wt(t,e){return e(t)}function Ht(t){return Array.isArray(t)||(t=Object.values(t)),t}function qt(t,e,i){for(var n=[],s=[],o=0,r=t=Ht(t);o<r.length;o++){var l=r[o],a=Wt(l,e);a in i.entities?s.push({id:a,changes:l}):n.push(l)}return[n,s]}function Ft(t){function e(e,i){var n=Wt(e,t);n in i.entities||(i.ids.push(n),i.entities[n]=e)}function i(t,i){for(var n=0,s=t=Ht(t);n<s.length;n++)e(s[n],i)}function n(e,i){var n=Wt(e,t);n in i.entities||i.ids.push(n),i.entities[n]=e}function s(t,e){var i=!1;t.forEach((function(t){t in e.entities&&(delete e.entities[t],i=!0)})),i&&(e.ids=e.ids.filter((function(t){return t in e.entities})))}function o(e,i){var n={},s={};if(e.forEach((function(t){t.id in i.entities&&(s[t.id]={id:t.id,changes:Ct(Ct({},s[t.id]?s[t.id].changes:null),t.changes)})})),(e=Object.values(s)).length>0){var o=e.filter((function(e){return function(e,i,n){var s=n.entities[i.id],o=Object.assign({},s,i.changes),r=Wt(o,t),l=r!==i.id;return l&&(e[i.id]=r,delete n.entities[i.id]),n.entities[r]=o,l}(n,e,i)})).length>0;o&&(i.ids=Object.keys(i.entities))}}function r(e,n){var s=qt(e,t,n),r=s[0];o(s[1],n),i(r,n)}return{removeAll:(l=function(t){Object.assign(t,{ids:[],entities:{}})},a=Nt((function(t,e){return l(e)})),function(t){return a(t,void 0)}),addOne:Nt(e),addMany:Nt(i),setOne:Nt(n),setMany:Nt((function(t,e){for(var i=0,s=t=Ht(t);i<s.length;i++)n(s[i],e)})),setAll:Nt((function(t,e){t=Ht(t),e.ids=[],e.entities={},i(t,e)})),updateOne:Nt((function(t,e){return o([t],e)})),updateMany:Nt(o),upsertOne:Nt((function(t,e){return r([t],e)})),upsertMany:Nt(r),removeOne:Nt((function(t,e){return s([t],e)})),removeMany:Nt(s)};var l,a}function zt(t){void 0===t&&(t={});var e=Ct({sortComparer:!1,selectId:function(t){return t.id}},t),i=e.selectId,n=e.sortComparer,s={getInitialState:function(t){return void 0===t&&(t={}),Object.assign({ids:[],entities:{}},t)}},o={getSelectors:function(t){var e=function(t){return t.ids},i=function(t){return t.entities},n=Tt(e,i,(function(t,e){return t.map((function(t){return e[t]}))})),s=function(t,e){return e},o=function(t,e){return t[e]},r=Tt(e,(function(t){return t.length}));if(!t)return{selectIds:e,selectEntities:i,selectAll:n,selectTotal:r,selectById:Tt(i,s,o)};var l=Tt(t,i);return{selectIds:Tt(t,e),selectEntities:l,selectAll:Tt(t,n),selectTotal:Tt(t,r),selectById:Tt(l,s,o)}}},r=n?function(t,e){var i=Ft(t);function n(e,i){var n=(e=Ht(e)).filter((function(e){return!(Wt(e,t)in i.entities)}));0!==n.length&&l(n,i)}function s(t,e){0!==(t=Ht(t)).length&&l(t,e)}function o(e,i){for(var n=!1,s=0,o=e;s<o.length;s++){var r=o[s],l=i.entities[r.id];if(l){n=!0,Object.assign(l,r.changes);var h=t(l);r.id!==h&&(delete i.entities[r.id],i.entities[h]=l)}}n&&a(i)}function r(e,i){var s=qt(e,t,i),r=s[0];o(s[1],i),n(r,i)}function l(e,i){e.forEach((function(e){i.entities[t(e)]=e})),a(i)}function a(i){var n=Object.values(i.entities);n.sort(e);var s=n.map(t);(function(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(t[i]!==e[i])return!1;return!0})(i.ids,s)||(i.ids=s)}return{removeOne:i.removeOne,removeMany:i.removeMany,removeAll:i.removeAll,addOne:Nt((function(t,e){return n([t],e)})),updateOne:Nt((function(t,e){return o([t],e)})),upsertOne:Nt((function(t,e){return r([t],e)})),setOne:Nt((function(t,e){return s([t],e)})),setMany:Nt(s),setAll:Nt((function(t,e){t=Ht(t),e.entities={},e.ids=[],n(t,e)})),addMany:Nt(n),updateMany:Nt(o),upsertMany:Nt(r)}}(i,n):Ft(i);return Ct(Ct(Ct({selectId:i,sortComparer:n},s),o),r)}var It=["name","message","stack","code"],Zt=function(t,e){this.payload=t,this.meta=e},Xt=function(t,e){this.payload=t,this.meta=e},jt=function(t){if("object"==typeof t&&null!==t){for(var e={},i=0,n=It;i<n.length;i++){var s=n[i];"string"==typeof t[s]&&(e[s]=t[s])}return e}return{message:String(t)}},Yt=function(){function t(t,e,i){var n=Lt(t+"/fulfilled",(function(t,e,i,n){return{payload:t,meta:At(Ct({},n||{}),{arg:i,requestId:e,requestStatus:"fulfilled"})}})),s=Lt(t+"/pending",(function(t,e,i){return{payload:void 0,meta:At(Ct({},i||{}),{arg:e,requestId:t,requestStatus:"pending"})}})),o=Lt(t+"/rejected",(function(t,e,n,s,o){return{payload:s,error:(i&&i.serializeError||jt)(t||"Rejected"),meta:At(Ct({},o||{}),{arg:n,requestId:e,rejectedWithValue:!!s,requestStatus:"rejected",aborted:"AbortError"===(null==t?void 0:t.name),condition:"ConditionError"===(null==t?void 0:t.name)})}})),r="undefined"!=typeof AbortController?AbortController:function(){function t(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return t.prototype.abort=function(){},t}();return Object.assign((function(t){return function(l,a,h){var c,d=(null==i?void 0:i.idGenerator)?i.idGenerator(t):function(t){void 0===t&&(t=21);for(var e="",i=t;i--;)e+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return e}(),u=new r;function f(t){c=t,u.abort()}var p=function(){return r=this,p=null,g=function(){var r,p,g,m,O,v;return function(t,e){var i,n,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=2&o[0]?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[2&o[0],s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(!((s=(s=r.trys).length>0&&s[s.length-1])||6!==o[0]&&2!==o[0])){r=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(6===o[0]&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],n=0}finally{i=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(w){switch(w.label){case 0:return w.trys.push([0,4,,5]),null===(b=m=null==(r=null==i?void 0:i.condition)?void 0:r.call(i,t,{getState:a,extra:h}))||"object"!=typeof b||"function"!=typeof b.then?[3,2]:[4,m];case 1:m=w.sent(),w.label=2;case 2:if(!1===m||u.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return O=new Promise((function(t,e){return u.signal.addEventListener("abort",(function(){return e({name:"AbortError",message:c||"Aborted"})}))})),l(s(d,t,null==(p=null==i?void 0:i.getPendingMeta)?void 0:p.call(i,{requestId:d,arg:t},{getState:a,extra:h}))),[4,Promise.race([O,Promise.resolve(e(t,{dispatch:l,getState:a,extra:h,requestId:d,signal:u.signal,abort:f,rejectWithValue:function(t,e){return new Zt(t,e)},fulfillWithValue:function(t,e){return new Xt(t,e)}})).then((function(e){if(e instanceof Zt)throw e;return e instanceof Xt?n(e.payload,d,t,e.meta):n(e,d,t)}))])];case 3:return g=w.sent(),[3,5];case 4:return v=w.sent(),g=v instanceof Zt?o(null,d,t,v.payload,v.meta):o(v,d,t),[3,5];case 5:return i&&!i.dispatchConditionRejection&&o.match(g)&&g.meta.condition||l(g),[2,g]}var b}))},new Promise((function(t,e){var i=function(t){try{s(g.next(t))}catch(t){e(t)}},n=function(t){try{s(g.throw(t))}catch(t){e(t)}},s=function(e){return e.done?t(e.value):Promise.resolve(e.value).then(i,n)};s((g=g.apply(r,p)).next())}));var r,p,g}();return Object.assign(p,{abort:f,requestId:d,arg:t,unwrap:function(){return p.then(Ut)}})}}),{pending:s,rejected:o,fulfilled:n,typePrefix:t})}return t.withTypes=function(){return t},t}();function Ut(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}Object.assign;var Kt="listenerMiddleware";Lt(Kt+"/add"),Lt(Kt+"/removeAll"),Lt(Kt+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:void 0!==i.g?i.g:globalThis);"undefined"!=typeof window&&window.requestAnimationFrame&&window.requestAnimationFrame,function(){function t(t,e){var i=o[t];return i?i.enumerable=e:o[t]=i={configurable:!0,enumerable:e,get:function(){var e=this[z];return Y.get(e,t)},set:function(e){var i=this[z];Y.set(i,t,e)}},i}function e(t){for(var e=t.length-1;e>=0;e--){var s=t[e][z];if(!s.P)switch(s.i){case 5:n(s)&&E(s);break;case 4:i(s)&&E(s)}}}function i(t){for(var e=t.t,i=t.k,n=Z(i),s=n.length-1;s>=0;s--){var o=n[s];if(o!==z){var r=e[o];if(void 0===r&&!a(e,o))return!0;var l=i[o],h=l&&l[z];if(h?h.t!==r:!c(l,r))return!0}}var d=!!e[z];return n.length!==Z(e).length+(d?0:1)}function n(t){var e=t.k;if(e.length!==t.t.length)return!0;var i=Object.getOwnPropertyDescriptor(e,e.length-1);if(i&&!i.get)return!0;for(var n=0;n<e.length;n++)if(!e.hasOwnProperty(n))return!0;return!1}var o={};!function(t,e){j[t]||(j[t]=e)}("ES5",{J:function(e,i){var n=Array.isArray(e),s=function(e,i){if(e){for(var n=Array(i.length),s=0;s<i.length;s++)Object.defineProperty(n,""+s,t(s,!0));return n}var o=X(i);delete o[z];for(var r=Z(o),l=0;l<r.length;l++){var a=r[l];o[a]=t(a,e||!!o[a].enumerable)}return Object.create(Object.getPrototypeOf(i),o)}(n,e),o={i:n?5:4,A:i?i.A:w(),P:!1,I:!1,R:{},l:i,t:e,k:s,o:null,g:!1,C:!1};return Object.defineProperty(s,z,{value:o,writable:!0}),s},S:function(t,i,o){o?s(i)&&i[z].A===t&&e(t.p):(t.u&&function t(e){if(e&&"object"==typeof e){var i=e[z];if(i){var s=i.t,o=i.k,l=i.R,h=i.i;if(4===h)r(o,(function(e){e!==z&&(void 0!==s[e]||a(s,e)?l[e]||t(o[e]):(l[e]=!0,E(i)))})),r(s,(function(t){void 0!==o[t]||a(o,t)||(l[t]=!1,E(i))}));else if(5===h){if(n(i)&&(E(i),l.length=!0),o.length<s.length)for(var c=o.length;c<s.length;c++)l[c]=!1;else for(var d=s.length;d<o.length;d++)l[d]=!0;for(var u=Math.min(o.length,s.length),f=0;f<u;f++)o.hasOwnProperty(f)||(l[f]=!0),void 0===l[f]&&t(o[f])}}}}(t.p[0]),e(t.p))},K:function(t){return 4===t.i?i(t):n(t)}})}()},6479:function(t,e,i){"use strict";var n=i(1601),s=i.n(n),o=i(6314),r=i.n(o)()(s());r.push([t.id,"html{height:100%}body{height:100%}",""]),e.A=r},6783:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{eT:function(){return propsValidation},yz:function(){return createShallowSelector}});var react_redux__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3561),reselect__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1081),reselect__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(6234);function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}var createShallowSelector=(0,reselect__WEBPACK_IMPORTED_MODULE_1__.Ad)(reselect__WEBPACK_IMPORTED_MODULE_2__.UI,react_redux__WEBPACK_IMPORTED_MODULE_0__.bN),propsValidation=function propsValidation(jsCode){try{var jsObject=eval("("+jsCode+")");if("object"!==_typeof(jsObject))throw new Error("You must pass an object")}catch(t){return console.error(t),!1}return!0};function isNotNullable(t){return null!==t}},6925:function(t){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},7430:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{u:function(){return WidgetRenderer}});var _emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(2445),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1302),_components_errorOverlay__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3380),_store__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9994),_store_app__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1934);function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function ownKeys(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(i),!0).forEach((function(e){_defineProperty(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function _defineProperty(t,e,i){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,e||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var safeParseProps=function safeParseProps(widgetProps){try{return eval("("+widgetProps+")")}catch(t){return{kitchenSink:"testing"}}},WidgetRenderer=(0,react__WEBPACK_IMPORTED_MODULE_0__.memo)((function(t){var e=t.platform,i=((0,_store__WEBPACK_IMPORTED_MODULE_2__.jL)(),(0,_store__WEBPACK_IMPORTED_MODULE_2__.GV)(_store_app__WEBPACK_IMPORTED_MODULE_3__.Ep)),n=(0,_store__WEBPACK_IMPORTED_MODULE_2__.GV)(_store_app__WEBPACK_IMPORTED_MODULE_3__.vo),s=(0,_store__WEBPACK_IMPORTED_MODULE_2__.GV)(_store_app__WEBPACK_IMPORTED_MODULE_3__.OO),o=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((function(){if(i)return e.utils.widgets.getByUrl(i)}),[i,s]),r=safeParseProps(n);return(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Y)(_components_errorOverlay__WEBPACK_IMPORTED_MODULE_1__.h,{children:(0,_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.Y)(o,_objectSpread({},r))})}))},7526:function(t,e){"use strict";e.byteLength=function(t){var e=l(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){var e,i,o=l(t),r=o[0],a=o[1],h=new s(function(t,e,i){return 3*(e+i)/4-i}(0,r,a)),c=0,d=a>0?r-4:r;for(i=0;i<d;i+=4)e=n[t.charCodeAt(i)]<<18|n[t.charCodeAt(i+1)]<<12|n[t.charCodeAt(i+2)]<<6|n[t.charCodeAt(i+3)],h[c++]=e>>16&255,h[c++]=e>>8&255,h[c++]=255&e;return 2===a&&(e=n[t.charCodeAt(i)]<<2|n[t.charCodeAt(i+1)]>>4,h[c++]=255&e),1===a&&(e=n[t.charCodeAt(i)]<<10|n[t.charCodeAt(i+1)]<<4|n[t.charCodeAt(i+2)]>>2,h[c++]=e>>8&255,h[c++]=255&e),h},e.fromByteArray=function(t){for(var e,n=t.length,s=n%3,o=[],r=16383,l=0,h=n-s;l<h;l+=r)o.push(a(t,l,l+r>h?h:l+r));return 1===s?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2===s&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),o.join("")};for(var i=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0;r<64;++r)i[r]=o[r],n[o.charCodeAt(r)]=r;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function a(t,e,n){for(var s,o,r=[],l=e;l<n;l+=3)s=(t[l]<<16&16711680)+(t[l+1]<<8&65280)+(255&t[l+2]),r.push(i[(o=s)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return r.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},7659:function(t){"use strict";var e={};t.exports=function(t,i){var n=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},7825:function(t){"use strict";t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var s=void 0!==i.layer;s&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,s&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var o=i.sourceMap;o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},8287:function(t,e,i){"use strict";var n=i(7526),s=i(251),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(t){return+t!=t&&(t=0),a.alloc(+t)},e.INSPECT_MAX_BYTES=50;var r=2147483647;function l(t){if(t>r)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,a.prototype),e}function a(t,e,i){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return d(t)}return h(t,e,i)}function h(t,e,i){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var i=0|g(t,e),n=l(i),s=n.write(t,e);return s!==i&&(n=n.slice(0,s)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(H(t,Uint8Array)){var e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return u(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(H(t,ArrayBuffer)||t&&H(t.buffer,ArrayBuffer))return f(t,e,i);if("undefined"!=typeof SharedArrayBuffer&&(H(t,SharedArrayBuffer)||t&&H(t.buffer,SharedArrayBuffer)))return f(t,e,i);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return a.from(n,e,i);var s=function(t){if(a.isBuffer(t)){var e=0|p(t.length),i=l(e);return 0===i.length||t.copy(i,0,0,e),i}return void 0!==t.length?"number"!=typeof t.length||q(t.length)?l(0):u(t):"Buffer"===t.type&&Array.isArray(t.data)?u(t.data):void 0}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return a.from(t[Symbol.toPrimitive]("string"),e,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function d(t){return c(t),l(t<0?0:0|p(t))}function u(t){for(var e=t.length<0?0:0|p(t.length),i=l(e),n=0;n<e;n+=1)i[n]=255&t[n];return i}function f(t,e,i){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(i||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,e):new Uint8Array(t,e,i),Object.setPrototypeOf(n,a.prototype),n}function p(t){if(t>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return 0|t}function g(t,e){if(a.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||H(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var i=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===i)return 0;for(var s=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return N(t).length;default:if(s)return n?-1:V(t).length;e=(""+e).toLowerCase(),s=!0}}function m(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,e,i);case"utf8":case"utf-8":return C(this,e,i);case"ascii":return T(this,e,i);case"latin1":case"binary":return P(this,e,i);case"base64":return M(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function O(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function v(t,e,i,n,s){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),q(i=+i)&&(i=s?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(s)return-1;i=t.length-1}else if(i<0){if(!s)return-1;i=0}if("string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:w(t,e,i,n,s);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):w(t,[e],i,n,s);throw new TypeError("val must be string, number or Buffer")}function w(t,e,i,n,s){var o,r=1,l=t.length,a=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;r=2,l/=2,a/=2,i/=2}function h(t,e){return 1===r?t[e]:t.readUInt16BE(e*r)}if(s){var c=-1;for(o=i;o<l;o++)if(h(t,o)===h(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===a)return c*r}else-1!==c&&(o-=o-c),c=-1}else for(i+a>l&&(i=l-a),o=i;o>=0;o--){for(var d=!0,u=0;u<a;u++)if(h(t,o+u)!==h(e,u)){d=!1;break}if(d)return o}return-1}function b(t,e,i,n){i=Number(i)||0;var s=t.length-i;n?(n=Number(n))>s&&(n=s):n=s;var o=e.length;n>o/2&&(n=o/2);for(var r=0;r<n;++r){var l=parseInt(e.substr(2*r,2),16);if(q(l))return r;t[i+r]=l}return r}function y(t,e,i,n){return W(V(e,t.length-i),t,i,n)}function S(t,e,i,n){return W(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function x(t,e,i,n){return W(N(e),t,i,n)}function k(t,e,i,n){return W(function(t,e){for(var i,n,s,o=[],r=0;r<t.length&&!((e-=2)<0);++r)n=(i=t.charCodeAt(r))>>8,s=i%256,o.push(s),o.push(n);return o}(e,t.length-i),t,i,n)}function M(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function C(t,e,i){i=Math.min(t.length,i);for(var n=[],s=e;s<i;){var o,r,l,a,h=t[s],c=null,d=h>239?4:h>223?3:h>191?2:1;if(s+d<=i)switch(d){case 1:h<128&&(c=h);break;case 2:128==(192&(o=t[s+1]))&&(a=(31&h)<<6|63&o)>127&&(c=a);break;case 3:o=t[s+1],r=t[s+2],128==(192&o)&&128==(192&r)&&(a=(15&h)<<12|(63&o)<<6|63&r)>2047&&(a<55296||a>57343)&&(c=a);break;case 4:o=t[s+1],r=t[s+2],l=t[s+3],128==(192&o)&&128==(192&r)&&128==(192&l)&&(a=(15&h)<<18|(63&o)<<12|(63&r)<<6|63&l)>65535&&a<1114112&&(c=a)}null===c?(c=65533,d=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),s+=d}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);for(var i="",n=0;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=A));return i}(n)}e.kMaxLength=r,a.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(t,e,i){return h(t,e,i)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(t,e,i){return function(t,e,i){return c(t),t<=0?l(t):void 0!==e?"string"==typeof i?l(t).fill(e,i):l(t).fill(e):l(t)}(t,e,i)},a.allocUnsafe=function(t){return d(t)},a.allocUnsafeSlow=function(t){return d(t)},a.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==a.prototype},a.compare=function(t,e){if(H(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),H(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var i=t.length,n=e.length,s=0,o=Math.min(i,n);s<o;++s)if(t[s]!==e[s]){i=t[s],n=e[s];break}return i<n?-1:n<i?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=a.allocUnsafe(e),s=0;for(i=0;i<t.length;++i){var o=t[i];if(H(o,Uint8Array))s+o.length>n.length?a.from(o).copy(n,s):Uint8Array.prototype.set.call(n,o,s);else{if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,s)}s+=o.length}return n},a.byteLength=g,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)O(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)O(this,e,e+3),O(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)O(this,e,e+7),O(this,e+1,e+6),O(this,e+2,e+5),O(this,e+3,e+4);return this},a.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?C(this,0,t):m.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(t+=" ... "),"<Buffer "+t+">"},o&&(a.prototype[o]=a.prototype.inspect),a.prototype.compare=function(t,e,i,n,s){if(H(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),e<0||i>t.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&e>=i)return 0;if(n>=s)return-1;if(e>=i)return 1;if(this===t)return 0;for(var o=(s>>>=0)-(n>>>=0),r=(i>>>=0)-(e>>>=0),l=Math.min(o,r),h=this.slice(n,s),c=t.slice(e,i),d=0;d<l;++d)if(h[d]!==c[d]){o=h[d],r=c[d];break}return o<r?-1:r<o?1:0},a.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},a.prototype.indexOf=function(t,e,i){return v(this,t,e,i,!0)},a.prototype.lastIndexOf=function(t,e,i){return v(this,t,e,i,!1)},a.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(i)?(i>>>=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var s=this.length-e;if((void 0===i||i>s)&&(i=s),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return b(this,t,e,i);case"utf8":case"utf-8":return y(this,t,e,i);case"ascii":case"latin1":case"binary":return S(this,t,e,i);case"base64":return x(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,e,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function T(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(127&t[s]);return n}function P(t,e,i){var n="";i=Math.min(t.length,i);for(var s=e;s<i;++s)n+=String.fromCharCode(t[s]);return n}function D(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var s="",o=e;o<i;++o)s+=F[t[o]];return s}function E(t,e,i){for(var n=t.slice(e,i),s="",o=0;o<n.length-1;o+=2)s+=String.fromCharCode(n[o]+256*n[o+1]);return s}function R(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function Q(t,e,i,n,s,o){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>s||e<o)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function B(t,e,i,n,s,o){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function L(t,e,i,n,o){return e=+e,i>>>=0,o||B(t,0,i,4),s.write(t,e,i,n,23,4),i+4}function $(t,e,i,n,o){return e=+e,i>>>=0,o||B(t,0,i,8),s.write(t,e,i,n,52,8),i+8}a.prototype.slice=function(t,e){var i=this.length;(t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(t,e,i){t>>>=0,e>>>=0,i||R(t,e,this.length);for(var n=this[t],s=1,o=0;++o<e&&(s*=256);)n+=this[t+o]*s;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(t,e,i){t>>>=0,e>>>=0,i||R(t,e,this.length);for(var n=this[t+--e],s=1;e>0&&(s*=256);)n+=this[t+--e]*s;return n},a.prototype.readUint8=a.prototype.readUInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),this[t]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,i){t>>>=0,e>>>=0,i||R(t,e,this.length);for(var n=this[t],s=1,o=0;++o<e&&(s*=256);)n+=this[t+o]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*e)),n},a.prototype.readIntBE=function(t,e,i){t>>>=0,e>>>=0,i||R(t,e,this.length);for(var n=e,s=1,o=this[t+--n];n>0&&(s*=256);)o+=this[t+--n]*s;return o>=(s*=128)&&(o-=Math.pow(2,8*e)),o},a.prototype.readInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){t>>>=0,e||R(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},a.prototype.readInt16BE=function(t,e){t>>>=0,e||R(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},a.prototype.readInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return t>>>=0,e||R(t,4,this.length),s.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return t>>>=0,e||R(t,4,this.length),s.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return t>>>=0,e||R(t,8,this.length),s.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return t>>>=0,e||R(t,8,this.length),s.read(this,t,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(t,e,i,n){t=+t,e>>>=0,i>>>=0,n||Q(this,t,e,i,Math.pow(2,8*i)-1,0);var s=1,o=0;for(this[e]=255&t;++o<i&&(s*=256);)this[e+o]=t/s&255;return e+i},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(t,e,i,n){t=+t,e>>>=0,i>>>=0,n||Q(this,t,e,i,Math.pow(2,8*i)-1,0);var s=i-1,o=1;for(this[e+s]=255&t;--s>=0&&(o*=256);)this[e+s]=t/o&255;return e+i},a.prototype.writeUint8=a.prototype.writeUInt8=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,1,255,0),this[e]=255&t,e+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var s=Math.pow(2,8*i-1);Q(this,t,e,i,s-1,-s)}var o=0,r=1,l=0;for(this[e]=255&t;++o<i&&(r*=256);)t<0&&0===l&&0!==this[e+o-1]&&(l=1),this[e+o]=(t/r|0)-l&255;return e+i},a.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e>>>=0,!n){var s=Math.pow(2,8*i-1);Q(this,t,e,i,s-1,-s)}var o=i-1,r=1,l=0;for(this[e+o]=255&t;--o>=0&&(r*=256);)t<0&&0===l&&0!==this[e+o+1]&&(l=1),this[e+o]=(t/r|0)-l&255;return e+i},a.prototype.writeInt8=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeInt16BE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeInt32LE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},a.prototype.writeInt32BE=function(t,e,i){return t=+t,e>>>=0,i||Q(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeFloatLE=function(t,e,i){return L(this,t,e,!0,i)},a.prototype.writeFloatBE=function(t,e,i){return L(this,t,e,!1,i)},a.prototype.writeDoubleLE=function(t,e,i){return $(this,t,e,!0,i)},a.prototype.writeDoubleBE=function(t,e,i){return $(this,t,e,!1,i)},a.prototype.copy=function(t,e,i,n){if(!a.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var s=n-i;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,i,n):Uint8Array.prototype.set.call(t,this.subarray(i,n),e),s},a.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var s=t.charCodeAt(0);("utf8"===n&&s<128||"latin1"===n)&&(t=s)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var o;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=e;o<i;++o)this[o]=t;else{var r=a.isBuffer(t)?t:a.from(t,n),l=r.length;if(0===l)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<i-e;++o)this[o+e]=r[o%l]}return this};var _=/[^+/0-9A-Za-z-_]/g;function V(t,e){var i;e=e||1/0;for(var n=t.length,s=null,o=[],r=0;r<n;++r){if((i=t.charCodeAt(r))>55295&&i<57344){if(!s){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(r+1===n){(e-=3)>-1&&o.push(239,191,189);continue}s=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),s=i;continue}i=65536+(s-55296<<10|i-56320)}else s&&(e-=3)>-1&&o.push(239,191,189);if(s=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function N(t){return n.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(_,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function W(t,e,i,n){for(var s=0;s<n&&!(s+i>=e.length||s>=t.length);++s)e[s+i]=t[s];return s}function H(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function q(t){return t!=t}var F=function(){for(var t="0123456789abcdef",e=new Array(256),i=0;i<16;++i)for(var n=16*i,s=0;s<16;++s)e[n+s]=t[i]+t[s];return e}()},8493:function(t,e,i){"use strict";var n=i(1302),s="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e},o=n.useState,r=n.useEffect,l=n.useLayoutEffect,a=n.useDebugValue;function h(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!s(t,i)}catch(t){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(t,e){return e()}:function(t,e){var i=e(),n=o({inst:{value:i,getSnapshot:e}}),s=n[0].inst,c=n[1];return l((function(){s.value=i,s.getSnapshot=e,h(s)&&c({inst:s})}),[t,i,e]),r((function(){return h(s)&&c({inst:s}),t((function(){h(s)&&c({inst:s})}))}),[t]),a(i),i};e.useSyncExternalStore=void 0!==n.useSyncExternalStore?n.useSyncExternalStore:c},9242:function(t,e,i){"use strict";t.exports=i(2162)},9888:function(t,e,i){"use strict";t.exports=i(8493)},9889:function(t,e,i){"use strict";i.d(e,{cX:function(){return v},tR:function(){return O},xI:function(){return u}});var n=i(6432),s=i(3459),o=i.n(s),r=i(3077),l=i(6783);function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var h="bathtub",c="url",d="props",u=(0,n.pU)({selectId:function(t){return t.widgetId},sortComparer:function(t,e){return t.widgetId.localeCompare(e.widgetId)}}),f=u.getInitialState({loading:!0,error:void 0,activeWidgetUrl:void 0,activeWidgetProps:o()({kitchenSink:"testing"},{unsafe:!0,space:2}),isPropsEditorOpen:!1,tickTock:!1,isWidgetSwitcherOpen:!1,environment:"integration",hasPropsError:!1}),p=(0,n.Z0)({initialState:f,name:"app",reducers:{setActiveWidgetUrl:function(t,e){t.activeWidgetUrl=e.payload,t.isWidgetSwitcherOpen=!1,sessionStorage.setItem("".concat(h,"-").concat(c),e.payload)},setActiveWidgetProps:function(t,e){(0,l.eT)(e.payload)?(t.activeWidgetProps=e.payload,t.isPropsEditorOpen=!1,t.hasPropsError=!1,sessionStorage.setItem("".concat(h,"-").concat(d),e.payload)):t.hasPropsError=!0},clearPropsError:function(t){t.hasPropsError=!1},setIsPropsEditorOpen:function(t,e){var i;t.isPropsEditorOpen=e.payload,t.activeWidgetProps=null!==(i=m())&&void 0!==i?i:t.activeWidgetProps;var n=(0,l.eT)(t.activeWidgetProps);t.hasPropsError=!n},setIsWidgetSwitcherOpen:function(t,e){t.isWidgetSwitcherOpen=e.payload},renderWidget:function(t){var e,i;t.activeWidgetProps=null!==(e=m())&&void 0!==e?e:t.activeWidgetProps,t.activeWidgetUrl=null!==(i=g())&&void 0!==i?i:t.activeWidgetUrl,t.tickTock=!t.tickTock},reset:function(){sessionStorage.removeItem("".concat(h,"-").concat(c)),sessionStorage.removeItem("".concat(h,"-").concat(d)),window.location.reload()}},extraReducers:function(t){t.addCase(r.Z.loadWidgets.pending,(function(t){t.loading=!0,t.error=void 0})),t.addCase(r.Z.loadWidgets.rejected,(function(t,e){t.loading=!1,t.error="[".concat(e.error.name," (").concat(e.error.code,")] ").concat(e.error.message,"\n\nStack:\n").concat(e.error.stack)})),t.addCase(r.Z.loadWidgets.fulfilled,(function(t,e){var i,n;t.loading=!1,t.error=void 0;var s,o,r=(s=e.payload,o=2,function(t){if(Array.isArray(t))return t}(s)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,s,o,r,l=[],a=!0,h=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;a=!1}else for(;!(a=(n=o.call(i)).done)&&(l.push(n.value),l.length!==e);a=!0);}catch(t){h=!0,s=t}finally{try{if(!a&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(h)throw s}}return l}}(s,o)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?a(t,e):void 0}}(s,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=r[0],d=r[1];u.setAll(t,l),t.activeWidgetProps=null!==(i=m())&&void 0!==i?i:t.activeWidgetProps,t.activeWidgetUrl=null!==(n=null!=d?d:g())&&void 0!==n?n:t.activeWidgetUrl,t.activeWidgetUrl&&sessionStorage.setItem("".concat(h,"-").concat(c),t.activeWidgetUrl)}))}}),g=function(){var t=sessionStorage.getItem("".concat(h,"-").concat(c));if(t)return t},m=function(){var t=sessionStorage.getItem("".concat(h,"-").concat(d));if(t)return t},O=p.actions,v=p.reducer},9994:function(t,e,i){"use strict";i.d(e,{GV:function(){return c},M_:function(){return a},jL:function(){return h},yz:function(){return l.yz}});var n=i(6432),s=i(3561),o=i(5391),r=i(1934),l=i(6783),a=(0,n.U1)({reducer:{app:r.cX,widgetBrowser:o.No},middleware:function(t){return t()}}),h=s.wA,c=s.d4}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={id:t,exports:{}};return __webpack_modules__[t](i,i.exports,__webpack_require__),i.exports}__webpack_require__.y=__system_context__,__webpack_require__.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=function(t,e){for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.p="/",__webpack_require__.nc=void 0;var __webpack_exports__={};return(0,__webpack_require__(126).w)(2),function(){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return gI}});var t=__webpack_require__(2445),e=__webpack_require__(2639),i=__webpack_require__(1302),n=__webpack_require__(9994),s=__webpack_require__(1934),o=__webpack_require__(5872),r=__webpack_require__(4386),l=__webpack_require__(4876),a=__webpack_require__(2011),h=__webpack_require__(1826),c=(0,i.memo)((function(e){var i=e.port,o=(0,n.jL)();return h.platformProps.utils.widgets.get("@1fe/starter-kit"),(0,t.Y)(l.Button,{onClick:function(){return o(s.tR.setActiveWidgetUrl("http://127.0.0.1:".concat(i||"8080","/js/1fe-bundle.js")))},children:i})}));function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=Array(e);i<e;i++)n[i]=t[i];return n}var u=(0,n.yz)(s.Mb,s.Ep,(function(t,e){return{isVisible:t.isWidgetSwitcherOpen,widgetUrl:e}})),f=(0,i.memo)((function(e){var o,h,f=e.trigger,p=(0,n.GV)(u),g=p.isVisible,m=p.widgetUrl,O=(0,n.jL)(),v=(o=(0,i.useState)(m),h=2,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,s,o,r,l=[],a=!0,h=!1;try{if(o=(i=i.call(t)).next,0===e){if(Object(i)!==i)return;a=!1}else for(;!(a=(n=o.call(i)).done)&&(l.push(n.value),l.length!==e);a=!0);}catch(t){h=!0,s=t}finally{try{if(!a&&null!=i.return&&(r=i.return(),Object(r)!==r))return}finally{if(h)throw s}}return l}}(o,h)||function(t,e){if(t){if("string"==typeof t)return d(t,e);var i={}.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(t,e):void 0}}(o,h)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),w=v[0],b=v[1];return(0,t.FD)(t.FK,{children:[f,(0,t.FD)(l.Modal,{open:g,onCancel:function(){return O(s.tR.setIsWidgetSwitcherOpen(!1))},footer:[(0,t.Y)(r.A,{keyName:"esc",onKeyDown:function(){O(s.tR.setIsWidgetSwitcherOpen(!1))},children:(0,t.Y)(l.Button,{type:"primary",disabled:!w||w===m,onClick:function(){w&&O(s.tR.setActiveWidgetUrl(w))},"data-qa":"apply-widget-url",children:"Apply"})}),(0,t.Y)(l.Button,{type:"primary",onClick:function(){O(s.tR.setIsWidgetSwitcherOpen(!1))},children:"Close"})],children:[(0,t.Y)(l.Typography.Title,{level:2,children:"Widget switcher"}),(0,t.FD)(a.VP,{padding:"".concat("32px"," 0"),children:[(0,t.Y)("label",{htmlFor:"widgetUrl",children:"Enter a widget url"}),(0,t.Y)(l.Input,{id:"widgetUrl",name:"widgetUrl",type:"url",placeholder:"http://127.0.0.1:8081/js/1fe-bundle.js",onChange:function(t){return b(t.target.value)},value:null!=w?w:m,"data-qa":"widgetUrlInput"}),(0,t.FD)("div",{children:[(0,t.Y)(a.EY,{children:"Quick load: "}),(0,t.Y)(c,{port:"8080"}),(0,t.Y)(c,{port:"8081"}),(0,t.Y)(c,{port:"8082"}),(0,t.Y)(c,{port:"8083"})]}),(0,t.FD)(a.az,{padding:"".concat("24px"," 0"),children:[(0,t.Y)("p",{children:(0,t.Y)("b",{children:"Shortcuts"})}),(0,t.Y)("table",{children:(0,t.FD)("tbody",{children:[(0,t.FD)("tr",{children:[(0,t.Y)("td",{children:"Copy"}),(0,t.Y)("td",{children:"CTRL+SHIFT+C"})]}),(0,t.FD)("tr",{children:[(0,t.Y)("td",{children:"Open widget switcher"}),(0,t.Y)("td",{children:"Ctrl+/"})]}),(0,t.FD)("tr",{children:[(0,t.Y)("td",{children:"Open props editor"}),(0,t.Y)("td",{children:"Ctrl+P"})]}),(0,t.FD)("tr",{children:[(0,t.Y)("td",{children:"Reset"}),(0,t.Y)("td",{children:"Ctrl+R"})]}),(0,t.FD)("tr",{children:[(0,t.Y)("td",{children:"Clean (on error)"}),(0,t.Y)("td",{children:"CMD+ESC"})]})]})})]})]})]})]})}));const p=1024;let g=0;class m{constructor(t,e){this.from=t,this.to=e}}class O{constructor(t={}){this.id=g++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=b.match(t)),e=>{let i=t(e);return void 0===i?null:[this,i]}}}O.closedBy=new O({deserialize:t=>t.split(" ")}),O.openedBy=new O({deserialize:t=>t.split(" ")}),O.group=new O({deserialize:t=>t.split(" ")}),O.isolate=new O({deserialize:t=>{if(t&&"rtl"!=t&&"ltr"!=t&&"auto"!=t)throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}}),O.contextHash=new O({perNode:!0}),O.lookAhead=new O({perNode:!0}),O.mounted=new O({perNode:!0});class v{constructor(t,e,i){this.tree=t,this.overlay=e,this.parser=i}static get(t){return t&&t.props&&t.props[O.mounted.id]}}const w=Object.create(null);class b{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):w,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new b(t.name||"",e,t.id,i);if(t.props)for(let i of t.props)if(Array.isArray(i)||(i=i(n)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[i[0].id]=i[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(O.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return t=>{for(let i=t.prop(O.group),n=-1;n<(i?i.length:0);n++){let s=e[n<0?t.name:i[n]];if(s)return s}}}}b.none=new b("",Object.create(null),0,8);class y{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let e of t){let t=e(i);t&&(n||(n=Object.assign({},i.props)),n[t[0].id]=t[1])}e.push(n?new b(i.name,n,i.id,i.flags):i)}return new y(e)}}const S=new WeakMap,x=new WeakMap;var k;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(k||(k={}));class M{constructor(t,e,i,n,s){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,s&&s.length){this.props=Object.create(null);for(let[t,e]of s)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=v.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let i=t.toString();i&&(e&&(e+=","),e+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new V(this.topNode,t)}cursorAt(t,e=0,i=0){let n=S.get(this)||this.topNode,s=new V(n);return s.moveTo(t,e),S.set(this,s._tree),s}get topNode(){return new E(this,0,0,null)}resolve(t,e=0){let i=P(S.get(this)||this.topNode,t,e,!1);return S.set(this,i),i}resolveInner(t,e=0){let i=P(x.get(this)||this.topNode,t,e,!0);return x.set(this,i),i}resolveStack(t,e=0){return function(t,e,i){let n=t.resolveInner(e,i),s=null;for(let t=n instanceof E?n:n.context.parent;t;t=t.parent)if(t.index<0){let o=t.parent;(s||(s=[n])).push(o.resolve(e,i)),t=o}else{let o=v.get(t.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let r=new E(o.tree,o.overlay[0].from+t.from,-1,t);(s||(s=[n])).push(P(r,e,i,!1))}}return s?$(s):n}(this,t,e)}iterate(t){let{enter:e,leave:i,from:n=0,to:s=this.length}=t,o=t.mode||0,r=(o&k.IncludeAnonymous)>0;for(let t=this.cursor(o|k.IncludeAnonymous);;){let o=!1;if(t.from<=s&&t.to>=n&&(!r&&t.type.isAnonymous||!1!==e(t))){if(t.firstChild())continue;o=!0}for(;o&&i&&(r||!t.type.isAnonymous)&&i(t),!t.nextSibling();){if(!t.parent())return;o=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:q(b.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,i)=>new M(this.type,t,e,i,this.propValues)),t.makeTree||((t,e,i)=>new M(b.none,t,e,i)))}static build(t){return function(t){var e;let{buffer:i,nodeSet:n,maxBufferLength:s=p,reused:o=[],minRepeatType:r=n.types.length}=t,l=Array.isArray(i)?new C(i,i.length):i,a=n.types,h=0,c=0;function d(t,e,i,p,v,w){let{id:b,start:y,end:S,size:x}=l,k=c,C=h;for(;x<0;){if(l.next(),-1==x){let e=o[b];return i.push(e),void p.push(y-t)}if(-3==x)return void(h=b);if(-4==x)return void(c=b);throw new RangeError(`Unrecognized record size: ${x}`)}let T,P,D=a[b],E=y-t;if(S-y<=s&&(P=function(t,e){let i=l.fork(),n=0,o=0,a=0,h=i.end-s,c={size:0,start:0,skip:0};t:for(let s=i.pos-t;i.pos>s;){let t=i.size;if(i.id==e&&t>=0){c.size=n,c.start=o,c.skip=a,a+=4,n+=4,i.next();continue}let l=i.pos-t;if(t<0||l<s||i.start<h)break;let d=i.id>=r?4:0,u=i.start;for(i.next();i.pos>l;){if(i.size<0){if(-3!=i.size)break t;d+=4}else i.id>=r&&(d+=4);i.next()}o=u,n+=t,a+=d}return(e<0||n==t)&&(c.size=n,c.start=o,c.skip=a),c.size>4?c:void 0}(l.pos-e,v))){let e=new Uint16Array(P.size-P.skip),i=l.pos-P.size,s=e.length;for(;l.pos>i;)s=m(P.start,e,s);T=new A(e,S-P.start,n),E=P.start-t}else{let t=l.pos-x;l.next();let e=[],i=[],n=b>=r?b:-1,o=0,a=S;for(;l.pos>t;)n>=0&&l.id==n&&l.size>=0?(l.end<=a-s&&(f(e,i,y,o,l.end,a,n,k,C),o=e.length,a=l.end),l.next()):w>2500?u(y,t,e,i):d(y,t,e,i,n,w+1);if(n>=0&&o>0&&o<e.length&&f(e,i,y,o,y,a,n,k,C),e.reverse(),i.reverse(),n>-1&&o>0){let t=function(t,e){return(i,n,s)=>{let o,r,l=0,a=i.length-1;if(a>=0&&(o=i[a])instanceof M){if(!a&&o.type==t&&o.length==s)return o;(r=o.prop(O.lookAhead))&&(l=n[a]+o.length+r)}return g(t,i,n,s,l,e)}}(D,C);T=q(D,e,i,0,e.length,0,S-y,t,t)}else T=g(D,e,i,S-y,k-S,C)}i.push(T),p.push(E)}function u(t,e,i,o){let r=[],a=0,h=-1;for(;l.pos>e;){let{id:t,start:e,end:i,size:n}=l;if(n>4)l.next();else{if(h>-1&&e<h)break;h<0&&(h=i-s),r.push(t,e,i),a++,l.next()}}if(a){let e=new Uint16Array(4*a),s=r[r.length-2];for(let t=r.length-3,i=0;t>=0;t-=3)e[i++]=r[t],e[i++]=r[t+1]-s,e[i++]=r[t+2]-s,e[i++]=i;i.push(new A(e,r[2]-s,n)),o.push(s-t)}}function f(t,e,i,s,o,r,l,a,h){let c=[],d=[];for(;t.length>s;)c.push(t.pop()),d.push(e.pop()+i-o);t.push(g(n.types[l],c,d,r-o,a-r,h)),e.push(o-i)}function g(t,e,i,n,s,o,r){if(o){let t=[O.contextHash,o];r=r?[t].concat(r):[t]}if(s>25){let t=[O.lookAhead,s];r=r?[t].concat(r):[t]}return new M(t,e,i,n,r)}function m(t,e,i){let{id:n,start:s,end:o,size:a}=l;if(l.next(),a>=0&&n<r){let r=i;if(a>4){let n=l.pos-(a-4);for(;l.pos>n;)i=m(t,e,i)}e[--i]=r,e[--i]=o-t,e[--i]=s-t,e[--i]=n}else-3==a?h=n:-4==a&&(c=n);return i}let v=[],w=[];for(;l.pos>0;)d(t.start||0,t.bufferStart||0,v,w,-1,0);let b=null!==(e=t.length)&&void 0!==e?e:v.length?w[0]+v[0].length:0;return new M(a[t.topID],v.reverse(),w.reverse(),b)}(t)}}M.empty=new M(b.none,[],[],0);class C{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new C(this.buffer,this.index)}}class A{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return b.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],s=n.name;if(/\W/.test(s)&&!n.isError&&(s=JSON.stringify(s)),i==(t+=4))return s;let o=[];for(;t<i;)o.push(this.childString(t)),t=this.buffer[t+3];return s+"("+o.join(",")+")"}findChild(t,e,i,n,s){let{buffer:o}=this,r=-1;for(let l=t;l!=e&&!(T(s,n,o[l+1],o[l+2])&&(r=l,i>0));l=o[l+3]);return r}slice(t,e,i){let n=this.buffer,s=new Uint16Array(e-t),o=0;for(let r=t,l=0;r<e;){s[l++]=n[r++],s[l++]=n[r++]-i;let e=s[l++]=n[r++]-i;s[l++]=n[r++]-t,o=Math.max(o,e)}return new A(s,o,this.set)}}function T(t,e,i,n){switch(t){case-2:return i<e;case-1:return n>=e&&i<e;case 0:return i<e&&n>e;case 1:return i<=e&&n>e;case 2:return n>e;case 4:return!0}}function P(t,e,i,n){for(var s;t.from==t.to||(i<1?t.from>=e:t.from>e)||(i>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof E&&t.index<0?null:t.parent;if(!e)return t;t=e}let o=n?0:k.IgnoreOverlays;if(n)for(let n=t,r=n.parent;r;n=r,r=n.parent)n instanceof E&&n.index<0&&(null===(s=r.enter(e,i,o))||void 0===s?void 0:s.from)!=n.from&&(t=r);for(;;){let n=t.enter(e,i,o);if(!n)return t;t=n}}class D{cursor(t=0){return new V(this,t)}getChild(t,e=null,i=null){let n=R(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return R(this,t,e,i)}resolve(t,e=0){return P(this,t,e,!1)}resolveInner(t,e=0){return P(this,t,e,!0)}matchContext(t){return Q(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),i=this;for(;e;){let t=e.lastChild;if(!t||t.to!=e.to)break;t.type.isError&&t.from==t.to?(i=e,e=t.prevSibling):e=t}return i}get node(){return this}get next(){return this.parent}}class E extends D{constructor(t,e,i,n){super(),this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,s=0){for(let o=this;;){for(let{children:r,positions:l}=o._tree,a=e>0?r.length:-1;t!=a;t+=e){let a=r[t],h=l[t]+o.from;if(T(n,i,h,h+a.length))if(a instanceof A){if(s&k.ExcludeBuffers)continue;let r=a.findChild(0,a.buffer.length,e,i-h,n);if(r>-1)return new L(new B(o,a,t,h),null,r)}else if(s&k.IncludeAnonymous||!a.type.isAnonymous||N(a)){let r;if(!(s&k.IgnoreMounts)&&(r=v.get(a))&&!r.overlay)return new E(r.tree,h,t,o);let l=new E(a,h,t,o);return s&k.IncludeAnonymous||!l.type.isAnonymous?l:l.nextChild(e<0?a.children.length-1:0,e,i,n)}}if(s&k.IncludeAnonymous||!o.type.isAnonymous)return null;if(t=o.index>=0?o.index+e:e<0?-1:o._parent._tree.children.length,o=o._parent,!o)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&k.IgnoreOverlays)&&(n=v.get(this._tree))&&n.overlay){let i=t-this.from;for(let{from:t,to:s}of n.overlay)if((e>0?t<=i:t<i)&&(e<0?s>=i:s>i))return new E(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function R(t,e,i,n){let s=t.cursor(),o=[];if(!s.firstChild())return o;if(null!=i)for(let t=!1;!t;)if(t=s.type.is(i),!s.nextSibling())return o;for(;;){if(null!=n&&s.type.is(n))return o;if(s.type.is(e)&&o.push(s.node),!s.nextSibling())return null==n?o:[]}}function Q(t,e,i=e.length-1){for(let n=t;i>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[i]&&e[i]!=n.name)return!1;i--}}return!0}class B{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class L extends D{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){super(),this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return s<0?null:new L(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&k.ExcludeBuffers)return null;let{buffer:n}=this.context,s=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return s<0?null:new L(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new L(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new L(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,s=i.buffer[this.index+3];if(s>n){let o=i.buffer[this.index+1];t.push(i.slice(n,s,o)),e.push(0)}return new M(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function $(t){if(!t.length)return null;let e=0,i=t[0];for(let n=1;n<t.length;n++){let s=t[n];(s.from>i.from||s.to<i.to)&&(i=s,e=n)}let n=i instanceof E&&i.index<0?null:i.parent,s=t.slice();return n?s[e]=n:s.splice(e,1),new _(s,i)}class _{constructor(t,e){this.heads=t,this.node=e}get next(){return $(this.heads)}}class V{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof E)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof E?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,s=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return!(s<0)&&(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?!(i&k.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&k.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&k.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let t=i<0?0:this.stack[i]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(t)}return i<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;({index:e,_parent:i}=i))if(e>-1)for(let n=e+t,s=t<0?-1:i._tree.children.length;n!=s;n+=t){let t=i._tree.children[n];if(this.mode&k.IncludeAnonymous||t instanceof A||!t.type.isAnonymous||N(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer)t:for(let n=this.index,s=this.stack.length;s>=0;){for(let o=t;o;o=o._parent)if(o.index==n){if(n==this.index)return o;e=o,i=s+1;break t}n=this.stack[--s]}for(let t=i;t<this.stack.length;t++)e=new L(this.buffer,e,this.stack[t]);return this.bufferNode=new L(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&e&&e(this),n=this.type.isAnonymous,!i)return;if(this.nextSibling())break;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return Q(this.node.parent,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,s=this.stack.length-1;n>=0;s--){if(s<0)return Q(this._tree,t,n);let o=i[e.buffer[this.stack[s]]];if(!o.isAnonymous){if(t[n]&&t[n]!=o.name)return!1;n--}}return!0}}function N(t){return t.children.some((t=>t instanceof A||!t.type.isAnonymous||N(t)))}const W=new WeakMap;function H(t,e){if(!t.isAnonymous||e instanceof A||e.type!=t)return 1;let i=W.get(e);if(null==i){i=1;for(let n of e.children){if(n.type!=t||!(n instanceof M)){i=1;break}i+=H(t,n)}W.set(e,i)}return i}function q(t,e,i,n,s,o,r,l,a){let h=0;for(let i=n;i<s;i++)h+=H(t,e[i]);let c=Math.ceil(1.5*h/8),d=[],u=[];return function e(i,n,s,r,l){for(let h=s;h<r;){let s=h,f=n[h],p=H(t,i[h]);for(h++;h<r;h++){let e=H(t,i[h]);if(p+e>=c)break;p+=e}if(h==s+1){if(p>c){let t=i[s];e(t.children,t.positions,0,t.children.length,n[s]+l);continue}d.push(i[s])}else{let e=n[h-1]+i[h-1].length-f;d.push(q(t,i,n,s,h,f,e,null,a))}u.push(f+l-o)}}(e,i,n,s,0),(l||a)(d,u,r)}class F{constructor(){this.map=new WeakMap}setBuffer(t,e,i){let n=this.map.get(t);n||this.map.set(t,n=new Map),n.set(e,i)}getBuffer(t,e){let i=this.map.get(t);return i&&i.get(e)}set(t,e){t instanceof L?this.setBuffer(t.context.buffer,t.index,e):t instanceof E&&this.map.set(t.tree,e)}get(t){return t instanceof L?this.getBuffer(t.context.buffer,t.index):t instanceof E?this.map.get(t.tree):void 0}cursorSet(t,e){t.buffer?this.setBuffer(t.buffer.buffer,t.index,e):this.map.set(t.tree,e)}cursorGet(t){return t.buffer?this.getBuffer(t.buffer.buffer,t.index):this.map.get(t.tree)}}class z{constructor(t,e,i,n,s=!1,o=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(s?1:0)|(o?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],i=!1){let n=[new z(0,t.length,t,0,!1,i)];for(let i of e)i.to>t.length&&n.push(i);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],s=1,o=t.length?t[0]:null;for(let r=0,l=0,a=0;;r++){let h=r<e.length?e[r]:null,c=h?h.fromA:1e9;if(c-l>=i)for(;o&&o.from<c;){let e=o;if(l>=e.from||c<=e.to||a){let t=Math.max(e.from,l)-a,i=Math.min(e.to,c)-a;e=t>=i?null:new z(t,i,e.tree,e.offset+a,r>0,!!h)}if(e&&n.push(e),o.to>c)break;o=s<t.length?t[s++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class I{startParse(t,e,i){return"string"==typeof t&&(t=new Z(t)),i=i?i.length?i.map((t=>new m(t.from,t.to))):[new m(0,0)]:[new m(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let t=n.advance();if(t)return t}}}class Z{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new O({perNode:!0});class X{constructor(t,e,i,n,s,o,r,l,a,h=0,c){this.p=t,this.stack=e,this.state=i,this.reducePos=n,this.pos=s,this.score=o,this.buffer=r,this.bufferBase=l,this.curContext=a,this.lookAhead=h,this.parent=c}toString(){return`[${this.stack.filter(((t,e)=>e%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(t,e,i=0){let n=t.parser.context;return new X(t,[],e,i,i,0,[],0,n?new j(n,n.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t}reduce(t){var e;let i=t>>19,n=65535&t,{parser:s}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let r=s.dynamicPrecedence(n);if(r&&(this.score+=r),0==i)return this.pushState(s.getGoto(this.state,n,!0),this.reducePos),n<s.minRepeatTerm&&this.storeNode(n,this.reducePos,this.reducePos,o?8:4,!0),void this.reduceContext(n,this.reducePos);let l=this.stack.length-3*(i-1)-(262144&t?6:0),a=l?this.stack[l-2]:this.p.ranges[0].from,h=this.reducePos-a;h>=2e3&&!(null===(e=this.p.parser.nodeSet.types[n])||void 0===e?void 0:e.isAnonymous)&&(a==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=h):this.p.lastBigReductionSize<h&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=a,this.p.lastBigReductionSize=h));let c=l?this.stack[l-1]:0,d=this.bufferBase+this.buffer.length-c;if(n<s.minRepeatTerm||131072&t){let t=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(n,a,t,d+4,!0)}if(262144&t)this.state=this.stack[l];else{let t=this.stack[l-3];this.state=s.getGoto(t,n,!0)}for(;this.stack.length>l;)this.stack.pop();this.reduceContext(n,a)}storeNode(t,e,i,n=4,s=!1){if(0==t&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let t=this,n=this.buffer.length;if(0==n&&t.parent&&(n=t.bufferBase-t.parent.bufferBase,t=t.parent),n>0&&0==t.buffer[n-4]&&t.buffer[n-1]>-1){if(e==i)return;if(t.buffer[n-2]>=e)return void(t.buffer[n-2]=i)}}if(s&&this.pos!=i){let s=this.buffer.length;if(s>0&&0!=this.buffer[s-4]){let t=!1;for(let e=s;e>0&&this.buffer[e-2]>i;e-=4)if(this.buffer[e-1]>=0){t=!0;break}if(t)for(;s>0&&this.buffer[s-2]>i;)this.buffer[s]=this.buffer[s-4],this.buffer[s+1]=this.buffer[s-3],this.buffer[s+2]=this.buffer[s-2],this.buffer[s+3]=this.buffer[s-1],s-=4,n>4&&(n-=4)}this.buffer[s]=t,this.buffer[s+1]=e,this.buffer[s+2]=i,this.buffer[s+3]=n}else this.buffer.push(t,e,i,n)}shift(t,e,i,n){if(131072&t)this.pushState(65535&t,this.pos);else if(262144&t)this.pos=n,this.shiftContext(e,i),e<=this.p.parser.maxNode&&this.buffer.push(e,i,n,4);else{let s=t,{parser:o}=this.p;(n>this.pos||e<=o.maxNode)&&(this.pos=n,o.stateFlag(s,1)||(this.reducePos=n)),this.pushState(s,i),this.shiftContext(e,i),e<=o.maxNode&&this.buffer.push(e,i,n,4)}}apply(t,e,i,n){65536&t?this.reduce(t):this.shift(t,e,i,n)}useNode(t,e){let i=this.p.reused.length-1;(i<0||this.p.reused[i]!=t)&&(this.p.reused.push(t),i++);let n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(i,n,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,t,this,this.p.stream.reset(this.pos-t.length)))}split(){let t=this,e=t.buffer.length;for(;e>0&&t.buffer[e-2]>t.reducePos;)e-=4;let i=t.buffer.slice(e),n=t.bufferBase+e;for(;t&&n==t.bufferBase;)t=t.parent;return new X(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,i,n,this.curContext,this.lookAhead,t)}recoverByDelete(t,e){let i=t<=this.p.parser.maxNode;i&&this.storeNode(t,this.pos,e,4),this.storeNode(0,this.pos,e,i?8:4),this.pos=this.reducePos=e,this.score-=190}canShift(t){for(let e=new Y(this);;){let i=this.p.parser.stateSlot(e.state,4)||this.p.parser.hasAction(e.state,t);if(0==i)return!1;if(!(65536&i))return!0;e.reduce(i)}}recoverByInsert(t){if(this.stack.length>=300)return[];let e=this.p.parser.nextStates(this.state);if(e.length>8||this.stack.length>=120){let i=[];for(let n,s=0;s<e.length;s+=2)(n=e[s+1])!=this.state&&this.p.parser.hasAction(n,t)&&i.push(e[s],n);if(this.stack.length<120)for(let t=0;i.length<8&&t<e.length;t+=2){let n=e[t+1];i.some(((t,e)=>1&e&&t==n))||i.push(e[t],n)}e=i}let i=[];for(let t=0;t<e.length&&i.length<4;t+=2){let n=e[t+1];if(n==this.state)continue;let s=this.split();s.pushState(n,this.pos),s.storeNode(0,s.pos,s.pos,4,!0),s.shiftContext(e[t],this.pos),s.reducePos=this.pos,s.score-=200,i.push(s)}return i}forceReduce(){let{parser:t}=this.p,e=t.stateSlot(this.state,5);if(!(65536&e))return!1;if(!t.validAction(this.state,e)){let i=e>>19,n=65535&e,s=this.stack.length-3*i;if(s<0||t.getGoto(this.stack[s],n,!1)<0){let t=this.findForcedReduction();if(null==t)return!1;e=t}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(e),!0}findForcedReduction(){let{parser:t}=this.p,e=[],i=(n,s)=>{if(!e.includes(n))return e.push(n),t.allActions(n,(e=>{if(393216&e);else if(65536&e){let i=(e>>19)-s;if(i>1){let n=65535&e,s=this.stack.length-3*i;if(s>=0&&t.getGoto(this.stack[s],n,!1)>=0)return i<<19|65536|n}}else{let t=i(e,s+1);if(null!=t)return t}}))};return i(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:t}=this.p;return 65535==t.data[t.stateSlot(this.state,1)]&&!t.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(t){if(this.state!=t.state||this.stack.length!=t.stack.length)return!1;for(let e=0;e<this.stack.length;e+=3)if(this.stack[e]!=t.stack[e])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(t){return this.p.parser.dialect.flags[t]}shiftContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,t,this,this.p.stream.reset(e)))}reduceContext(t,e){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,t,this,this.p.stream.reset(e)))}emitContext(){let t=this.buffer.length-1;(t<0||-3!=this.buffer[t])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let t=this.buffer.length-1;(t<0||-4!=this.buffer[t])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(t){if(t!=this.curContext.context){let e=new j(this.curContext.tracker,t);e.hash!=this.curContext.hash&&this.emitContext(),this.curContext=e}}setLookAhead(t){t>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=t)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class j{constructor(t,e){this.tracker=t,this.context=e,this.hash=t.strict?t.hash(e):0}}class Y{constructor(t){this.start=t,this.state=t.state,this.stack=t.stack,this.base=this.stack.length}reduce(t){let e=65535&t,i=t>>19;0==i?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(i-1);let n=this.start.p.parser.getGoto(this.stack[this.base-3],e,!0);this.state=n}}class U{constructor(t,e,i){this.stack=t,this.pos=e,this.index=i,this.buffer=t.buffer,0==this.index&&this.maybeNext()}static create(t,e=t.bufferBase+t.buffer.length){return new U(t,e,e-t.bufferBase)}maybeNext(){let t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new U(this.stack,this.pos,this.index)}}function K(t,e=Uint16Array){if("string"!=typeof t)return t;let i=null;for(let n=0,s=0;n<t.length;){let o=0;for(;;){let e=t.charCodeAt(n++),i=!1;if(126==e){o=65535;break}e>=92&&e--,e>=34&&e--;let s=e-32;if(s>=46&&(s-=46,i=!0),o+=s,i)break;o*=46}i?i[s++]=o:i=new e(o)}return i}class G{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const J=new G;class tt{constructor(t,e){this.input=t,this.ranges=e,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=J,this.rangeIndex=0,this.pos=this.chunkPos=e[0].from,this.range=e[0],this.end=e[e.length-1].to,this.readNext()}resolveOffset(t,e){let i=this.range,n=this.rangeIndex,s=this.pos+t;for(;s<i.from;){if(!n)return null;let t=this.ranges[--n];s-=i.from-t.to,i=t}for(;e<0?s>i.to:s>=i.to;){if(n==this.ranges.length-1)return null;let t=this.ranges[++n];s+=t.from-i.to,i=t}return s}clipPos(t){if(t>=this.range.from&&t<this.range.to)return t;for(let e of this.ranges)if(e.to>t)return Math.max(t,e.from);return this.end}peek(t){let e,i,n=this.chunkOff+t;if(n>=0&&n<this.chunk.length)e=this.pos+t,i=this.chunk.charCodeAt(n);else{let n=this.resolveOffset(t,1);if(null==n)return-1;if(e=n,e>=this.chunk2Pos&&e<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(e-this.chunk2Pos);else{let t=this.rangeIndex,n=this.range;for(;n.to<=e;)n=this.ranges[++t];this.chunk2=this.input.chunk(this.chunk2Pos=e),e+this.chunk2.length>n.to&&(this.chunk2=this.chunk2.slice(0,n.to-e)),i=this.chunk2.charCodeAt(0)}}return e>=this.token.lookAhead&&(this.token.lookAhead=e+1),i}acceptToken(t,e=0){let i=e?this.resolveOffset(e,-1):this.pos;if(null==i||i<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=t,this.token.end=i}acceptTokenTo(t,e){this.token.value=t,this.token.end=e}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:t,chunkPos:e}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=t,this.chunk2Pos=e,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let t=this.input.chunk(this.pos),e=this.pos+t.length;this.chunk=e>this.range.to?t.slice(0,this.range.to-this.pos):t,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(t=1){for(this.chunkOff+=t;this.pos+t>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();t-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=t,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(t,e){if(e?(this.token=e,e.start=t,e.lookAhead=t+1,e.value=e.extended=-1):this.token=J,this.pos!=t){if(this.pos=t,t==this.end)return this.setDone(),this;for(;t<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;t>=this.range.to;)this.range=this.ranges[++this.rangeIndex];t>=this.chunkPos&&t<this.chunkPos+this.chunk.length?this.chunkOff=t-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(t,e){if(t>=this.chunkPos&&e<=this.chunkPos+this.chunk.length)return this.chunk.slice(t-this.chunkPos,e-this.chunkPos);if(t>=this.chunk2Pos&&e<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(t-this.chunk2Pos,e-this.chunk2Pos);if(t>=this.range.from&&e<=this.range.to)return this.input.read(t,e);let i="";for(let n of this.ranges){if(n.from>=e)break;n.to>t&&(i+=this.input.read(Math.max(n.from,t),Math.min(n.to,e)))}return i}}class et{constructor(t,e){this.data=t,this.id=e}token(t,e){let{parser:i}=e.p;st(this.data,t,e,this.id,i.data,i.tokenPrecTable)}}et.prototype.contextual=et.prototype.fallback=et.prototype.extend=!1;class it{constructor(t,e,i){this.precTable=e,this.elseToken=i,this.data="string"==typeof t?K(t):t}token(t,e){let i=t.pos,n=0;for(;;){let i=t.next<0,s=t.resolveOffset(1,1);if(st(this.data,t,e,0,this.data,this.precTable),t.token.value>-1)break;if(null==this.elseToken)return;if(i||n++,null==s)break;t.reset(s,t.token)}n&&(t.reset(i,t.token),t.acceptToken(this.elseToken,n))}}it.prototype.contextual=et.prototype.fallback=et.prototype.extend=!1;class nt{constructor(t,e={}){this.token=t,this.contextual=!!e.contextual,this.fallback=!!e.fallback,this.extend=!!e.extend}}function st(t,e,i,n,s,o){let r=0,l=1<<n,{dialect:a}=i.p.parser;t:for(;0!=(l&t[r]);){let i=t[r+1];for(let n=r+3;n<i;n+=2)if((t[n+1]&l)>0){let i=t[n];if(a.allows(i)&&(-1==e.token.value||e.token.value==i||rt(i,e.token.value,s,o))){e.acceptToken(i);break}}let n=e.next,h=0,c=t[r+2];if(!(e.next<0&&c>h&&65535==t[i+3*c-3])){for(;h<c;){let s=h+c>>1,o=i+s+(s<<1),l=t[o],a=t[o+1]||65536;if(n<l)c=s;else{if(!(n>=a)){r=t[o+2],e.advance();continue t}h=s+1}}break}r=t[i+3*c-1]}}function ot(t,e,i){for(let n,s=e;65535!=(n=t[s]);s++)if(n==i)return s-e;return-1}function rt(t,e,i,n){let s=ot(i,n,e);return s<0||ot(i,n,t)<s}const lt="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let at=null;function ht(t,e,i){let n=t.cursor(k.IncludeAnonymous);for(n.moveTo(e);;)if(!(i<0?n.childBefore(e):n.childAfter(e)))for(;;){if((i<0?n.to<e:n.from>e)&&!n.type.isError)return i<0?Math.max(0,Math.min(n.to-1,e-25)):Math.min(t.length,Math.max(n.from+1,e+25));if(i<0?n.prevSibling():n.nextSibling())break;if(!n.parent())return i<0?0:t.length}}class ct{constructor(t,e){this.fragments=t,this.nodeSet=e,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let t=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(t){for(this.safeFrom=t.openStart?ht(t.tree,t.from+t.offset,1)-t.offset:t.from,this.safeTo=t.openEnd?ht(t.tree,t.to+t.offset,-1)-t.offset:t.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(t.tree),this.start.push(-t.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(t){if(t<this.nextStart)return null;for(;this.fragment&&this.safeTo<=t;)this.nextFragment();if(!this.fragment)return null;for(;;){let e=this.trees.length-1;if(e<0)return this.nextFragment(),null;let i=this.trees[e],n=this.index[e];if(n==i.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=i.children[n],o=this.start[e]+i.positions[n];if(o>t)return this.nextStart=o,null;if(s instanceof M){if(o==t){if(o<this.safeFrom)return null;let t=o+s.length;if(t<=this.safeTo){let e=s.prop(O.lookAhead);if(!e||t+e<this.fragment.to)return s}}this.index[e]++,o+s.length>=Math.max(this.safeFrom,t)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[e]++,this.nextStart=o+s.length}}}class dt{constructor(t,e){this.stream=e,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=t.tokenizers.map((t=>new G))}getActions(t){let e=0,i=null,{parser:n}=t.p,{tokenizers:s}=n,o=n.stateSlot(t.state,3),r=t.curContext?t.curContext.hash:0,l=0;for(let n=0;n<s.length;n++){if(!(1<<n&o))continue;let a=s[n],h=this.tokens[n];if((!i||a.fallback)&&((a.contextual||h.start!=t.pos||h.mask!=o||h.context!=r)&&(this.updateCachedToken(h,a,t),h.mask=o,h.context=r),h.lookAhead>h.end+25&&(l=Math.max(h.lookAhead,l)),0!=h.value)){let n=e;if(h.extended>-1&&(e=this.addActions(t,h.extended,h.end,e)),e=this.addActions(t,h.value,h.end,e),!a.extend&&(i=h,e>n))break}}for(;this.actions.length>e;)this.actions.pop();return l&&t.setLookAhead(l),i||t.pos!=this.stream.end||(i=new G,i.value=t.p.parser.eofTerm,i.start=i.end=t.pos,e=this.addActions(t,i.value,i.end,e)),this.mainToken=i,this.actions}getMainToken(t){if(this.mainToken)return this.mainToken;let e=new G,{pos:i,p:n}=t;return e.start=i,e.end=Math.min(i+1,n.stream.end),e.value=i==n.stream.end?n.parser.eofTerm:0,e}updateCachedToken(t,e,i){let n=this.stream.clipPos(i.pos);if(e.token(this.stream.reset(n,t),i),t.value>-1){let{parser:e}=i.p;for(let n=0;n<e.specialized.length;n++)if(e.specialized[n]==t.value){let s=e.specializers[n](this.stream.read(t.start,t.end),i);if(s>=0&&i.p.parser.dialect.allows(s>>1)){1&s?t.extended=s>>1:t.value=s>>1;break}}}else t.value=0,t.end=this.stream.clipPos(n+1)}putAction(t,e,i,n){for(let e=0;e<n;e+=3)if(this.actions[e]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=i,n}addActions(t,e,i,n){let{state:s}=t,{parser:o}=t.p,{data:r}=o;for(let t=0;t<2;t++)for(let l=o.stateSlot(s,t?2:1);;l+=3){if(65535==r[l]){if(1!=r[l+1]){0==n&&2==r[l+1]&&(n=this.putAction(Ot(r,l+2),e,i,n));break}l=Ot(r,l+2)}r[l]==e&&(n=this.putAction(Ot(r,l+1),e,i,n))}return n}}class ut{constructor(t,e,i,n){this.parser=t,this.input=e,this.ranges=n,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new tt(e,n),this.tokens=new dt(t,this.stream),this.topTerm=t.top[1];let{from:s}=n[0];this.stacks=[X.start(this,t.top[0],s)],this.fragments=i.length&&this.stream.end-s>4*t.bufferLength?new ct(i,t.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let t,e,i=this.stacks,n=this.minStackPos,s=this.stacks=[];if(this.bigReductionCount>300&&1==i.length){let[t]=i;for(;t.forceReduce()&&t.stack.length&&t.stack[t.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<i.length;o++){let r=i[o];for(;;){if(this.tokens.mainToken=null,r.pos>n)s.push(r);else{if(this.advanceStack(r,s,i))continue;{t||(t=[],e=[]),t.push(r);let i=this.tokens.getMainToken(r);e.push(i.value,i.end)}}break}}if(!s.length){let e=t&&function(t){let e=null;for(let i of t){let t=i.p.stoppedAt;(i.pos==i.p.stream.end||null!=t&&i.pos>t)&&i.p.parser.stateFlag(i.state,2)&&(!e||e.score<i.score)&&(e=i)}return e}(t);if(e)return lt&&console.log("Finish with "+this.stackID(e)),this.stackToTree(e);if(this.parser.strict)throw lt&&t&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+n);this.recovering||(this.recovering=5)}if(this.recovering&&t){let i=null!=this.stoppedAt&&t[0].pos>this.stoppedAt?t[0]:this.runRecovery(t,e,s);if(i)return lt&&console.log("Force-finish "+this.stackID(i)),this.stackToTree(i.forceAll())}if(this.recovering){let t=1==this.recovering?1:3*this.recovering;if(s.length>t)for(s.sort(((t,e)=>e.score-t.score));s.length>t;)s.pop();s.some((t=>t.reducePos>n))&&this.recovering--}else if(s.length>1){t:for(let t=0;t<s.length-1;t++){let e=s[t];for(let i=t+1;i<s.length;i++){let n=s[i];if(e.sameState(n)||e.buffer.length>500&&n.buffer.length>500){if(!((e.score-n.score||e.buffer.length-n.buffer.length)>0)){s.splice(t--,1);continue t}s.splice(i--,1)}}}s.length>12&&s.splice(12,s.length-12)}this.minStackPos=s[0].pos;for(let t=1;t<s.length;t++)s[t].pos<this.minStackPos&&(this.minStackPos=s[t].pos);return null}stopAt(t){if(null!=this.stoppedAt&&this.stoppedAt<t)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=t}advanceStack(t,e,i){let n=t.pos,{parser:s}=this,o=lt?this.stackID(t)+" -> ":"";if(null!=this.stoppedAt&&n>this.stoppedAt)return t.forceReduce()?t:null;if(this.fragments){let e=t.curContext&&t.curContext.tracker.strict,i=e?t.curContext.hash:0;for(let r=this.fragments.nodeAt(n);r;){let n=this.parser.nodeSet.types[r.type.id]==r.type?s.getGoto(t.state,r.type.id):-1;if(n>-1&&r.length&&(!e||(r.prop(O.contextHash)||0)==i))return t.useNode(r,n),lt&&console.log(o+this.stackID(t)+` (via reuse of ${s.getName(r.type.id)})`),!0;if(!(r instanceof M)||0==r.children.length||r.positions[0]>0)break;let l=r.children[0];if(!(l instanceof M&&0==r.positions[0]))break;r=l}}let r=s.stateSlot(t.state,4);if(r>0)return t.reduce(r),lt&&console.log(o+this.stackID(t)+` (via always-reduce ${s.getName(65535&r)})`),!0;if(t.stack.length>=8400)for(;t.stack.length>6e3&&t.forceReduce(););let l=this.tokens.getActions(t);for(let r=0;r<l.length;){let a=l[r++],h=l[r++],c=l[r++],d=r==l.length||!i,u=d?t:t.split(),f=this.tokens.mainToken;if(u.apply(a,h,f?f.start:u.pos,c),lt&&console.log(o+this.stackID(u)+` (via ${65536&a?`reduce of ${s.getName(65535&a)}`:"shift"} for ${s.getName(h)} @ ${n}${u==t?"":", split"})`),d)return!0;u.pos>n?e.push(u):i.push(u)}return!1}advanceFully(t,e){let i=t.pos;for(;;){if(!this.advanceStack(t,null,null))return!1;if(t.pos>i)return ft(t,e),!0}}runRecovery(t,e,i){let n=null,s=!1;for(let o=0;o<t.length;o++){let r=t[o],l=e[o<<1],a=e[1+(o<<1)],h=lt?this.stackID(r)+" -> ":"";if(r.deadEnd){if(s)continue;if(s=!0,r.restart(),lt&&console.log(h+this.stackID(r)+" (restarted)"),this.advanceFully(r,i))continue}let c=r.split(),d=h;for(let t=0;c.forceReduce()&&t<10&&(lt&&console.log(d+this.stackID(c)+" (via force-reduce)"),!this.advanceFully(c,i));t++)lt&&(d=this.stackID(c)+" -> ");for(let t of r.recoverByInsert(l))lt&&console.log(h+this.stackID(t)+" (via recover-insert)"),this.advanceFully(t,i);this.stream.end>r.pos?(a==r.pos&&(a++,l=0),r.recoverByDelete(l,a),lt&&console.log(h+this.stackID(r)+` (via recover-delete ${this.parser.getName(l)})`),ft(r,i)):(!n||n.score<r.score)&&(n=r)}return n}stackToTree(t){return t.close(),M.build({buffer:U.create(t),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:t.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(t){let e=(at||(at=new WeakMap)).get(t);return e||at.set(t,e=String.fromCodePoint(this.nextStackID++)),e+t}}function ft(t,e){for(let i=0;i<e.length;i++){let n=e[i];if(n.pos==t.pos&&n.sameState(t))return void(e[i].score<t.score&&(e[i]=t))}e.push(t)}class pt{constructor(t,e,i){this.source=t,this.flags=e,this.disabled=i}allows(t){return!this.disabled||0==this.disabled[t]}}const gt=t=>t;class mt extends I{constructor(t){if(super(),this.wrappers=[],14!=t.version)throw new RangeError(`Parser version (${t.version}) doesn't match runtime version (14)`);let e=t.nodeNames.split(" ");this.minRepeatTerm=e.length;for(let i=0;i<t.repeatNodeCount;i++)e.push("");let i=Object.keys(t.topRules).map((e=>t.topRules[e][1])),n=[];for(let t=0;t<e.length;t++)n.push([]);function s(t,e,i){n[t].push([e,e.deserialize(String(i))])}if(t.nodeProps)for(let e of t.nodeProps){let t=e[0];"string"==typeof t&&(t=O[t]);for(let i=1;i<e.length;){let n=e[i++];if(n>=0)s(n,t,e[i++]);else{let o=e[i+-n];for(let r=-n;r>0;r--)s(e[i++],t,o);i++}}}this.nodeSet=new y(e.map(((e,s)=>b.define({name:s>=this.minRepeatTerm?void 0:e,id:s,props:n[s],top:i.indexOf(s)>-1,error:0==s,skipped:t.skippedNodes&&t.skippedNodes.indexOf(s)>-1})))),t.propSources&&(this.nodeSet=this.nodeSet.extend(...t.propSources)),this.strict=!1,this.bufferLength=p;let o=K(t.tokenData);this.context=t.context,this.specializerSpecs=t.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let t=0;t<this.specializerSpecs.length;t++)this.specialized[t]=this.specializerSpecs[t].term;this.specializers=this.specializerSpecs.map(vt),this.states=K(t.states,Uint32Array),this.data=K(t.stateData),this.goto=K(t.goto),this.maxTerm=t.maxTerm,this.tokenizers=t.tokenizers.map((t=>"number"==typeof t?new et(o,t):t)),this.topRules=t.topRules,this.dialects=t.dialects||{},this.dynamicPrecedences=t.dynamicPrecedences||null,this.tokenPrecTable=t.tokenPrec,this.termNames=t.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(t,e,i){let n=new ut(this,t,e,i);for(let s of this.wrappers)n=s(n,t,e,i);return n}getGoto(t,e,i=!1){let n=this.goto;if(e>=n[0])return-1;for(let s=n[e+1];;){let e=n[s++],o=1&e,r=n[s++];if(o&&i)return r;for(let i=s+(e>>1);s<i;s++)if(n[s]==t)return r;if(o)return-1}}hasAction(t,e){let i=this.data;for(let n=0;n<2;n++)for(let s,o=this.stateSlot(t,n?2:1);;o+=3){if(65535==(s=i[o])){if(1!=i[o+1]){if(2==i[o+1])return Ot(i,o+2);break}s=i[o=Ot(i,o+2)]}if(s==e||0==s)return Ot(i,o+1)}return 0}stateSlot(t,e){return this.states[6*t+e]}stateFlag(t,e){return(this.stateSlot(t,0)&e)>0}validAction(t,e){return!!this.allActions(t,(t=>t==e||null))}allActions(t,e){let i=this.stateSlot(t,4),n=i?e(i):void 0;for(let i=this.stateSlot(t,1);null==n;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=Ot(this.data,i+2)}n=e(Ot(this.data,i+1))}return n}nextStates(t){let e=[];for(let i=this.stateSlot(t,1);;i+=3){if(65535==this.data[i]){if(1!=this.data[i+1])break;i=Ot(this.data,i+2)}if(!(1&this.data[i+2])){let t=this.data[i+1];e.some(((e,i)=>1&i&&e==t))||e.push(this.data[i],t)}}return e}configure(t){let e=Object.assign(Object.create(mt.prototype),this);if(t.props&&(e.nodeSet=this.nodeSet.extend(...t.props)),t.top){let i=this.topRules[t.top];if(!i)throw new RangeError(`Invalid top rule name ${t.top}`);e.top=i}return t.tokenizers&&(e.tokenizers=this.tokenizers.map((e=>{let i=t.tokenizers.find((t=>t.from==e));return i?i.to:e}))),t.specializers&&(e.specializers=this.specializers.slice(),e.specializerSpecs=this.specializerSpecs.map(((i,n)=>{let s=t.specializers.find((t=>t.from==i.external));if(!s)return i;let o=Object.assign(Object.assign({},i),{external:s.to});return e.specializers[n]=vt(o),o}))),t.contextTracker&&(e.context=t.contextTracker),t.dialect&&(e.dialect=this.parseDialect(t.dialect)),null!=t.strict&&(e.strict=t.strict),t.wrap&&(e.wrappers=e.wrappers.concat(t.wrap)),null!=t.bufferLength&&(e.bufferLength=t.bufferLength),e}hasWrappers(){return this.wrappers.length>0}getName(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.nodeSet.types[t].name||t)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(t){let e=this.dynamicPrecedences;return null==e?0:e[t]||0}parseDialect(t){let e=Object.keys(this.dialects),i=e.map((()=>!1));if(t)for(let n of t.split(" ")){let t=e.indexOf(n);t>=0&&(i[t]=!0)}let n=null;for(let t=0;t<e.length;t++)if(!i[t])for(let i,s=this.dialects[e[t]];65535!=(i=this.data[s++]);)(n||(n=new Uint8Array(this.maxTerm+1)))[i]=1;return new pt(t,i,n)}static deserialize(t){return new mt(t)}}function Ot(t,e){return t[e]|t[e+1]<<16}function vt(t){if(t.external){let e=t.extend?1:0;return(i,n)=>t.external(i,n)<<1|e}return t.get}let wt=0;class bt{constructor(t,e,i,n){this.name=t,this.set=e,this.base=i,this.modified=n,this.id=wt++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let i="string"==typeof t?t:"?";if(t instanceof bt&&(e=t),null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let n=new bt(i,[],null,[]);if(n.set.push(n),e)for(let t of e.set)n.set.push(t);return n}static defineModifier(t){let e=new St(t);return t=>t.modified.indexOf(e)>-1?t:St.get(t.base||t,t.modified.concat(e).sort(((t,e)=>t.id-e.id)))}}let yt=0;class St{constructor(t){this.name=t,this.instances=[],this.id=yt++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find((i=>{return i.base==t&&(n=e,s=i.modified,n.length==s.length&&n.every(((t,e)=>t==s[e])));var n,s}));if(i)return i;let n=[],s=new bt(t.name,n,t,e);for(let t of e)t.instances.push(s);let o=function(t){let e=[[]];for(let i=0;i<t.length;i++)for(let n=0,s=e.length;n<s;n++)e.push(e[n].concat(t[i]));return e.sort(((t,e)=>e.length-t.length))}(e);for(let e of t.set)if(!e.modified.length)for(let t of o)n.push(St.get(e,t));return s}}function xt(t){let e=Object.create(null);for(let i in t){let n=t[i];Array.isArray(n)||(n=[n]);for(let t of i.split(" "))if(t){let i=[],s=2,o=t;for(let e=0;;){if("..."==o&&e>0&&e+3==t.length){s=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!n)throw new RangeError("Invalid path: "+t);if(i.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let r=t[e++];if(e==t.length&&"!"==r){s=0;break}if("/"!=r)throw new RangeError("Invalid path: "+t);o=t.slice(e)}let r=i.length-1,l=i[r];if(!l)throw new RangeError("Invalid path: "+t);let a=new Mt(n,s,r>0?i.slice(0,r):null);e[l]=a.sort(e[l])}}return kt.add(e)}const kt=new O;class Mt{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}function Ct(t,e){let i=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)i[t.id]=e.class;else i[e.tag.id]=e.class;let{scope:n,all:s=null}=e||{};return{style:t=>{let e=s;for(let n of t)for(let t of n.set){let n=i[t.id];if(n){e=e?e+" "+n:n;break}}return e},scope:n}}function At(t,e,i,n=0,s=t.length){let o=new Tt(n,Array.isArray(e)?e:[e],i);o.highlightRange(t.cursor(),n,s,"",o.highlighters),o.flush(s)}Mt.empty=new Mt([],2,null);class Tt{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,s){let{type:o,from:r,to:l}=t;if(r>=i||l<=e)return;o.isTop&&(s=this.highlighters.filter((t=>!t.scope||t.scope(o))));let a=n,h=function(t){let e=t.type.prop(kt);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}(t)||Mt.empty,c=function(t,e){let i=null;for(let n of t){let t=n.style(e);t&&(i=i?i+" "+t:t)}return i}(s,h.tags);if(c&&(a&&(a+=" "),a+=c,1==h.mode&&(n+=(n?" ":"")+c)),this.startSpan(Math.max(e,r),a),h.opaque)return;let d=t.tree&&t.tree.prop(O.mounted);if(d&&d.overlay){let o=t.node.enter(d.overlay[0].from+r,1),h=this.highlighters.filter((t=>!t.scope||t.scope(d.tree.type))),c=t.firstChild();for(let u=0,f=r;;u++){let p=u<d.overlay.length?d.overlay[u]:null,g=p?p.from+r:l,m=Math.max(e,f),O=Math.min(i,g);if(m<O&&c)for(;t.from<O&&(this.highlightRange(t,m,O,n,s),this.startSpan(Math.min(O,t.to),a),!(t.to>=g)&&t.nextSibling()););if(!p||g>i)break;f=p.to+r,f>e&&(this.highlightRange(o.cursor(),Math.max(e,p.from+r),Math.min(i,f),"",h),this.startSpan(Math.min(i,f),a))}c&&t.parent()}else if(t.firstChild()){d&&(n="");do{if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,n,s),this.startSpan(Math.min(i,t.to),a)}}while(t.nextSibling());t.parent()}}}const Pt=bt.define,Dt=Pt(),Et=Pt(),Rt=Pt(Et),Qt=Pt(Et),Bt=Pt(),Lt=Pt(Bt),$t=Pt(Bt),_t=Pt(),Vt=Pt(_t),Nt=Pt(),Wt=Pt(),Ht=Pt(),qt=Pt(Ht),Ft=Pt(),zt={comment:Dt,lineComment:Pt(Dt),blockComment:Pt(Dt),docComment:Pt(Dt),name:Et,variableName:Pt(Et),typeName:Rt,tagName:Pt(Rt),propertyName:Qt,attributeName:Pt(Qt),className:Pt(Et),labelName:Pt(Et),namespace:Pt(Et),macroName:Pt(Et),literal:Bt,string:Lt,docString:Pt(Lt),character:Pt(Lt),attributeValue:Pt(Lt),number:$t,integer:Pt($t),float:Pt($t),bool:Pt(Bt),regexp:Pt(Bt),escape:Pt(Bt),color:Pt(Bt),url:Pt(Bt),keyword:Nt,self:Pt(Nt),null:Pt(Nt),atom:Pt(Nt),unit:Pt(Nt),modifier:Pt(Nt),operatorKeyword:Pt(Nt),controlKeyword:Pt(Nt),definitionKeyword:Pt(Nt),moduleKeyword:Pt(Nt),operator:Wt,derefOperator:Pt(Wt),arithmeticOperator:Pt(Wt),logicOperator:Pt(Wt),bitwiseOperator:Pt(Wt),compareOperator:Pt(Wt),updateOperator:Pt(Wt),definitionOperator:Pt(Wt),typeOperator:Pt(Wt),controlOperator:Pt(Wt),punctuation:Ht,separator:Pt(Ht),bracket:qt,angleBracket:Pt(qt),squareBracket:Pt(qt),paren:Pt(qt),brace:Pt(qt),content:_t,heading:Vt,heading1:Pt(Vt),heading2:Pt(Vt),heading3:Pt(Vt),heading4:Pt(Vt),heading5:Pt(Vt),heading6:Pt(Vt),contentSeparator:Pt(_t),list:Pt(_t),quote:Pt(_t),emphasis:Pt(_t),strong:Pt(_t),link:Pt(_t),monospace:Pt(_t),strikethrough:Pt(_t),inserted:Pt(),deleted:Pt(),changed:Pt(),invalid:Pt(),meta:Ft,documentMeta:Pt(Ft),annotation:Pt(Ft),processingInstruction:Pt(Ft),definition:bt.defineModifier("definition"),constant:bt.defineModifier("constant"),function:bt.defineModifier("function"),standard:bt.defineModifier("standard"),local:bt.defineModifier("local"),special:bt.defineModifier("special")};for(let t in zt){let e=zt[t];e instanceof bt&&(e.name=t)}Ct([{tag:zt.link,class:"tok-link"},{tag:zt.heading,class:"tok-heading"},{tag:zt.emphasis,class:"tok-emphasis"},{tag:zt.strong,class:"tok-strong"},{tag:zt.keyword,class:"tok-keyword"},{tag:zt.atom,class:"tok-atom"},{tag:zt.bool,class:"tok-bool"},{tag:zt.url,class:"tok-url"},{tag:zt.labelName,class:"tok-labelName"},{tag:zt.inserted,class:"tok-inserted"},{tag:zt.deleted,class:"tok-deleted"},{tag:zt.literal,class:"tok-literal"},{tag:zt.string,class:"tok-string"},{tag:zt.number,class:"tok-number"},{tag:[zt.regexp,zt.escape,zt.special(zt.string)],class:"tok-string2"},{tag:zt.variableName,class:"tok-variableName"},{tag:zt.local(zt.variableName),class:"tok-variableName tok-local"},{tag:zt.definition(zt.variableName),class:"tok-variableName tok-definition"},{tag:zt.special(zt.variableName),class:"tok-variableName2"},{tag:zt.definition(zt.propertyName),class:"tok-propertyName tok-definition"},{tag:zt.typeName,class:"tok-typeName"},{tag:zt.namespace,class:"tok-namespace"},{tag:zt.className,class:"tok-className"},{tag:zt.macroName,class:"tok-macroName"},{tag:zt.propertyName,class:"tok-propertyName"},{tag:zt.operator,class:"tok-operator"},{tag:zt.comment,class:"tok-comment"},{tag:zt.meta,class:"tok-meta"},{tag:zt.invalid,class:"tok-invalid"},{tag:zt.punctuation,class:"tok-punctuation"}]);const It=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],Zt=new class{constructor(t){this.start=t.start,this.shift=t.shift||gt,this.reduce=t.reduce||gt,this.reuse=t.reuse||gt,this.hash=t.hash||(()=>0),this.strict=!1!==t.strict}}({start:!1,shift(t,e){return 5==e||6==e||319==e?t:320==e},strict:!1}),Xt=new nt(((t,e)=>{let{next:i}=t;(125==i||-1==i||e.context)&&t.acceptToken(317)}),{contextual:!0,fallback:!0}),jt=new nt(((t,e)=>{let i,{next:n}=t;It.indexOf(n)>-1||(47!=n||47!=(i=t.peek(1))&&42!=i)&&(125==n||59==n||-1==n||e.context||t.acceptToken(315))}),{contextual:!0}),Yt=new nt(((t,e)=>{91!=t.next||e.context||t.acceptToken(316)}),{contextual:!0}),Ut=new nt(((t,e)=>{let{next:i}=t;if(43==i||45==i){if(t.advance(),i==t.next){t.advance();let i=!e.context&&e.canShift(1);t.acceptToken(i?1:2)}}else 63==i&&46==t.peek(1)&&(t.advance(),t.advance(),(t.next<48||t.next>57)&&t.acceptToken(3))}),{contextual:!0});function Kt(t,e){return t>=65&&t<=90||t>=97&&t<=122||95==t||t>=192||!e&&t>=48&&t<=57}const Gt=new nt(((t,e)=>{if(60!=t.next||!e.dialectEnabled(0))return;if(t.advance(),47==t.next)return;let i=0;for(;It.indexOf(t.next)>-1;)t.advance(),i++;if(Kt(t.next,!0)){for(t.advance(),i++;Kt(t.next,!1);)t.advance(),i++;for(;It.indexOf(t.next)>-1;)t.advance(),i++;if(44==t.next)return;for(let e=0;;e++){if(7==e){if(!Kt(t.next,!0))return;break}if(t.next!="extends".charCodeAt(e))break;t.advance(),i++}}t.acceptToken(4,-i)})),Jt=xt({"get set async static":zt.modifier,"for while do if else switch try catch finally return throw break continue default case":zt.controlKeyword,"in of await yield void typeof delete instanceof as satisfies":zt.operatorKeyword,"let var const using function class extends":zt.definitionKeyword,"import export from":zt.moduleKeyword,"with debugger new":zt.keyword,TemplateString:zt.special(zt.string),super:zt.atom,BooleanLiteral:zt.bool,this:zt.self,null:zt.null,Star:zt.modifier,VariableName:zt.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":zt.function(zt.variableName),VariableDefinition:zt.definition(zt.variableName),Label:zt.labelName,PropertyName:zt.propertyName,PrivatePropertyName:zt.special(zt.propertyName),"CallExpression/MemberExpression/PropertyName":zt.function(zt.propertyName),"FunctionDeclaration/VariableDefinition":zt.function(zt.definition(zt.variableName)),"ClassDeclaration/VariableDefinition":zt.definition(zt.className),"NewExpression/VariableName":zt.className,PropertyDefinition:zt.definition(zt.propertyName),PrivatePropertyDefinition:zt.definition(zt.special(zt.propertyName)),UpdateOp:zt.updateOperator,"LineComment Hashbang":zt.lineComment,BlockComment:zt.blockComment,Number:zt.number,String:zt.string,Escape:zt.escape,ArithOp:zt.arithmeticOperator,LogicOp:zt.logicOperator,BitOp:zt.bitwiseOperator,CompareOp:zt.compareOperator,RegExp:zt.regexp,Equals:zt.definitionOperator,Arrow:zt.function(zt.punctuation),": Spread":zt.punctuation,"( )":zt.paren,"[ ]":zt.squareBracket,"{ }":zt.brace,"InterpolationStart InterpolationEnd":zt.special(zt.brace),".":zt.derefOperator,", ;":zt.separator,"@":zt.meta,TypeName:zt.typeName,TypeDefinition:zt.definition(zt.typeName),"type enum interface implements namespace module declare":zt.definitionKeyword,"abstract global Privacy readonly override":zt.modifier,"is keyof unique infer asserts":zt.operatorKeyword,JSXAttributeValue:zt.attributeValue,JSXText:zt.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":zt.angleBracket,"JSXIdentifier JSXNameSpacedName":zt.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":zt.attributeName,"JSXBuiltin/JSXIdentifier":zt.standard(zt.tagName)}),te={__proto__:null,export:20,as:25,from:33,default:36,async:41,function:42,in:52,out:55,const:56,extends:60,this:64,true:72,false:72,null:84,void:88,typeof:92,super:108,new:142,delete:154,yield:163,await:167,class:172,public:235,private:235,protected:235,readonly:237,instanceof:256,satisfies:259,import:292,keyof:349,unique:353,infer:359,asserts:395,is:397,abstract:417,implements:419,type:421,let:424,var:426,using:429,interface:435,enum:439,namespace:445,module:447,declare:451,global:455,for:474,of:483,while:486,with:490,do:494,if:498,else:500,switch:504,case:510,try:516,catch:520,finally:524,return:528,throw:532,break:536,continue:540,debugger:544},ee={__proto__:null,async:129,get:131,set:133,declare:195,public:197,private:197,protected:197,static:199,abstract:201,override:203,readonly:209,accessor:211,new:401},ie={__proto__:null,"<":193},ne=mt.deserialize({version:14,states:"$EOQ%TQlOOO%[QlOOO'_QpOOP(lO`OOO*zQ!0MxO'#CiO+RO#tO'#CjO+aO&jO'#CjO+oO#@ItO'#DaO.QQlO'#DgO.bQlO'#DrO%[QlO'#DzO0fQlO'#ESOOQ!0Lf'#E['#E[O1PQ`O'#EXOOQO'#Ep'#EpOOQO'#Ik'#IkO1XQ`O'#GsO1dQ`O'#EoO1iQ`O'#EoO3hQ!0MxO'#JqO6[Q!0MxO'#JrO6uQ`O'#F]O6zQ,UO'#FtOOQ!0Lf'#Ff'#FfO7VO7dO'#FfO7eQMhO'#F|O9[Q`O'#F{OOQ!0Lf'#Jr'#JrOOQ!0Lb'#Jq'#JqO9aQ`O'#GwOOQ['#K^'#K^O9lQ`O'#IXO9qQ!0LrO'#IYOOQ['#J_'#J_OOQ['#I^'#I^Q`QlOOQ`QlOOO9yQ!L^O'#DvO:QQlO'#EOO:XQlO'#EQO9gQ`O'#GsO:`QMhO'#CoO:nQ`O'#EnO:yQ`O'#EyO;OQMhO'#FeO;mQ`O'#GsOOQO'#K_'#K_O;rQ`O'#K_O<QQ`O'#G{O<QQ`O'#G|O<QQ`O'#HOO9gQ`O'#HRO<wQ`O'#HUO>`Q`O'#CeO>pQ`O'#HbO>xQ`O'#HhO>xQ`O'#HjO`QlO'#HlO>xQ`O'#HnO>xQ`O'#HqO>}Q`O'#HwO?SQ!0LsO'#H}O%[QlO'#IPO?_Q!0LsO'#IRO?jQ!0LsO'#ITO9qQ!0LrO'#IVO?uQ!0MxO'#CiO@wQpO'#DlQOQ`OOO%[QlO'#EQOA_Q`O'#ETO:`QMhO'#EnOAjQ`O'#EnOAuQ!bO'#FeOOQ['#Cg'#CgOOQ!0Lb'#Dq'#DqOOQ!0Lb'#Ju'#JuO%[QlO'#JuOOQO'#Jx'#JxOOQO'#Ig'#IgOBuQpO'#EgOOQ!0Lb'#Ef'#EfOOQ!0Lb'#J|'#J|OCqQ!0MSO'#EgOC{QpO'#EWOOQO'#Jw'#JwODaQpO'#JxOEnQpO'#EWOC{QpO'#EgPE{O&2DjO'#CbPOOO)CD|)CD|OOOO'#I_'#I_OFWO#tO,59UOOQ!0Lh,59U,59UOOOO'#I`'#I`OFfO&jO,59UOFtQ!L^O'#DcOOOO'#Ib'#IbOF{O#@ItO,59{OOQ!0Lf,59{,59{OGZQlO'#IcOGnQ`O'#JsOImQ!fO'#JsO+}QlO'#JsOItQ`O,5:ROJ[Q`O'#EpOJiQ`O'#KSOJtQ`O'#KROJtQ`O'#KROJ|Q`O,5;^OKRQ`O'#KQOOQ!0Ln,5:^,5:^OKYQlO,5:^OMWQ!0MxO,5:fOMwQ`O,5:nONbQ!0LrO'#KPONiQ`O'#KOO9aQ`O'#KOON}Q`O'#KOO! VQ`O,5;]O! [Q`O'#KOO!#aQ!fO'#JrOOQ!0Lh'#Ci'#CiO%[QlO'#ESO!$PQ!fO,5:sOOQS'#Jy'#JyOOQO-E<i-E<iO9gQ`O,5=_O!$gQ`O,5=_O!$lQlO,5;ZO!&oQMhO'#EkO!(YQ`O,5;ZO!(_QlO'#DyO!(iQpO,5;dO!(qQpO,5;dO%[QlO,5;dOOQ['#FT'#FTOOQ['#FV'#FVO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eO%[QlO,5;eOOQ['#FZ'#FZO!)PQlO,5;tOOQ!0Lf,5;y,5;yOOQ!0Lf,5;z,5;zOOQ!0Lf,5;|,5;|O%[QlO'#IoO!+SQ!0LrO,5<iO%[QlO,5;eO!&oQMhO,5;eO!+qQMhO,5;eO!-cQMhO'#E^O%[QlO,5;wOOQ!0Lf,5;{,5;{O!-jQ,UO'#FjO!.gQ,UO'#KWO!.RQ,UO'#KWO!.nQ,UO'#KWOOQO'#KW'#KWO!/SQ,UO,5<SOOOW,5<`,5<`O!/eQlO'#FvOOOW'#In'#InO7VO7dO,5<QO!/lQ,UO'#FxOOQ!0Lf,5<Q,5<QO!0]Q$IUO'#CyOOQ!0Lh'#C}'#C}O!0pO#@ItO'#DRO!1^QMjO,5<eO!1eQ`O,5<hO!3QQ(CWO'#GXO!3_Q`O'#GYO!3dQ`O'#GYO!5SQ(CWO'#G^O!6XQpO'#GbOOQO'#Gn'#GnO!+xQMhO'#GmOOQO'#Gp'#GpO!+xQMhO'#GoO!6zQ$IUO'#JkOOQ!0Lh'#Jk'#JkO!7UQ`O'#JjO!7dQ`O'#JiO!7lQ`O'#CuOOQ!0Lh'#C{'#C{O!7}Q`O'#C}OOQ!0Lh'#DV'#DVOOQ!0Lh'#DX'#DXO1SQ`O'#DZO!+xQMhO'#GPO!+xQMhO'#GRO!8SQ`O'#GTO!8XQ`O'#GUO!3dQ`O'#G[O!+xQMhO'#GaO<QQ`O'#JjO!8^Q`O'#EqO!8{Q`O,5<gOOQ!0Lb'#Cr'#CrO!9TQ`O'#ErO!9}QpO'#EsOOQ!0Lb'#KQ'#KQO!:UQ!0LrO'#K`O9qQ!0LrO,5=cO`QlO,5>sOOQ['#Jg'#JgOOQ[,5>t,5>tOOQ[-E<[-E<[O!<TQ!0MxO,5:bO!9xQpO,5:`O!>nQ!0MxO,5:jO%[QlO,5:jO!AUQ!0MxO,5:lOOQO,5@y,5@yO!AuQMhO,5=_O!BTQ!0LrO'#JhO9[Q`O'#JhO!BfQ!0LrO,59ZO!BqQpO,59ZO!ByQMhO,59ZO:`QMhO,59ZO!CUQ`O,5;ZO!C^Q`O'#HaO!CrQ`O'#KcO%[QlO,5;}O!9xQpO,5<PO!CzQ`O,5=zO!DPQ`O,5=zO!DUQ`O,5=zO9qQ!0LrO,5=zO<QQ`O,5=jOOQO'#Cy'#CyO!DdQpO,5=gO!DlQMhO,5=hO!DwQ`O,5=jO!D|Q!bO,5=mO!EUQ`O'#K_O>}Q`O'#HWO9gQ`O'#HYO!EZQ`O'#HYO:`QMhO'#H[O!E`Q`O'#H[OOQ[,5=p,5=pO!EeQ`O'#H]O!EvQ`O'#CoO!E{Q`O,59PO!FVQ`O,59PO!H[QlO,59POOQ[,59P,59PO!HlQ!0LrO,59PO%[QlO,59PO!JwQlO'#HdOOQ['#He'#HeOOQ['#Hf'#HfO`QlO,5=|O!K_Q`O,5=|O`QlO,5>SO`QlO,5>UO!KdQ`O,5>WO`QlO,5>YO!KiQ`O,5>]O!KnQlO,5>cOOQ[,5>i,5>iO%[QlO,5>iO9qQ!0LrO,5>kOOQ[,5>m,5>mO# xQ`O,5>mOOQ[,5>o,5>oO# xQ`O,5>oOOQ[,5>q,5>qO#!fQpO'#D_O%[QlO'#JuO##XQpO'#JuO##cQpO'#DmO##tQpO'#DmO#&VQlO'#DmO#&^Q`O'#JtO#&fQ`O,5:WO#&kQ`O'#EtO#&yQ`O'#KTO#'RQ`O,5;_O#'WQpO'#DmO#'eQpO'#EVOOQ!0Lf,5:o,5:oO%[QlO,5:oO#'lQ`O,5:oO>}Q`O,5;YO!BqQpO,5;YO!ByQMhO,5;YO:`QMhO,5;YO#'tQ`O,5@aO#'yQ07dO,5:sOOQO-E<e-E<eO#)PQ!0MSO,5;ROC{QpO,5:rO#)ZQpO,5:rOC{QpO,5;RO!BfQ!0LrO,5:rOOQ!0Lb'#Ej'#EjOOQO,5;R,5;RO%[QlO,5;RO#)hQ!0LrO,5;RO#)sQ!0LrO,5;RO!BqQpO,5:rOOQO,5;X,5;XO#*RQ!0LrO,5;RPOOO'#I]'#I]P#*gO&2DjO,58|POOO,58|,58|OOOO-E<]-E<]OOQ!0Lh1G.p1G.pOOOO-E<^-E<^OOOO,59},59}O#*rQ!bO,59}OOOO-E<`-E<`OOQ!0Lf1G/g1G/gO#*wQ!fO,5>}O+}QlO,5>}OOQO,5?T,5?TO#+RQlO'#IcOOQO-E<a-E<aO#+`Q`O,5@_O#+hQ!fO,5@_O#+oQ`O,5@mOOQ!0Lf1G/m1G/mO%[QlO,5@nO#+wQ`O'#IiOOQO-E<g-E<gO#+oQ`O,5@mOOQ!0Lb1G0x1G0xOOQ!0Ln1G/x1G/xOOQ!0Ln1G0Y1G0YO%[QlO,5@kO#,]Q!0LrO,5@kO#,nQ!0LrO,5@kO#,uQ`O,5@jO9aQ`O,5@jO#,}Q`O,5@jO#-]Q`O'#IlO#,uQ`O,5@jOOQ!0Lb1G0w1G0wO!(iQpO,5:uO!(tQpO,5:uOOQS,5:w,5:wO#-}QdO,5:wO#.VQMhO1G2yO9gQ`O1G2yOOQ!0Lf1G0u1G0uO#.eQ!0MxO1G0uO#/jQ!0MvO,5;VOOQ!0Lh'#GW'#GWO#0WQ!0MzO'#JkO!$lQlO1G0uO#2cQ!fO'#JvO%[QlO'#JvO#2mQ`O,5:eOOQ!0Lh'#D_'#D_OOQ!0Lf1G1O1G1OO%[QlO1G1OOOQ!0Lf1G1f1G1fO#2rQ`O1G1OO#5WQ!0MxO1G1PO#5_Q!0MxO1G1PO#7uQ!0MxO1G1PO#7|Q!0MxO1G1PO#:dQ!0MxO1G1PO#<zQ!0MxO1G1PO#=RQ!0MxO1G1PO#=YQ!0MxO1G1PO#?pQ!0MxO1G1PO#?wQ!0MxO1G1PO#BUQ?MtO'#CiO#DPQ?MtO1G1`O#DWQ?MtO'#JrO#DkQ!0MxO,5?ZOOQ!0Lb-E<m-E<mO#FxQ!0MxO1G1PO#GuQ!0MzO1G1POOQ!0Lf1G1P1G1PO#HxQMjO'#J{O#ISQ`O,5:xO#IXQ!0MxO1G1cO#I{Q,UO,5<WO#JTQ,UO,5<XO#J]Q,UO'#FoO#JtQ`O'#FnOOQO'#KX'#KXOOQO'#Im'#ImO#JyQ,UO1G1nOOQ!0Lf1G1n1G1nOOOW1G1y1G1yO#K[Q?MtO'#JqO#KfQ`O,5<bO!)PQlO,5<bOOOW-E<l-E<lOOQ!0Lf1G1l1G1lO#KkQpO'#KWOOQ!0Lf,5<d,5<dO#KsQpO,5<dO#KxQMhO'#DTOOOO'#Ia'#IaO#LPO#@ItO,59mOOQ!0Lh,59m,59mO%[QlO1G2PO!8XQ`O'#IqO#L[Q`O,5<zOOQ!0Lh,5<w,5<wO!+xQMhO'#ItO#LxQMjO,5=XO!+xQMhO'#IvO#MkQMjO,5=ZO!&oQMhO,5=]OOQO1G2S1G2SO#MuQ!dO'#CrO#NYQ(CWO'#ErO$ _QpO'#GbO$ uQ!dO,5<sO$ |Q`O'#KZO9aQ`O'#KZO$![Q`O,5<uO!+xQMhO,5<tO$!aQ`O'#GZO$!rQ`O,5<tO$!wQ!dO'#GWO$#UQ!dO'#K[O$#`Q`O'#K[O!&oQMhO'#K[O$#eQ`O,5<xO$#jQlO'#JuO$#tQpO'#GcO##tQpO'#GcO$$VQ`O'#GgO!3dQ`O'#GkO$$[Q!0LrO'#IsO$$gQpO,5<|OOQ!0Lp,5<|,5<|O$$nQpO'#GcO$${QpO'#GdO$%^QpO'#GdO$%cQMjO,5=XO$%sQMjO,5=ZOOQ!0Lh,5=^,5=^O!+xQMhO,5@UO!+xQMhO,5@UO$&TQ`O'#IxO$&iQ`O,5@TO$&qQ`O,59aOOQ!0Lh,59i,59iO$'hQ$IYO,59uOOQ!0Lh'#Jo'#JoO$(ZQMjO,5<kO$(|QMjO,5<mO@oQ`O,5<oOOQ!0Lh,5<p,5<pO$)WQ`O,5<vO$)]QMjO,5<{O$)mQ`O,5@UO$){Q`O'#KOO!$lQlO1G2RO$*QQ`O1G2RO9aQ`O'#KRO9aQ`O'#EtO%[QlO'#EtO9aQ`O'#IzO$*VQ!0LrO,5@zOOQ[1G2}1G2}OOQ[1G4_1G4_OOQ!0Lf1G/|1G/|OOQ!0Lf1G/z1G/zO$,XQ!0MxO1G0UOOQ[1G2y1G2yO!&oQMhO1G2yO%[QlO1G2yO#.YQ`O1G2yO$.]QMhO'#EkOOQ!0Lb,5@S,5@SO$.jQ!0LrO,5@SOOQ[1G.u1G.uO!BfQ!0LrO1G.uO!BqQpO1G.uO!ByQMhO1G.uO$.{Q`O1G0uO$/QQ`O'#CiO$/]Q`O'#KdO$/eQ`O,5={O$/jQ`O'#KdO$/oQ`O'#KdO$/}Q`O'#JQO$0]Q`O,5@}O$0eQ!fO1G1iOOQ!0Lf1G1k1G1kO9gQ`O1G3fO@oQ`O1G3fO$0lQ`O1G3fO$0qQ`O1G3fOOQ[1G3f1G3fO!DwQ`O1G3UO!&oQMhO1G3RO$0vQ`O1G3ROOQ[1G3S1G3SO!&oQMhO1G3SO$0{Q`O1G3SO$1TQpO'#HQOOQ[1G3U1G3UO!6SQpO'#I|O!D|Q!bO1G3XOOQ[1G3X1G3XOOQ[,5=r,5=rO$1]QMhO,5=tO9gQ`O,5=tO$$VQ`O,5=vO9[Q`O,5=vO!BqQpO,5=vO!ByQMhO,5=vO:`QMhO,5=vO$1kQ`O'#KbO$1vQ`O,5=wOOQ[1G.k1G.kO$1{Q!0LrO1G.kO@oQ`O1G.kO$2WQ`O1G.kO9qQ!0LrO1G.kO$4`Q!fO,5APO$4mQ`O,5APO9aQ`O,5APO$4xQlO,5>OO$5PQ`O,5>OOOQ[1G3h1G3hO`QlO1G3hOOQ[1G3n1G3nOOQ[1G3p1G3pO>xQ`O1G3rO$5UQlO1G3tO$9YQlO'#HsOOQ[1G3w1G3wO$9gQ`O'#HyO>}Q`O'#H{OOQ[1G3}1G3}O$9oQlO1G3}O9qQ!0LrO1G4TOOQ[1G4V1G4VOOQ!0Lb'#G_'#G_O9qQ!0LrO1G4XO9qQ!0LrO1G4ZO$=vQ`O,5@aO!)PQlO,5;`O9aQ`O,5;`O>}Q`O,5:XO!)PQlO,5:XO!BqQpO,5:XO$={Q?MtO,5:XOOQO,5;`,5;`O$>VQpO'#IdO$>mQ`O,5@`OOQ!0Lf1G/r1G/rO$>uQpO'#IjO$?PQ`O,5@oOOQ!0Lb1G0y1G0yO##tQpO,5:XOOQO'#If'#IfO$?XQpO,5:qOOQ!0Ln,5:q,5:qO#'oQ`O1G0ZOOQ!0Lf1G0Z1G0ZO%[QlO1G0ZOOQ!0Lf1G0t1G0tO>}Q`O1G0tO!BqQpO1G0tO!ByQMhO1G0tOOQ!0Lb1G5{1G5{O!BfQ!0LrO1G0^OOQO1G0m1G0mO%[QlO1G0mO$?`Q!0LrO1G0mO$?kQ!0LrO1G0mO!BqQpO1G0^OC{QpO1G0^O$?yQ!0LrO1G0mOOQO1G0^1G0^O$@_Q!0MxO1G0mPOOO-E<Z-E<ZPOOO1G.h1G.hOOOO1G/i1G/iO$@iQ!bO,5<iO$@qQ!fO1G4iOOQO1G4o1G4oO%[QlO,5>}O$@{Q`O1G5yO$ATQ`O1G6XO$A]Q!fO1G6YO9aQ`O,5?TO$AgQ!0MxO1G6VO%[QlO1G6VO$AwQ!0LrO1G6VO$BYQ`O1G6UO$BYQ`O1G6UO9aQ`O1G6UO$BbQ`O,5?WO9aQ`O,5?WOOQO,5?W,5?WO$BvQ`O,5?WO$){Q`O,5?WOOQO-E<j-E<jOOQS1G0a1G0aOOQS1G0c1G0cO#.QQ`O1G0cOOQ[7+(e7+(eO!&oQMhO7+(eO%[QlO7+(eO$CUQ`O7+(eO$CaQMhO7+(eO$CoQ!0MzO,5=XO$EzQ!0MzO,5=ZO$HVQ!0MzO,5=XO$JhQ!0MzO,5=ZO$LyQ!0MzO,59uO% OQ!0MzO,5<kO%#ZQ!0MzO,5<mO%%fQ!0MzO,5<{OOQ!0Lf7+&a7+&aO%'wQ!0MxO7+&aO%(kQlO'#IeO%(xQ`O,5@bO%)QQ!fO,5@bOOQ!0Lf1G0P1G0PO%)[Q`O7+&jOOQ!0Lf7+&j7+&jO%)aQ?MtO,5:fO%[QlO7+&zO%)kQ?MtO,5:bO%)xQ?MtO,5:jO%*SQ?MtO,5:lO%*^QMhO'#IhO%*hQ`O,5@gOOQ!0Lh1G0d1G0dOOQO1G1r1G1rOOQO1G1s1G1sO%*pQ!jO,5<ZO!)PQlO,5<YOOQO-E<k-E<kOOQ!0Lf7+'Y7+'YOOOW7+'e7+'eOOOW1G1|1G1|O%*{Q`O1G1|OOQ!0Lf1G2O1G2OOOOO,59o,59oO%+QQ!dO,59oOOOO-E<_-E<_OOQ!0Lh1G/X1G/XO%+XQ!0MxO7+'kOOQ!0Lh,5?],5?]O%+{QMhO1G2fP%,SQ`O'#IqPOQ!0Lh-E<o-E<oO%,pQMjO,5?`OOQ!0Lh-E<r-E<rO%-cQMjO,5?bOOQ!0Lh-E<t-E<tO%-mQ!dO1G2wO%-tQ!dO'#CrO%.[QMhO'#KRO$#jQlO'#JuOOQ!0Lh1G2_1G2_O%.cQ`O'#IpO%.wQ`O,5@uO%.wQ`O,5@uO%/PQ`O,5@uO%/[Q`O,5@uOOQO1G2a1G2aO%/jQMjO1G2`O!+xQMhO1G2`O%/zQ(CWO'#IrO%0XQ`O,5@vO!&oQMhO,5@vO%0aQ!dO,5@vOOQ!0Lh1G2d1G2dO%2qQ!fO'#CiO%2{Q`O,5=POOQ!0Lb,5<},5<}O%3TQpO,5<}OOQ!0Lb,5=O,5=OOClQ`O,5<}O%3`QpO,5<}OOQ!0Lb,5=R,5=RO$){Q`O,5=VOOQO,5?_,5?_OOQO-E<q-E<qOOQ!0Lp1G2h1G2hO##tQpO,5<}O$#jQlO,5=PO%3nQ`O,5=OO%3yQpO,5=OO!+xQMhO'#ItO%4sQMjO1G2sO!+xQMhO'#IvO%5fQMjO1G2uO%5pQMjO1G5pO%5zQMjO1G5pOOQO,5?d,5?dOOQO-E<v-E<vOOQO1G.{1G.{O!9xQpO,59wO%[QlO,59wOOQ!0Lh,5<j,5<jO%6XQ`O1G2ZO!+xQMhO1G2bO!+xQMhO1G5pO!+xQMhO1G5pO%6^Q!0MxO7+'mOOQ!0Lf7+'m7+'mO!$lQlO7+'mO%7QQ`O,5;`OOQ!0Lb,5?f,5?fOOQ!0Lb-E<x-E<xO%7VQ!dO'#K]O#'oQ`O7+(eO4UQ!fO7+(eO$CXQ`O7+(eO%7aQ!0MvO'#CiO%7tQ!0MvO,5=SO%8fQ`O,5=SO%8nQ`O,5=SOOQ!0Lb1G5n1G5nOOQ[7+$a7+$aO!BfQ!0LrO7+$aO!BqQpO7+$aO!$lQlO7+&aO%8sQ`O'#JPO%9[Q`O,5AOOOQO1G3g1G3gO9gQ`O,5AOO%9[Q`O,5AOO%9dQ`O,5AOOOQO,5?l,5?lOOQO-E=O-E=OOOQ!0Lf7+'T7+'TO%9iQ`O7+)QO9qQ!0LrO7+)QO9gQ`O7+)QO@oQ`O7+)QOOQ[7+(p7+(pO%9nQ!0MvO7+(mO!&oQMhO7+(mO!DrQ`O7+(nOOQ[7+(n7+(nO!&oQMhO7+(nO%9xQ`O'#KaO%:TQ`O,5=lOOQO,5?h,5?hOOQO-E<z-E<zOOQ[7+(s7+(sO%;gQpO'#HZOOQ[1G3`1G3`O!&oQMhO1G3`O%[QlO1G3`O%;nQ`O1G3`O%;yQMhO1G3`O9qQ!0LrO1G3bO$$VQ`O1G3bO9[Q`O1G3bO!BqQpO1G3bO!ByQMhO1G3bO%<XQ`O'#JOO%<mQ`O,5@|O%<uQpO,5@|OOQ!0Lb1G3c1G3cOOQ[7+$V7+$VO@oQ`O7+$VO9qQ!0LrO7+$VO%=QQ`O7+$VO%[QlO1G6kO%[QlO1G6lO%=VQ!0LrO1G6kO%=aQlO1G3jO%=hQ`O1G3jO%=mQlO1G3jOOQ[7+)S7+)SO9qQ!0LrO7+)^O`QlO7+)`OOQ['#Kg'#KgOOQ['#JR'#JRO%=tQlO,5>_OOQ[,5>_,5>_O%[QlO'#HtO%>RQ`O'#HvOOQ[,5>e,5>eO9aQ`O,5>eOOQ[,5>g,5>gOOQ[7+)i7+)iOOQ[7+)o7+)oOOQ[7+)s7+)sOOQ[7+)u7+)uO%>WQpO1G5{O%>rQ?MtO1G0zO%>|Q`O1G0zOOQO1G/s1G/sO%?XQ?MtO1G/sO>}Q`O1G/sO!)PQlO'#DmOOQO,5?O,5?OOOQO-E<b-E<bOOQO,5?U,5?UOOQO-E<h-E<hO!BqQpO1G/sOOQO-E<d-E<dOOQ!0Ln1G0]1G0]OOQ!0Lf7+%u7+%uO#'oQ`O7+%uOOQ!0Lf7+&`7+&`O>}Q`O7+&`O!BqQpO7+&`OOQO7+%x7+%xO$@_Q!0MxO7+&XOOQO7+&X7+&XO%[QlO7+&XO%?cQ!0LrO7+&XO!BfQ!0LrO7+%xO!BqQpO7+%xO%?nQ!0LrO7+&XO%?|Q!0MxO7++qO%[QlO7++qO%@^Q`O7++pO%@^Q`O7++pOOQO1G4r1G4rO9aQ`O1G4rO%@fQ`O1G4rOOQS7+%}7+%}O#'oQ`O<<LPO4UQ!fO<<LPO%@tQ`O<<LPOOQ[<<LP<<LPO!&oQMhO<<LPO%[QlO<<LPO%@|Q`O<<LPO%AXQ!0MzO,5?`O%CdQ!0MzO,5?bO%EoQ!0MzO1G2`O%HQQ!0MzO1G2sO%J]Q!0MzO1G2uO%LhQ!fO,5?PO%[QlO,5?POOQO-E<c-E<cO%LrQ`O1G5|OOQ!0Lf<<JU<<JUO%LzQ?MtO1G0uO& RQ?MtO1G1PO& YQ?MtO1G1PO&#ZQ?MtO1G1PO&#bQ?MtO1G1PO&%cQ?MtO1G1PO&'dQ?MtO1G1PO&'kQ?MtO1G1PO&'rQ?MtO1G1PO&)sQ?MtO1G1PO&)zQ?MtO1G1PO&*RQ!0MxO<<JfO&+yQ?MtO1G1PO&,vQ?MvO1G1PO&-yQ?MvO'#JkO&0PQ?MtO1G1cO&0^Q?MtO1G0UO&0hQMjO,5?SOOQO-E<f-E<fO!)PQlO'#FqOOQO'#KY'#KYOOQO1G1u1G1uO&0rQ`O1G1tO&0wQ?MtO,5?ZOOOW7+'h7+'hOOOO1G/Z1G/ZO&1RQ!dO1G4wOOQ!0Lh7+(Q7+(QP!&oQMhO,5?]O!+xQMhO7+(cO&1YQ`O,5?[O9aQ`O,5?[OOQO-E<n-E<nO&1hQ`O1G6aO&1hQ`O1G6aO&1pQ`O1G6aO&1{QMjO7+'zO&2]Q!dO,5?^O&2gQ`O,5?^O!&oQMhO,5?^OOQO-E<p-E<pO&2lQ!dO1G6bO&2vQ`O1G6bO&3OQ`O1G2kO!&oQMhO1G2kOOQ!0Lb1G2i1G2iOOQ!0Lb1G2j1G2jO%3TQpO1G2iO!BqQpO1G2iOClQ`O1G2iOOQ!0Lb1G2q1G2qO&3TQpO1G2iO&3cQ`O1G2kO$){Q`O1G2jOClQ`O1G2jO$#jQlO1G2kO&3kQ`O1G2jO&4_QMjO,5?`OOQ!0Lh-E<s-E<sO&5QQMjO,5?bOOQ!0Lh-E<u-E<uO!+xQMhO7++[OOQ!0Lh1G/c1G/cO&5[Q`O1G/cOOQ!0Lh7+'u7+'uO&5aQMjO7+'|O&5qQMjO7++[O&5{QMjO7++[O&6YQ!0MxO<<KXOOQ!0Lf<<KX<<KXO&6|Q`O1G0zO!&oQMhO'#IyO&7RQ`O,5@wO&9TQ!fO<<LPO!&oQMhO1G2nO&9[Q!0LrO1G2nOOQ[<<G{<<G{O!BfQ!0LrO<<G{O&9mQ!0MxO<<I{OOQ!0Lf<<I{<<I{OOQO,5?k,5?kO&:aQ`O,5?kO&:fQ`O,5?kOOQO-E<}-E<}O&:tQ`O1G6jO&:tQ`O1G6jO9gQ`O1G6jO@oQ`O<<LlOOQ[<<Ll<<LlO&:|Q`O<<LlO9qQ!0LrO<<LlOOQ[<<LX<<LXO%9nQ!0MvO<<LXOOQ[<<LY<<LYO!DrQ`O<<LYO&;RQpO'#I{O&;^Q`O,5@{O!)PQlO,5@{OOQ[1G3W1G3WOOQO'#I}'#I}O9qQ!0LrO'#I}O&;fQpO,5=uOOQ[,5=u,5=uO&;mQpO'#EgO&;tQpO'#GeO&;yQ`O7+(zO&<OQ`O7+(zOOQ[7+(z7+(zO!&oQMhO7+(zO%[QlO7+(zO&<WQ`O7+(zOOQ[7+(|7+(|O9qQ!0LrO7+(|O$$VQ`O7+(|O9[Q`O7+(|O!BqQpO7+(|O&<cQ`O,5?jOOQO-E<|-E<|OOQO'#H^'#H^O&<nQ`O1G6hO9qQ!0LrO<<GqOOQ[<<Gq<<GqO@oQ`O<<GqO&<vQ`O7+,VO&<{Q`O7+,WO%[QlO7+,VO%[QlO7+,WOOQ[7+)U7+)UO&=QQ`O7+)UO&=VQlO7+)UO&=^Q`O7+)UOOQ[<<Lx<<LxOOQ[<<Lz<<LzOOQ[-E=P-E=POOQ[1G3y1G3yO&=cQ`O,5>`OOQ[,5>b,5>bO&=hQ`O1G4PO9aQ`O7+&fO!)PQlO7+&fOOQO7+%_7+%_O&=mQ?MtO1G6YO>}Q`O7+%_OOQ!0Lf<<Ia<<IaOOQ!0Lf<<Iz<<IzO>}Q`O<<IzOOQO<<Is<<IsO$@_Q!0MxO<<IsO%[QlO<<IsOOQO<<Id<<IdO!BfQ!0LrO<<IdO&=wQ!0LrO<<IsO&>SQ!0MxO<= ]O&>dQ`O<= [OOQO7+*^7+*^O9aQ`O7+*^OOQ[ANAkANAkO&>lQ!fOANAkO!&oQMhOANAkO#'oQ`OANAkO4UQ!fOANAkO&>sQ`OANAkO%[QlOANAkO&>{Q!0MzO7+'zO&A^Q!0MzO,5?`O&CiQ!0MzO,5?bO&EtQ!0MzO7+'|O&HVQ!fO1G4kO&HaQ?MtO7+&aO&JeQ?MvO,5=XO&LlQ?MvO,5=ZO&L|Q?MvO,5=XO&M^Q?MvO,5=ZO&MnQ?MvO,59uO' tQ?MvO,5<kO'#wQ?MvO,5<mO'&]Q?MvO,5<{O'(RQ?MtO7+'kO'(`Q?MtO7+'mO'(mQ`O,5<]OOQO7+'`7+'`OOQ!0Lh7+*c7+*cO'(rQMjO<<K}OOQO1G4v1G4vO'(yQ`O1G4vO')UQ`O1G4vO')dQ`O7++{O')dQ`O7++{O!&oQMhO1G4xO')lQ!dO1G4xO')vQ`O7++|O'*OQ`O7+(VO'*ZQ!dO7+(VOOQ!0Lb7+(T7+(TOOQ!0Lb7+(U7+(UO!BqQpO7+(TOClQ`O7+(TO'*eQ`O7+(VO!&oQMhO7+(VO$){Q`O7+(UO'*jQ`O7+(VOClQ`O7+(UO'*rQMjO<<NvOOQ!0Lh7+$}7+$}O!+xQMhO<<NvO'*|Q!dO,5?eOOQO-E<w-E<wO'+WQ!0MvO7+(YO!&oQMhO7+(YOOQ[AN=gAN=gO9gQ`O1G5VOOQO1G5V1G5VO'+hQ`O1G5VO'+mQ`O7+,UO'+mQ`O7+,UO9qQ!0LrOANBWO@oQ`OANBWOOQ[ANBWANBWOOQ[ANAsANAsOOQ[ANAtANAtO'+uQ`O,5?gOOQO-E<y-E<yO',QQ?MtO1G6gOOQO,5?i,5?iOOQO-E<{-E<{OOQ[1G3a1G3aO',[Q`O,5=POOQ[<<Lf<<LfO!&oQMhO<<LfO&;yQ`O<<LfO',aQ`O<<LfO%[QlO<<LfOOQ[<<Lh<<LhO9qQ!0LrO<<LhO$$VQ`O<<LhO9[Q`O<<LhO',iQpO1G5UO',tQ`O7+,SOOQ[AN=]AN=]O9qQ!0LrOAN=]OOQ[<= q<= qOOQ[<= r<= rO',|Q`O<= qO'-RQ`O<= rOOQ[<<Lp<<LpO'-WQ`O<<LpO'-]QlO<<LpOOQ[1G3z1G3zO>}Q`O7+)kO'-dQ`O<<JQO'-oQ?MtO<<JQOOQO<<Hy<<HyOOQ!0LfAN?fAN?fOOQOAN?_AN?_O$@_Q!0MxOAN?_OOQOAN?OAN?OO%[QlOAN?_OOQO<<Mx<<MxOOQ[G27VG27VO!&oQMhOG27VO#'oQ`OG27VO'-yQ!fOG27VO4UQ!fOG27VO'.QQ`OG27VO'.YQ?MtO<<JfO'.gQ?MvO1G2`O'0]Q?MvO,5?`O'2`Q?MvO,5?bO'4cQ?MvO1G2sO'6fQ?MvO1G2uO'8iQ?MtO<<KXO'8vQ?MtO<<I{OOQO1G1w1G1wO!+xQMhOANAiOOQO7+*b7+*bO'9TQ`O7+*bO'9`Q`O<= gO'9hQ!dO7+*dOOQ!0Lb<<Kq<<KqO$){Q`O<<KqOClQ`O<<KqO'9rQ`O<<KqO!&oQMhO<<KqOOQ!0Lb<<Ko<<KoO!BqQpO<<KoO'9}Q!dO<<KqOOQ!0Lb<<Kp<<KpO':XQ`O<<KqO!&oQMhO<<KqO$){Q`O<<KpO':^QMjOANDbO':hQ!0MvO<<KtOOQO7+*q7+*qO9gQ`O7+*qO':xQ`O<= pOOQ[G27rG27rO9qQ!0LrOG27rO!)PQlO1G5RO';QQ`O7+,RO';YQ`O1G2kO&;yQ`OANBQOOQ[ANBQANBQO!&oQMhOANBQO';_Q`OANBQOOQ[ANBSANBSO9qQ!0LrOANBSO$$VQ`OANBSOOQO'#H_'#H_OOQO7+*p7+*pOOQ[G22wG22wOOQ[ANE]ANE]OOQ[ANE^ANE^OOQ[ANB[ANB[O';gQ`OANB[OOQ[<<MV<<MVO!)PQlOAN?lOOQOG24yG24yO$@_Q!0MxOG24yO#'oQ`OLD,qOOQ[LD,qLD,qO!&oQMhOLD,qO';lQ!fOLD,qO';sQ?MvO7+'zO'=iQ?MvO,5?`O'?lQ?MvO,5?bO'AoQ?MvO7+'|O'CeQMjOG27TOOQO<<M|<<M|OOQ!0LbANA]ANA]O$){Q`OANA]OClQ`OANA]O'CuQ!dOANA]OOQ!0LbANAZANAZO'C|Q`OANA]O!&oQMhOANA]O'DXQ!dOANA]OOQ!0LbANA[ANA[OOQO<<N]<<N]OOQ[LD-^LD-^O'DcQ?MtO7+*mOOQO'#Gf'#GfOOQ[G27lG27lO&;yQ`OG27lO!&oQMhOG27lOOQ[G27nG27nO9qQ!0LrOG27nOOQ[G27vG27vO'DmQ?MtOG25WOOQOLD*eLD*eOOQ[!$(!]!$(!]O#'oQ`O!$(!]O!&oQMhO!$(!]O'DwQ!0MzOG27TOOQ!0LbG26wG26wO$){Q`OG26wO'GYQ`OG26wOClQ`OG26wO'GeQ!dOG26wO!&oQMhOG26wOOQ[LD-WLD-WO&;yQ`OLD-WOOQ[LD-YLD-YOOQ[!)9Ew!)9EwO#'oQ`O!)9EwOOQ!0LbLD,cLD,cO$){Q`OLD,cOClQ`OLD,cO'GlQ`OLD,cO'GwQ!dOLD,cOOQ[!$(!r!$(!rOOQ[!.K;c!.K;cO'HOQ?MvOG27TOOQ!0Lb!$( }!$( }O$){Q`O!$( }OClQ`O!$( }O'ItQ`O!$( }OOQ!0Lb!)9Ei!)9EiO$){Q`O!)9EiOClQ`O!)9EiOOQ!0Lb!.K;T!.K;TO$){Q`O!.K;TOOQ!0Lb!4/0o!4/0oO!)PQlO'#DzO1PQ`O'#EXO'JPQ!fO'#JqO'JWQ!L^O'#DvO'J_QlO'#EOO'JfQ!fO'#CiO'L|Q!fO'#CiO!)PQlO'#EQO'M^QlO,5;ZO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO,5;eO!)PQlO'#IoO( aQ`O,5<iO!)PQlO,5;eO( iQMhO,5;eO(#SQMhO,5;eO!)PQlO,5;wO!&oQMhO'#GmO( iQMhO'#GmO!&oQMhO'#GoO( iQMhO'#GoO1SQ`O'#DZO1SQ`O'#DZO!&oQMhO'#GPO( iQMhO'#GPO!&oQMhO'#GRO( iQMhO'#GRO!&oQMhO'#GaO( iQMhO'#GaO!)PQlO,5:jO(#ZQpO'#D_O(#eQpO'#JuO!)PQlO,5@nO'M^QlO1G0uO(#oQ?MtO'#CiO!)PQlO1G2PO!&oQMhO'#ItO( iQMhO'#ItO!&oQMhO'#IvO( iQMhO'#IvO(#yQ!dO'#CrO!&oQMhO,5<tO( iQMhO,5<tO'M^QlO1G2RO!)PQlO7+&zO!&oQMhO1G2`O( iQMhO1G2`O!&oQMhO'#ItO( iQMhO'#ItO!&oQMhO'#IvO( iQMhO'#IvO!&oQMhO1G2bO( iQMhO1G2bO'M^QlO7+'mO'M^QlO7+&aO!&oQMhOANAiO( iQMhOANAiO($^Q`O'#EoO($cQ`O'#EoO($kQ`O'#F]O($pQ`O'#EyO($uQ`O'#KSO(%QQ`O'#KQO(%]Q`O,5;ZO(%bQMjO,5<eO(%iQ`O'#GYO(%nQ`O'#GYO(%sQ`O,5<gO(%{Q`O,5;ZO(&TQ?MtO1G1`O(&[Q`O,5<tO(&aQ`O,5<tO(&fQ`O,5<vO(&kQ`O,5<vO(&pQ`O1G2RO(&uQ`O1G0uO(&zQMjO<<K}O('RQMjO<<K}O7eQMhO'#F|O9[Q`O'#F{OAjQ`O'#EnO!)PQlO,5;tO!3dQ`O'#GYO!3dQ`O'#GYO!3dQ`O'#G[O!3dQ`O'#G[O!+xQMhO7+(cO!+xQMhO7+(cO%-mQ!dO1G2wO%-mQ!dO1G2wO!&oQMhO,5=]O!&oQMhO,5=]",stateData:"((X~O'{OS'|OSTOS'}RQ~OPYOQYOSfOY!VOaqOdzOeyOl!POpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!uwO!xxO!|]O$W|O$niO%h}O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO&V!WO&]!XO&_!YO&a!ZO&c![O&f!]O&l!^O&r!_O&t!`O&v!aO&x!bO&z!cO(SSO(UTO(XUO(`VO(n[O~OWtO~P`OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(S!dO(UTO(XUO(`VO(n[O~Oa!wOs!nO!S!oO!b!yO!c!vO!d!vO!|;wO#T!pO#U!pO#V!xO#W!pO#X!pO#[!zO#]!zO(T!lO(UTO(XUO(d!mO(n!sO~O'}!{O~OP]XR]X[]Xa]Xj]Xr]X!Q]X!S]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X'y]X(`]X(q]X(x]X(y]X~O!g%RX~P(qO_!}O(U#PO(V!}O(W#PO~O_#QO(W#PO(X#PO(Y#QO~Ox#SO!U#TO(a#TO(b#VO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(S;{O(UTO(XUO(`VO(n[O~O![#ZO!]#WO!Y(gP!Y(uP~P+}O!^#cO~P`OPYOQYOSfOd!jOe!iOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(UTO(XUO(`VO(n[O~Op#mO![#iO!|]O#i#lO#j#iO(S;|O!k(rP~P.iO!l#oO(S#nO~O!x#sO!|]O%h#tO~O#k#uO~O!g#vO#k#uO~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!]$_O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(`VO(q$YO(x#|O(y#}O~Oa(eX'y(eX'v(eX!k(eX!Y(eX!_(eX%i(eX!g(eX~P1qO#S$dO#`$eO$Q$eOP(fXR(fX[(fXj(fXr(fX!Q(fX!S(fX!](fX!l(fX!p(fX#R(fX#n(fX#o(fX#p(fX#q(fX#r(fX#s(fX#t(fX#u(fX#v(fX#x(fX#z(fX#{(fX(`(fX(q(fX(x(fX(y(fX!_(fX%i(fX~Oa(fX'y(fX'v(fX!Y(fX!k(fXv(fX!g(fX~P4UO#`$eO~O$]$hO$_$gO$f$mO~OSfO!_$nO$i$oO$k$qO~Oh%VOj%cOk%cOl%cOp%WOr%XOs$tOt$tOz%YO|%ZO!O%[O!S${O!_$|O!i%aO!l$xO#j%bO$W%_O$t%]O$v%^O$y%`O(S$sO(UTO(XUO(`$uO(x$}O(y%POg(]P~O!l%dO~O!S%gO!_%hO(S%fO~O!g%lO~Oa%mO'y%mO~O!Q%qO~P%[O(T!lO~P%[O%n%uO~P%[Oh%VO!l%dO(S%fO(T!lO~Oe%|O!l%dO(S%fO~Oj$RO~O!Q&RO!_&OO!l&QO%j&UO(S%fO(T!lO(UTO(XUO`)VP~O!x#sO~O%s&WO!S)RX!_)RX(S)RX~O(S&XO~Ol!PO!u&^O%j!QO%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO~Od&cOe&bO!x&`O%h&aO%{&_O~P<VOd&fOeyOl!PO!_&eO!u&^O!xxO!|]O%h}O%l!OO%m!OO%n!OO%q!RO%s!SO%v!TO%w!TO%y!UO~Ob&iO#`&lO%j&gO(T!lO~P=[O!l&mO!u&qO~O!l#oO~O!_XO~Oa%mO'w&yO'y%mO~Oa%mO'w&|O'y%mO~Oa%mO'w'OO'y%mO~O'v]X!Y]Xv]X!k]X&Z]X!_]X%i]X!g]X~P(qO!b']O!c'UO!d'UO(T!lO(UTO(XUO~Os'SO!S'RO!['VO(d'QO!^(hP!^(wP~P@cOn'`O!_'^O(S%fO~Oe'eO!l%dO(S%fO~O!Q&RO!l&QO~Os!nO!S!oO!|;wO#T!pO#U!pO#W!pO#X!pO(T!lO(UTO(XUO(d!mO(n!sO~O!b'kO!c'jO!d'jO#V!pO#['lO#]'lO~PA}Oa%mOh%VO!g#vO!l%dO'y%mO(q'nO~O!p'rO#`'pO~PC]Os!nO!S!oO(UTO(XUO(d!mO(n!sO~O!_XOs(lX!S(lX!b(lX!c(lX!d(lX!|(lX#T(lX#U(lX#V(lX#W(lX#X(lX#[(lX#](lX(T(lX(U(lX(X(lX(d(lX(n(lX~O!c'jO!d'jO(T!lO~PC{O(O'vO(P'vO(Q'xO~O_!}O(U'zO(V!}O(W'zO~O_#QO(W'zO(X'zO(Y#QO~Ov'|O~P%[Ox#SO!U#TO(a#TO(b(PO~O![(RO!Y'VX!Y']X!]'VX!]']X~P+}O!](TO!Y(gX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!](TO!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(`VO(q$YO(x#|O(y#}O~O!Y(gX~PGvO!Y(YO~O!Y(tX!](tX!g(tX!k(tX(q(tX~O#`(tX#k#dX!^(tX~PIyO#`(ZO!Y(vX!](vX~O!]([O!Y(uX~O!Y(_O~O#`$eO~PIyO!^(`O~P`OR#zO!Q#yO!S#{O!l#xO(`VOP!na[!naj!nar!na!]!na!p!na#R!na#n!na#o!na#p!na#q!na#r!na#s!na#t!na#u!na#v!na#x!na#z!na#{!na(q!na(x!na(y!na~Oa!na'y!na'v!na!Y!na!k!nav!na!_!na%i!na!g!na~PKaO!k(aO~O!g#vO#`(bO(q'nO!](sXa(sX'y(sX~O!k(sX~PM|O!S%gO!_%hO!|]O#i(gO#j(fO(S%fO~O!](hO!k(rX~O!k(jO~O!S%gO!_%hO#j(fO(S%fO~OP(fXR(fX[(fXj(fXr(fX!Q(fX!S(fX!](fX!l(fX!p(fX#R(fX#n(fX#o(fX#p(fX#q(fX#r(fX#s(fX#t(fX#u(fX#v(fX#x(fX#z(fX#{(fX(`(fX(q(fX(x(fX(y(fX~O!g#vO!k(fX~P! jOR(lO!Q(kO!l#xO#S$dO!|!{a!S!{a~O!x!{a%h!{a!_!{a#i!{a#j!{a(S!{a~P!#kO!x(pO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_XO!iuO!lZO!oYO!pYO!qYO!svO!u!gO!x!hO$W!kO$niO(S!dO(UTO(XUO(`VO(n[O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<eO!S${O!_$|O!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(S(tO(UTO(XUO(`$uO(x$}O(y%PO~O#k(vO~O![(xO!k(jP~P%[O(d(zO(n[O~O!S(|O!l#xO(d(zO(n[O~OP;vOQ;vOSfOd=rOe!iOpkOr;vOskOtkOzkO|;vO!O;vO!SWO!WkO!XkO!_!eO!i;yO!lZO!o;vO!p;vO!q;vO!s;zO!u;}O!x!hO$W!kO$n=pO(S)ZO(UTO(XUO(`VO(n[O~O!]$_Oa$qa'y$qa'v$qa!k$qa!Y$qa!_$qa%i$qa!g$qa~Ol)bO~P!&oOh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O%[O!S${O!_$|O!i%aO!l$xO#j%bO$W%_O$t%]O$v%^O$y%`O(S(tO(UTO(XUO(`$uO(x$}O(y%PO~Og(oP~P!+xO!Q)gO!g)fO!_$^X$Z$^X$]$^X$_$^X$f$^X~O!g)fO!_(zX$Z(zX$](zX$_(zX$f(zX~O!Q)gO~P!.RO!Q)gO!_(zX$Z(zX$](zX$_(zX$f(zX~O!_)iO$Z)mO$])hO$_)hO$f)nO~O![)qO~P!)PO$]$hO$_$gO$f)uO~On$zX!Q$zX#S$zX'x$zX(x$zX(y$zX~OgmXg$zXnmX!]mX#`mX~P!/wOx)wO(a)xO(b)zO~On*TO!Q)|O'x)}O(x$}O(y%PO~Og){O~P!0{Og*UO~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<eO!S*WO!_*XO!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(UTO(XUO(`$uO(x$}O(y%PO~O![*[O(S*VO!k(}P~P!1jO#k*^O~O!l*_O~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<eO!S${O!_$|O!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(S*aO(UTO(XUO(`$uO(x$}O(y%PO~O![*dO!Y)OP~P!3iOr*pOs!nO!S*fO!b*nO!c*hO!d*hO!l*_O#[*oO%`*jO(T!lO(UTO(XUO(d!mO~O!^*mO~P!5^O#S$dOn(_X!Q(_X'x(_X(x(_X(y(_X!](_X#`(_X~Og(_X$O(_X~P!6`On*uO#`*tOg(^X!](^X~O!]*vOg(]X~Oj%cOk%cOl%cO(S&XOg(]P~Os*yO~O!l+OO~O(S(tO~Op+TO!S%gO![#iO!_%hO!|]O#i#lO#j#iO(S%fO!k(rP~O!g#vO#k+UO~O!S%gO![+WO!]([O!_%hO(S%fO!Y(uP~Os'YO!S+YO![+XO(UTO(XUO(d(zO~O!^(wP~P!9iO!]+ZOa)SX'y)SX~OP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO#z$WO#{$XO(`VO(q$YO(x#|O(y#}O~Oa!ja!]!ja'y!ja'v!ja!Y!ja!k!jav!ja!_!ja%i!ja!g!ja~P!:aOR#zO!Q#yO!S#{O!l#xO(`VOP!ra[!raj!rar!ra!]!ra!p!ra#R!ra#n!ra#o!ra#p!ra#q!ra#r!ra#s!ra#t!ra#u!ra#v!ra#x!ra#z!ra#{!ra(q!ra(x!ra(y!ra~Oa!ra'y!ra'v!ra!Y!ra!k!rav!ra!_!ra%i!ra!g!ra~P!<wOR#zO!Q#yO!S#{O!l#xO(`VOP!ta[!taj!tar!ta!]!ta!p!ta#R!ta#n!ta#o!ta#p!ta#q!ta#r!ta#s!ta#t!ta#u!ta#v!ta#x!ta#z!ta#{!ta(q!ta(x!ta(y!ta~Oa!ta'y!ta'v!ta!Y!ta!k!tav!ta!_!ta%i!ta!g!ta~P!?_Oh%VOn+dO!_'^O%i+cO~O!g+fOa([X!_([X'y([X!]([X~Oa%mO!_XO'y%mO~Oh%VO!l%dO~Oh%VO!l%dO(S%fO~O!g#vO#k(vO~Ob+qO%j+rO(S+nO(UTO(XUO!^)WP~O!]+sO`)VX~O[+wO~O`+xO~O!_&OO(S%fO(T!lO`)VP~Oh%VO#`+}O~Oh%VOn,QO!_$|O~O!_,SO~O!Q,UO!_XO~O%n%uO~O!x,ZO~Oe,`O~Ob,aO(S#nO(UTO(XUO!^)UP~Oe%|O~O%j!QO(S&XO~P=[O[,fO`,eO~OPYOQYOSfOdzOeyOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!iuO!lZO!oYO!pYO!qYO!svO!xxO!|]O$niO%h}O(UTO(XUO(`VO(n[O~O!_!eO!u!gO$W!kO(S!dO~P!F_O`,eOa%mO'y%mO~OPYOQYOSfOd!jOe!iOpkOrYOskOtkOzkO|YO!OYO!SWO!WkO!XkO!_!eO!iuO!lZO!oYO!pYO!qYO!svO!x!hO$W!kO$niO(S!dO(UTO(XUO(`VO(n[O~Oa,kOl!OO!uwO%l!OO%m!OO%n!OO~P!HwO!l&mO~O&],qO~O!_,sO~O&n,uO&p,vOP&kaQ&kaS&kaY&kaa&kad&kae&kal&kap&kar&kas&kat&kaz&ka|&ka!O&ka!S&ka!W&ka!X&ka!_&ka!i&ka!l&ka!o&ka!p&ka!q&ka!s&ka!u&ka!x&ka!|&ka$W&ka$n&ka%h&ka%j&ka%l&ka%m&ka%n&ka%q&ka%s&ka%v&ka%w&ka%y&ka&V&ka&]&ka&_&ka&a&ka&c&ka&f&ka&l&ka&r&ka&t&ka&v&ka&x&ka&z&ka'v&ka(S&ka(U&ka(X&ka(`&ka(n&ka!^&ka&d&kab&ka&i&ka~O(S,{O~Oh!eX!]!RX!^!RX!g!RX!g!eX!l!eX#`!RX~O!]!eX!^!eX~P# }O!g-QO#`-POh(iX!]#hX!^#hX!g(iX!l(iX~O!](iX!^(iX~P#!pOh%VO!g-SO!l%dO!]!aX!^!aX~Os!nO!S!oO(UTO(XUO(d!mO~OP;vOQ;vOSfOd=rOe!iOpkOr;vOskOtkOzkO|;vO!O;vO!SWO!WkO!XkO!_!eO!i;yO!lZO!o;vO!p;vO!q;vO!s;zO!u;}O!x!hO$W!kO$n=pO(UTO(XUO(`VO(n[O~O(S<rO~P#$VO!]-WO!^(hX~O!^-YO~O!g-QO#`-PO!]#hX!^#hX~O!]-ZO!^(wX~O!^-]O~O!c-^O!d-^O(T!lO~P##tO!^-aO~P'_On-dO!_'^O~O!Y-iO~Os!{a!b!{a!c!{a!d!{a#T!{a#U!{a#V!{a#W!{a#X!{a#[!{a#]!{a(T!{a(U!{a(X!{a(d!{a(n!{a~P!#kO!p-nO#`-lO~PC]O!c-pO!d-pO(T!lO~PC{Oa%mO#`-lO'y%mO~Oa%mO!g#vO#`-lO'y%mO~Oa%mO!g#vO!p-nO#`-lO'y%mO(q'nO~O(O'vO(P'vO(Q-uO~Ov-vO~O!Y'Va!]'Va~P!:aO![-zO!Y'VX!]'VX~P%[O!](TO!Y(ga~O!Y(ga~PGvO!]([O!Y(ua~O!S%gO![.OO!_%hO(S%fO!Y']X!]']X~O#`.QO!](sa!k(saa(sa'y(sa~O!g#vO~P#,]O!](hO!k(ra~O!S%gO!_%hO#j.UO(S%fO~Op.ZO!S%gO![.WO!_%hO!|]O#i.YO#j.WO(S%fO!]'`X!k'`X~OR._O!l#xO~Oh%VOn.bO!_'^O%i.aO~Oa#ci!]#ci'y#ci'v#ci!Y#ci!k#civ#ci!_#ci%i#ci!g#ci~P!:aOn=|O!Q)|O'x)}O(x$}O(y%PO~O#k#_aa#_a#`#_a'y#_a!]#_a!k#_a!_#_a!Y#_a~P#/XO#k(_XP(_XR(_X[(_Xa(_Xj(_Xr(_X!S(_X!l(_X!p(_X#R(_X#n(_X#o(_X#p(_X#q(_X#r(_X#s(_X#t(_X#u(_X#v(_X#x(_X#z(_X#{(_X'y(_X(`(_X(q(_X!k(_X!Y(_X'v(_Xv(_X!_(_X%i(_X!g(_X~P!6`O!].oO!k(jX~P!:aO!k.rO~O!Y.tO~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(`VO[#mia#mij#mir#mi!]#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'y#mi(q#mi(x#mi(y#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#n#mi~P#2wO#n$OO~P#2wOP$[OR#zOr$aO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(`VO[#mia#mij#mi!]#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'y#mi(q#mi(x#mi(y#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#r#mi~P#5fO#r$QO~P#5fOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO(`VOa#mi!]#mi#x#mi#z#mi#{#mi'y#mi(q#mi(x#mi(y#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#v#mi~P#8TOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO(`VO(y#}Oa#mi!]#mi#z#mi#{#mi'y#mi(q#mi(x#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#x$UO~P#:kO#x#mi~P#:kO#v$SO~P#8TOP$[OR#zO[$cOj$ROr$aO!Q#yO!S#{O!l#xO!p$[O#R$RO#n$OO#o$PO#p$PO#q$PO#r$QO#s$RO#t$RO#u$bO#v$SO#x$UO(`VO(x#|O(y#}Oa#mi!]#mi#{#mi'y#mi(q#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~O#z#mi~P#=aO#z$WO~P#=aOP]XR]X[]Xj]Xr]X!Q]X!S]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(`]X(q]X(x]X(y]X!]]X!^]X~O$O]X~P#@OOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O#v<TO#x<VO#z<XO#{<YO(`VO(q$YO(x#|O(y#}O~O$O.vO~P#B]O#S$dO#`<`O$Q<`O$O(fX!^(fX~P! jOa'ca!]'ca'y'ca'v'ca!k'ca!Y'cav'ca!_'ca%i'ca!g'ca~P!:aO[#mia#mij#mir#mi!]#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi'y#mi(q#mi'v#mi!Y#mi!k#miv#mi!_#mi%i#mi!g#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n$OO#o$PO#p$PO#q$PO(`VO(x#mi(y#mi~P#E_On=|O!Q)|O'x)}O(x$}O(y%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(`#mi~P#E_O!].zOg(oX~P!0{Og.|O~Oa$Pi!]$Pi'y$Pi'v$Pi!Y$Pi!k$Piv$Pi!_$Pi%i$Pi!g$Pi~P!:aO$].}O$_.}O~O$]/OO$_/OO~O!g)fO#`/PO!_$cX$Z$cX$]$cX$_$cX$f$cX~O![/QO~O!_)iO$Z/SO$])hO$_)hO$f/TO~O!]<ZO!^(eX~P#B]O!^/UO~O!g)fO$f(zX~O$f/WO~Ov/XO~P!&oOx)wO(a)xO(b/[O~O!S/_O~O(x$}On%aa!Q%aa'x%aa(y%aa!]%aa#`%aa~Og%aa$O%aa~P#LaO(y%POn%ca!Q%ca'x%ca(x%ca!]%ca#`%ca~Og%ca$O%ca~P#MSO!]fX!gfX!kfX!k$zX(qfX~P!/wO![/hO!]([O(S/gO!Y(uP!Y)OP~P!1jOr*pO!b*nO!c*hO!d*hO!l*_O#[*oO%`*jO(T!lO(UTO(XUO~Os<oO!S/iO![+XO!^*mO(d<nO!^(wP~P#NmO!k/jO~P#/XO!]/kO!g#vO(q'nO!k(}X~O!k/pO~O!S%gO![*[O!_%hO(S%fO!k(}P~O#k/rO~O!Y$zX!]$zX!g%RX~P!/wO!]/sO!Y)OX~P#/XO!g/uO~O!Y/wO~OpkO(S/xO~P.iOh%VOr/}O!g#vO!l%dO(q'nO~O!g+fO~Oa%mO!]0RO'y%mO~O!^0TO~P!5^O!c0UO!d0UO(T!lO~P##tOs!nO!S0VO(UTO(XUO(d!mO~O#[0XO~Og%aa!]%aa#`%aa$O%aa~P!0{Og%ca!]%ca#`%ca$O%ca~P!0{Oj%cOk%cOl%cO(S&XOg'lX!]'lX~O!]*vOg(]a~Og0bO~OR0cO!Q0cO!S0dO#S$dOn}a'x}a(x}a(y}a!]}a#`}a~Og}a$O}a~P$&vO!Q)|O'x)}On$sa(x$sa(y$sa!]$sa#`$sa~Og$sa$O$sa~P$'rO!Q)|O'x)}On$ua(x$ua(y$ua!]$ua#`$ua~Og$ua$O$ua~P$(eO#k0gO~Og%Ta!]%Ta#`%Ta$O%Ta~P!0{On0iO#`0hOg(^a!](^a~O!g#vO~O#k0lO~O!]+ZOa)Sa'y)Sa~OR#zO!Q#yO!S#{O!l#xO(`VOP!ri[!rij!rir!ri!]!ri!p!ri#R!ri#n!ri#o!ri#p!ri#q!ri#r!ri#s!ri#t!ri#u!ri#v!ri#x!ri#z!ri#{!ri(q!ri(x!ri(y!ri~Oa!ri'y!ri'v!ri!Y!ri!k!riv!ri!_!ri%i!ri!g!ri~P$*bOh%VOr%XOs$tOt$tOz%YO|%ZO!O<eO!S${O!_$|O!i=vO!l$xO#j<kO$W%_O$t<gO$v<iO$y%`O(UTO(XUO(`$uO(x$}O(y%PO~Op0uO%]0vO(S0tO~P$,xO!g+fOa([a!_([a'y([a!]([a~O#k0|O~O[]X!]fX!^fX~O!]0}O!^)WX~O!^1PO~O[1QO~Ob1SO(S+nO(UTO(XUO~O!_&OO(S%fO`'tX!]'tX~O!]+sO`)Va~O!k1VO~P!:aO[1YO~O`1ZO~O#`1^O~On1aO!_$|O~O(d(zO!^)TP~Oh%VOn1jO!_1gO%i1iO~O[1tO!]1rO!^)UX~O!^1uO~O`1wOa%mO'y%mO~O(S#nO(UTO(XUO~O#S$dO#`$eO$Q$eOP(fXR(fX[(fXr(fX!Q(fX!S(fX!](fX!l(fX!p(fX#R(fX#n(fX#o(fX#p(fX#q(fX#r(fX#s(fX#t(fX#u(fX#v(fX#x(fX#z(fX#{(fX(`(fX(q(fX(x(fX(y(fX~Oj1zO&Z1{Oa(fX~P$2cOj1zO#`$eO&Z1{O~Oa1}O~P%[Oa2PO~O&d2SOP&biQ&biS&biY&bia&bid&bie&bil&bip&bir&bis&bit&biz&bi|&bi!O&bi!S&bi!W&bi!X&bi!_&bi!i&bi!l&bi!o&bi!p&bi!q&bi!s&bi!u&bi!x&bi!|&bi$W&bi$n&bi%h&bi%j&bi%l&bi%m&bi%n&bi%q&bi%s&bi%v&bi%w&bi%y&bi&V&bi&]&bi&_&bi&a&bi&c&bi&f&bi&l&bi&r&bi&t&bi&v&bi&x&bi&z&bi'v&bi(S&bi(U&bi(X&bi(`&bi(n&bi!^&bib&bi&i&bi~Ob2YO!^2WO&i2XO~P`O!_XO!l2[O~O&p,vOP&kiQ&kiS&kiY&kia&kid&kie&kil&kip&kir&kis&kit&kiz&ki|&ki!O&ki!S&ki!W&ki!X&ki!_&ki!i&ki!l&ki!o&ki!p&ki!q&ki!s&ki!u&ki!x&ki!|&ki$W&ki$n&ki%h&ki%j&ki%l&ki%m&ki%n&ki%q&ki%s&ki%v&ki%w&ki%y&ki&V&ki&]&ki&_&ki&a&ki&c&ki&f&ki&l&ki&r&ki&t&ki&v&ki&x&ki&z&ki'v&ki(S&ki(U&ki(X&ki(`&ki(n&ki!^&ki&d&kib&ki&i&ki~O!Y2bO~O!]!aa!^!aa~P#B]Os!nO!S!oO![2hO(d!mO!]'WX!^'WX~P@cO!]-WO!^(ha~O!]'^X!^'^X~P!9iO!]-ZO!^(wa~O!^2oO~P'_Oa%mO#`2xO'y%mO~Oa%mO!g#vO#`2xO'y%mO~Oa%mO!g#vO!p2|O#`2xO'y%mO(q'nO~Oa%mO'y%mO~P!:aO!]$_Ov$qa~O!Y'Vi!]'Vi~P!:aO!](TO!Y(gi~O!]([O!Y(ui~O!Y(vi!](vi~P!:aO!](si!k(sia(si'y(si~P!:aO#`3OO!](si!k(sia(si'y(si~O!](hO!k(ri~O!S%gO!_%hO!|]O#i3TO#j3SO(S%fO~O!S%gO!_%hO#j3SO(S%fO~On3[O!_'^O%i3ZO~Oh%VOn3[O!_'^O%i3ZO~O#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'y%aa(`%aa(q%aa!k%aa!Y%aa'v%aav%aa!_%aa%i%aa!g%aa~P#LaO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'y%ca(`%ca(q%ca!k%ca!Y%ca'v%cav%ca!_%ca%i%ca!g%ca~P#MSO#k%aaP%aaR%aa[%aaa%aaj%aar%aa!S%aa!]%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa'y%aa(`%aa(q%aa!k%aa!Y%aa'v%aa#`%aav%aa!_%aa%i%aa!g%aa~P#/XO#k%caP%caR%ca[%caa%caj%car%ca!S%ca!]%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca'y%ca(`%ca(q%ca!k%ca!Y%ca'v%ca#`%cav%ca!_%ca%i%ca!g%ca~P#/XO#k}aP}a[}aa}aj}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a'y}a(`}a(q}a!k}a!Y}a'v}av}a!_}a%i}a!g}a~P$&vO#k$saP$saR$sa[$saa$saj$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa'y$sa(`$sa(q$sa!k$sa!Y$sa'v$sav$sa!_$sa%i$sa!g$sa~P$'rO#k$uaP$uaR$ua[$uaa$uaj$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua'y$ua(`$ua(q$ua!k$ua!Y$ua'v$uav$ua!_$ua%i$ua!g$ua~P$(eO#k%TaP%TaR%Ta[%Taa%Taj%Tar%Ta!S%Ta!]%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta'y%Ta(`%Ta(q%Ta!k%Ta!Y%Ta'v%Ta#`%Tav%Ta!_%Ta%i%Ta!g%Ta~P#/XOa#cq!]#cq'y#cq'v#cq!Y#cq!k#cqv#cq!_#cq%i#cq!g#cq~P!:aO![3dO!]'XX!k'XX~P%[O!].oO!k(ja~O!].oO!k(ja~P!:aO!Y3gO~O$O!na!^!na~PKaO$O!ja!]!ja!^!ja~P#B]O$O!ra!^!ra~P!<wO$O!ta!^!ta~P!?_Og'[X!]'[X~P!+xO!].zOg(oa~OSfO!_3{O$d3|O~O!^4QO~Ov4RO~P#/XOa$mq!]$mq'y$mq'v$mq!Y$mq!k$mqv$mq!_$mq%i$mq!g$mq~P!:aO!Y4TO~P!&oO!S4UO~O!Q)|O'x)}O(y%POn'ha(x'ha!]'ha#`'ha~Og'ha$O'ha~P%,XO!Q)|O'x)}On'ja(x'ja(y'ja!]'ja#`'ja~Og'ja$O'ja~P%,zO(q$YO~P#/XO!YfX!Y$zX!]fX!]$zX!g%RX#`fX~P!/wO(S<xO~P!1jO!S%gO![4XO!_%hO(S%fO!]'dX!k'dX~O!]/kO!k(}a~O!]/kO!g#vO!k(}a~O!]/kO!g#vO(q'nO!k(}a~Og$|i!]$|i#`$|i$O$|i~P!0{O![4aO!Y'fX!]'fX~P!3iO!]/sO!Y)Oa~O!]/sO!Y)Oa~P#/XOP]XR]X[]Xj]Xr]X!Q]X!S]X!Y]X!]]X!l]X!p]X#R]X#S]X#`]X#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(`]X(q]X(x]X(y]X~Oj%YX!g%YX~P%0kOj4fO!g#vO~Oh%VO!g#vO!l%dO~Oh%VOr4kO!l%dO(q'nO~Or4pO!g#vO(q'nO~Os!nO!S4qO(UTO(XUO(d!mO~O(x$}On%ai!Q%ai'x%ai(y%ai!]%ai#`%ai~Og%ai$O%ai~P%4[O(y%POn%ci!Q%ci'x%ci(x%ci!]%ci#`%ci~Og%ci$O%ci~P%4}Og(^i!](^i~P!0{O#`4wOg(^i!](^i~P!0{O!k4zO~Oa$oq!]$oq'y$oq'v$oq!Y$oq!k$oqv$oq!_$oq%i$oq!g$oq~P!:aO!Y5QO~O!]5RO!_)PX~P#/XOa$zX!_$zX%^]X'y$zX!]$zX~P!/wO%^5UOaoXnoX!QoX!_oX'xoX'yoX(xoX(yoX!]oX~Op5VO(S#nO~O%^5UO~Ob5]O%j5^O(S+nO(UTO(XUO!]'sX!^'sX~O!]0}O!^)Wa~O[5bO~O`5cO~Oa%mO'y%mO~P#/XO!]5kO#`5mO!^)TX~O!^5nO~Or5tOs!nO!S*fO!b!yO!c!vO!d!vO!|;wO#T!pO#U!pO#V!pO#W!pO#X!pO#[5sO#]!zO(T!lO(UTO(XUO(d!mO(n!sO~O!^5rO~P%:YOn5yO!_1gO%i5xO~Oh%VOn5yO!_1gO%i5xO~Ob6QO(S#nO(UTO(XUO!]'rX!^'rX~O!]1rO!^)Ua~O(UTO(XUO(d6SO~O`6WO~Oj6ZO&Z6[O~PM|O!k6]O~P%[Oa6_O~Oa6_O~P%[Ob2YO!^6dO&i2XO~P`O!g6fO~O!g6hOh(ii!](ii!^(ii!g(ii!l(iir(ii(q(ii~O!]#hi!^#hi~P#B]O#`6iO!]#hi!^#hi~O!]!ai!^!ai~P#B]Oa%mO#`6rO'y%mO~Oa%mO!g#vO#`6rO'y%mO~O!](sq!k(sqa(sq'y(sq~P!:aO!](hO!k(rq~O!S%gO!_%hO#j6yO(S%fO~O!_'^O%i6|O~On7QO!_'^O%i6|O~O#k'haP'haR'ha['haa'haj'har'ha!S'ha!l'ha!p'ha#R'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#v'ha#x'ha#z'ha#{'ha'y'ha(`'ha(q'ha!k'ha!Y'ha'v'hav'ha!_'ha%i'ha!g'ha~P%,XO#k'jaP'jaR'ja['jaa'jaj'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja'y'ja(`'ja(q'ja!k'ja!Y'ja'v'jav'ja!_'ja%i'ja!g'ja~P%,zO#k$|iP$|iR$|i[$|ia$|ij$|ir$|i!S$|i!]$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i'y$|i(`$|i(q$|i!k$|i!Y$|i'v$|i#`$|iv$|i!_$|i%i$|i!g$|i~P#/XO#k%aiP%aiR%ai[%aia%aij%air%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai'y%ai(`%ai(q%ai!k%ai!Y%ai'v%aiv%ai!_%ai%i%ai!g%ai~P%4[O#k%ciP%ciR%ci[%cia%cij%cir%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci'y%ci(`%ci(q%ci!k%ci!Y%ci'v%civ%ci!_%ci%i%ci!g%ci~P%4}O!]'Xa!k'Xa~P!:aO!].oO!k(ji~O$O#ci!]#ci!^#ci~P#B]OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O(`VO[#mij#mir#mi#R#mi#o#mi#p#mi#q#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(q#mi(x#mi(y#mi!]#mi!^#mi~O#n#mi~P%MXO#n<PO~P%MXOP$[OR#zOr<]O!Q#yO!S#{O!l#xO!p$[O#n<PO#o<QO#p<QO#q<QO(`VO[#mij#mi#R#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(q#mi(x#mi(y#mi!]#mi!^#mi~O#r#mi~P& aO#r<RO~P& aOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O(`VO#x#mi#z#mi#{#mi$O#mi(q#mi(x#mi(y#mi!]#mi!^#mi~O#v#mi~P&#iOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O#v<TO(`VO(y#}O#z#mi#{#mi$O#mi(q#mi(x#mi!]#mi!^#mi~O#x<VO~P&%jO#x#mi~P&%jO#v<TO~P&#iOP$[OR#zO[<_Oj<SOr<]O!Q#yO!S#{O!l#xO!p$[O#R<SO#n<PO#o<QO#p<QO#q<QO#r<RO#s<SO#t<SO#u<^O#v<TO#x<VO(`VO(x#|O(y#}O#{#mi$O#mi(q#mi!]#mi!^#mi~O#z#mi~P&'yO#z<XO~P&'yOa#|y!]#|y'y#|y'v#|y!Y#|y!k#|yv#|y!_#|y%i#|y!g#|y~P!:aO[#mij#mir#mi#R#mi#r#mi#s#mi#t#mi#u#mi#v#mi#x#mi#z#mi#{#mi$O#mi(q#mi!]#mi!^#mi~OP$[OR#zO!Q#yO!S#{O!l#xO!p$[O#n<PO#o<QO#p<QO#q<QO(`VO(x#mi(y#mi~P&*uOn=}O!Q)|O'x)}O(x$}O(y%POP#miR#mi!S#mi!l#mi!p#mi#n#mi#o#mi#p#mi#q#mi(`#mi~P&*uO#S$dOP(_XR(_X[(_Xj(_Xn(_Xr(_X!Q(_X!S(_X!l(_X!p(_X#R(_X#n(_X#o(_X#p(_X#q(_X#r(_X#s(_X#t(_X#u(_X#v(_X#x(_X#z(_X#{(_X$O(_X'x(_X(`(_X(q(_X(x(_X(y(_X!](_X!^(_X~O$O$Pi!]$Pi!^$Pi~P#B]O$O!ri!^!ri~P$*bOg'[a!]'[a~P!0{O!^7dO~O!]'ca!^'ca~P#B]O!Y7eO~P#/XO!g#vO(q'nO!]'da!k'da~O!]/kO!k(}i~O!]/kO!g#vO!k(}i~Og$|q!]$|q#`$|q$O$|q~P!0{O!Y'fa!]'fa~P#/XO!g7lO~O!]/sO!Y)Oi~P#/XO!]/sO!Y)Oi~O!Y7oO~Oh%VOr7tO!l%dO(q'nO~Oj7vO!g#vO~Or7yO!g#vO(q'nO~O!Q)|O'x)}O(y%POn'ia(x'ia!]'ia#`'ia~Og'ia$O'ia~P&3vO!Q)|O'x)}On'ka(x'ka(y'ka!]'ka#`'ka~Og'ka$O'ka~P&4iO!Y7{O~Og%Oq!]%Oq#`%Oq$O%Oq~P!0{Og(^q!](^q~P!0{O#`7|Og(^q!](^q~P!0{Oa$oy!]$oy'y$oy'v$oy!Y$oy!k$oyv$oy!_$oy%i$oy!g$oy~P!:aO!g6hO~O!]5RO!_)Pa~O!_'^OP$TaR$Ta[$Taj$Tar$Ta!Q$Ta!S$Ta!]$Ta!l$Ta!p$Ta#R$Ta#n$Ta#o$Ta#p$Ta#q$Ta#r$Ta#s$Ta#t$Ta#u$Ta#v$Ta#x$Ta#z$Ta#{$Ta(`$Ta(q$Ta(x$Ta(y$Ta~O%i6|O~P&7ZO%^8QOa%[i!_%[i'y%[i!]%[i~Oa#cy!]#cy'y#cy'v#cy!Y#cy!k#cyv#cy!_#cy%i#cy!g#cy~P!:aO[8SO~Ob8UO(S+nO(UTO(XUO~O!]0}O!^)Wi~O`8YO~O(d(zO!]'oX!^'oX~O!]5kO!^)Ta~O!^8cO~P%:YO(n!sO~P$${O#[8dO~O!_1gO~O!_1gO%i8fO~On8iO!_1gO%i8fO~O[8nO!]'ra!^'ra~O!]1rO!^)Ui~O!k8rO~O!k8sO~O!k8vO~O!k8vO~P%[Oa8xO~O!g8yO~O!k8zO~O!](vi!^(vi~P#B]Oa%mO#`9SO'y%mO~O!](sy!k(sya(sy'y(sy~P!:aO!](hO!k(ry~O%i9VO~P&7ZO!_'^O%i9VO~O#k$|qP$|qR$|q[$|qa$|qj$|qr$|q!S$|q!]$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q'y$|q(`$|q(q$|q!k$|q!Y$|q'v$|q#`$|qv$|q!_$|q%i$|q!g$|q~P#/XO#k'iaP'iaR'ia['iaa'iaj'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia'y'ia(`'ia(q'ia!k'ia!Y'ia'v'iav'ia!_'ia%i'ia!g'ia~P&3vO#k'kaP'kaR'ka['kaa'kaj'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka'y'ka(`'ka(q'ka!k'ka!Y'ka'v'kav'ka!_'ka%i'ka!g'ka~P&4iO#k%OqP%OqR%Oq[%Oqa%Oqj%Oqr%Oq!S%Oq!]%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq'y%Oq(`%Oq(q%Oq!k%Oq!Y%Oq'v%Oq#`%Oqv%Oq!_%Oq%i%Oq!g%Oq~P#/XO!]'Xi!k'Xi~P!:aO$O#cq!]#cq!^#cq~P#B]O(x$}OP%aaR%aa[%aaj%aar%aa!S%aa!l%aa!p%aa#R%aa#n%aa#o%aa#p%aa#q%aa#r%aa#s%aa#t%aa#u%aa#v%aa#x%aa#z%aa#{%aa$O%aa(`%aa(q%aa!]%aa!^%aa~On%aa!Q%aa'x%aa(y%aa~P&HnO(y%POP%caR%ca[%caj%car%ca!S%ca!l%ca!p%ca#R%ca#n%ca#o%ca#p%ca#q%ca#r%ca#s%ca#t%ca#u%ca#v%ca#x%ca#z%ca#{%ca$O%ca(`%ca(q%ca!]%ca!^%ca~On%ca!Q%ca'x%ca(x%ca~P&JuOn=}O!Q)|O'x)}O(y%PO~P&HnOn=}O!Q)|O'x)}O(x$}O~P&JuOR0cO!Q0cO!S0dO#S$dOP}a[}aj}an}ar}a!l}a!p}a#R}a#n}a#o}a#p}a#q}a#r}a#s}a#t}a#u}a#v}a#x}a#z}a#{}a$O}a'x}a(`}a(q}a(x}a(y}a!]}a!^}a~O!Q)|O'x)}OP$saR$sa[$saj$san$sar$sa!S$sa!l$sa!p$sa#R$sa#n$sa#o$sa#p$sa#q$sa#r$sa#s$sa#t$sa#u$sa#v$sa#x$sa#z$sa#{$sa$O$sa(`$sa(q$sa(x$sa(y$sa!]$sa!^$sa~O!Q)|O'x)}OP$uaR$ua[$uaj$uan$uar$ua!S$ua!l$ua!p$ua#R$ua#n$ua#o$ua#p$ua#q$ua#r$ua#s$ua#t$ua#u$ua#v$ua#x$ua#z$ua#{$ua$O$ua(`$ua(q$ua(x$ua(y$ua!]$ua!^$ua~On=}O!Q)|O'x)}O(x$}O(y%PO~OP%TaR%Ta[%Taj%Tar%Ta!S%Ta!l%Ta!p%Ta#R%Ta#n%Ta#o%Ta#p%Ta#q%Ta#r%Ta#s%Ta#t%Ta#u%Ta#v%Ta#x%Ta#z%Ta#{%Ta$O%Ta(`%Ta(q%Ta!]%Ta!^%Ta~P'%zO$O$mq!]$mq!^$mq~P#B]O$O$oq!]$oq!^$oq~P#B]O!^9dO~O$O9eO~P!0{O!g#vO!]'di!k'di~O!g#vO(q'nO!]'di!k'di~O!]/kO!k(}q~O!Y'fi!]'fi~P#/XO!]/sO!Y)Oq~Or9lO!g#vO(q'nO~O[9nO!Y9mO~P#/XO!Y9mO~Oj9tO!g#vO~Og(^y!](^y~P!0{O!]'ma!_'ma~P#/XOa%[q!_%[q'y%[q!]%[q~P#/XO[9yO~O!]0}O!^)Wq~O#`9}O!]'oa!^'oa~O!]5kO!^)Ti~P#B]O!S:PO~O!_1gO%i:SO~O(UTO(XUO(d:XO~O!]1rO!^)Uq~O!k:[O~O!k:]O~O!k:^O~O!k:^O~P%[O#`:aO!]#hy!^#hy~O!]#hy!^#hy~P#B]O%i:fO~P&7ZO!_'^O%i:fO~O$O#|y!]#|y!^#|y~P#B]OP$|iR$|i[$|ij$|ir$|i!S$|i!l$|i!p$|i#R$|i#n$|i#o$|i#p$|i#q$|i#r$|i#s$|i#t$|i#u$|i#v$|i#x$|i#z$|i#{$|i$O$|i(`$|i(q$|i!]$|i!^$|i~P'%zO!Q)|O'x)}O(y%POP'haR'ha['haj'han'har'ha!S'ha!l'ha!p'ha#R'ha#n'ha#o'ha#p'ha#q'ha#r'ha#s'ha#t'ha#u'ha#v'ha#x'ha#z'ha#{'ha$O'ha(`'ha(q'ha(x'ha!]'ha!^'ha~O!Q)|O'x)}OP'jaR'ja['jaj'jan'jar'ja!S'ja!l'ja!p'ja#R'ja#n'ja#o'ja#p'ja#q'ja#r'ja#s'ja#t'ja#u'ja#v'ja#x'ja#z'ja#{'ja$O'ja(`'ja(q'ja(x'ja(y'ja!]'ja!^'ja~O(x$}OP%aiR%ai[%aij%ain%air%ai!Q%ai!S%ai!l%ai!p%ai#R%ai#n%ai#o%ai#p%ai#q%ai#r%ai#s%ai#t%ai#u%ai#v%ai#x%ai#z%ai#{%ai$O%ai'x%ai(`%ai(q%ai(y%ai!]%ai!^%ai~O(y%POP%ciR%ci[%cij%cin%cir%ci!Q%ci!S%ci!l%ci!p%ci#R%ci#n%ci#o%ci#p%ci#q%ci#r%ci#s%ci#t%ci#u%ci#v%ci#x%ci#z%ci#{%ci$O%ci'x%ci(`%ci(q%ci(x%ci!]%ci!^%ci~O$O$oy!]$oy!^$oy~P#B]O$O#cy!]#cy!^#cy~P#B]O!g#vO!]'dq!k'dq~O!]/kO!k(}y~O!Y'fq!]'fq~P#/XOr:pO!g#vO(q'nO~O[:tO!Y:sO~P#/XO!Y:sO~Og(^!R!](^!R~P!0{Oa%[y!_%[y'y%[y!]%[y~P#/XO!]0}O!^)Wy~O!]5kO!^)Tq~O(S:zO~O!_1gO%i:}O~O!k;QO~O%i;VO~P&7ZOP$|qR$|q[$|qj$|qr$|q!S$|q!l$|q!p$|q#R$|q#n$|q#o$|q#p$|q#q$|q#r$|q#s$|q#t$|q#u$|q#v$|q#x$|q#z$|q#{$|q$O$|q(`$|q(q$|q!]$|q!^$|q~P'%zO!Q)|O'x)}O(y%POP'iaR'ia['iaj'ian'iar'ia!S'ia!l'ia!p'ia#R'ia#n'ia#o'ia#p'ia#q'ia#r'ia#s'ia#t'ia#u'ia#v'ia#x'ia#z'ia#{'ia$O'ia(`'ia(q'ia(x'ia!]'ia!^'ia~O!Q)|O'x)}OP'kaR'ka['kaj'kan'kar'ka!S'ka!l'ka!p'ka#R'ka#n'ka#o'ka#p'ka#q'ka#r'ka#s'ka#t'ka#u'ka#v'ka#x'ka#z'ka#{'ka$O'ka(`'ka(q'ka(x'ka(y'ka!]'ka!^'ka~OP%OqR%Oq[%Oqj%Oqr%Oq!S%Oq!l%Oq!p%Oq#R%Oq#n%Oq#o%Oq#p%Oq#q%Oq#r%Oq#s%Oq#t%Oq#u%Oq#v%Oq#x%Oq#z%Oq#{%Oq$O%Oq(`%Oq(q%Oq!]%Oq!^%Oq~P'%zOg%e!Z!]%e!Z#`%e!Z$O%e!Z~P!0{O!Y;ZO~P#/XOr;[O!g#vO(q'nO~O[;^O!Y;ZO~P#/XO!]'oq!^'oq~P#B]O!]#h!Z!^#h!Z~P#B]O#k%e!ZP%e!ZR%e!Z[%e!Za%e!Zj%e!Zr%e!Z!S%e!Z!]%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z'y%e!Z(`%e!Z(q%e!Z!k%e!Z!Y%e!Z'v%e!Z#`%e!Zv%e!Z!_%e!Z%i%e!Z!g%e!Z~P#/XOr;fO!g#vO(q'nO~O!Y;gO~P#/XOr;nO!g#vO(q'nO~O!Y;oO~P#/XOP%e!ZR%e!Z[%e!Zj%e!Zr%e!Z!S%e!Z!l%e!Z!p%e!Z#R%e!Z#n%e!Z#o%e!Z#p%e!Z#q%e!Z#r%e!Z#s%e!Z#t%e!Z#u%e!Z#v%e!Z#x%e!Z#z%e!Z#{%e!Z$O%e!Z(`%e!Z(q%e!Z!]%e!Z!^%e!Z~P'%zOr;rO!g#vO(q'nO~Ov(eX~P1qO!Q%qO~P!)PO(T!lO~P!)PO!YfX!]fX#`fX~P%0kOP]XR]X[]Xj]Xr]X!Q]X!S]X!]]X!]fX!l]X!p]X#R]X#S]X#`]X#`fX#kfX#n]X#o]X#p]X#q]X#r]X#s]X#t]X#u]X#v]X#x]X#z]X#{]X$Q]X(`]X(q]X(x]X(y]X~O!gfX!k]X!kfX(qfX~P'JsOP;vOQ;vOSfOd=rOe!iOpkOr;vOskOtkOzkO|;vO!O;vO!SWO!WkO!XkO!_XO!i;yO!lZO!o;vO!p;vO!q;vO!s;zO!u;}O!x!hO$W!kO$n=pO(S)ZO(UTO(XUO(`VO(n[O~O!]<ZO!^$qa~Oh%VOp%WOr%XOs$tOt$tOz%YO|%ZO!O<fO!S${O!_$|O!i=wO!l$xO#j<lO$W%_O$t<hO$v<jO$y%`O(S(tO(UTO(XUO(`$uO(x$}O(y%PO~Ol)bO~P( iOr!eX(q!eX~P# }Or(iX(q(iX~P#!pO!^]X!^fX~P'JsO!YfX!Y$zX!]fX!]$zX#`fX~P!/wO#k<OO~O!g#vO#k<OO~O#`<`O~Oj<SO~O#`<pO!](vX!^(vX~O#`<`O!](tX!^(tX~O#k<qO~Og<sO~P!0{O#k<yO~O#k<zO~O!g#vO#k<{O~O!g#vO#k<qO~O$O<|O~P#B]O#k<}O~O#k=OO~O#k=TO~O#k=UO~O#k=VO~O#k=WO~O$O=XO~P!0{O$O=YO~P!0{Ok#S#T#U#W#X#[#i#j#u$n$t$v$y%]%^%h%i%j%q%s%v%w%y%{~'}T#o!X'{(T#ps#n#qr!Q'|$]'|(S$_(d~",goto:"$8g)[PPPPPP)]PP)`P)qP+R/WPPPP6bPP6xPP<pPPP@dP@zP@zPPP@zPCSP@zP@zP@zPCWPC]PCzPHtPPPHxPPPPHxK{PPPLRLsPHxPHxPP! RHxPPPHxPHxP!#YHxP!&p!'u!(OP!(r!(v!(r!,TPPPPPPP!,t!'uPP!-U!.vP!2SHxHx!2X!5e!:R!:R!>QPPP!>YHxPPPPPPPPP!AiP!BvPPHx!DXPHxPHxHxHxHxHxPHx!EkP!HuP!K{P!LP!LZ!L_!L_P!HrP!Lc!LcP# iP# mHxPHx# s#$xCW@zP@zP@z@zP#&V@z@z#(i@z#+a@z#-m@z@z#.]#0q#0q#0v#1P#0q#1[PP#0qP@z#1t@z#5s@z@z6bPPP#9xPPP#:c#:cP#:cP#:y#:cPP#;PP#:vP#:v#;d#:v#<O#<U#<X)`#<[)`P#<c#<c#<cP)`P)`P)`P)`PP)`P#<i#<lP#<l)`P#<pP#<sP)`P)`P)`P)`P)`P)`)`PP#<y#=P#=[#=b#=h#=n#=t#>S#>Y#>d#>j#>t#>z#?[#?b#@S#@f#@l#@r#AQ#Ag#C[#Cj#Cq#E]#Ek#G]#Gk#Gq#Gw#G}#HX#H_#He#Ho#IR#IXPPPPPPPPPPP#I_PPPPPPP#JS#MZ#Ns#Nz$ SPPP$&nP$&w$)p$0Z$0^$0a$1`$1c$1j$1rP$1x$1{P$2i$2m$3e$4s$4x$5`PP$5e$5k$5o$5r$5v$5z$6v$7_$7v$7z$7}$8Q$8W$8Z$8_$8cR!|RoqOXst!Z#d%l&p&r&s&u,n,s2S2VY!vQ'^-`1g5qQ%svQ%{yQ&S|Q&h!VS'U!e-WQ'd!iS'j!r!yU*h$|*X*lQ+l%|Q+y&UQ,_&bQ-^']Q-h'eQ-p'kQ0U*nQ1q,`R<m;z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9SS#q];w!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU*{%[<e<fQ+q&OQ,a&eQ,h&mQ0r+dQ0w+fQ1S+rQ1y,fQ3W.bQ5V0vQ5]0}Q6Q1rQ7O3[Q8U5^R9Y7Q'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s!S!nQ!r!v!y!z$|'U']'^'j'k'l*h*l*n*o-W-^-`-p0U0X1g5q5s%[$ti#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q&V|Q'S!eS'Y%h-ZQ+q&OQ,a&eQ0f+OQ1S+rQ1X+xQ1x,eQ1y,fQ5]0}Q5f1ZQ6Q1rQ6T1tQ6U1wQ8U5^Q8X5cQ8q6WQ9|8YQ:Y8nR<o*XrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR,c&i&z^OPXYstuvwz!Z!`!g!j!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=r=s[#]WZ#W#Z'V(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ%vxQ%zyS&P|&UQ&]!TQ'a!hQ'c!iQ(o#sS+k%{%|Q+o&OQ,Y&`Q,^&bS-g'd'eQ.d(pQ0{+lQ1R+rQ1T+sQ1W+wQ1l,ZS1p,_,`Q2t-hQ5[0}Q5`1QQ5e1YQ6P1qQ8T5^Q8W5bQ9x8SR:w9y!U$zi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y!^%xy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pQ+e%vQ,O&YQ,R&ZQ,]&bQ.c(oQ1k,YU1o,^,_,`Q3].dQ5z1lS6O1p1qQ8m6P#f=t#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o=u<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YW%Ti%V*v=pS&Y!Q&gQ&Z!RQ&[!SQ+S%cR+|&W%]%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}T)x$u)yV*{%[<e<fW'Y!e%h*X-ZS({#y#zQ+`%qQ+v&RS.](k(lQ1b,SQ4x0cR8^5k'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s$i$^c#Y#e%p%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.w.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gT#TV#U'RkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ'W!eR2i-W!W!nQ!e!r!v!y!z$|'U']'^'j'k'l*X*h*l*n*o-W-^-`-p0U0X1g5q5sR1d,UnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&w!^Q't!xS(q#u<OQ+i%yQ,W&]Q,X&_Q-e'bQ-r'mS.m(v<qS0k+U<{Q0y+jQ1f,VQ2Z,uQ2],vQ2e-RQ2r-fQ2u-jS5P0l=VQ5W0zS5Z0|=WQ6j2gQ6n2sQ6s2zQ8R5XQ8}6lQ9O6oQ9R6tR:`8z$d$]c#Y#e%r%t(Q(W(r(w)P)Q)R)S)T)U)V)W)X)Y)[)^)`)e)o+a+u-U-s-x-}.P.n.q.u.x.y/]0j2c2f2v2}3c3h3i3j3k3l3m3n3o3p3q3r3s3t3w3x4P5O5Y6k6q6v7V7W7a7b8`8|9Q9[9b9c:c:y;R;x=gS(m#p'gQ(}#zS+_%p.wS.^(l(nR3U._'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS#q];wQ&r!XQ&s!YQ&u![Q&v!]R2R,qQ'_!hQ+b%vQ-c'aS.`(o+eQ2p-bW3Y.c.d0q0sQ6m2qW6z3V3X3]5TU9U6{6}7PU:e9W9X9ZS;T:d:gQ;b;UR;j;cU!wQ'^-`T5o1g5q!Q_OXZ`st!V!Z#d#h%d%l&g&i&p&r&s&u(h,n,s.V2S2V]!pQ!r'^-`1g5qT#q];w%^{OPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS({#y#zS.](k(l!s=^$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sU$fd)],hS(n#p'gU*s%R(u3vU0e*z.i7]Q5T0rQ6{3WQ9X7OR:g9Ym!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sQ'r!uS(d#g1|S-n'i'uQ/n*ZQ/{*gQ2|-qQ4]/oQ4i/}Q4j0OQ4o0WQ7h4WS7s4k4mS7w4p4rQ9g7iQ9k7oQ9p7tQ9u7yS:o9l9mS;Y:p:sS;e;Z;[S;m;f;gS;q;n;oR;t;rQ#wbQ'q!uS(c#g1|S(e#m+TQ+V%eQ+g%wQ+m%}U-m'i'r'uQ.R(dQ/m*ZQ/|*gQ0P*iQ0x+hQ1m,[S2y-n-qQ3R.ZS4[/n/oQ4e/yS4h/{0WQ4l0QQ5|1nQ6u2|Q7g4WQ7k4]U7r4i4o4rQ7u4nQ8k5}S9f7h7iQ9j7oQ9r7wQ9s7xQ:V8lQ:m9gS:n9k9mQ:v9uQ;P:WS;X:o:sS;d;Y;ZS;l;e;gS;p;m;oQ;s;qQ;u;tQ=a=[Q=l=eR=m=fV!wQ'^-`%^aOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SS#wz!j!r=Z$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=a=r%^bOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SQ%ej!^%wy!i!u%z%{%|'T'c'd'e'i's*g+k+l-T-g-h-o/{0O0{2m2t2{4i4j4m7s9pS%}z!jQ+h%xQ,[&bW1n,],^,_,`U5}1o1p1qS8l6O6PQ:W8m!r=[$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ=e=qR=f=r%QeOPXYstuvw!Z!`!g!o#S#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9SY#bWZ#W#Z(R!b%im#h#i#l$x%d%g([(f(g(h*W*[*_+W+X+Z,j-Q.O.U.V.W.Y/h/k2[3S3T4X6h6yQ,i&m!p=]$Z$n)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sR=`'VU'Z!e%h*XR2k-Z%SdOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y,k,n,s-d-l-z.Q.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3d4q5y6Z6[6_6r8i8x9S!r)]$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sQ,h&mQ0r+dQ3W.bQ7O3[R9Y7Q!b$Tc#Y%p(Q(W(r(w)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!P<U)[)o-U.w2c2f3h3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!f$Vc#Y%p(Q(W(r(w)U)V)X)Y)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;x!T<W)[)o-U.w2c2f3h3n3o3q3r3w4P6k7W7a7b8`8|9[9b9c:y;R=g!^$Zc#Y%p(Q(W(r(w)^)e+u-s-x-}.P.n.q/]0j2v2}3c3s5O5Y6q6v7V9Q:c;xQ4V/fz=s)[)o-U.w2c2f3h3w4P6k7W7a7b8`8|9[9b9c:y;R=gQ=x=zR=y={'QkOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sS$oh$pR3|/P'XgOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$kf$qQ$ifS)h$l)lR)t$qT$jf$qT)j$l)l'XhOPWXYZhstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$Z$_$a$e$n$p%l%s&Q&i&l&m&p&r&s&u&y'R'V'`'p(R(T(Z(b(v(x(|)q){*f+U+Y+d,k,n,s-P-S-d-l-z.Q.b.o.v/P/Q/i0V0d0l0|1j1z1{1}2P2S2V2X2h2x3O3[3d3{4q5m5y6Z6[6_6i6r7Q8i8x9S9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=sT$oh$pQ$rhR)s$p%^jOPWXYZstuvw!Z!`!g!o#S#W#Z#d#o#u#x#{$O$P$Q$R$S$T$U$V$W$X$_$a$e%l%s&Q&i&l&m&p&r&s&u&y'R'`'p(R(T(Z(b(v(x(|){*f+U+Y+d,k,n,s-d-l-z.Q.b.o.v/i0V0d0l0|1j1z1{1}2P2S2V2X2x3O3[3d4q5y6Z6[6_6r7Q8i8x9S!s=q$Z$n'V)q-P-S/Q2h3{5m6i9}:a;v;y;z;}<O<P<Q<R<S<T<U<V<W<X<Y<Z<]<`<m<p<q<s<{<|=V=W=s#glOPXZst!Z!`!o#S#d#o#{$n%l&i&l&m&p&r&s&u&y'R'`(|)q*f+Y+d,k,n,s-d.b/Q/i0V0d1j1z1{1}2P2S2V2X3[3{4q5y6Z6[6_7Q8i8x!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}Q+P%`Q/^)|o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!U$yi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yQ*`$zU*i$|*X*lQ+Q%aQ0Q*j#f=c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n=d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YQ=h=tQ=i=uQ=j=vR=k=w!U%Ri$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y#f(u#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}o3v<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=YnoOXst!Z#d%l&p&r&s&u,n,s2S2VS*c${*WQ,|&|Q,}'OR4`/s%[%Si#v$b$c$d$x${%O%Q%]%^%b)w*P*R*T*W*^*d*t*u+c+f+},Q.a.z/_/h/r/s/u0Y0[0g0h0i1^1a1i3Z4U4V4a4f4w5R5U5x6|7l7v7|8Q8f9V9e9n9t:S:f:t:};V;^<^<_<a<b<c<d<g<h<i<j<k<l<t<u<v<w<y<z<}=O=P=Q=R=S=T=U=X=Y=p=x=y=|=}Q,P&ZQ1`,RQ5i1_R8]5jV*k$|*X*lU*k$|*X*lT5p1g5qS/y*f/iQ4n0VT7x4q:PQ+g%wQ0P*iQ0x+hQ1m,[Q5|1nQ8k5}Q:V8lR;P:W!U%Oi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=yx*P$v)c*Q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=oS0Y*q0Z#f<a#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<b<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!d<t(s)a*Y*b.e.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={`<u3u7X7[7`9]:h:k;kS=P.g3aT=Q7Z9`!U%Qi$d%O%Q%]%^%b*P*R*^*t*u.z/r0Y0[0g0h0i4V4w7|9e=p=x=y|*R$v)c*S*q+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=oS0[*r0]#f<c#v$b$c$x${)w*T*W*d+c+f+},Q.a/_/h/s/u1^1a1i3Z4U4a4f5R5U5x6|7l7v8Q8f9V9n9t:S:f:t:};V;^<a<c<g<i<k<t<v<y<}=P=R=T=X=|=}n<d<^<_<b<d<h<j<l<u<w<z=O=Q=S=U=Y!h<v(s)a*Y*b.f.g.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={d<w3u7Y7Z7`9]9^:h:i:k;kS=R.h3bT=S7[9arnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ&d!UR,k&mrnOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VR&d!UQ,T&[R1[+|snOXst!V!Z#d%l&g&p&r&s&u,n,s2S2VQ1h,YS5w1k1lU8e5u5v5zS:R8g8hS:{:Q:TQ;_:|R;i;`Q&k!VR,d&gR6T1tR:Y8nS&P|&UR1T+sQ&p!WR,n&qR,t&vT2T,s2VR,x&wQ,w&wR2^,xQ'w!{R-t'wSsOtQ#dXT%os#dQ#OTR'y#OQ#RUR'{#RQ)y$uR/Z)yQ#UVR(O#UQ#XWU(U#X(V-{Q(V#YR-{(WQ-X'WR2j-XQ.p(wS3e.p3fR3f.qQ-`'^R2n-`Y!rQ'^-`1g5qR'h!rQ.{)cR3z.{U#_W%g*WU(]#_(^-|Q(^#`R-|(XQ-['ZR2l-[t`OXst!V!Z#d%l&g&i&p&r&s&u,n,s2S2VS#hZ%dU#r`#h.VR.V(hQ(i#jQ.S(eW.[(i.S3P6wQ3P.TR6w3QQ)l$lR/R)lQ$phR)r$pQ$`cU)_$`-w<[Q-w;xR<[)oQ/l*ZW4Y/l4Z7j9hU4Z/m/n/oS7j4[4]R9h7k$e*O$v(s)a)c*Y*b*q*r*|*}+R.g.h.j.k.l/Y/b/d/f/q/v0^0_0p1]3^3_3`3u3y4S4^4_4c4s4u4{4|4}5h7R7S7T7U7Z7[7^7_7`7f7m7p7z7}8P9]9^9_9i9q9v9w:h:i:j:k:l:q:u;W;];h;k=b=n=o=z={Q/t*bU4b/t4d7nQ4d/vR7n4cS*l$|*XR0S*lx*Q$v)c*q*r+R/q0^0_3y4^4{4|4}7f7z9v:l=b=n=o!d.e(s)a*Y*b.g.h.l/Y/f/v0p1]3`4S4_4c5h7R7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/c*Q.e7Xa7X3u7Z7[7`9]:h:k;kQ0Z*qQ3a.gU4t0Z3a9`R9`7Z|*S$v)c*q*r+R/b/q0^0_3y4^4s4{4|4}7f7z9v:l=b=n=o!h.f(s)a*Y*b.g.h.l/Y/f/v0p1]3^3`4S4_4c5h7R7S7U7m7p7}8P9i9q9w:q:u;W;];h=z={U/e*S.f7Ye7Y3u7Z7[7`9]9^:h:i:k;kQ0]*rQ3b.hU4v0]3b9aR9a7[Q*w%UR0a*wQ5S0pR8O5SQ+[%jR0o+[Q5l1bS8_5l:OR:O8`Q,V&]R1e,VQ5q1gR8b5qQ1s,aS6R1s8oR8o6TQ1O+oW5_1O5a8V9zQ5a1RQ8V5`R9z8WQ+t&PR1U+tQ2V,sR6c2VYrOXst#dQ&t!ZQ+^%lQ,m&pQ,o&rQ,p&sQ,r&uQ2Q,nS2T,s2VR6b2SQ%npQ&x!_Q&{!aQ&}!bQ'P!cQ'o!uQ+]%kQ+i%yQ+{&VQ,c&kQ,z&zW-k'i'q'r'uQ-r'mQ0R*kQ0y+jS1v,d,gQ2_,yQ2`,|Q2a,}Q2u-jW2w-m-n-q-sQ5W0zQ5d1XQ5g1]Q5{1mQ6V1xQ6a2RU6p2v2y2|Q6s2zQ8R5XQ8Z5fQ8[5hQ8a5pQ8j5|Q8p6US9P6q6uQ9R6tQ9{8XQ:U8kQ:Z8qQ:b9QQ:x9|Q;O:VQ;S:cR;a;PQ%yyQ'b!iQ'm!uU+j%z%{%|Q-R'TU-f'c'd'eS-j'i'sQ/z*gS0z+k+lQ2g-TS2s-g-hQ2z-oS4g/{0OQ5X0{Q6l2mQ6o2tQ6t2{U7q4i4j4mQ9o7sR:r9pS$wi=pR*x%VU%Ui%V=pR0`*vQ$viS(s#v+fS)a$b$cQ)c$dQ*Y$xS*b${*WQ*q%OQ*r%QQ*|%]Q*}%^Q+R%bQ.g<aQ.h<cQ.j<gQ.k<iQ.l<kQ/Y)wQ/b*PQ/d*RQ/f*TQ/q*^S/v*d/hQ0^*tQ0_*ul0p+c,Q.a1a1i3Z5x6|8f9V:S:f:};VQ1]+}Q3^<tQ3_<vQ3`<yS3u<^<_Q3y.zS4S/_4UQ4^/rQ4_/sQ4c/uQ4s0YQ4u0[Q4{0gQ4|0hQ4}0iQ5h1^Q7R<}Q7S=PQ7T=RQ7U=TQ7Z<bQ7[<dQ7^<hQ7_<jQ7`<lQ7f4VQ7m4aQ7p4fQ7z4wQ7}5RQ8P5UQ9]<zQ9^<uQ9_<wQ9i7lQ9q7vQ9v7|Q9w8QQ:h=OQ:i=QQ:j=SQ:k=UQ:l9eQ:q9nQ:u9tQ;W=XQ;]:tQ;h;^Q;k=YQ=b=pQ=n=xQ=o=yQ=z=|R={=}Q*z%[Q.i<eR7]<fnpOXst!Z#d%l&p&r&s&u,n,s2S2VQ!fPS#fZ#oQ&z!`W'f!o*f0V4qQ'}#SQ)O#{Q)p$nS,g&i&lQ,l&mQ,y&yS-O'R/iQ-b'`Q.s(|Q/V)qQ0m+YQ0s+dQ2O,kQ2q-dQ3X.bQ4O/QQ4y0dQ5v1jQ6X1zQ6Y1{Q6^1}Q6`2PQ6e2XQ7P3[Q7c3{Q8h5yQ8t6ZQ8u6[Q8w6_Q9Z7QQ:T8iR:_8x#[cOPXZst!Z!`!o#d#o#{%l&i&l&m&p&r&s&u&y'R'`(|*f+Y+d,k,n,s-d.b/i0V0d1j1z1{1}2P2S2V2X3[4q5y6Z6[6_7Q8i8xQ#YWQ#eYQ%puQ%rvS%tw!gS(Q#W(TQ(W#ZQ(r#uQ(w#xQ)P$OQ)Q$PQ)R$QQ)S$RQ)T$SQ)U$TQ)V$UQ)W$VQ)X$WQ)Y$XQ)[$ZQ)^$_Q)`$aQ)e$eW)o$n)q/Q3{Q+a%sQ+u&QS-U'V2hQ-s'pS-x(R-zQ-}(ZQ.P(bQ.n(vQ.q(xQ.u;vQ.w;yQ.x;zQ.y;}Q/]){Q0j+UQ2c-PQ2f-SQ2v-lQ2}.QQ3c.oQ3h<OQ3i<PQ3j<QQ3k<RQ3l<SQ3m<TQ3n<UQ3o<VQ3p<WQ3q<XQ3r<YQ3s.vQ3t<]Q3w<`Q3x<mQ4P<ZQ5O0lQ5Y0|Q6k<pQ6q2xQ6v3OQ7V3dQ7W<qQ7a<sQ7b<{Q8`5mQ8|6iQ9Q6rQ9[<|Q9b=VQ9c=WQ:c9SQ:y9}Q;R:aQ;x#SR=g=sR#[WR'X!el!tQ!r!v!y!z'^'j'k'l-`-p1g5q5sS'T!e-WU*g$|*X*lS-T'U']S0O*h*nQ0W*oQ2m-^Q4m0UR4r0XR(y#xQ!fQT-_'^-`]!qQ!r'^-`1g5qQ#p]R'g;wR)d$dY!uQ'^-`1g5qQ'i!rS's!v!yS'u!z5sS-o'j'kQ-q'lR2{-pT#kZ%dS#jZ%dS%jm,jU(e#h#i#lS.T(f(gQ.X(hQ0n+ZQ3Q.UU3R.V.W.YS6x3S3TR9T6yd#^W#W#Z%g(R([*W+W.O/hr#gZm#h#i#l%d(f(g(h+Z.U.V.W.Y3S3T6yS*Z$x*_Q/o*[Q1|,jQ2d-QQ4W/kQ6g2[Q7i4XQ8{6hT=_'V+XV#aW%g*WU#`W%g*WS(S#W([U(X#Z+W/hS-V'V+XT-y(R.OV'[!e%h*XQ$lfR)v$qT)k$l)lR3}/PT*]$x*_T*e${*WQ0q+cQ1_,QQ3V.aQ5j1aQ5u1iQ6}3ZQ8g5xQ9W6|Q:Q8fQ:d9VQ:|:SQ;U:fQ;`:}R;c;VnqOXst!Z#d%l&p&r&s&u,n,s2S2VQ&j!VR,c&gtmOXst!U!V!Z#d%l&g&p&r&s&u,n,s2S2VR,j&mT%km,jR1c,SR,b&eQ&T|R+z&UR+p&OT&n!W&qT&o!W&qT2U,s2V",nodeNames:"⚠ ArithOp ArithOp ?. JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList in out const TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewTarget new NewExpression ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression TypeArgList CompareOp < declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression InstantiationExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast < ArrowFunction TypeParamList SequenceExpression InstantiationExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate asserts is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:379,context:Zt,nodeProps:[["isolate",-8,5,6,14,37,39,51,53,55,""],["group",-26,9,17,19,68,207,211,215,216,218,221,224,234,236,242,244,246,248,251,257,263,265,267,269,271,273,274,"Statement",-34,13,14,32,35,36,42,51,54,55,57,62,70,72,76,80,82,84,85,110,111,120,121,136,139,141,142,143,144,145,147,148,167,169,171,"Expression",-23,31,33,37,41,43,45,173,175,177,178,180,181,182,184,185,186,188,189,190,201,203,205,206,"Type",-3,88,103,109,"ClassItem"],["openedBy",23,"<",38,"InterpolationStart",56,"[",60,"{",73,"(",160,"JSXStartCloseTag"],["closedBy",-2,24,168,">",40,"InterpolationEnd",50,"]",61,"}",74,")",165,"JSXEndTag"]],propSources:[Jt],skippedNodes:[0,5,6,277],repeatNodeCount:37,tokenData:"$Fq07[R!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#:O!R![#<_![!]#I_!]!^#Jk!^!_#Ku!_!`$![!`!a$$v!a!b$*T!b!c$,r!c!}Er!}#O$-|#O#P$/W#P#Q$4o#Q#R$5y#R#SEr#S#T$7W#T#o$8b#o#p$<r#p#q$=h#q#r$>x#r#s$@U#s$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$I|Er$I|$I}$Dk$I}$JO$Dk$JO$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr(n%d_$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$i&j(Y!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(Y!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$i&j(VpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(VpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z07[+rq$i&j(Vp(Y!b'{0/lOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z07[.ST(W#S$i&j'|0/lO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c07[.n_$i&j(Vp(Y!b'|0/lOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)3p/x`$i&j!p),Q(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW1V`#v(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW2d_#v(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At3l_(U':f$i&j(Y!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$i&j(Y!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$i&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$d`$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$d``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$d`$i&j(Y!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(Y!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$d`(Y!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k%9[:hh$i&j(Vp(Y!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__WS$i&j(Vp(Y!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]WS$i&j(Y!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXWS$i&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSWSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWWS(Y!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]WS$i&j(VpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWWS(VpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYWS(Vp(Y!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S%9[C}i$i&j(n%1l(Vp(Y!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr%9[EoP;=`<%lCr07[FRk$i&j(Vp(Y!b$]#t(S,2j(d$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$i&j(Vp(Y!b$]#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv07[JPP;=`<%lEr(KWJ_`$i&j(Vp(Y!b#p(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWKl_$i&j$Q(Ch(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,#xLva(y+JY$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KWNW`$i&j#z(Ch(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'At! c_(X';W$i&j(VpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$i&j(VpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$i&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$d`$i&j(VpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(VpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$d`(VpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b/5|!'t_!l/.^$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&U!)O_!k!Lf$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z-!n!*[b$i&j(Vp(Y!b(T%&f#q(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW!+o`$i&j(Vp(Y!b#n(ChOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;x!,|`$i&j(Vp(Y!br+4YOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z,$U!.Z_!]+Jf$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!/ec$i&j(Vp(Y!b!Q.2^OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!0ya$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#%|!2Z_![!L^$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!3eg$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!5Vg$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!6wc$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad!8_c$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[!9uf$i&j(Vp(Y!b#o(ChOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcxz!;Zz{#-}{!P!;Z!P!Q#/d!Q!^!;Z!^!_#(i!_!`#7S!`!a#8i!a!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z?O!;fb$i&j(Vp(Y!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z>^!<w`$i&j(Y!b!X7`OY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eq!Q!^!<n!^!_!Gr!_!}!<n!}#O!KS#O#P!Dy#P#o!<n#o#p!Gr#p;'S!<n;'S;=`!L]<%lO!<n<z!>Q^$i&j!X7`OY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@c!_!}!=y!}#O!CW#O#P!Dy#P#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!?Td$i&j!X7`O!^&c!_#W&c#W#X!>|#X#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#k!>|#k#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&c7`!@hX!X7`OY!@cZ!P!@c!P!Q!AT!Q!}!@c!}#O!Ar#O#P!Bq#P;'S!@c;'S;=`!CQ<%lO!@c7`!AYW!X7`#W#X!AT#Z#[!AT#]#^!AT#a#b!AT#g#h!AT#i#j!AT#j#k!AT#m#n!AT7`!AuVOY!ArZ#O!Ar#O#P!B[#P#Q!@c#Q;'S!Ar;'S;=`!Bk<%lO!Ar7`!B_SOY!ArZ;'S!Ar;'S;=`!Bk<%lO!Ar7`!BnP;=`<%l!Ar7`!BtSOY!@cZ;'S!@c;'S;=`!CQ<%lO!@c7`!CTP;=`<%l!@c<z!C][$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#O!CW#O#P!DR#P#Q!=y#Q#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DWX$i&jOY!CWYZ&cZ!^!CW!^!_!Ar!_#o!CW#o#p!Ar#p;'S!CW;'S;=`!Ds<%lO!CW<z!DvP;=`<%l!CW<z!EOX$i&jOY!=yYZ&cZ!^!=y!^!_!@c!_#o!=y#o#p!@c#p;'S!=y;'S;=`!Ek<%lO!=y<z!EnP;=`<%l!=y>^!Ezl$i&j(Y!b!X7`OY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#W&}#W#X!Eq#X#Z&}#Z#[!Eq#[#]&}#]#^!Eq#^#a&}#a#b!Eq#b#g&}#g#h!Eq#h#i&}#i#j!Eq#j#k!Eq#k#m&}#m#n!Eq#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}8r!GyZ(Y!b!X7`OY!GrZw!Grwx!@cx!P!Gr!P!Q!Hl!Q!}!Gr!}#O!JU#O#P!Bq#P;'S!Gr;'S;=`!J|<%lO!Gr8r!Hse(Y!b!X7`OY'}Zw'}x#O'}#P#W'}#W#X!Hl#X#Z'}#Z#[!Hl#[#]'}#]#^!Hl#^#a'}#a#b!Hl#b#g'}#g#h!Hl#h#i'}#i#j!Hl#j#k!Hl#k#m'}#m#n!Hl#n;'S'};'S;=`(f<%lO'}8r!JZX(Y!bOY!JUZw!JUwx!Arx#O!JU#O#P!B[#P#Q!Gr#Q;'S!JU;'S;=`!Jv<%lO!JU8r!JyP;=`<%l!JU8r!KPP;=`<%l!Gr>^!KZ^$i&j(Y!bOY!KSYZ&cZw!KSwx!CWx!^!KS!^!_!JU!_#O!KS#O#P!DR#P#Q!<n#Q#o!KS#o#p!JU#p;'S!KS;'S;=`!LV<%lO!KS>^!LYP;=`<%l!KS>^!L`P;=`<%l!<n=l!Ll`$i&j(Vp!X7`OY!LcYZ&cZr!Lcrs!=ys!P!Lc!P!Q!Mn!Q!^!Lc!^!_# o!_!}!Lc!}#O#%P#O#P!Dy#P#o!Lc#o#p# o#p;'S!Lc;'S;=`#&Y<%lO!Lc=l!Mwl$i&j(Vp!X7`OY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#W(r#W#X!Mn#X#Z(r#Z#[!Mn#[#](r#]#^!Mn#^#a(r#a#b!Mn#b#g(r#g#h!Mn#h#i(r#i#j!Mn#j#k!Mn#k#m(r#m#n!Mn#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r8Q# vZ(Vp!X7`OY# oZr# ors!@cs!P# o!P!Q#!i!Q!}# o!}#O#$R#O#P!Bq#P;'S# o;'S;=`#$y<%lO# o8Q#!pe(Vp!X7`OY)rZr)rs#O)r#P#W)r#W#X#!i#X#Z)r#Z#[#!i#[#])r#]#^#!i#^#a)r#a#b#!i#b#g)r#g#h#!i#h#i)r#i#j#!i#j#k#!i#k#m)r#m#n#!i#n;'S)r;'S;=`*Z<%lO)r8Q#$WX(VpOY#$RZr#$Rrs!Ars#O#$R#O#P!B[#P#Q# o#Q;'S#$R;'S;=`#$s<%lO#$R8Q#$vP;=`<%l#$R8Q#$|P;=`<%l# o=l#%W^$i&j(VpOY#%PYZ&cZr#%Prs!CWs!^#%P!^!_#$R!_#O#%P#O#P!DR#P#Q!Lc#Q#o#%P#o#p#$R#p;'S#%P;'S;=`#&S<%lO#%P=l#&VP;=`<%l#%P=l#&]P;=`<%l!Lc?O#&kn$i&j(Vp(Y!b!X7`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#W%Z#W#X#&`#X#Z%Z#Z#[#&`#[#]%Z#]#^#&`#^#a%Z#a#b#&`#b#g%Z#g#h#&`#h#i%Z#i#j#&`#j#k#&`#k#m%Z#m#n#&`#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z9d#(r](Vp(Y!b!X7`OY#(iZr#(irs!Grsw#(iwx# ox!P#(i!P!Q#)k!Q!}#(i!}#O#+`#O#P!Bq#P;'S#(i;'S;=`#,`<%lO#(i9d#)th(Vp(Y!b!X7`OY*gZr*grs'}sw*gwx)rx#O*g#P#W*g#W#X#)k#X#Z*g#Z#[#)k#[#]*g#]#^#)k#^#a*g#a#b#)k#b#g*g#g#h#)k#h#i*g#i#j#)k#j#k#)k#k#m*g#m#n#)k#n;'S*g;'S;=`+Z<%lO*g9d#+gZ(Vp(Y!bOY#+`Zr#+`rs!JUsw#+`wx#$Rx#O#+`#O#P!B[#P#Q#(i#Q;'S#+`;'S;=`#,Y<%lO#+`9d#,]P;=`<%l#+`9d#,cP;=`<%l#(i?O#,o`$i&j(Vp(Y!bOY#,fYZ&cZr#,frs!KSsw#,fwx#%Px!^#,f!^!_#+`!_#O#,f#O#P!DR#P#Q!;Z#Q#o#,f#o#p#+`#p;'S#,f;'S;=`#-q<%lO#,f?O#-tP;=`<%l#,f?O#-zP;=`<%l!;Z07[#.[b$i&j(Vp(Y!b'}0/l!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z07[#/o_$i&j(Vp(Y!bT0/lOY#/dYZ&cZr#/drs#0nsw#/dwx#4Ox!^#/d!^!_#5}!_#O#/d#O#P#1p#P#o#/d#o#p#5}#p;'S#/d;'S;=`#6|<%lO#/d06j#0w]$i&j(Y!bT0/lOY#0nYZ&cZw#0nwx#1px!^#0n!^!_#3R!_#O#0n#O#P#1p#P#o#0n#o#p#3R#p;'S#0n;'S;=`#3x<%lO#0n05W#1wX$i&jT0/lOY#1pYZ&cZ!^#1p!^!_#2d!_#o#1p#o#p#2d#p;'S#1p;'S;=`#2{<%lO#1p0/l#2iST0/lOY#2dZ;'S#2d;'S;=`#2u<%lO#2d0/l#2xP;=`<%l#2d05W#3OP;=`<%l#1p01O#3YW(Y!bT0/lOY#3RZw#3Rwx#2dx#O#3R#O#P#2d#P;'S#3R;'S;=`#3r<%lO#3R01O#3uP;=`<%l#3R06j#3{P;=`<%l#0n05x#4X]$i&j(VpT0/lOY#4OYZ&cZr#4Ors#1ps!^#4O!^!_#5Q!_#O#4O#O#P#1p#P#o#4O#o#p#5Q#p;'S#4O;'S;=`#5w<%lO#4O00^#5XW(VpT0/lOY#5QZr#5Qrs#2ds#O#5Q#O#P#2d#P;'S#5Q;'S;=`#5q<%lO#5Q00^#5tP;=`<%l#5Q05x#5zP;=`<%l#4O01p#6WY(Vp(Y!bT0/lOY#5}Zr#5}rs#3Rsw#5}wx#5Qx#O#5}#O#P#2d#P;'S#5};'S;=`#6v<%lO#5}01p#6yP;=`<%l#5}07[#7PP;=`<%l#/d)3h#7ab$i&j$Q(Ch(Vp(Y!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;ZAt#8vb$Z#t$i&j(Vp(Y!b!X7`OY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Lcx!P!;Z!P!Q#&`!Q!^!;Z!^!_#(i!_!}!;Z!}#O#,f#O#P!Dy#P#o!;Z#o#p#(i#p;'S!;Z;'S;=`#-w<%lO!;Z'Ad#:Zp$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#U%Z#U#V#?i#V#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#d#Bq#d#l%Z#l#m#Es#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#<jk$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#<_![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#<_#S#X%Z#X#Y!4|#Y#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#>j_$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#?rd$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#A]f$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#AQ!R!S#AQ!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#AQ#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Bzc$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Dbe$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#DV!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#DV#S#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#E|g$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'Ad#Gpi$i&j(Vp(Y!bs'9tOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#Ge![!^%Z!^!_*g!_!c%Z!c!i#Ge!i#O%Z#O#P&c#P#R%Z#R#S#Ge#S#T%Z#T#Z#Ge#Z#b%Z#b#c#>_#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x#Il_!g$b$i&j$O)Lv(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#Jv_al$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f#LS^h#)`#R-<U(Vp(Y!b$n7`OY*gZr*grs'}sw*gwx)rx!P*g!P!Q#MO!Q!^*g!^!_#Mt!_!`$ f!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#MXX$k&j(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El#M}Z#r(Ch(Vp(Y!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#Np!`#O*g#P;'S*g;'S;=`+Z<%lO*g(El#NyX$Q(Ch(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g(El$ oX#s(Ch(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g*)x$!ga#`*!Y$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$#l!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(K[$#w_#k(Cl$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z*)x$%Vag!*r#s(Ch$f#|$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$&[!`!a$'f!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$&g_#s(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$'qa#r(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$(v!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$)R`#r(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(Kd$*`a(q(Ct$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!a%Z!a!b$+e!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$+p`$i&j#{(Ch(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`$,}_!|$Ip$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z04f$.X_!S0,v$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/]Z$i&jO!^$0O!^!_$0f!_#i$0O#i#j$0k#j#l$0O#l#m$2^#m#o$0O#o#p$0f#p;'S$0O;'S;=`$4i<%lO$0O(n$0VT_#S$i&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0kO_#S(n$0p[$i&jO!Q&c!Q![$1f![!^&c!_!c&c!c!i$1f!i#T&c#T#Z$1f#Z#o&c#o#p$3|#p;'S&c;'S;=`&w<%lO&c(n$1kZ$i&jO!Q&c!Q![$2^![!^&c!_!c&c!c!i$2^!i#T&c#T#Z$2^#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2cZ$i&jO!Q&c!Q![$3U![!^&c!_!c&c!c!i$3U!i#T&c#T#Z$3U#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3ZZ$i&jO!Q&c!Q![$0O![!^&c!_!c&c!c!i$0O!i#T&c#T#Z$0O#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$4PR!Q![$4Y!c!i$4Y#T#Z$4Y#S$4]S!Q![$4Y!c!i$4Y#T#Z$4Y#q#r$0f(n$4lP;=`<%l$0O#1[$4z_!Y#)l$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(KW$6U`#x(Ch$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z+;p$7c_$i&j(Vp(Y!b(`+4QOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$8qk$i&j(Vp(Y!b(S,2j$_#t(d$I[OY%ZYZ&cZr%Zrs&}st%Ztu$8buw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$8b![!^%Z!^!_*g!_!c%Z!c!}$8b!}#O%Z#O#P&c#P#R%Z#R#S$8b#S#T%Z#T#o$8b#o#p*g#p$g%Z$g;'S$8b;'S;=`$<l<%lO$8b+d$:qk$i&j(Vp(Y!b$_#tOY%ZYZ&cZr%Zrs&}st%Ztu$:fuw%Zwx(rx}%Z}!O$:f!O!Q%Z!Q![$:f![!^%Z!^!_*g!_!c%Z!c!}$:f!}#O%Z#O#P&c#P#R%Z#R#S$:f#S#T%Z#T#o$:f#o#p*g#p$g%Z$g;'S$:f;'S;=`$<f<%lO$:f+d$<iP;=`<%l$:f07[$<oP;=`<%l$8b#Jf$<{X!_#Hb(Vp(Y!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g,#x$=sa(x+JY$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+e#q;'S%Z;'S;=`+a<%lO%Z)>v$?V_!^(CdvBr$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z?O$@a_!q7`$i&j(Vp(Y!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z07[$Aq|$i&j(Vp(Y!b'{0/l$]#t(S,2j(d$I[OX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$A`#BZ$ISEr$IS$I_$A`$I_$JTEr$JT$JU$A`$JU$KVEr$KV$KW$A`$KW&FUEr&FU&FV$A`&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$A`?HUOEr07[$D|k$i&j(Vp(Y!b'|0/l$]#t(S,2j(d$I[OY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[jt,Yt,Ut,Gt,2,3,4,5,6,7,8,9,10,11,12,13,14,Xt,new it("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOx~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!U~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(b~~",141,339),new it("j~RQYZXz{^~^O(P~~aP!P!Qd~iO(Q~~",25,322)],topRules:{Script:[0,7],SingleExpression:[1,275],SingleClassItem:[2,276]},dialects:{jsx:0,ts:15098},dynamicPrecedences:{80:1,82:1,94:1,169:1,199:1},specialized:[{term:326,get:t=>te[t]||-1},{term:342,get:t=>ee[t]||-1},{term:95,get:t=>ie[t]||-1}],tokenPrec:15124});let se=[],oe=[];function re(t){if(t<768)return!1;for(let e=0,i=se.length;;){let n=e+i>>1;if(t<se[n])i=n;else{if(!(t>=oe[n]))return!0;e=n+1}if(e==i)return!1}}function le(t){return t>=127462&&t<=127487}function ae(t,e,i=!0,n=!0){return(i?he:ce)(t,e,n)}function he(t,e,i){if(e==t.length)return e;e&&ue(t.charCodeAt(e))&&fe(t.charCodeAt(e-1))&&e--;let n=de(t,e);for(e+=pe(n);e<t.length;){let s=de(t,e);if(8205==n||8205==s||i&&re(s))e+=pe(s),n=s;else{if(!le(s))break;{let i=0,n=e-2;for(;n>=0&&le(de(t,n));)i++,n-=2;if(i%2==0)break;e+=2}}}return e}function ce(t,e,i){for(;e>0;){let n=he(t,e-2,i);if(n<e)return n;e--}return 0}function de(t,e){let i=t.charCodeAt(e);if(!fe(i)||e+1==t.length)return i;let n=t.charCodeAt(e+1);return ue(n)?n-56320+(i-55296<<10)+65536:i}function ue(t){return t>=56320&&t<57344}function fe(t){return t>=55296&&t<56320}function pe(t){return t<65536?1:2}(()=>{let t="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((t=>t?parseInt(t,36):1));for(let e=0,i=0;e<t.length;e++)(e%2?oe:se).push(i+=t[e])})();class ge{lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){[t,e]=ke(this,t,e);let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),Oe.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){[t,e]=ke(this,t,e);let i=[];return this.decompose(t,e,i,0),Oe.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new be(this),s=new be(t);for(let t=e,o=e;;){if(n.next(t),s.next(t),t=0,n.lineBreak!=s.lineBreak||n.done!=s.done||n.value!=s.value)return!1;if(o+=n.value.length,n.done||o>=i)return!0}}iter(t=1){return new be(this,t)}iterRange(t,e=this.length){return new ye(this,t,e)}iterLines(t,e){let i;if(null==t)i=this.iter();else{null==e&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new Se(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}constructor(){}static of(t){if(0==t.length)throw new RangeError("A document must have at least one line");return 1!=t.length||t[0]?t.length<=32?new me(t):Oe.from(me.split(t,[])):ge.empty}}class me extends ge{constructor(t,e=function(t){let e=-1;for(let i of t)e+=i.length+1;return e}(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let s=0;;s++){let o=this.text[s],r=n+o.length;if((e?i:r)>=t)return new xe(n,r,i,o);n=r+1,i++}}decompose(t,e,i,n){let s=t<=0&&e>=this.length?this:new me(we(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(1&n){let t=i.pop(),e=ve(s.text,t.text.slice(),0,s.length);if(e.length<=32)i.push(new me(e,t.length+s.length));else{let t=e.length>>1;i.push(new me(e.slice(0,t)),new me(e.slice(t)))}}else i.push(s)}replace(t,e,i){if(!(i instanceof me))return super.replace(t,e,i);[t,e]=ke(this,t,e);let n=ve(this.text,ve(i.text,we(this.text,0,t)),e),s=this.length+i.length-(e-t);return n.length<=32?new me(n,s):Oe.from(me.split(n,[]),s)}sliceString(t,e=this.length,i="\n"){[t,e]=ke(this,t,e);let n="";for(let s=0,o=0;s<=e&&o<this.text.length;o++){let r=this.text[o],l=s+r.length;s>t&&o&&(n+=i),t<l&&e>s&&(n+=r.slice(Math.max(0,t-s),e-s)),s=l+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let s of t)i.push(s),n+=s.length+1,32==i.length&&(e.push(new me(i,n)),i=[],n=-1);return n>-1&&e.push(new me(i,n)),e}}class Oe extends ge{constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let e of t)this.lines+=e.lines}lineInner(t,e,i,n){for(let s=0;;s++){let o=this.children[s],r=n+o.length,l=i+o.lines-1;if((e?l:r)>=t)return o.lineInner(t,e,i,n);n=r+1,i=l+1}}decompose(t,e,i,n){for(let s=0,o=0;o<=e&&s<this.children.length;s++){let r=this.children[s],l=o+r.length;if(t<=l&&e>=o){let s=n&((o<=t?1:0)|(l>=e?2:0));o>=t&&l<=e&&!s?i.push(r):r.decompose(t-o,e-o,i,s)}o=l+1}}replace(t,e,i){if([t,e]=ke(this,t,e),i.lines<this.lines)for(let n=0,s=0;n<this.children.length;n++){let o=this.children[n],r=s+o.length;if(t>=s&&e<=r){let l=o.replace(t-s,e-s,i),a=this.lines-o.lines+l.lines;if(l.lines<a>>4&&l.lines>a>>6){let s=this.children.slice();return s[n]=l,new Oe(s,this.length-(e-t)+i.length)}return super.replace(s,r,l)}s=r+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i="\n"){[t,e]=ke(this,t,e);let n="";for(let s=0,o=0;s<this.children.length&&o<=e;s++){let r=this.children[s],l=o+r.length;o>t&&s&&(n+=i),t<l&&e>o&&(n+=r.sliceString(t-o,e-o,i)),o=l+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof Oe))return 0;let i=0,[n,s,o,r]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,s+=e){if(n==o||s==r)return i;let l=this.children[n],a=t.children[s];if(l!=a)return i+l.scanIdentical(a,e);i+=l.length+1}}static from(t,e=t.reduce(((t,e)=>t+e.length+1),-1)){let i=0;for(let e of t)i+=e.lines;if(i<32){let i=[];for(let e of t)e.flatten(i);return new me(i,e)}let n=Math.max(32,i>>5),s=n<<1,o=n>>1,r=[],l=0,a=-1,h=[];function c(t){let e;if(t.lines>s&&t instanceof Oe)for(let e of t.children)c(e);else t.lines>o&&(l>o||!l)?(d(),r.push(t)):t instanceof me&&l&&(e=h[h.length-1])instanceof me&&t.lines+e.lines<=32?(l+=t.lines,a+=t.length+1,h[h.length-1]=new me(e.text.concat(t.text),e.length+1+t.length)):(l+t.lines>n&&d(),l+=t.lines,a+=t.length+1,h.push(t))}function d(){0!=l&&(r.push(1==h.length?h[0]:Oe.from(h,a)),a=-1,l=h.length=0)}for(let e of t)c(e);return d(),1==r.length?r[0]:new Oe(r,e)}}function ve(t,e,i=0,n=1e9){for(let s=0,o=0,r=!0;o<t.length&&s<=n;o++){let l=t[o],a=s+l.length;a>=i&&(a>n&&(l=l.slice(0,n-s)),s<i&&(l=l.slice(i-s)),r?(e[e.length-1]+=l,r=!1):e.push(l)),s=a+1}return e}function we(t,e,i){return ve(t,[""],e,i)}ge.empty=new me([""],0);class be{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof me?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],s=this.offsets[i],o=s>>1,r=n instanceof me?n.text.length:n.children.length;if(o==(e>0?r:0)){if(0==i)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&s)==(e>0?0:1)){if(this.offsets[i]+=e,0==t)return this.lineBreak=!0,this.value="\n",this;t--}else if(n instanceof me){let s=n.text[o+(e<0?-1:0)];if(this.offsets[i]+=e,s.length>Math.max(0,t))return this.value=0==t?s:e>0?s.slice(t):s.slice(0,s.length-t),this;t-=s.length}else{let s=n.children[o+(e<0?-1:0)];t>s.length?(t-=s.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(s),this.offsets.push(e>0?1:(s instanceof me?s.text.length:s.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class ye{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new be(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class Se{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e&&this.afterBreak?(this.value="",this.afterBreak=!1):e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(ge.prototype[Symbol.iterator]=function(){return this.iter()},be.prototype[Symbol.iterator]=ye.prototype[Symbol.iterator]=Se.prototype[Symbol.iterator]=function(){return this});class xe{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}function ke(t,e,i){return[e=Math.max(0,Math.min(t.length,e)),Math.max(e,Math.min(t.length,i))]}function Me(t,e,i=!0,n=!0){return ae(t,e,i,n)}function Ce(t,e){let i=t.charCodeAt(e);if(!((n=i)>=55296&&n<56320&&e+1!=t.length))return i;var n;let s=t.charCodeAt(e+1);return function(t){return t>=56320&&t<57344}(s)?s-56320+(i-55296<<10)+65536:i}function Ae(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function Te(t){return t<65536?1:2}const Pe=/\r\n?|\n/;var De=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(De||(De={}));class Ee{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let s=this.sections[e++],o=this.sections[e++];o<0?(t(i,n,s),n+=s):n+=o,i+=s}}iterChangedRanges(t,e=!1){Le(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new Ee(t)}composeDesc(t){return this.empty?t:t.empty?this:_e(this,t)}mapDesc(t,e=!1){return t.empty?this:$e(this,t,e)}mapPos(t,e=-1,i=De.Simple){let n=0,s=0;for(let o=0;o<this.sections.length;){let r=this.sections[o++],l=this.sections[o++],a=n+r;if(l<0){if(a>t)return s+(t-n);s+=r}else{if(i!=De.Simple&&a>=t&&(i==De.TrackDel&&n<t&&a>t||i==De.TrackBefore&&n<t||i==De.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!r)return t==n||e<0?s:s+l;s+=l}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return s}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let s=n+this.sections[i++];if(this.sections[i++]>=0&&n<=e&&s>=t)return!(n<t&&s>e)||"cover";n=s}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some((t=>"number"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ee(t)}static create(t){return new Ee(t)}}class Re extends Ee{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return Le(this,((e,i,n,s,o)=>t=t.replace(n,n+(i-e),o)),!1),t}mapDesc(t,e=!1){return $e(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,s=0;n<e.length;n+=2){let o=e[n],r=e[n+1];if(r>=0){e[n]=r,e[n+1]=o;let l=n>>1;for(;i.length<l;)i.push(ge.empty);i.push(o?t.slice(s,s+o):ge.empty)}s+=o}return new Re(e,i)}compose(t){return this.empty?t:t.empty?this:_e(this,t,!0)}map(t,e=!1){return t.empty?this:$e(this,t,e,!0)}iterChanges(t,e=!1){Le(this,t,e)}get desc(){return Ee.create(this.sections)}filter(t){let e=[],i=[],n=[],s=new Ve(this);t:for(let o=0,r=0;;){let l=o==t.length?1e9:t[o++];for(;r<l||r==l&&0==s.len;){if(s.done)break t;let t=Math.min(s.len,l-r);Qe(n,t,-1);let o=-1==s.ins?-1:0==s.off?s.ins:0;Qe(e,t,o),o>0&&Be(i,e,s.text),s.forward(t),r+=t}let a=t[o++];for(;r<a;){if(s.done)break t;let t=Math.min(s.len,a-r);Qe(e,t,-1),Qe(n,t,-1==s.ins?-1:0==s.off?s.ins:0),s.forward(t),r+=t}}return{changes:new Re(e,i),filtered:Ee.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):0==n?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],s=[],o=0,r=null;function l(t=!1){if(!t&&!n.length)return;o<e&&Qe(n,e-o,-1);let i=new Re(n,s);r=r?r.compose(i.map(r)):i,n=[],s=[],o=0}return function t(a){if(Array.isArray(a))for(let e of a)t(e);else if(a instanceof Re){if(a.length!=e)throw new RangeError(`Mismatched change set length (got ${a.length}, expected ${e})`);l(),r=r?r.compose(a.map(r)):a}else{let{from:t,to:r=t,insert:h}=a;if(t>r||t<0||r>e)throw new RangeError(`Invalid change range ${t} to ${r} (in doc of length ${e})`);let c=h?"string"==typeof h?ge.of(h.split(i||Pe)):h:ge.empty,d=c.length;if(t==r&&0==d)return;t<o&&l(),t>o&&Qe(n,t-o,-1),Qe(n,r-t,d),Be(s,n,c),o=r}}(t),l(!r),r}static empty(t){return new Re(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let s=t[n];if("number"==typeof s)e.push(s,-1);else{if(!Array.isArray(s)||"number"!=typeof s[0]||s.some(((t,e)=>e&&"string"!=typeof t)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==s.length)e.push(s[0],0);else{for(;i.length<n;)i.push(ge.empty);i[n]=ge.of(s.slice(1)),e.push(s[0],i[n].length)}}}return new Re(e,i)}static createSet(t,e){return new Re(t,e)}}function Qe(t,e,i,n=!1){if(0==e&&i<=0)return;let s=t.length-2;s>=0&&i<=0&&i==t[s+1]?t[s]+=e:s>=0&&0==e&&0==t[s]?t[s+1]+=i:n?(t[s]+=e,t[s+1]+=i):t.push(e,i)}function Be(t,e,i){if(0==i.length)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(i);else{for(;t.length<n;)t.push(ge.empty);t.push(i)}}function Le(t,e,i){let n=t.inserted;for(let s=0,o=0,r=0;r<t.sections.length;){let l=t.sections[r++],a=t.sections[r++];if(a<0)s+=l,o+=l;else{let h=s,c=o,d=ge.empty;for(;h+=l,c+=a,a&&n&&(d=d.append(n[r-2>>1])),!(i||r==t.sections.length||t.sections[r+1]<0);)l=t.sections[r++],a=t.sections[r++];e(s,h,o,c,d),s=h,o=c}}}function $e(t,e,i,n=!1){let s=[],o=n?[]:null,r=new Ve(t),l=new Ve(e);for(let t=-1;;){if(r.done&&l.len||l.done&&r.len)throw new Error("Mismatched change set lengths");if(-1==r.ins&&-1==l.ins){let t=Math.min(r.len,l.len);Qe(s,t,-1),r.forward(t),l.forward(t)}else if(l.ins>=0&&(r.ins<0||t==r.i||0==r.off&&(l.len<r.len||l.len==r.len&&!i))){let e=l.len;for(Qe(s,l.ins,-1);e;){let i=Math.min(r.len,e);r.ins>=0&&t<r.i&&r.len<=i&&(Qe(s,0,r.ins),o&&Be(o,s,r.text),t=r.i),r.forward(i),e-=i}l.next()}else{if(!(r.ins>=0)){if(r.done&&l.done)return o?Re.createSet(s,o):Ee.create(s);throw new Error("Mismatched change set lengths")}{let e=0,i=r.len;for(;i;)if(-1==l.ins){let t=Math.min(i,l.len);e+=t,i-=t,l.forward(t)}else{if(!(0==l.ins&&l.len<i))break;i-=l.len,l.next()}Qe(s,e,t<r.i?r.ins:0),o&&t<r.i&&Be(o,s,r.text),t=r.i,r.forward(r.len-i)}}}}function _e(t,e,i=!1){let n=[],s=i?[]:null,o=new Ve(t),r=new Ve(e);for(let t=!1;;){if(o.done&&r.done)return s?Re.createSet(n,s):Ee.create(n);if(0==o.ins)Qe(n,o.len,0,t),o.next();else if(0!=r.len||r.done){if(o.done||r.done)throw new Error("Mismatched change set lengths");{let e=Math.min(o.len2,r.len),i=n.length;if(-1==o.ins){let i=-1==r.ins?-1:r.off?0:r.ins;Qe(n,e,i,t),s&&i&&Be(s,n,r.text)}else-1==r.ins?(Qe(n,o.off?0:o.len,e,t),s&&Be(s,n,o.textBit(e))):(Qe(n,o.off?0:o.len,r.off?0:r.ins,t),s&&!r.off&&Be(s,n,r.text));t=(o.ins>e||r.ins>=0&&r.len>e)&&(t||n.length>i),o.forward2(e),r.forward(e)}}else Qe(n,0,r.ins,t),s&&Be(s,n,r.text),r.next()}}class Ve{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?ge.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?ge.empty:e[i].slice(this.off,null==t?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){-1==this.ins?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class Ne{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let t=7&this.flags;return 7==t?null:t}get goalColumn(){let t=this.flags>>6;return 16777215==t?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new Ne(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return We.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return We.range(this.anchor,i)}eq(t,e=!1){return!(this.anchor!=t.anchor||this.head!=t.head||e&&this.empty&&this.assoc!=t.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||"number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid JSON representation for SelectionRange");return We.range(t.anchor,t.head)}static create(t,e,i){return new Ne(t,e,i)}}class We{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:We.create(this.ranges.map((i=>i.map(t,e))),this.mainIndex)}eq(t,e=!1){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let i=0;i<this.ranges.length;i++)if(!this.ranges[i].eq(t.ranges[i],e))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new We([this.main],0)}addRange(t,e=!0){return We.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,We.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((t=>t.toJSON())),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||"number"!=typeof t.main||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new We(t.ranges.map((t=>Ne.fromJSON(t))),t.main)}static single(t,e=t){return new We([We.range(t,e)],0)}static create(t,e=0){if(0==t.length)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let s=t[n];if(s.empty?s.from<=i:s.from<i)return We.normalized(t.slice(),e);i=s.to}return new We(t,e)}static cursor(t,e=0,i,n){return Ne.create(t,t,(0==e?0:e<0?8:16)|(null==i?7:Math.min(6,i))|(null!=n?n:16777215)<<6)}static range(t,e,i,n){let s=(null!=i?i:16777215)<<6|(null==n?7:Math.min(6,n));return e<t?Ne.create(e,t,48|s):Ne.create(t,e,(e>t?8:0)|s)}static normalized(t,e=0){let i=t[e];t.sort(((t,e)=>t.from-e.from)),e=t.indexOf(i);for(let i=1;i<t.length;i++){let n=t[i],s=t[i-1];if(n.empty?n.from<=s.to:n.from<s.to){let o=s.from,r=Math.max(n.to,s.to);i<=e&&e--,t.splice(--i,2,n.anchor>n.head?We.range(r,o):We.range(o,r))}}return new We(t,e)}}function He(t,e){for(let i of t.ranges)if(i.to>e)throw new RangeError("Selection points outside of document")}let qe=0;class Fe{constructor(t,e,i,n,s){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=qe++,this.default=t([]),this.extensions="function"==typeof s?s(this):s}get reader(){return this}static define(t={}){return new Fe(t.combine||(t=>t),t.compareInput||((t,e)=>t===e),t.compare||(t.combine?(t,e)=>t===e:ze),!!t.static,t.enables)}of(t){return new Ie([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ie(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ie(t,this,2,e)}from(t,e){return e||(e=t=>t),this.compute([t],(i=>e(i.field(t))))}}function ze(t,e){return t==e||t.length==e.length&&t.every(((t,i)=>t===e[i]))}class Ie{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=qe++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,s=this.id,o=t[s]>>1,r=2==this.type,l=!1,a=!1,h=[];for(let i of this.dependencies)"doc"==i?l=!0:"selection"==i?a=!0:1&(null!==(e=t[i.id])&&void 0!==e?e:1)||h.push(t[i.id]);return{create(t){return t.values[o]=i(t),1},update(t,e){if(l&&e.docChanged||a&&(e.docChanged||e.selection)||Xe(t,h)){let e=i(t);if(r?!Ze(e,t.values[o],n):!n(e,t.values[o]))return t.values[o]=e,1}return 0},reconfigure:(t,e)=>{let l,a=e.config.address[s];if(null!=a){let s=si(e,a);if(this.dependencies.every((i=>i instanceof Fe?e.facet(i)===t.facet(i):!(i instanceof Ue)||e.field(i,!1)==t.field(i,!1)))||(r?Ze(l=i(t),s,n):n(l=i(t),s)))return t.values[o]=s,0}else l=i(t);return t.values[o]=l,1}}}}function Ze(t,e,i){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0}function Xe(t,e){let i=!1;for(let n of e)1&ni(t,n)&&(i=!0);return i}function je(t,e,i){let n=i.map((e=>t[e.id])),s=i.map((t=>t.type)),o=n.filter((t=>!(1&t))),r=t[e.id]>>1;function l(t){let i=[];for(let e=0;e<n.length;e++){let o=si(t,n[e]);if(2==s[e])for(let t of o)i.push(t);else i.push(o)}return e.combine(i)}return{create(t){for(let e of n)ni(t,e);return t.values[r]=l(t),1},update(t,i){if(!Xe(t,o))return 0;let n=l(t);return e.compare(n,t.values[r])?0:(t.values[r]=n,1)},reconfigure(t,s){let o=Xe(t,n),a=s.config.facets[e.id],h=s.facet(e);if(a&&!o&&ze(i,a))return t.values[r]=h,0;let c=l(t);return e.compare(c,h)?(t.values[r]=h,0):(t.values[r]=c,1)}}}const Ye=Fe.define({static:!0});class Ue{constructor(t,e,i,n,s){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=s,this.provides=void 0}static define(t){let e=new Ue(qe++,t.create,t.update,t.compare||((t,e)=>t===e),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(Ye).find((t=>t.field==this));return((null==e?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:t=>(t.values[e]=this.create(t),1),update:(t,i)=>{let n=t.values[e],s=this.updateF(n,i);return this.compareF(n,s)?0:(t.values[e]=s,1)},reconfigure:(t,i)=>{let n,s=t.facet(Ye),o=i.facet(Ye);return(n=s.find((t=>t.field==this)))&&n!=o.find((t=>t.field==this))?(t.values[e]=n.create(t),1):null!=i.config.address[this.id]?(t.values[e]=i.field(this),0):(t.values[e]=this.create(t),1)}}}init(t){return[this,Ye.of({field:this,create:t})]}get extension(){return this}}function Ke(t){return e=>new Je(e,t)}const Ge={highest:Ke(0),high:Ke(1),default:Ke(2),low:Ke(3),lowest:Ke(4)};class Je{constructor(t,e){this.inner=t,this.prec=e}}class ti{of(t){return new ei(this,t)}reconfigure(t){return ti.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class ei{constructor(t,e){this.compartment=t,this.inner=e}}class ii{constructor(t,e,i,n,s,o){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return null==e?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],s=Object.create(null),o=new Map;for(let i of function(t,e,i){let n=[[],[],[],[],[]],s=new Map;return function t(o,r){let l=s.get(o);if(null!=l){if(l<=r)return;let t=n[l].indexOf(o);t>-1&&n[l].splice(t,1),o instanceof ei&&i.delete(o.compartment)}if(s.set(o,r),Array.isArray(o))for(let e of o)t(e,r);else if(o instanceof ei){if(i.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let n=e.get(o.compartment)||o.inner;i.set(o.compartment,n),t(n,r)}else if(o instanceof Je)t(o.inner,o.prec);else if(o instanceof Ue)n[r].push(o),o.provides&&t(o.provides,r);else if(o instanceof Ie)n[r].push(o),o.facet.extensions&&t(o.facet.extensions,2);else{let e=o.extension;if(!e)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);t(e,r)}}(t,2),n.reduce(((t,e)=>t.concat(e)))}(t,e,o))i instanceof Ue?n.push(i):(s[i.facet.id]||(s[i.facet.id]=[])).push(i);let r=Object.create(null),l=[],a=[];for(let t of n)r[t.id]=a.length<<1,a.push((e=>t.slot(e)));let h=null==i?void 0:i.config.facets;for(let t in s){let e=s[t],n=e[0].facet,o=h&&h[t]||[];if(e.every((t=>0==t.type)))if(r[n.id]=l.length<<1|1,ze(o,e))l.push(i.facet(n));else{let t=n.combine(e.map((t=>t.value)));l.push(i&&n.compare(t,i.facet(n))?i.facet(n):t)}else{for(let t of e)0==t.type?(r[t.id]=l.length<<1|1,l.push(t.value)):(r[t.id]=a.length<<1,a.push((e=>t.dynamicSlot(e))));r[n.id]=a.length<<1,a.push((t=>je(t,n,e)))}}let c=a.map((t=>t(r)));return new ii(t,o,c,r,l,s)}}function ni(t,e){if(1&e)return 2;let i=e>>1,n=t.status[i];if(4==n)throw new Error("Cyclic dependency between fields and/or facets");if(2&n)return n;t.status[i]=4;let s=t.computeSlot(t,t.config.dynamicSlots[i]);return t.status[i]=2|s}function si(t,e){return 1&e?t.config.staticValues[e>>1]:t.values[e>>1]}const oi=Fe.define(),ri=Fe.define({combine:t=>t.some((t=>t)),static:!0}),li=Fe.define({combine:t=>t.length?t[0]:void 0,static:!0}),ai=Fe.define(),hi=Fe.define(),ci=Fe.define(),di=Fe.define({combine:t=>!!t.length&&t[0]});class ui{constructor(t,e){this.type=t,this.value=e}static define(){return new fi}}class fi{of(t){return new ui(this,t)}}class pi{constructor(t){this.map=t}of(t){return new gi(this,t)}}class gi{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return void 0===e?void 0:e==this.value?this:new gi(this.type,e)}is(t){return this.type==t}static define(t={}){return new pi(t.map||(t=>t))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let t=n.map(e);t&&i.push(t)}return i}}gi.reconfigure=gi.define(),gi.appendConfig=gi.define();class mi{constructor(t,e,i,n,s,o){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,i&&He(i,e.newLength),s.some((t=>t.type==mi.time))||(this.annotations=s.concat(mi.time.of(Date.now())))}static create(t,e,i,n,s,o){return new mi(t,e,i,n,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(mi.userEvent);return!(!e||!(e==t||e.length>t.length&&e.slice(0,t.length)==t&&"."==e[t.length]))}}function Oi(t,e){let i=[];for(let n=0,s=0;;){let o,r;if(n<t.length&&(s==e.length||e[s]>=t[n]))o=t[n++],r=t[n++];else{if(!(s<e.length))return i;o=e[s++],r=e[s++]}!i.length||i[i.length-1]<o?i.push(o,r):i[i.length-1]<r&&(i[i.length-1]=r)}}function vi(t,e,i){var n;let s,o,r;return i?(s=e.changes,o=Re.empty(e.changes.length),r=t.changes.compose(e.changes)):(s=e.changes.map(t.changes),o=t.changes.mapDesc(e.changes,!0),r=t.changes.compose(s)),{changes:r,selection:e.selection?e.selection.map(o):null===(n=t.selection)||void 0===n?void 0:n.map(s),effects:gi.mapEffects(t.effects,s).concat(gi.mapEffects(e.effects,o)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function wi(t,e,i){let n=e.selection,s=Si(e.annotations);return e.userEvent&&(s=s.concat(mi.userEvent.of(e.userEvent))),{changes:e.changes instanceof Re?e.changes:Re.of(e.changes||[],i,t.facet(li)),selection:n&&(n instanceof We?n:We.single(n.anchor,n.head)),effects:Si(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function bi(t,e,i){let n=wi(t,e.length?e[0]:{},t.doc.length);e.length&&!1===e[0].filter&&(i=!1);for(let s=1;s<e.length;s++){!1===e[s].filter&&(i=!1);let o=!!e[s].sequential;n=vi(n,wi(t,e[s],o?n.changes.newLength:t.doc.length),o)}let s=mi.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return function(t){let e=t.startState,i=e.facet(ci),n=t;for(let s=i.length-1;s>=0;s--){let o=i[s](t);o&&Object.keys(o).length&&(n=vi(n,wi(e,o,t.changes.newLength),!0))}return n==t?t:mi.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}(i?function(t){let e=t.startState,i=!0;for(let n of e.facet(ai)){let e=n(t);if(!1===e){i=!1;break}Array.isArray(e)&&(i=!0===i?e:Oi(i,e))}if(!0!==i){let n,s;if(!1===i)s=t.changes.invertedDesc,n=Re.empty(e.doc.length);else{let e=t.changes.filter(i);n=e.changes,s=e.filtered.mapDesc(e.changes).invertedDesc}t=mi.create(e,n,t.selection&&t.selection.map(s),gi.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let n=e.facet(hi);for(let i=n.length-1;i>=0;i--){let s=n[i](t);t=s instanceof mi?s:Array.isArray(s)&&1==s.length&&s[0]instanceof mi?s[0]:bi(e,Si(s),!1)}return t}(s):s)}mi.time=ui.define(),mi.userEvent=ui.define(),mi.addToHistory=ui.define(),mi.remote=ui.define();const yi=[];function Si(t){return null==t?yi:Array.isArray(t)?t:[t]}var xi=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(xi||(xi={}));const ki=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Mi;try{Mi=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(t){}class Ci{constructor(t,e,i,n,s,o){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let t=0;t<this.config.dynamicSlots.length;t++)ni(this,t<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(null!=i)return ni(this,i),si(this,i);if(e)throw new RangeError("Field is not present in this state")}update(...t){return bi(this,t,!0)}applyTransaction(t){let e,i=this.config,{base:n,compartments:s}=i;for(let e of t.effects)e.is(ti.reconfigure)?(i&&(s=new Map,i.compartments.forEach(((t,e)=>s.set(e,t))),i=null),s.set(e.value.compartment,e.value.extension)):e.is(gi.reconfigure)?(i=null,n=e.value):e.is(gi.appendConfig)&&(i=null,n=Si(n).concat(e.value));i?e=t.startState.values.slice():(i=ii.resolve(n,s,this),e=new Ci(i,this.doc,this.selection,i.dynamicSlots.map((()=>null)),((t,e)=>e.reconfigure(t,this)),null).values);let o=t.startState.facet(ri)?t.newSelection:t.newSelection.asSingle();new Ci(i,t.newDoc,o,e,((e,i)=>i.update(e,t)),t)}replaceSelection(t){return"string"==typeof t&&(t=this.toText(t)),this.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:t},range:We.cursor(e.from+t.length)})))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),s=[i.range],o=Si(i.effects);for(let i=1;i<e.ranges.length;i++){let r=t(e.ranges[i]),l=this.changes(r.changes),a=l.map(n);for(let t=0;t<i;t++)s[t]=s[t].map(a);let h=n.mapDesc(l,!0);s.push(r.range.map(h)),n=n.compose(a),o=gi.mapEffects(o,a).concat(gi.mapEffects(Si(r.effects),h))}return{changes:n,selection:We.create(s,e.mainIndex),effects:o}}changes(t=[]){return t instanceof Re?t:Re.of(t,this.doc.length,this.facet(Ci.lineSeparator))}toText(t){return ge.of(t.split(this.facet(Ci.lineSeparator)||Pe))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return null==e?t.default:(ni(this,e),si(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof Ue&&null!=this.config.address[n.id]&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||"string"!=typeof t.doc)throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i)for(let e in i)if(Object.prototype.hasOwnProperty.call(t,e)){let s=i[e],o=t[e];n.push(s.init((t=>s.spec.fromJSON(o,t))))}return Ci.create({doc:t.doc,selection:We.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=ii.resolve(t.extensions||[],new Map),i=t.doc instanceof ge?t.doc:ge.of((t.doc||"").split(e.staticFacet(Ci.lineSeparator)||Pe)),n=t.selection?t.selection instanceof We?t.selection:We.single(t.selection.anchor,t.selection.head):We.single(0);return He(n,i.length),e.staticFacet(ri)||(n=n.asSingle()),new Ci(e,i,n,e.dynamicSlots.map((()=>null)),((t,e)=>e.create(t)),null)}get tabSize(){return this.facet(Ci.tabSize)}get lineBreak(){return this.facet(Ci.lineSeparator)||"\n"}get readOnly(){return this.facet(di)}phrase(t,...e){for(let e of this.facet(Ci.phrases))if(Object.prototype.hasOwnProperty.call(e,t)){t=e[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,((t,i)=>{if("$"==i)return"$";let n=+(i||1);return!n||n>e.length?t:e[n-1]}))),t}languageDataAt(t,e,i=-1){let n=[];for(let s of this.facet(oi))for(let o of s(this,e,i))Object.prototype.hasOwnProperty.call(o,t)&&n.push(o[t]);return n}charCategorizer(t){return e=this.languageDataAt("wordChars",t).join(""),t=>{if(!/\S/.test(t))return xi.Space;if(function(t){if(Mi)return Mi.test(t);for(let e=0;e<t.length;e++){let i=t[e];if(/\w/.test(i)||i>""&&(i.toUpperCase()!=i.toLowerCase()||ki.test(i)))return!0}return!1}(t))return xi.Word;for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return xi.Word;return xi.Other};var e}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),s=this.charCategorizer(t),o=t-i,r=t-i;for(;o>0;){let t=Me(e,o,!1);if(s(e.slice(t,o))!=xi.Word)break;o=t}for(;r<n;){let t=Me(e,r);if(s(e.slice(r,t))!=xi.Word)break;r=t}return o==r?null:We.range(o+i,r+i)}}function Ai(t,e,i={}){let n={};for(let e of t)for(let t of Object.keys(e)){let s=e[t],o=n[t];if(void 0===o)n[t]=s;else if(o===s||void 0===s);else{if(!Object.hasOwnProperty.call(i,t))throw new Error("Config merge conflict for field "+t);n[t]=i[t](o,s)}}for(let t in e)void 0===n[t]&&(n[t]=e[t]);return n}Ci.allowMultipleSelections=ri,Ci.tabSize=Fe.define({combine:t=>t.length?t[0]:4}),Ci.lineSeparator=li,Ci.readOnly=di,Ci.phrases=Fe.define({compare(t,e){let i=Object.keys(t),n=Object.keys(e);return i.length==n.length&&i.every((i=>t[i]==e[i]))}}),Ci.languageData=oi,Ci.changeFilter=ai,Ci.transactionFilter=hi,Ci.transactionExtender=ci,ti.reconfigure=gi.define();class Ti{eq(t){return this==t}range(t,e=t){return Pi.create(t,e,this)}}Ti.prototype.startSide=Ti.prototype.endSide=0,Ti.prototype.point=!1,Ti.prototype.mapMode=De.TrackDel;class Pi{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new Pi(t,e,i)}}function Di(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class Ei{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let s=i?this.to:this.from;for(let o=n,r=s.length;;){if(o==r)return o;let n=o+r>>1,l=s[n]-t||(i?this.value[n].endSide:this.value[n].startSide)-e;if(n==o)return l>=0?o:r;l>=0?r=n:o=n+1}}between(t,e,i,n){for(let s=this.findIndex(e,-1e9,!0),o=this.findIndex(i,1e9,!1,s);s<o;s++)if(!1===n(this.from[s]+t,this.to[s]+t,this.value[s]))return!1}map(t,e){let i=[],n=[],s=[],o=-1,r=-1;for(let l=0;l<this.value.length;l++){let a,h,c=this.value[l],d=this.from[l]+t,u=this.to[l]+t;if(d==u){let t=e.mapPos(d,c.startSide,c.mapMode);if(null==t)continue;if(a=h=t,c.startSide!=c.endSide&&(h=e.mapPos(d,c.endSide),h<a))continue}else if(a=e.mapPos(d,c.startSide),h=e.mapPos(u,c.endSide),a>h||a==h&&c.startSide>0&&c.endSide<=0)continue;(h-a||c.endSide-c.startSide)<0||(o<0&&(o=a),c.point&&(r=Math.max(r,h-a)),i.push(c),n.push(a-o),s.push(h-o))}return{mapped:i.length?new Ei(n,s,i,r):null,pos:o}}}class Ri{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new Ri(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:s=this.length}=t,o=t.filter;if(0==e.length&&!o)return this;if(i&&(e=e.slice().sort(Di)),this.isEmpty)return e.length?Ri.of(e):this;let r=new Li(this,null,-1).goto(0),l=0,a=[],h=new Qi;for(;r.value||l<e.length;)if(l<e.length&&(r.from-e[l].from||r.startSide-e[l].value.startSide)>=0){let t=e[l++];h.addInner(t.from,t.to,t.value)||a.push(t)}else 1==r.rangeIndex&&r.chunkIndex<this.chunk.length&&(l==e.length||this.chunkEnd(r.chunkIndex)<e[l].from)&&(!o||n>this.chunkEnd(r.chunkIndex)||s<this.chunkPos[r.chunkIndex])&&h.addChunk(this.chunkPos[r.chunkIndex],this.chunk[r.chunkIndex])?r.nextChunk():((!o||n>r.to||s<r.from||o(r.from,r.to,r.value))&&(h.addInner(r.from,r.to,r.value)||a.push(Pi.create(r.from,r.to,r.value))),r.next());return h.finishInner(this.nextLayer.isEmpty&&!a.length?Ri.empty:this.nextLayer.update({add:a,filter:o,filterFrom:n,filterTo:s}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let s=0;s<this.chunk.length;s++){let o=this.chunkPos[s],r=this.chunk[s],l=t.touchesRange(o,o+r.length);if(!1===l)n=Math.max(n,r.maxPoint),e.push(r),i.push(t.mapPos(o));else if(!0===l){let{mapped:s,pos:l}=r.map(o,t);s&&(n=Math.max(n,s.maxPoint),e.push(s),i.push(l))}}let s=this.nextLayer.map(t);return 0==e.length?s:new Ri(i,e,s||Ri.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let s=this.chunkPos[n],o=this.chunk[n];if(e>=s&&t<=s+o.length&&!1===o.between(s,t-s,e-s,i))return}this.nextLayer.between(t,e,i)}}iter(t=0){return $i.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return $i.from(t).goto(e)}static compare(t,e,i,n,s=-1){let o=t.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=s)),r=e.filter((t=>t.maxPoint>0||!t.isEmpty&&t.maxPoint>=s)),l=Bi(o,r,i),a=new Vi(o,l,s),h=new Vi(r,l,s);i.iterGaps(((t,e,i)=>Ni(a,t,h,e,i,n))),i.empty&&0==i.length&&Ni(a,0,h,0,0,n)}static eq(t,e,i=0,n){null==n&&(n=999999999);let s=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0)),o=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0));if(s.length!=o.length)return!1;if(!s.length)return!0;let r=Bi(s,o),l=new Vi(s,r,0).goto(i),a=new Vi(o,r,0).goto(i);for(;;){if(l.to!=a.to||!Wi(l.active,a.active)||l.point&&(!a.point||!l.point.eq(a.point)))return!1;if(l.to>n)return!0;l.next(),a.next()}}static spans(t,e,i,n,s=-1){let o=new Vi(t,null,s).goto(e),r=e,l=o.openStart;for(;;){let t=Math.min(o.to,i);if(o.point){let i=o.activeForPoint(o.to),s=o.pointFrom<e?i.length+1:o.point.startSide<0?i.length:Math.min(i.length,l);n.point(r,t,o.point,i,s,o.pointRank),l=Math.min(o.openEnd(t),i.length)}else t>r&&(n.span(r,t,o.active,l),l=o.openEnd(t));if(o.to>i)return l+(o.point&&o.to>i?1:0);r=o.to,o.next()}}static of(t,e=!1){let i=new Qi;for(let n of t instanceof Pi?[t]:e?function(t){if(t.length>1)for(let e=t[0],i=1;i<t.length;i++){let n=t[i];if(Di(e,n)>0)return t.slice().sort(Di);e=n}return t}(t):t)i.add(n.from,n.to,n.value);return i.finish()}static join(t){if(!t.length)return Ri.empty;let e=t[t.length-1];for(let i=t.length-2;i>=0;i--)for(let n=t[i];n!=Ri.empty;n=n.nextLayer)e=new Ri(n.chunkPos,n.chunk,e,Math.max(n.maxPoint,e.maxPoint));return e}}Ri.empty=new Ri([],[],null,-1),Ri.empty.nextLayer=Ri.empty;class Qi{finishChunk(t){this.chunks.push(new Ei(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new Qi)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(n<0||(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),0))}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(Ri.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return t;let e=Ri.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function Bi(t,e,i){let n=new Map;for(let e of t)for(let t=0;t<e.chunk.length;t++)e.chunk[t].maxPoint<=0&&n.set(e.chunk[t],e.chunkPos[t]);let s=new Set;for(let t of e)for(let e=0;e<t.chunk.length;e++){let o=n.get(t.chunk[e]);null==o||(i?i.mapPos(o):o)!=t.chunkPos[e]||(null==i?void 0:i.touchesRange(o,o+t.chunk[e].length))||s.add(t.chunk[e])}return s}class Li{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let e=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(e)||this.layer.chunkEnd(this.chunkIndex)<t||e.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class $i{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let s=0;s<t.length;s++)for(let o=t[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=i&&n.push(new Li(o,e,i,s));return 1==n.length?n[0]:new $i(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let t=this.heap.length>>1;t>=0;t--)_i(this.heap,t);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let t=this.heap.length>>1;t>=0;t--)_i(this.heap,t);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),_i(this.heap,0)}}}function _i(t,e){for(let i=t[e];;){let n=1+(e<<1);if(n>=t.length)break;let s=t[n];if(n+1<t.length&&s.compare(t[n+1])>=0&&(s=t[n+1],n++),i.compare(s)<0)break;t[n]=i,t[e]=s,e=n}}class Vi{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=$i.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Hi(this.active,t),Hi(this.activeTo,t),Hi(this.activeRank,t),this.minActive=Fi(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:s}=this.cursor;for(;e<this.activeRank.length&&(s-this.activeRank[e]||n-this.activeTo[e])>0;)e++;qi(this.active,e,i),qi(this.activeTo,e,n),qi(this.activeRank,e,s),t&&qi(t,e,this.cursor.from),this.minActive=Fi(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&Hi(i,n)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let t=this.cursor.value;if(t.point){if(!(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=t,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=t.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(i),this.cursor.next()}}}if(i){this.openStart=0;for(let e=i.length-1;e>=0&&i[e]<t;e--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function Ni(t,e,i,n,s,o){t.goto(e),i.goto(n);let r=n+s,l=n,a=n-e;for(;;){let e=t.to+a-i.to,n=e||t.endSide-i.endSide,s=n<0?t.to+a:i.to,h=Math.min(s,r);if(t.point||i.point?t.point&&i.point&&(t.point==i.point||t.point.eq(i.point))&&Wi(t.activeForPoint(t.to),i.activeForPoint(i.to))||o.comparePoint(l,h,t.point,i.point):h>l&&!Wi(t.active,i.active)&&o.compareRange(l,h,t.active,i.active),s>r)break;(e||t.openEnd!=i.openEnd)&&o.boundChange&&o.boundChange(s),l=s,n<=0&&t.next(),n>=0&&i.next()}}function Wi(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!=e[i]&&!t[i].eq(e[i]))return!1;return!0}function Hi(t,e){for(let i=e,n=t.length-1;i<n;i++)t[i]=t[i+1];t.pop()}function qi(t,e,i){for(let i=t.length-1;i>=e;i--)t[i+1]=t[i];t[e]=i}function Fi(t,e){let i=-1,n=1e9;for(let s=0;s<e.length;s++)(e[s]-n||t[s].endSide-t[i].endSide)<0&&(i=s,n=e[s]);return i}function zi(t,e,i=t.length){let n=0;for(let s=0;s<i&&s<t.length;)9==t.charCodeAt(s)?(n+=e-n%e,s++):(n++,s=Me(t,s));return n}function Ii(t,e,i,n){for(let n=0,s=0;;){if(s>=e)return n;if(n==t.length)break;s+=9==t.charCodeAt(n)?i-s%i:1,n=Me(t,n)}return!0===n?-1:t.length}const Zi="undefined"==typeof Symbol?"__ͼ":Symbol.for("ͼ"),Xi="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),ji="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class Yi{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}function s(t,e,o,r){let l=[],a=/^@(\w+)\b/.exec(t[0]),h=a&&"keyframes"==a[1];if(a&&null==e)return o.push(t[0]+";");for(let i in e){let r=e[i];if(/&/.test(i))s(i.split(/,\s*/).map((e=>t.map((t=>e.replace(/&/,t))))).reduce(((t,e)=>t.concat(e))),r,o);else if(r&&"object"==typeof r){if(!a)throw new RangeError("The value of a property ("+i+") should be a primitive value.");s(n(i),r,l,h)}else null!=r&&l.push(i.replace(/_.*/,"").replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))+": "+r+";")}(l.length||h)&&o.push((!i||a||r?t:t.map(i)).join(", ")+" {"+l.join(" ")+"}")}for(let e in t)s(n(e),t[e],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let t=ji[Zi]||1;return ji[Zi]=t+1,"ͼ"+t.toString(36)}static mount(t,e,i){let n=t[Xi],s=i&&i.nonce;n?s&&n.setNonce(s):n=new Ki(t,s),n.mount(Array.isArray(e)?e:[e],t)}}let Ui=new Map;class Ki{constructor(t,e){let i=t.ownerDocument||t,n=i.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let e=Ui.get(i);if(e)return t[Xi]=e;this.sheet=new n.CSSStyleSheet,Ui.set(i,this)}else this.styleTag=i.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[Xi]=this}mount(t,e){let i=this.sheet,n=0,s=0;for(let e=0;e<t.length;e++){let o=t[e],r=this.modules.indexOf(o);if(r<s&&r>-1&&(this.modules.splice(r,1),s--,r=-1),-1==r){if(this.modules.splice(s++,0,o),i)for(let t=0;t<o.rules.length;t++)i.insertRule(o.rules[t],n++)}else{for(;s<r;)n+=this.modules[s++].rules.length;n+=o.rules.length,s++}}if(i)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let t="";for(let e=0;e<this.modules.length;e++)t+=this.modules[e].getRules()+"\n";this.styleTag.textContent=t;let i=e.head||e;this.styleTag.parentNode!=i&&i.insertBefore(this.styleTag,i.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}for(var Gi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ji={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},tn="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),en="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),nn=0;nn<10;nn++)Gi[48+nn]=Gi[96+nn]=String(nn);for(nn=1;nn<=24;nn++)Gi[nn+111]="F"+nn;for(nn=65;nn<=90;nn++)Gi[nn]=String.fromCharCode(nn+32),Ji[nn]=String.fromCharCode(nn);for(var sn in Gi)Ji.hasOwnProperty(sn)||(Ji[sn]=Gi[sn]);function on(t){var e=!(tn&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||en&&t.shiftKey&&t.key&&1==t.key.length||"Unidentified"==t.key)&&t.key||(t.shiftKey?Ji:Gi)[t.keyCode]||t.key||"Unidentified";return"Esc"==e&&(e="Escape"),"Del"==e&&(e="Delete"),"Left"==e&&(e="ArrowLeft"),"Up"==e&&(e="ArrowUp"),"Right"==e&&(e="ArrowRight"),"Down"==e&&(e="ArrowDown"),e}function rn(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function ln(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function an(t,e){if(!e.anchorNode)return!1;try{return ln(t,e.anchorNode)}catch(t){return!1}}function hn(t){return 3==t.nodeType?Sn(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function cn(t,e,i,n){return!!i&&(fn(t,e,i,n,-1)||fn(t,e,i,n,1))}function dn(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function un(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function fn(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:pn(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=dn(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?pn(t):0}}}function pn(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function gn(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function mn(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function On(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}class vn{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?pn(e):0),i,Math.min(t.focusOffset,i?pn(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let wn,bn=null;function yn(t){if(t.setActive)return t.setActive();if(bn)return t.focus(bn);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==bn?{get preventScroll(){return bn={preventScroll:!0},!0}}:void 0),!bn){bn=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function Sn(t,e,i=e){let n=wn||(wn=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function xn(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function kn(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function Mn(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function Cn(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=pn(i)}else{if(!i.parentNode||un(i))return null;n=dn(i),i=i.parentNode}}}function An(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||un(i))return null;n=dn(i)+1,i=i.parentNode}}}class Tn{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Tn(t.parentNode,dn(t),e)}static after(t,e){return new Tn(t.parentNode,dn(t)+1,e)}}const Pn=[];class Dn{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=Dn.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=En(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=En(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==pn(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Dn.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=Pn){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Rn(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function En(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}Dn.prototype.breakAfter=0;class Rn{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Qn(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function Bn(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,Qn(t,h,c,l,a,n,0,s,o)}let Ln="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},$n="undefined"!=typeof document?document:{documentElement:{style:{}}};const _n=/Edge\/(\d+)/.exec(Ln.userAgent),Vn=/MSIE \d/.test(Ln.userAgent),Nn=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ln.userAgent),Wn=!!(Vn||Nn||_n),Hn=!Wn&&/gecko\/(\d+)/i.test(Ln.userAgent),qn=!Wn&&/Chrome\/(\d+)/.exec(Ln.userAgent),Fn="webkitFontSmoothing"in $n.documentElement.style,zn=!Wn&&/Apple Computer/.test(Ln.vendor),In=zn&&(/Mobile\/\w+/.test(Ln.userAgent)||Ln.maxTouchPoints>2);var Zn={mac:In||/Mac/.test(Ln.platform),windows:/Win/.test(Ln.platform),linux:/Linux|X11/.test(Ln.platform),ie:Wn,ie_version:Vn?$n.documentMode||6:Nn?+Nn[1]:_n?+_n[1]:0,gecko:Hn,gecko_version:Hn?+(/Firefox\/(\d+)/.exec(Ln.userAgent)||[0,0])[1]:0,chrome:!!qn,chrome_version:qn?+qn[1]:0,ios:In,android:/Android\b/.test(Ln.userAgent),webkit:Fn,safari:zn,webkit_version:Fn?+(/\bAppleWebKit\/(\d+)/.exec(Ln.userAgent)||[0,0])[1]:0,tabSize:null!=$n.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class Xn extends Dn{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof Xn)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new Xn(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Tn(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?Zn.chrome||Zn.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=Sn(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return Zn.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?gn(a,r<0):a||null}(this.dom,t,e)}}class jn extends Dn{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(kn(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof jn&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(Bn(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new jn(this.mark,e,o)}domAtPos(t){return Kn(this,t)}coordsAt(t,e){return Jn(this,t,e)}}class Yn extends Dn{static create(t,e,i){return new Yn(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=Yn.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof Yn&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof Yn&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?Tn.before(this.dom):Tn.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return gn(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Un extends Dn{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Un&&t.side==this.side}split(){return new Un(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Tn.before(this.dom):Tn.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function Kn(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new Tn(i,0)}function Gn(t,e,i){let n,{children:s}=t;i>0&&e instanceof jn&&s.length&&(n=s[s.length-1])instanceof jn&&n.mark.eq(e.mark)?Gn(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function Jn(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&(i>0||ts(o,c)))&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=hn(e);return i[i.length-1]||null}(t)}function ts(t,e){let i=t.coordsAt(0,1),n=e.coordsAt(0,1);return i&&n&&n.top<i.bottom}function es(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}Xn.prototype.children=Yn.prototype.children=Un.prototype.children=Pn;const is=Object.create(null);function ns(t,e,i){if(t==e)return!0;t||(t=is),e||(e=is);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function ss(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function os(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class rs{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var ls=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(ls||(ls={}));class as extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new hs(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new ds(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=us(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new ds(t,e,i,n,t.widget||null,!0)}static line(t){return new cs(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}as.none=Ri.empty;class hs extends as{constructor(t){let{start:e,end:i}=us(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof hs&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&ns(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}hs.prototype.point=!1;class cs extends as{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof cs&&this.spec.class==t.spec.class&&ns(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}cs.prototype.mapMode=De.TrackBefore,cs.prototype.point=!0;class ds extends as{constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?ls.WidgetRange:this.startSide<=0?ls.WidgetBefore:ls.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof ds&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function us(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function fs(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}ds.prototype.point=!0;class ps extends Dn{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof ps))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Bn(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new ps;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){ns(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Gn(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=es(e,this.attrs||{})),i&&(this.attrs=es({class:i},this.attrs||{}))}domAtPos(t){return Kn(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(kn(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(ss(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&Dn.get(n)instanceof jn;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=Dn.get(n))||void 0===i?void 0:i.isEditable)||Zn.ios&&this.children.some((t=>t instanceof Xn))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof Xn)||/[^ -~]/.test(i.text))return null;let n=hn(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=Jn(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof ps&&0==this.children.length&&0==t.children.length&&ns(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof ps)return s;if(o>e)break}n=o+s.breakAfter}return null}}class gs extends Dn{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof gs&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?Tn.before(this.dom):Tn.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new gs(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return Pn}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof gs&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof ms?null:gn(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class ms extends rs{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Os{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof gs&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new ps),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(vs(new Un(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof gs||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(vs(new Xn(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof ds){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof ds)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new gs(i.widget||ws.block,r,i));else{let o=Yn.create(i.widget||ws.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(vs(new Un(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(vs(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new Os(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function vs(t,e){for(let i of e)t=new jn(i,[t],t.length);return t}class ws extends rs{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}ws.inline=new ws("span"),ws.block=new ws("div");var bs=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(bs||(bs={}));const ys=bs.LTR,Ss=bs.RTL;function xs(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const ks=xs("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Ms=xs("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Cs=Object.create(null),As=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);Cs[e]=i,Cs[i]=-e}function Ts(t){return t<=247?ks[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?Ms[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const Ps=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Ds{get dir(){return this.level%2?Ss:ys}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function Es(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!Es(n.inner,s.inner))return!1}return!0}const Rs=[];function Qs(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=Rs[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if(Rs[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new Ds(a,p.from,u)),Bs(t,p.direction==ys!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?Rs[f]!=l:Rs[f]==l))break;f++}d?Qs(t,a,f,n+1,s,d,r):a<f&&r.push(new Ds(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=Rs[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if(Rs[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new Ds(p.to,a,u)),Bs(t,p.direction==ys!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?Rs[f-1]!=l:Rs[f-1]==l))break;f--}d?Qs(t,f,a,n+1,s,d,r):f<a&&r.push(new Ds(f,a,u)),a=f}}function Bs(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=Ts(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),Rs[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=Rs[t];if(128==s)t<l-1&&e==Rs[t+1]&&24&e?s=Rs[t]=e:Rs[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==Rs[s];)s++;let o=t&&8==e||s<i&&8==Rs[s]?1==n?1:8:256;for(let e=t;e<s;e++)Rs[e]=o;t=s-1}else 8==s&&1==n&&(Rs[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=Cs[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(As[t+1]==-i){let e=As[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&(Rs[r]=Rs[As[t]]=i),l=t;break}}else{if(189==As.length)break;As[l++]=r,As[l++]=e,As[l++]=a}else if(2==(n=Rs[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=As[e+2];if(2&i)break;if(t)As[e+2]|=2;else{if(4&i)break;As[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=Rs[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=Rs[r])break;r++}let h=1==o,c=h==(1==(r<e?Rs[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),Rs[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),Qs(t,s,o,e,i,n,r)}function Ls(t){return[new Ds(0,t,0)]}let $s="";function _s(t,e,i,n,s){var o;let r=n.head-t.from,l=Ds.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),$s=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function Vs(t,e,i){for(let n=e;n<i;n++){let e=Ts(t.charCodeAt(n));if(1==e)return ys;if(2==e||4==e)return Ss}return ys}const Ns=Fe.define(),Ws=Fe.define(),Hs=Fe.define(),qs=Fe.define(),Fs=Fe.define(),zs=Fe.define(),Is=Fe.define(),Zs=Fe.define(),Xs=Fe.define(),js=Fe.define({combine:t=>t.some((t=>t))}),Ys=Fe.define({combine:t=>t.some((t=>t))}),Us=Fe.define();class Ks{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new Ks(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Ks(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Gs=gi.define({map:(t,e)=>t.map(e)}),Js=gi.define();function to(t,e,i){let n=t.facet(qs);n.length?n[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const eo=Fe.define({combine:t=>!t.length||t[0]});let io=0;const no=Fe.define();class so{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new so(io++,t,i,n,(t=>{let e=[no.of(t)];return o&&e.push(ao.of((e=>{let i=e.plugin(t);return i?o(i):as.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return so.define((e=>new t(e)),e)}}class oo{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(to(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){to(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){to(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const ro=Fe.define(),lo=Fe.define(),ao=Fe.define(),ho=Fe.define(),co=Fe.define(),uo=Fe.define();function fo(t,e){let i=t.state.facet(uo);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=Vs(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const po=Fe.define();function go(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(po)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const mo=Fe.define();class Oo{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new Oo(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new Oo(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new Oo(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class vo{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new Oo(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new vo(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class wo extends Dn{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=as.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new ps],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Oo(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=bo(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new Oo(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=Dn.get(e);if(i instanceof jn)c.push({node:e,deco:i.mark});else{if(i instanceof ps||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new hs({inclusive:!0,attributes:os(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new Oo(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Zn.ie||Zn.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new yo;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=Oo.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=Zn.chrome||Zn.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof gs&&t.widget instanceof ms&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=Os.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=Os.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=Os.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);Qn(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(Js)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new Xn(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new jn(i,[e],e.length);let i=new ps;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=Dn.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(eo)||this.dom.tabIndex>-1)&&an(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if(Zn.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new Tn(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(cn(l.node,l.offset,c.anchorNode,c.anchorOffset)&&cn(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{Zn.android&&Zn.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=rn(this.view.root);if(t)if(r.empty){if(Zn.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?Cn:An)(l.node,l.offset);e&&(l=new Tn(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new Tn(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new Tn(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&cn(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=rn(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=ps.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=Dn.get(i.childNodes[n]);t instanceof ps&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=Dn.get(i.childNodes[n]);t instanceof ps&&(e=t.domAtPos(t.length))}return e?new Tn(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=Dn.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof ps)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof ps&&!(i instanceof ps&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof gs&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof ps))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof Xn))return null;let s=Me(n.text,i);if(s==i)return null;let o=Sn(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==bs.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?hn(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?bs.RTL:bs.LTR}measureTextSize(){for(let t of this.children)if(t instanceof ps){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=hn(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new Rn(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(as.replace({widget:new ms(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return as.set(t)}updateDeco(){let t=1,e=this.view.state.facet(ao).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(ho).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(Us))try{if(e(this.view,t.range,t))return!0}catch(t){to(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=go(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=mn(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=On(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==bs.LTR)}}function bo(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=Cn(i.focusNode,i.focusOffset),s=An(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=Dn.get(s.node);if(!e||e instanceof Xn&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=Dn.get(n.node);!t||t instanceof Xn&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let yo=class{constructor(){this.changes=[]}compareRange(t,e){fs(t,e,this.changes)}comparePoint(t,e){fs(t,e,this.changes)}boundChange(t){fs(t,t,this.changes)}};function So(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function xo(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function ko(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function Mo(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function Co(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function Ao(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=hn(u);for(let f=0;f<t.length;f++){let p=t[f];s&&ko(s,p)&&(p=Mo(Co(p,s.bottom),s.top));let g=So(e,p),m=xo(i,p);if(0==g&&0==m)return 3==u.nodeType?To(u,e,i):Ao(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&ko(h,p)?h=Co(h,p.bottom):c&&ko(c,p)&&(c=Mo(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?To(n,u,i):d&&"false"!=n.contentEditable?Ao(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function To(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=Sn(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if((Zn.chrome||Zn.gecko)&&Sn(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function Po(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=ls.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:Do(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:Do(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||Zn.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return Sn(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||Zn.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():Sn(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(pn(O),v))}if(!O||!t.docView.dom.contains(O)){let e=ps.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=Ao(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function Do(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function Eo(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=_s(s,o,r,l,i),h=$s;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function Ro(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function Qo(t,e,i){let n=Ro(t.state.facet(co).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const Bo="￿";class Lo{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Bo}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=Dn.get(n),r=Dn.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:un(n))||un(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=Dn.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+($o(t,i.node,i.offset)?e:0))}}function $o(t,e,i){for(;;){if(!e||i<pn(e))return!1;if(e==t)return!0;i=dn(e)+1,e=e.parentNode}}class _o{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Vo{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new _o(i,n)),s==i&&o==n||e.push(new _o(s,o))),e}(t),i=new Lo(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!ln(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!ln(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if((Zn.ios||Zn.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function No(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||Zn.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,Bo),e.text,l-n,a);h&&(Zn.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Bo+Bo&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(Bo))})}else n&&(!t.hasFocus&&t.state.facet(eo)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(Zn.mac||Zn.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:Zn.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return Wo(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function Wo(t,e,i,n=-1){if(Zn.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(Zn.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&xn(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&xn(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&xn(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&bo(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet(zs).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class Ho{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,Zn.safari&&t.contentDOM.addEventListener("input",(()=>null)),Zn.gecko&&function(t){pr.has(t)||(pr.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=Dn.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=Fo(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&Zo.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),Zn.android&&Zn.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!Zn.ios||t.synthetic||t.altKey||t.metaKey||!((e=zo.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||Io.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,xn(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(Zn.safari&&!Zn.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function qo(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){to(i.state,t)}}}function Fo(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(qo(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(qo(e.value,s))}}for(let t in Yo)i(t).handlers.push(Yo[t]);for(let t in Uo)i(t).observers.push(Uo[t]);return e}const zo=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Io="dthko",Zo=[16,17,18,20,91,92,224,225];function Xo(t){return.7*Math.max(0,t)+8}class jo{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(co).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(Ns);return i.length?i[0](e):Zn.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=rn(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=ar(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=go(this.view);t.clientX-h.left<=o+6?n=-Xo(o-t.clientX):t.clientX+h.right>=l-6&&(n=Xo(t.clientX-l)),t.clientY-h.top<=r+6?s=-Xo(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=Xo(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=Ro(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=Ro(this.atoms,n.from,-1),e=Ro(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const Yo=Object.create(null),Uo=Object.create(null),Ko=Zn.ie&&Zn.ie_version<15||Zn.ios&&Zn.webkit_version<604;function Go(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function Jo(t,e){e=Go(t.state,Zs,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=cr&&n.selection.ranges.every((t=>t.empty))&&cr==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function tr(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=ps.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}Uo.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},Yo.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),Uo.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},Uo.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},Yo.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(Hs))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=nr(t,e),n=ar(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=nr(t,e),h=tr(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=tr(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new jo(t,e,i,n)),n&&t.observer.ignore((()=>{yn(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let er=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function ir(t,e,i,n){let s=ps.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&er(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&er(i,n,l)?1:r&&r.bottom>=n?-1:1}function nr(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:ir(t,i,e.clientX,e.clientY)}}const sr=Zn.ie&&Zn.ie_version<=11;let or=null,rr=0,lr=0;function ar(t){if(!sr)return t.detail;let e=or,i=lr;return or=t,lr=Date.now(),rr=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(rr+1)%3:1}function hr(t,e,i,n){if(!(i=Go(t.state,Zs,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(Ws);return i.length?i[0](e):Zn.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}Yo.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",Go(t.state,Xs,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},Yo.dragend=t=>(t.inputState.draggedContent=null,!1),Yo.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&hr(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return hr(t,e,i,!0),!0}return!1},Yo.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=Ko?null:e.clipboardData;return i?(Jo(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),Jo(t,i.value)}),50)}(t),!1)};let cr=null;Yo.copy=Yo.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:Go(t,Xs,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;cr=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=Ko?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const dr=ui.define();function ur(t,e){let i=[];for(let n of t.facet(Is)){let s=n(t,e);s&&i.push(s)}return i.length?t.update({effects:i,annotations:dr.of(!0)}):null}function fr(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=ur(t.state,e);i?t.dispatch(i):t.update([])}}),10)}Uo.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),fr(t)},Uo.blur=t=>{t.observer.clearSelectionRange(),fr(t)},Uo.compositionstart=Uo.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},Uo.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Zn.chrome&&Zn.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},Uo.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},Yo.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return Wo(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if(Zn.chrome&&Zn.android&&(s=zo.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return Zn.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),Zn.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>Uo.compositionend(t,e)),20),!1};const pr=new Set,gr=["pre-wrap","normal","pre-line","break-spaces"];let mr=!1;function Or(){mr=!1}class vr{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return gr.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=gr.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class wr{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class br{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?ls.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ds?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new br(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var yr=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(yr||(yr={}));const Sr=.001;class xr{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>Sr&&(mr=!0),this.height=t)}replace(t,e,i){return xr.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,yr.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,yr.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,yr.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=Dr.build(i.setDoc(o),t,h,c);s=kr(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new Cr(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new Tr(xr.of(t.slice(0,e)),o,xr.of(t.slice(i)))}}function kr(t,e){return t==e?t:(t.constructor!=e.constructor&&(mr=!0),e)}xr.prototype.size=1;class Mr extends xr{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new br(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Cr extends Mr{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new br(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof Cr||n instanceof Ar&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof Ar?n=new Cr(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):xr.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Ar extends xr{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new br(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new br(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==yr.ByHeight)return this.blockAt(t,i,n,s);if(e==yr.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new br(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new br(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new br(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof Ar?i[i.length-1]=new Ar(t.length+n):i.push(null,new Ar(n-1))}if(t>0){let e=i[0];e instanceof Ar?i[0]=new Ar(t+e.length):i.unshift(new Ar(t-1),null)}return xr.of(i)}decomposeLeft(t,e){e.push(new Ar(t-1),null)}decomposeRight(t,e){e.push(null,new Ar(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new Ar(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=Sr&&(r=-2);let l=new Cr(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new Ar(s-o).updateHeight(t,o));let l=xr.of(i);return(r<0||Math.abs(l.height-this.height)>=Sr||Math.abs(r-this.heightMetrics(t,e).perLine)>=Sr)&&(mr=!0),kr(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class Tr extends xr{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==yr.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==yr.ByPosNoHeight?yr.ByPosNoHeight:yr.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,yr.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&Pr(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),Pr(s,t)}return xr.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?xr.of(this.break?[t,null,e]:[t,e]):(this.left=kr(this.left,t),this.right=kr(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Pr(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof Ar&&(n=t[e+1])instanceof Ar&&t.splice(e-1,3,new Ar(i.length+1+n.length))}class Dr{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Cr?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new Cr(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new Mr(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Cr(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new Ar(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Cr)return t;let e=new Cr(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof Cr||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new Cr(0,-1));let i=t;for(let t of this.nodes)t instanceof Cr&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new Dr(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class Er{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&fs(t,e,this.changes,5)}}function Rr(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function Qr(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class Br{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return as.replace({widget:new Lr(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class Lr extends rs{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class $r{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Wr,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=bs.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(lo).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new vr(e),this.stateDeco=t.facet(ao).filter((t=>"function"!=typeof t)),this.heightMap=xr.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new Oo(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=as.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new _r(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Wr:new Hr(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(qr(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ao).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=Oo.extendWithRanges(n,function(t,e,i){let n=new Er;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Or(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||mr)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(Ys)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?bs.RTL:bs.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=On(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=Mn(t.scrollDOM);let f=(this.printing?Qr:Rr)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),Or();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?xr.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new Oo(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new wr(i.from,s))}mr&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new _r(n.lineAt(o-1e3*i,yr.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),yr.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,yr.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new _r(n.lineAt(i-500,yr.ByHeight,s,0,0).from,n.lineAt(i+o+500,yr.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new _r(this.heightMap.lineAt(i,yr.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,yr.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,yr.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,yr.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new Br(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=bs.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new Br(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=ls.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=Nr(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=Vr(s,t),a=Vr(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=Nr(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=Vr(s,c),a=Vr(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=Nr(n,i)-Nr(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){Br.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=as.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||qr(this.heightMap.lineAt(t,yr.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||qr(this.heightMap.lineAt(this.scaler.fromDOM(t),yr.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return qr(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class _r{constructor(t,e){this.from=t,this.to=e}}function Vr({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function Nr(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const Wr={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class Hr{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,yr.ByPos,t,0,0).top,r=e.lineAt(s,yr.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof Hr&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function qr(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new br(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>qr(t,e))):t._content)}const Fr=Fe.define({combine:t=>t.join(" ")}),zr=Fe.define({combine:t=>t.indexOf(!0)>-1}),Ir=Yi.newName(),Zr=Yi.newName(),Xr=Yi.newName(),jr={"&light":"."+Zr,"&dark":"."+Xr};function Yr(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const Ur=Yr("."+Ir,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},jr),Kr={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Gr=Zn.ie&&Zn.ie_version<=11;class Jr{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new vn,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(Zn.ie&&Zn.ie_version<=11||Zn.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||Zn.chrome&&Zn.chrome_version<126||(this.editContext=new il(t),t.state.facet(eo)&&(t.contentDOM.editContext=this.editContext.editContext)),Gr&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(eo)?i.root.activeElement!=this.dom:!an(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(Zn.ie&&Zn.ie_version<=11||Zn.android&&Zn.chrome)&&!i.state.selection.main.empty&&n.focusNode&&cn(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=rn(t.root);if(!e)return!1;let i=Zn.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return el(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?el(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=an(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,pn(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=pn(i))}else{if(i==t)return!0;n=dn(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Kr),Gr&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Gr&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&xn(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&an(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new Vo(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=No(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=tl(e,t.previousSibling||t.target.previousSibling,-1),n=tl(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(eo)!=t.state.facet(eo)&&(t.view.contentDOM.editContext=t.state.facet(eo)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function tl(t,e,i){for(;e;){let n=Dn.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function el(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return cn(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class il{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if((Zn.mac||Zn.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);Wo(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(as.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:Js.of(as.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=rn(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class nl{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new $r(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(Gs)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(no).map((t=>new oo(t)));for(let t of this.plugins)t.update(this);this.observer=new Jr(this),this.inputState=new Ho(this),this.inputState.ensureHandlers(this.plugins),this.docView=new wo(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(dr)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=ur(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=vo.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new Ks(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(Gs)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=rl.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(mo)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(Fr)!=e.state.facet(Fr)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(Fs))try{t(e)}catch(t){to(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!No(this,h)&&a.force&&xn(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new $r(t),this.plugins=t.facet(no).map((t=>new oo(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new wo(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(no),i=t.state.facet(no);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new oo(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){to(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(Mn(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return to(this.state,t),ol}})),h=vo.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=ol)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){to(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(Fs))t(e)}get themeClasses(){return Ir+" "+(this.state.facet(zr)?Xr:Zr)+" "+this.state.facet(Fr)}updateAttrs(){let t=ll(this,ro,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(eo)?"true":"false",class:"cm-content",style:`${Zn.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),ll(this,lo,e);let i=this.observer.ignore((()=>{let i=ss(this.contentDOM,this.contentAttrs,e),n=ss(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(nl.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(mo);let t=this.state.facet(nl.cspNonce);Yi.mount(this.root,this.styleModules.concat(Ur).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Qo(this,t,Eo(this,t,e,i))}moveByGroup(t,e){return Qo(this,t,Eo(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=function(t,e,i){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let t;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;t&&(s.type!=ls.Text||t.type==s.type&&!(i<0?s.from<e:s.to>e))||(t=s)}}return t||n}return n}(t,e.head,e.assoc||-1),o=n&&s.type==ls.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==bs.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return Qo(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=Po(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Po(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return gn(i,s[Ds.find(s,t-n.from,-1,e)].dir==bs.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(js)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>sl)return Ls(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||Es(n.isolates,e=fo(this,t))))return n.order;e||(e=fo(this,t));let n=function(t,e,i){if(!t)return[new Ds(0,0,e==Ss?1:0)];if(e==ys&&!i.length&&!Ps.test(t))return Ls(t.length);if(i.length)for(;t.length>Rs.length;)Rs[Rs.length]=256;let n=[],s=e==ys?0:1;return Bs(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new rl(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Zn.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{yn(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return Gs.of(new Ks("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return Gs.of(new Ks(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return so.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return so.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[Fr.of(i),mo.of(Yr(`.${i}`,t))];return e&&e.dark&&n.push(zr.of(!0)),n}static baseTheme(t){return Ge.lowest(mo.of(Yr("."+Ir,t,jr)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&Dn.get(i)||Dn.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}nl.styleModule=mo,nl.inputHandler=zs,nl.clipboardInputFilter=Zs,nl.clipboardOutputFilter=Xs,nl.scrollHandler=Us,nl.focusChangeEffect=Is,nl.perLineTextDirection=js,nl.exceptionSink=qs,nl.updateListener=Fs,nl.editable=eo,nl.mouseSelectionStyle=Hs,nl.dragMovesSelection=Ws,nl.clickAddsSelectionRange=Ns,nl.decorations=ao,nl.outerDecorations=ho,nl.atomicRanges=co,nl.bidiIsolatedRanges=uo,nl.scrollMargins=po,nl.darkTheme=zr,nl.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),nl.contentAttributes=lo,nl.editorAttributes=ro,nl.lineWrapping=nl.contentAttributes.of({class:"cm-lineWrapping"}),nl.announce=gi.define();const sl=4096,ol={};class rl{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:bs.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new rl(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function ll(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&es(o,i)}return i}class al extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}al.prototype.elementClass="",al.prototype.toDOM=void 0,al.prototype.mapMode=De.TrackBefore,al.prototype.startSide=al.prototype.endSide=-1,al.prototype.point=!0;const hl=Fe.define(),cl=Fe.define(),dl={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Ri.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},ul=Fe.define();function fl(t){return[gl(),ul.of(Object.assign(Object.assign({},dl),t))]}const pl=Fe.define({combine:t=>t.some((t=>t))});function gl(t){let e=[ml];return t&&!1===t.fixed&&e.push(pl.of(!0)),e}const ml=so.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(ul).map((e=>new bl(t,e)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(pl),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<.8*(i.to-i.from))}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(pl)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let i=Ri.iter(this.view.state.facet(hl),this.view.viewport.from),n=[],s=this.gutters.map((t=>new wl(t,this.view.viewport,-this.view.documentPadding.top)));for(let t of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(t.type)){let e=!0;for(let o of t.type)if(o.type==ls.Text&&e){vl(i,n,o.from);for(let t of s)t.line(this.view,o,n);e=!1}else if(o.widget)for(let t of s)t.widget(this.view,o)}else if(t.type==ls.Text){vl(i,n,t.from);for(let e of s)e.line(this.view,t,n)}else if(t.widget)for(let e of s)e.widget(this.view,t);for(let t of s)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(ul),i=t.state.facet(ul),n=t.docChanged||t.heightChanged||t.viewportChanged||!Ri.eq(t.startState.facet(hl),t.state.facet(hl),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let s=[];for(let n of i){let i=e.indexOf(n);i<0?s.push(new bl(this.view,n)):(this.gutters[i].update(t),s.push(this.gutters[i]))}for(let t of this.gutters)t.dom.remove(),s.indexOf(t)<0&&t.destroy();for(let t of s)this.dom.appendChild(t.dom);this.gutters=s}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>nl.scrollMargins.of((e=>{let i=e.plugin(t);return i&&0!=i.gutters.length&&i.fixed?e.textDirection==bs.LTR?{left:i.dom.offsetWidth*e.scaleX}:{right:i.dom.offsetWidth*e.scaleX}:null}))});function Ol(t){return Array.isArray(t)?t:[t]}function vl(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class wl{constructor(t,e,i){this.gutter=t,this.height=i,this.i=0,this.cursor=Ri.iter(t.markers,e.from)}addElement(t,e,i){let{gutter:n}=this,s=(e.top-this.height)/t.scaleY,o=e.height/t.scaleY;if(this.i==n.elements.length){let e=new yl(t,o,s,i);n.elements.push(e),n.dom.appendChild(e.dom)}else n.elements[this.i].update(t,o,s,i);this.height=e.bottom,this.i++}line(t,e,i){let n=[];vl(this.cursor,n,e.from),i.length&&(n=n.concat(i));let s=this.gutter.config.lineMarker(t,e,n);s&&n.unshift(s);let o=this.gutter;(0!=n.length||o.config.renderEmptyElements)&&this.addElement(t,e,n)}widget(t,e){let i=this.gutter.config.widgetMarker(t,e.widget,e),n=i?[i]:null;for(let i of t.state.facet(cl)){let s=i(t,e.widget,e);s&&(n||(n=[])).push(s)}n&&this.addElement(t,e,n)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class bl{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,(n=>{let s,o=n.target;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let t=o.getBoundingClientRect();s=(t.top+t.bottom)/2}else s=n.clientY;let r=t.lineBlockAtHeight(s-t.documentTop);e.domEventHandlers[i](t,r,n)&&n.preventDefault()}));this.markers=Ol(e.markers(t)),e.initialSpacer&&(this.spacer=new yl(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=Ol(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let i=t.view.viewport;return!Ri.eq(this.markers,e,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class yl{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let s=0,o=0;;){let r=o,l=s<e.length?e[s++]:null,a=!1;if(l){let t=l.elementClass;t&&(i+=" "+t);for(let t=o;t<this.markers.length;t++)if(this.markers[t].compare(l)){r=t,a=!0;break}}else r=this.markers.length;for(;o<r;){let t=this.markers[o++];if(t.toDOM){t.destroy(n);let e=n.nextSibling;n.remove(),n=e}}if(!l)break;l.toDOM&&(a?n=n.nextSibling:this.dom.insertBefore(l.toDOM(t),n)),a&&o++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}var Sl;const xl=new O;function kl(t){return Fe.define({combine:t?e=>e.concat(t):void 0})}const Ml=new O;class Cl{constructor(t,e,i=[],n=""){this.data=t,this.name=n,Ci.prototype.hasOwnProperty("tree")||Object.defineProperty(Ci.prototype,"tree",{get(){return Pl(this)}}),this.parser=e,this.extension=[Vl.of(this),Ci.languageData.of(((t,e,i)=>{let n=Al(t,e,i),s=n.type.prop(xl);if(!s)return[];let o=t.facet(s),r=n.type.prop(Ml);if(r){let s=n.resolve(e-n.from,i);for(let e of r)if(e.test(s,t)){let i=t.facet(e.facet);return"replace"==e.type?i:i.concat(o)}}return o}))].concat(i)}isActiveAt(t,e,i=-1){return Al(t,e,i).type.prop(xl)==this.data}findRegions(t){let e=t.facet(Vl);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(t,e)=>{if(t.prop(xl)==this.data)return void i.push({from:e,to:e+t.length});let s=t.prop(O.mounted);if(s){if(s.tree.prop(xl)==this.data){if(s.overlay)for(let t of s.overlay)i.push({from:t.from+e,to:t.to+e});else i.push({from:e,to:e+t.length});return}if(s.overlay){let t=i.length;if(n(s.tree,s.overlay[0].from+e),i.length>t)return}}for(let i=0;i<t.children.length;i++){let s=t.children[i];s instanceof M&&n(s,t.positions[i]+e)}};return n(Pl(t),0),i}get allowsNesting(){return!0}}function Al(t,e,i){let n=t.facet(Vl),s=Pl(t).topNode;if(!n||n.allowsNesting)for(let t=s;t;t=t.enter(e,i,k.ExcludeBuffers))t.type.isTop&&(s=t);return s}Cl.setState=gi.define();class Tl extends Cl{constructor(t,e,i){super(t,e,[],i),this.parser=e}static define(t){let e=kl(t.languageData);return new Tl(e,t.parser.configure({props:[xl.add((t=>t.isTop?e:void 0))]}),t.name)}configure(t,e){return new Tl(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function Pl(t){let e=t.field(Cl.state,!1);return e?e.tree:M.empty}class Dl{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let El=null;class Rl{constructor(t,e,i=[],n,s,o,r,l){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=s,this.viewport=o,this.skipped=r,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new Rl(t,e,[],M.empty,0,i,[],null)}startParse(){return this.parser.startParse(new Dl(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=M.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var i;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(z.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(i=this.parse.stoppedAt)&&void 0!==i?i:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(z.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=El;El=this;try{return t()}finally{El=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=Ql(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:s,viewport:o,skipped:r}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,i,n,s)=>e.push({fromA:t,toA:i,fromB:n,toB:s}))),i=z.applyChanges(i,e),n=M.empty,s=0,o={from:t.mapPos(o.from,-1),to:t.mapPos(o.to,1)},this.skipped.length){r=[];for(let e of this.skipped){let i=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);i<n&&r.push({from:i,to:n})}}}return new Rl(this.parser,e,i,n,s,o,r,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:i,to:n}=this.skipped[e];i<t.to&&n>t.from&&(this.fragments=Ql(this.fragments,i,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e||(this.reset(),0))}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends I{createParse(e,i,n){let s=n[0].from,o=n[n.length-1].to;return{parsedPos:s,advance(){let e=El;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=o,new M(b.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return El}}function Ql(t,e,i){return z.applyChanges(t,[{fromA:e,toA:i,fromB:e,toB:i}])}class Bl{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new Bl(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=Rl.create(t.facet(Vl).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new Bl(i)}}Cl.state=Ue.define({create:Bl.init,update(t,e){for(let t of e.effects)if(t.is(Cl.setState))return t.value;return e.startState.facet(Vl)!=e.state.facet(Vl)?Bl.init(e.state):t.apply(e)}});let Ll=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(Ll=t=>{let e=-1,i=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(i):cancelIdleCallback(e)});const $l="undefined"!=typeof navigator&&(null===(Sl=navigator.scheduling)||void 0===Sl?void 0:Sl.isInputPending)?()=>navigator.scheduling.isInputPending():null,_l=so.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(Cl.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(Cl.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=Ll(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,s=i.field(Cl.state);if(s.tree==s.context.tree&&s.context.isDone(n+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,t&&!$l?Math.max(25,t.timeRemaining()-5):1e9),r=s.context.treeLen<n&&i.doc.length>n+1e3,l=s.context.work((()=>$l&&$l()||Date.now()>o),n+(r?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:Cl.setState.of(new Bl(s.context))})),this.chunkBudget>0&&(!l||r)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>to(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Vl=Fe.define({combine(t){return t.length?t[0]:null},enables:t=>[Cl.state,_l,nl.contentAttributes.compute([t],(e=>{let i=e.facet(t);return i&&i.name?{"data-language":i.name}:{}}))]});class Nl{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}}const Wl=Fe.define(),Hl=Fe.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some((t=>t!=e[0])))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function ql(t){let e=t.facet(Hl);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function Fl(t,e){let i="",n=t.tabSize,s=t.facet(Hl)[0];if("\t"==s){for(;e>=n;)i+="\t",e-=n;s=" "}for(let t=0;t<e;t++)i+=s;return i}function zl(t,e){t instanceof Ci&&(t=new Il(t));for(let i of t.state.facet(Wl)){let n=i(t,e);if(void 0!==n)return n}let i=Pl(t.state);return i.length>=e?function(t,e,i){let n=e.resolveStack(i),s=e.resolveInner(i,-1).resolve(i,0).enterUnfinishedNodesBefore(i);if(s!=n.node){let t=[];for(let e=s;e&&(e.from!=n.node.from||e.type!=n.node.type);e=e.parent)t.push(e);for(let e=t.length-1;e>=0;e--)n={node:t[e],next:n}}return Xl(n,t,i)}(t,i,e):null}class Il{constructor(t,e={}){this.state=t,this.options=e,this.unit=ql(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:s}=this.options;return null!=n&&n>=i.from&&n<=i.to?s&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),s=this.countColumn(i,t-n),o=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return o>-1&&(s+=o-this.countColumn(i,i.search(/\S|$/))),s}countColumn(t,e=t.length){return zi(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),s=this.options.overrideIndentation;if(s){let t=s(n);if(t>-1)return t}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Zl=new O;function Xl(t,e,i){for(let n=t;n;n=n.next){let t=jl(n.node);if(t)return t(Ul.create(e,i,n))}return 0}function jl(t){let e=t.type.prop(Zl);if(e)return e;let i,n=t.firstChild;if(n&&(i=n.type.prop(O.closedBy))){let e=t.lastChild,n=e&&i.indexOf(e.name)>-1;return t=>Jl(t,!0,1,void 0,n&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?Yl:null}function Yl(){return 0}class Ul extends Il{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.context=i}get node(){return this.context.node}static create(t,e,i){return new Ul(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let i=t.resolve(e.from);for(;i.parent&&i.parent.from==i.from;)i=i.parent;if(Kl(i,t))break;e=this.state.doc.lineAt(i.from)}return this.lineIndent(e.from)}continue(){return Xl(this.context.next,this.base,this.pos)}}function Kl(t,e){for(let i=e;i;i=i.parent)if(t==i)return!0;return!1}function Gl({closing:t,align:e=!0,units:i=1}){return n=>Jl(n,e,i,t)}function Jl(t,e,i,n,s){let o=t.textAfter,r=o.match(/^\s*/)[0].length,l=n&&o.slice(r,r+n.length)==n||s==t.pos+r,a=e?function(t){let e=t.node,i=e.childAfter(e.from),n=e.lastChild;if(!i)return null;let s=t.options.simulateBreak,o=t.state.doc.lineAt(i.from),r=null==s||s<=o.from?o.to:Math.min(o.to,s);for(let t=i.to;;){let s=e.childAfter(t);if(!s||s==n)return null;if(!s.type.isSkipped){if(s.from>=r)return null;let t=/^ */.exec(o.text.slice(i.to-o.from))[0].length;return{from:i.from,to:i.to+t}}t=s.to}}(t):null;return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*i)}function ta({except:t,units:e=1}={}){return i=>{let n=t&&t.test(i.textAfter);return i.baseIndent+(n?0:e*i.unit)}}const ea=Fe.define(),ia=new O;function na(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function sa(t,e,i){for(let n of t.facet(ea)){let s=n(t,e,i);if(s)return s}return function(t,e,i){let n=Pl(t);if(n.length<i)return null;let s=null;for(let o=n.resolveStack(i,1);o;o=o.next){let r=o.node;if(r.to<=i||r.from>i)continue;if(s&&r.from<e)break;let l=r.type.prop(ia);if(l&&(r.to<n.length-50||n.length==t.doc.length||!na(r))){let n=l(r,t);n&&n.from<=i&&n.from>=e&&n.to>i&&(s=n)}}return s}(t,e,i)}function oa(t,e){let i=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return i>=n?void 0:{from:i,to:n}}const ra=gi.define({map:oa}),la=gi.define({map:oa});function aa(t){let e=[];for(let{head:i}of t.state.selection.ranges)e.some((t=>t.from<=i&&t.to>=i))||e.push(t.lineBlockAt(i));return e}const ha=Ue.define({create(){return as.none},update(t,e){t=t.map(e.changes);for(let i of e.effects)if(i.is(ra)&&!da(t,i.value.from,i.value.to)){let{preparePlaceholder:n}=e.state.facet(ma),s=n?as.replace({widget:new ba(n(e.state,i.value))}):wa;t=t.update({add:[s.range(i.value.from,i.value.to)]})}else i.is(la)&&(t=t.update({filter:(t,e)=>i.value.from!=t||i.value.to!=e,filterFrom:i.value.from,filterTo:i.value.to}));if(e.selection){let i=!1,{head:n}=e.selection.main;t.between(n,n,((t,e)=>{t<n&&e>n&&(i=!0)})),i&&(t=t.update({filterFrom:n,filterTo:n,filter:(t,e)=>e<=n||t>=n}))}return t},provide:t=>nl.decorations.from(t),toJSON(t,e){let i=[];return t.between(0,e.doc.length,((t,e)=>{i.push(t,e)})),i},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let i=0;i<t.length;){let n=t[i++],s=t[i++];if("number"!=typeof n||"number"!=typeof s)throw new RangeError("Invalid JSON for fold state");e.push(wa.range(n,s))}return as.set(e,!0)}});function ca(t,e,i){var n;let s=null;return null===(n=t.field(ha,!1))||void 0===n||n.between(e,i,((t,e)=>{(!s||s.from>t)&&(s={from:t,to:e})})),s}function da(t,e,i){let n=!1;return t.between(e,e,((t,s)=>{t==e&&s==i&&(n=!0)})),n}function ua(t,e){return t.field(ha,!1)?e:e.concat(gi.appendConfig.of(Oa()))}function fa(t,e,i=!0){let n=t.state.doc.lineAt(e.from).number,s=t.state.doc.lineAt(e.to).number;return nl.announce.of(`${t.state.phrase(i?"Folded lines":"Unfolded lines")} ${n} ${t.state.phrase("to")} ${s}.`)}const pa=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:t=>{for(let e of aa(t)){let i=sa(t.state,e.from,e.to);if(i)return t.dispatch({effects:ua(t.state,[ra.of(i),fa(t,i)])}),!0}return!1}},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:t=>{if(!t.state.field(ha,!1))return!1;let e=[];for(let i of aa(t)){let n=ca(t.state,i.from,i.to);n&&e.push(la.of(n),fa(t,n,!1))}return e.length&&t.dispatch({effects:e}),e.length>0}},{key:"Ctrl-Alt-[",run:t=>{let{state:e}=t,i=[];for(let n=0;n<e.doc.length;){let s=t.lineBlockAt(n),o=sa(e,s.from,s.to);o&&i.push(ra.of(o)),n=(o?t.lineBlockAt(o.to):s).to+1}return i.length&&t.dispatch({effects:ua(t.state,i)}),!!i.length}},{key:"Ctrl-Alt-]",run:t=>{let e=t.state.field(ha,!1);if(!e||!e.size)return!1;let i=[];return e.between(0,t.state.doc.length,((t,e)=>{i.push(la.of({from:t,to:e}))})),t.dispatch({effects:i}),!0}}],ga={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},ma=Fe.define({combine(t){return Ai(t,ga)}});function Oa(t){let e=[ha,xa];return t&&e.push(ma.of(t)),e}function va(t,e){let{state:i}=t,n=i.facet(ma),s=e=>{let i=t.lineBlockAt(t.posAtDOM(e.target)),n=ca(t.state,i.from,i.to);n&&t.dispatch({effects:la.of(n)}),e.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,s,e);let o=document.createElement("span");return o.textContent=n.placeholderText,o.setAttribute("aria-label",i.phrase("folded code")),o.title=i.phrase("unfold"),o.className="cm-foldPlaceholder",o.onclick=s,o}const wa=as.replace({widget:new class extends rs{toDOM(t){return va(t,null)}}});class ba extends rs{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return va(t,this.value)}}const ya={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Sa extends al{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}const xa=nl.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ka{constructor(t,e){let i;function n(t){let e=Yi.newName();return(i||(i=Object.create(null)))["."+e]=t,e}this.specs=t;const s="string"==typeof e.all?e.all:e.all?n(e.all):void 0,o=e.scope;this.scope=o instanceof Cl?t=>t.prop(xl)==o.data:o?t=>t==o:void 0,this.style=Ct(t.map((t=>({tag:t.tag,class:t.class||n(Object.assign({},t,{tag:null}))}))),{all:s}).style,this.module=i?new Yi(i):null,this.themeType=e.themeType}static define(t,e){return new ka(t,e||{})}}const Ma=Fe.define(),Ca=Fe.define({combine(t){return t.length?[t[0]]:null}});function Aa(t){let e=t.facet(Ma);return e.length?e:t.facet(Ca)}function Ta(t,e){let i,n=[Da];return t instanceof ka&&(t.module&&n.push(nl.styleModule.of(t.module)),i=t.themeType),(null==e?void 0:e.fallback)?n.push(Ca.of(t)):i?n.push(Ma.computeN([nl.darkTheme],(e=>e.facet(nl.darkTheme)==("dark"==i)?[t]:[]))):n.push(Ma.of(t)),n}class Pa{constructor(t){this.markCache=Object.create(null),this.tree=Pl(t.state),this.decorations=this.buildDeco(t,Aa(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=Pl(t.state),i=Aa(t.state),n=i!=Aa(t.startState),{viewport:s}=t.view,o=t.changes.mapPos(this.decoratedTo,1);e.length<s.to&&!n&&e.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=o):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i),this.decoratedTo=s.to)}buildDeco(t,e){if(!e||!this.tree.length)return as.none;let i=new Qi;for(let{from:n,to:s}of t.visibleRanges)At(this.tree,e,((t,e,n)=>{i.add(t,e,this.markCache[n]||(this.markCache[n]=as.mark({class:n})))}),n,s);return i.finish()}}const Da=Ge.high(so.fromClass(Pa,{decorations:t=>t.decorations})),Ea=ka.define([{tag:zt.meta,color:"#404740"},{tag:zt.link,textDecoration:"underline"},{tag:zt.heading,textDecoration:"underline",fontWeight:"bold"},{tag:zt.emphasis,fontStyle:"italic"},{tag:zt.strong,fontWeight:"bold"},{tag:zt.strikethrough,textDecoration:"line-through"},{tag:zt.keyword,color:"#708"},{tag:[zt.atom,zt.bool,zt.url,zt.contentSeparator,zt.labelName],color:"#219"},{tag:[zt.literal,zt.inserted],color:"#164"},{tag:[zt.string,zt.deleted],color:"#a11"},{tag:[zt.regexp,zt.escape,zt.special(zt.string)],color:"#e40"},{tag:zt.definition(zt.variableName),color:"#00f"},{tag:zt.local(zt.variableName),color:"#30a"},{tag:[zt.typeName,zt.namespace],color:"#085"},{tag:zt.className,color:"#167"},{tag:[zt.special(zt.variableName),zt.macroName],color:"#256"},{tag:zt.definition(zt.propertyName),color:"#00c"},{tag:zt.comment,color:"#940"},{tag:zt.invalid,color:"#f00"}]),Ra=nl.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Qa="()[]{}",Ba=Fe.define({combine(t){return Ai(t,{afterCursor:!0,brackets:Qa,maxScanDistance:1e4,renderMatch:_a})}}),La=as.mark({class:"cm-matchingBracket"}),$a=as.mark({class:"cm-nonmatchingBracket"});function _a(t){let e=[],i=t.matched?La:$a;return e.push(i.range(t.start.from,t.start.to)),t.end&&e.push(i.range(t.end.from,t.end.to)),e}const Va=Ue.define({create(){return as.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let i=[],n=e.state.facet(Ba);for(let t of e.state.selection.ranges){if(!t.empty)continue;let s=Fa(e.state,t.head,-1,n)||t.head>0&&Fa(e.state,t.head-1,1,n)||n.afterCursor&&(Fa(e.state,t.head,1,n)||t.head<e.state.doc.length&&Fa(e.state,t.head+1,-1,n));s&&(i=i.concat(n.renderMatch(s,e.state)))}return as.set(i,!0)},provide:t=>nl.decorations.from(t)}),Na=[Va,Ra],Wa=new O;function Ha(t,e,i){let n=t.prop(e<0?O.openedBy:O.closedBy);if(n)return n;if(1==t.name.length){let n=i.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[i[n+e]]}return null}function qa(t){let e=t.type.prop(Wa);return e?e(t.node):t}function Fa(t,e,i,n={}){let s=n.maxScanDistance||1e4,o=n.brackets||Qa,r=Pl(t),l=r.resolveInner(e,i);for(let t=l;t;t=t.parent){let n=Ha(t.type,i,o);if(n&&t.from<t.to){let s=qa(t);if(s&&(i>0?e>=s.from&&e<s.to:e>s.from&&e<=s.to))return za(0,0,i,t,s,n,o)}}return function(t,e,i,n,s,o,r){let l=i<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),a=r.indexOf(l);if(a<0||a%2==0!=i>0)return null;let h={from:i<0?e-1:e,to:i>0?e+1:e},c=t.doc.iterRange(e,i>0?t.doc.length:0),d=0;for(let t=0;!c.next().done&&t<=o;){let o=c.value;i<0&&(t+=o.length);let l=e+t*i;for(let t=i>0?0:o.length-1,e=i>0?o.length:-1;t!=e;t+=i){let e=r.indexOf(o[t]);if(!(e<0||n.resolveInner(l+t,1).type!=s))if(e%2==0==i>0)d++;else{if(1==d)return{start:h,end:{from:l+t,to:l+t+1},matched:e>>1==a>>1};d--}}i>0&&(t+=o.length)}return c.done?{start:h,matched:!1}:null}(t,e,i,r,l.type,s,o)}function za(t,e,i,n,s,o,r){let l=n.parent,a={from:s.from,to:s.to},h=0,c=null==l?void 0:l.cursor();if(c&&(i<0?c.childBefore(n.from):c.childAfter(n.to)))do{if(i<0?c.to<=n.from:c.from>=n.to){if(0==h&&o.indexOf(c.type.name)>-1&&c.from<c.to){let t=qa(c);return{start:a,end:t?{from:t.from,to:t.to}:void 0,matched:!0}}if(Ha(c.type,i,r))h++;else if(Ha(c.type,-i,r)){if(0==h){let t=qa(c);return{start:a,end:t&&t.from<t.to?{from:t.from,to:t.to}:void 0,matched:!1}}h--}}}while(i<0?c.prevSibling():c.nextSibling());return{start:a,matched:!1}}const Ia=Object.create(null),Za=[b.none],Xa=[],ja=Object.create(null),Ya=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Ya[t]=Ka(Ia,e);function Ua(t,e){Xa.indexOf(t)>-1||(Xa.push(t),console.warn(e))}function Ka(t,e){let i=[];for(let n of e.split(" ")){let e=[];for(let i of n.split(".")){let n=t[i]||zt[i];n?"function"==typeof n?e.length?e=e.map(n):Ua(i,`Modifier ${i} used at start of tag`):e.length?Ua(i,`Tag ${i} used as modifier`):e=Array.isArray(n)?n:[n]:Ua(i,`Unknown highlighting tag ${i}`)}for(let t of e)i.push(t)}if(!i.length)return 0;let n=e.replace(/ /g,"_"),s=n+" "+i.map((t=>t.id)),o=ja[s];if(o)return o.id;let r=ja[s]=b.define({id:Za.length,name:n,props:[xt({[n]:i})]});return Za.push(r),r.id}function Ga(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function Ja(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function th(t,e){if(!e.anchorNode)return!1;try{return Ja(t,e.anchorNode)}catch(t){return!1}}function eh(t){return 3==t.nodeType?ph(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function ih(t,e,i,n){return!!i&&(oh(t,e,i,n,-1)||oh(t,e,i,n,1))}function nh(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function sh(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function oh(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:rh(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=nh(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?rh(t):0}}}function rh(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function lh(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function ah(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function hh(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}bs.RTL,bs.LTR;class ch{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?rh(e):0),i,Math.min(t.focusOffset,i?rh(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let dh,uh=null;function fh(t){if(t.setActive)return t.setActive();if(uh)return t.focus(uh);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==uh?{get preventScroll(){return uh={preventScroll:!0},!0}}:void 0),!uh){uh=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function ph(t,e,i=e){let n=dh||(dh=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function gh(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function mh(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function Oh(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function vh(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=rh(i)}else{if(!i.parentNode||sh(i))return null;n=nh(i),i=i.parentNode}}}function wh(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||sh(i))return null;n=nh(i)+1,i=i.parentNode}}}class bh{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new bh(t.parentNode,nh(t),e)}static after(t,e){return new bh(t.parentNode,nh(t)+1,e)}}const yh=[];class Sh{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=Sh.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=xh(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=xh(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==rh(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Sh.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=yh){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new kh(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function xh(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}Sh.prototype.breakAfter=0;class kh{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Mh(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function Ch(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,Mh(t,h,c,l,a,n,0,s,o)}let Ah="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Th="undefined"!=typeof document?document:{documentElement:{style:{}}};const Ph=/Edge\/(\d+)/.exec(Ah.userAgent),Dh=/MSIE \d/.test(Ah.userAgent),Eh=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ah.userAgent),Rh=!!(Dh||Eh||Ph),Qh=!Rh&&/gecko\/(\d+)/i.test(Ah.userAgent),Bh=!Rh&&/Chrome\/(\d+)/.exec(Ah.userAgent),Lh="webkitFontSmoothing"in Th.documentElement.style,$h=!Rh&&/Apple Computer/.test(Ah.vendor),_h=$h&&(/Mobile\/\w+/.test(Ah.userAgent)||Ah.maxTouchPoints>2);var Vh={mac:_h||/Mac/.test(Ah.platform),windows:/Win/.test(Ah.platform),linux:/Linux|X11/.test(Ah.platform),ie:Rh,ie_version:Dh?Th.documentMode||6:Eh?+Eh[1]:Ph?+Ph[1]:0,gecko:Qh,gecko_version:Qh?+(/Firefox\/(\d+)/.exec(Ah.userAgent)||[0,0])[1]:0,chrome:!!Bh,chrome_version:Bh?+Bh[1]:0,ios:_h,android:/Android\b/.test(Ah.userAgent),webkit:Lh,safari:$h,webkit_version:Lh?+(/\bAppleWebKit\/(\d+)/.exec(Ah.userAgent)||[0,0])[1]:0,tabSize:null!=Th.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class Nh extends Sh{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof Nh)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new Nh(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new bh(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?Vh.chrome||Vh.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=ph(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return Vh.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?lh(a,r<0):a||null}(this.dom,t,e)}}class Wh extends Sh{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(mh(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof Wh&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(Ch(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new Wh(this.mark,e,o)}domAtPos(t){return Fh(this,t)}coordsAt(t,e){return Ih(this,t,e)}}class Hh extends Sh{static create(t,e,i){return new Hh(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=Hh.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof Hh&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof Hh&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?bh.before(this.dom):bh.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return lh(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class qh extends Sh{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof qh&&t.side==this.side}split(){return new qh(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?bh.before(this.dom):bh.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function Fh(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new bh(i,0)}function zh(t,e,i){let n,{children:s}=t;i>0&&e instanceof Wh&&s.length&&(n=s[s.length-1])instanceof Wh&&n.mark.eq(e.mark)?zh(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function Ih(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&(i>0||Zh(o,c)))&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=eh(e);return i[i.length-1]||null}(t)}function Zh(t,e){let i=t.coordsAt(0,1),n=e.coordsAt(0,1);return i&&n&&n.top<i.bottom}function Xh(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}Nh.prototype.children=Hh.prototype.children=qh.prototype.children=yh;const jh=Object.create(null);function Yh(t,e,i){if(t==e)return!0;t||(t=jh),e||(e=jh);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function Uh(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function Kh(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class Gh{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var Jh=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(Jh||(Jh={}));class tc extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new ec(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new nc(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=sc(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new nc(t,e,i,n,t.widget||null,!0)}static line(t){return new ic(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}tc.none=Ri.empty;class ec extends tc{constructor(t){let{start:e,end:i}=sc(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof ec&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&Yh(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}ec.prototype.point=!1;class ic extends tc{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof ic&&this.spec.class==t.spec.class&&Yh(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}ic.prototype.mapMode=De.TrackBefore,ic.prototype.point=!0;class nc extends tc{constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?Jh.WidgetRange:this.startSide<=0?Jh.WidgetBefore:Jh.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof nc&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function sc(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function oc(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}nc.prototype.point=!0;class rc extends Sh{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof rc))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Ch(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new rc;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Yh(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){zh(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Xh(e,this.attrs||{})),i&&(this.attrs=Xh({class:i},this.attrs||{}))}domAtPos(t){return Fh(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(mh(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Uh(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&Sh.get(n)instanceof Wh;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=Sh.get(n))||void 0===i?void 0:i.isEditable)||Vh.ios&&this.children.some((t=>t instanceof Nh))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof Nh)||/[^ -~]/.test(i.text))return null;let n=eh(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=Ih(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof rc&&0==this.children.length&&0==t.children.length&&Yh(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof rc)return s;if(o>e)break}n=o+s.breakAfter}return null}}class lc extends Sh{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof lc&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?bh.before(this.dom):bh.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new lc(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return yh}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof lc&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof ac?null:lh(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class ac extends Gh{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class hc{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof lc&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new rc),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(cc(new qh(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof lc||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(cc(new Nh(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof nc){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof nc)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new lc(i.widget||dc.block,r,i));else{let o=Hh.create(i.widget||dc.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(cc(new qh(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(cc(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new hc(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function cc(t,e){for(let i of e)t=new Wh(i,[t],t.length);return t}class dc extends Gh{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}dc.inline=new dc("span"),dc.block=new dc("div");var uc=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(uc||(uc={}));const fc=uc.LTR,pc=uc.RTL;function gc(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const mc=gc("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Oc=gc("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),vc=Object.create(null),wc=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);vc[e]=i,vc[i]=-e}function bc(t){return t<=247?mc[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?Oc[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const yc=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Sc{get dir(){return this.level%2?pc:fc}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function xc(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!xc(n.inner,s.inner))return!1}return!0}const kc=[];function Mc(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=kc[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if(kc[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new Sc(a,p.from,u)),Cc(t,p.direction==fc!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?kc[f]!=l:kc[f]==l))break;f++}d?Mc(t,a,f,n+1,s,d,r):a<f&&r.push(new Sc(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=kc[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if(kc[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new Sc(p.to,a,u)),Cc(t,p.direction==fc!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?kc[f-1]!=l:kc[f-1]==l))break;f--}d?Mc(t,f,a,n+1,s,d,r):f<a&&r.push(new Sc(f,a,u)),a=f}}function Cc(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=bc(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),kc[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=kc[t];if(128==s)t<l-1&&e==kc[t+1]&&24&e?s=kc[t]=e:kc[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==kc[s];)s++;let o=t&&8==e||s<i&&8==kc[s]?1==n?1:8:256;for(let e=t;e<s;e++)kc[e]=o;t=s-1}else 8==s&&1==n&&(kc[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=vc[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(wc[t+1]==-i){let e=wc[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&(kc[r]=kc[wc[t]]=i),l=t;break}}else{if(189==wc.length)break;wc[l++]=r,wc[l++]=e,wc[l++]=a}else if(2==(n=kc[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=wc[e+2];if(2&i)break;if(t)wc[e+2]|=2;else{if(4&i)break;wc[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=kc[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=kc[r])break;r++}let h=1==o,c=h==(1==(r<e?kc[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),kc[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),Mc(t,s,o,e,i,n,r)}function Ac(t){return[new Sc(0,t,0)]}let Tc="";function Pc(t,e,i,n,s){var o;let r=n.head-t.from,l=Sc.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),Tc=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function Dc(t,e,i){for(let n=e;n<i;n++){let e=bc(t.charCodeAt(n));if(1==e)return fc;if(2==e||4==e)return pc}return fc}const Ec=Fe.define(),Rc=Fe.define(),Qc=Fe.define(),Bc=Fe.define(),Lc=Fe.define(),$c=Fe.define(),_c=Fe.define(),Vc=Fe.define(),Nc=Fe.define(),Wc=Fe.define({combine:t=>t.some((t=>t))}),Hc=Fe.define({combine:t=>t.some((t=>t))}),qc=Fe.define();class Fc{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new Fc(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Fc(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const zc=gi.define({map:(t,e)=>t.map(e)}),Ic=gi.define();function Zc(t,e,i){let n=t.facet(Bc);n.length?n[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const Xc=Fe.define({combine:t=>!t.length||t[0]});let jc=0;const Yc=Fe.define();class Uc{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new Uc(jc++,t,i,n,(t=>{let e=[Yc.of(t)];return o&&e.push(td.of((e=>{let i=e.plugin(t);return i?o(i):tc.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return Uc.define((e=>new t(e)),e)}}class Kc{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(Zc(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Zc(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){Zc(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Gc=Fe.define(),Jc=Fe.define(),td=Fe.define(),ed=Fe.define(),id=Fe.define(),nd=Fe.define();function sd(t,e){let i=t.state.facet(nd);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=Dc(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const od=Fe.define();function rd(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(od)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const ld=Fe.define();class ad{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new ad(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new ad(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new ad(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class hd{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new ad(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new hd(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class cd extends Sh{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=tc.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new rc],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ad(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=dd(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new ad(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=Sh.get(e);if(i instanceof Wh)c.push({node:e,deco:i.mark});else{if(i instanceof rc||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new ec({inclusive:!0,attributes:Kh(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new ad(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Vh.ie||Vh.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new ud;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=ad.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=Vh.chrome||Vh.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof lc&&t.widget instanceof ac&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=hc.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=hc.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=hc.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);Mh(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(Ic)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new Nh(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new Wh(i,[e],e.length);let i=new rc;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=Sh.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(Xc)||this.dom.tabIndex>-1)&&th(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if(Vh.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new bh(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(ih(l.node,l.offset,c.anchorNode,c.anchorOffset)&&ih(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{Vh.android&&Vh.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=Ga(this.view.root);if(t)if(r.empty){if(Vh.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?vh:wh)(l.node,l.offset);e&&(l=new bh(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new bh(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new bh(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&ih(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=Ga(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=rc.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=Sh.get(i.childNodes[n]);t instanceof rc&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=Sh.get(i.childNodes[n]);t instanceof rc&&(e=t.domAtPos(t.length))}return e?new bh(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=Sh.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof rc)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof rc&&!(i instanceof rc&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof lc&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof rc))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof Nh))return null;let s=Me(n.text,i);if(s==i)return null;let o=ph(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==uc.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?eh(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?uc.RTL:uc.LTR}measureTextSize(){for(let t of this.children)if(t instanceof rc){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=eh(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new kh(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(tc.replace({widget:new ac(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return tc.set(t)}updateDeco(){let t=1,e=this.view.state.facet(td).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(ed).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(qc))try{if(e(this.view,t.range,t))return!0}catch(t){Zc(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=rd(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=ah(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=hh(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==uc.LTR)}}function dd(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=vh(i.focusNode,i.focusOffset),s=wh(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=Sh.get(s.node);if(!e||e instanceof Nh&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=Sh.get(n.node);!t||t instanceof Nh&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let ud=class{constructor(){this.changes=[]}compareRange(t,e){oc(t,e,this.changes)}comparePoint(t,e){oc(t,e,this.changes)}boundChange(t){oc(t,t,this.changes)}};function fd(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function pd(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function gd(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function md(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function Od(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function vd(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=eh(u);for(let f=0;f<t.length;f++){let p=t[f];s&&gd(s,p)&&(p=md(Od(p,s.bottom),s.top));let g=fd(e,p),m=pd(i,p);if(0==g&&0==m)return 3==u.nodeType?wd(u,e,i):vd(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&gd(h,p)?h=Od(h,p.bottom):c&&gd(c,p)&&(c=md(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?wd(n,u,i):d&&"false"!=n.contentEditable?vd(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function wd(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=ph(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if((Vh.chrome||Vh.gecko)&&ph(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function bd(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=Jh.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:yd(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:yd(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||Vh.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return ph(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||Vh.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():ph(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(rh(O),v))}if(!O||!t.docView.dom.contains(O)){let e=rc.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=vd(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function yd(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function Sd(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=Pc(s,o,r,l,i),h=Tc;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function xd(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function kd(t,e,i){let n=xd(t.state.facet(id).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const Md="￿";class Cd{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Md}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=Sh.get(n),r=Sh.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:sh(n))||sh(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=Sh.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(Ad(t,i.node,i.offset)?e:0))}}function Ad(t,e,i){for(;;){if(!e||i<rh(e))return!1;if(e==t)return!0;i=nh(e)+1,e=e.parentNode}}class Td{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Pd{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new Td(i,n)),s==i&&o==n||e.push(new Td(s,o))),e}(t),i=new Cd(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!Ja(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!Ja(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if((Vh.ios||Vh.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function Dd(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||Vh.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,Md),e.text,l-n,a);h&&(Vh.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Md+Md&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(Md))})}else n&&(!t.hasFocus&&t.state.facet(Xc)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(Vh.mac||Vh.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:Vh.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return Ed(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function Ed(t,e,i,n=-1){if(Vh.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(Vh.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&gh(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&gh(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&gh(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&dd(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet($c).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class Rd{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,Vh.safari&&t.contentDOM.addEventListener("input",(()=>null)),Vh.gecko&&function(t){su.has(t)||(su.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=Sh.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(Qd(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(Qd(e.value,s))}}for(let t in Nd)i(t).handlers.push(Nd[t]);for(let t in Wd)i(t).observers.push(Wd[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&$d.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),Vh.android&&Vh.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!Vh.ios||t.synthetic||t.altKey||t.metaKey||!((e=Bd.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||Ld.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,gh(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(Vh.safari&&!Vh.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Qd(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){Zc(i.state,t)}}}const Bd=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Ld="dthko",$d=[16,17,18,20,91,92,224,225];function _d(t){return.7*Math.max(0,t)+8}class Vd{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(id).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(Ec);return i.length?i[0](e):Vh.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=Ga(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=Gd(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=rd(this.view);t.clientX-h.left<=o+6?n=-_d(o-t.clientX):t.clientX+h.right>=l-6&&(n=_d(t.clientX-l)),t.clientY-h.top<=r+6?s=-_d(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=_d(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=xd(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=xd(this.atoms,n.from,-1),e=xd(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const Nd=Object.create(null),Wd=Object.create(null),Hd=Vh.ie&&Vh.ie_version<15||Vh.ios&&Vh.webkit_version<604;function qd(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function Fd(t,e){e=qd(t.state,Vc,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=tu&&n.selection.ranges.every((t=>t.empty))&&tu==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function zd(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=rc.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}Wd.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},Nd.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),Wd.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},Wd.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},Nd.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(Qc))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=Xd(t,e),n=Gd(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=Xd(t,e),h=zd(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=zd(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new Vd(t,e,i,n)),n&&t.observer.ignore((()=>{fh(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let Id=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function Zd(t,e,i,n){let s=rc.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&Id(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&Id(i,n,l)?1:r&&r.bottom>=n?-1:1}function Xd(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:Zd(t,i,e.clientX,e.clientY)}}const jd=Vh.ie&&Vh.ie_version<=11;let Yd=null,Ud=0,Kd=0;function Gd(t){if(!jd)return t.detail;let e=Yd,i=Kd;return Yd=t,Kd=Date.now(),Ud=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(Ud+1)%3:1}function Jd(t,e,i,n){if(!(i=qd(t.state,Vc,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(Rc);return i.length?i[0](e):Vh.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}Nd.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",qd(t.state,Nc,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},Nd.dragend=t=>(t.inputState.draggedContent=null,!1),Nd.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&Jd(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return Jd(t,e,i,!0),!0}return!1},Nd.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=Hd?null:e.clipboardData;return i?(Fd(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),Fd(t,i.value)}),50)}(t),!1)};let tu=null;Nd.copy=Nd.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:qd(t,Nc,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;tu=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=Hd?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const eu=ui.define();function iu(t,e){let i=[];for(let n of t.facet(_c)){let s=n(t,e);s&&i.push(s)}return i.length?t.update({effects:i,annotations:eu.of(!0)}):null}function nu(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=iu(t.state,e);i?t.dispatch(i):t.update([])}}),10)}Wd.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),nu(t)},Wd.blur=t=>{t.observer.clearSelectionRange(),nu(t)},Wd.compositionstart=Wd.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},Wd.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Vh.chrome&&Vh.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},Wd.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},Nd.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return Ed(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if(Vh.chrome&&Vh.android&&(s=Bd.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return Vh.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),Vh.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>Wd.compositionend(t,e)),20),!1};const su=new Set,ou=["pre-wrap","normal","pre-line","break-spaces"];let ru=!1;function lu(){ru=!1}class au{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return ou.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=ou.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class hu{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class cu{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?Jh.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof nc?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new cu(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var du=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(du||(du={}));const uu=.001;class fu{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>uu&&(ru=!0),this.height=t)}replace(t,e,i){return fu.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,du.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,du.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,du.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=bu.build(i.setDoc(o),t,h,c);s=pu(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new mu(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new vu(fu.of(t.slice(0,e)),o,fu.of(t.slice(i)))}}function pu(t,e){return t==e?t:(t.constructor!=e.constructor&&(ru=!0),e)}fu.prototype.size=1;class gu extends fu{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new cu(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class mu extends gu{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new cu(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof mu||n instanceof Ou&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof Ou?n=new mu(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):fu.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Ou extends fu{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new cu(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new cu(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==du.ByHeight)return this.blockAt(t,i,n,s);if(e==du.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new cu(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new cu(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new cu(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof Ou?i[i.length-1]=new Ou(t.length+n):i.push(null,new Ou(n-1))}if(t>0){let e=i[0];e instanceof Ou?i[0]=new Ou(t+e.length):i.unshift(new Ou(t-1),null)}return fu.of(i)}decomposeLeft(t,e){e.push(new Ou(t-1),null)}decomposeRight(t,e){e.push(null,new Ou(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new Ou(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=uu&&(r=-2);let l=new mu(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new Ou(s-o).updateHeight(t,o));let l=fu.of(i);return(r<0||Math.abs(l.height-this.height)>=uu||Math.abs(r-this.heightMetrics(t,e).perLine)>=uu)&&(ru=!0),pu(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class vu extends fu{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==du.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==du.ByPosNoHeight?du.ByPosNoHeight:du.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,du.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&wu(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),wu(s,t)}return fu.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?fu.of(this.break?[t,null,e]:[t,e]):(this.left=pu(this.left,t),this.right=pu(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function wu(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof Ou&&(n=t[e+1])instanceof Ou&&t.splice(e-1,3,new Ou(i.length+1+n.length))}class bu{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof mu?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new mu(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new gu(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new mu(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new Ou(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof mu)return t;let e=new mu(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof mu||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new mu(0,-1));let i=t;for(let t of this.nodes)t instanceof mu&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new bu(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class yu{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&oc(t,e,this.changes,5)}}function Su(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function xu(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class ku{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return tc.replace({widget:new Mu(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class Mu extends Gh{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Cu{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Du,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=uc.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Jc).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new au(e),this.stateDeco=t.facet(td).filter((t=>"function"!=typeof t)),this.heightMap=fu.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new ad(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=tc.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new Au(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Du:new Eu(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(Ru(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(td).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=ad.extendWithRanges(n,function(t,e,i){let n=new yu;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);lu(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||ru)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(Hc)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?uc.RTL:uc.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=hh(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=Oh(t.scrollDOM);let f=(this.printing?xu:Su)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),lu();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?fu.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new ad(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new hu(i.from,s))}ru&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new Au(n.lineAt(o-1e3*i,du.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),du.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,du.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new Au(n.lineAt(i-500,du.ByHeight,s,0,0).from,n.lineAt(i+o+500,du.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new Au(this.heightMap.lineAt(i,du.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,du.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,du.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,du.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new ku(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=uc.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new ku(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=Jh.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=Pu(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=Tu(s,t),a=Tu(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=Pu(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=Tu(s,c),a=Tu(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=Pu(n,i)-Pu(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){ku.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=tc.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||Ru(this.heightMap.lineAt(t,du.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||Ru(this.heightMap.lineAt(this.scaler.fromDOM(t),du.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return Ru(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Au{constructor(t,e){this.from=t,this.to=e}}function Tu({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function Pu(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const Du={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class Eu{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,du.ByPos,t,0,0).top,r=e.lineAt(s,du.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof Eu&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function Ru(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new cu(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>Ru(t,e))):t._content)}const Qu=Fe.define({combine:t=>t.join(" ")}),Bu=Fe.define({combine:t=>t.indexOf(!0)>-1}),Lu=Yi.newName(),$u=Yi.newName(),_u=Yi.newName(),Vu={"&light":"."+$u,"&dark":"."+_u};function Nu(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const Wu=Nu("."+Lu,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Vu),Hu={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},qu=Vh.ie&&Vh.ie_version<=11;class Fu{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new ch,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(Vh.ie&&Vh.ie_version<=11||Vh.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||Vh.chrome&&Vh.chrome_version<126||(this.editContext=new Zu(t),t.state.facet(Xc)&&(t.contentDOM.editContext=this.editContext.editContext)),qu&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Xc)?i.root.activeElement!=this.dom:!th(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(Vh.ie&&Vh.ie_version<=11||Vh.android&&Vh.chrome)&&!i.state.selection.main.empty&&n.focusNode&&ih(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Ga(t.root);if(!e)return!1;let i=Vh.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return Iu(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?Iu(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=th(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,rh(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=rh(i))}else{if(i==t)return!0;n=nh(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Hu),qu&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),qu&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&gh(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&th(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new Pd(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=Dd(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=zu(e,t.previousSibling||t.target.previousSibling,-1),n=zu(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Xc)!=t.state.facet(Xc)&&(t.view.contentDOM.editContext=t.state.facet(Xc)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function zu(t,e,i){for(;e;){let n=Sh.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function Iu(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return ih(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class Zu{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if((Vh.mac||Vh.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);Ed(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(tc.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:Ic.of(tc.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=Ga(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class Xu{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new Cu(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(zc)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Yc).map((t=>new Kc(t)));for(let t of this.plugins)t.update(this);this.observer=new Fu(this),this.inputState=new Rd(this),this.inputState.ensureHandlers(this.plugins),this.docView=new cd(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(eu)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=iu(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=hd.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new Fc(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(zc)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=Uu.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(ld)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(Qu)!=e.state.facet(Qu)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(Lc))try{t(e)}catch(t){Zc(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!Dd(this,h)&&a.force&&gh(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new Cu(t),this.plugins=t.facet(Yc).map((t=>new Kc(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new cd(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Yc),i=t.state.facet(Yc);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new Kc(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){Zc(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(Oh(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return Zc(this.state,t),Yu}})),h=hd.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=Yu)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){Zc(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(Lc))t(e)}get themeClasses(){return Lu+" "+(this.state.facet(Bu)?_u:$u)+" "+this.state.facet(Qu)}updateAttrs(){let t=Ku(this,Gc,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Xc)?"true":"false",class:"cm-content",style:`${Vh.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Ku(this,Jc,e);let i=this.observer.ignore((()=>{let i=Uh(this.contentDOM,this.contentAttrs,e),n=Uh(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(Xu.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(ld);let t=this.state.facet(Xu.cspNonce);Yi.mount(this.root,this.styleModules.concat(Wu).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return kd(this,t,Sd(this,t,e,i))}moveByGroup(t,e){return kd(this,t,Sd(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=function(t,e,i){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let t;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;t&&(s.type!=Jh.Text||t.type==s.type&&!(i<0?s.from<e:s.to>e))||(t=s)}}return t||n}return n}(t,e.head,e.assoc||-1),o=n&&s.type==Jh.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==uc.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return kd(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=bd(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),bd(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return lh(i,s[Sc.find(s,t-n.from,-1,e)].dir==uc.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(Wc)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>ju)return Ac(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||xc(n.isolates,e=sd(this,t))))return n.order;e||(e=sd(this,t));let n=function(t,e,i){if(!t)return[new Sc(0,0,e==pc?1:0)];if(e==fc&&!i.length&&!yc.test(t))return Ac(t.length);if(i.length)for(;t.length>kc.length;)kc[kc.length]=256;let n=[],s=e==fc?0:1;return Cc(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new Uu(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Vh.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{fh(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return zc.of(new Fc("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return zc.of(new Fc(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return Uc.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return Uc.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[Qu.of(i),ld.of(Nu(`.${i}`,t))];return e&&e.dark&&n.push(Bu.of(!0)),n}static baseTheme(t){return Ge.lowest(ld.of(Nu("."+Lu,t,Vu)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&Sh.get(i)||Sh.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}Xu.styleModule=ld,Xu.inputHandler=$c,Xu.clipboardInputFilter=Vc,Xu.clipboardOutputFilter=Nc,Xu.scrollHandler=qc,Xu.focusChangeEffect=_c,Xu.perLineTextDirection=Wc,Xu.exceptionSink=Bc,Xu.updateListener=Lc,Xu.editable=Xc,Xu.mouseSelectionStyle=Qc,Xu.dragMovesSelection=Rc,Xu.clickAddsSelectionRange=Ec,Xu.decorations=td,Xu.outerDecorations=ed,Xu.atomicRanges=id,Xu.bidiIsolatedRanges=nd,Xu.scrollMargins=od,Xu.darkTheme=Bu,Xu.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),Xu.contentAttributes=Jc,Xu.editorAttributes=Gc,Xu.lineWrapping=Xu.contentAttributes.of({class:"cm-lineWrapping"}),Xu.announce=gi.define();const ju=4096,Yu={};class Uu{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:uc.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new Uu(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function Ku(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&Xh(o,i)}return i}class Gu extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}function Ju(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function tf(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function ef(t,e){if(!e.anchorNode)return!1;try{return tf(t,e.anchorNode)}catch(t){return!1}}function nf(t){return 3==t.nodeType?mf(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function sf(t,e,i,n){return!!i&&(lf(t,e,i,n,-1)||lf(t,e,i,n,1))}function of(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function rf(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function lf(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:af(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=of(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?af(t):0}}}function af(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function hf(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function cf(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function df(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}Gu.prototype.elementClass="",Gu.prototype.toDOM=void 0,Gu.prototype.mapMode=De.TrackBefore,Gu.prototype.startSide=Gu.prototype.endSide=-1,Gu.prototype.point=!0;class uf{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?af(e):0),i,Math.min(t.focusOffset,i?af(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let ff,pf=null;function gf(t){if(t.setActive)return t.setActive();if(pf)return t.focus(pf);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==pf?{get preventScroll(){return pf={preventScroll:!0},!0}}:void 0),!pf){pf=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function mf(t,e,i=e){let n=ff||(ff=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function Of(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function vf(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function wf(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function bf(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=af(i)}else{if(!i.parentNode||rf(i))return null;n=of(i),i=i.parentNode}}}function yf(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||rf(i))return null;n=of(i)+1,i=i.parentNode}}}class Sf{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Sf(t.parentNode,of(t),e)}static after(t,e){return new Sf(t.parentNode,of(t)+1,e)}}const xf=[];class kf{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=kf.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=Mf(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=Mf(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==af(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!kf.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=xf){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Cf(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function Mf(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}kf.prototype.breakAfter=0;class Cf{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Af(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function Tf(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,Af(t,h,c,l,a,n,0,s,o)}let Pf="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Df="undefined"!=typeof document?document:{documentElement:{style:{}}};const Ef=/Edge\/(\d+)/.exec(Pf.userAgent),Rf=/MSIE \d/.test(Pf.userAgent),Qf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Pf.userAgent),Bf=!!(Rf||Qf||Ef),Lf=!Bf&&/gecko\/(\d+)/i.test(Pf.userAgent),$f=!Bf&&/Chrome\/(\d+)/.exec(Pf.userAgent),_f="webkitFontSmoothing"in Df.documentElement.style,Vf=!Bf&&/Apple Computer/.test(Pf.vendor),Nf=Vf&&(/Mobile\/\w+/.test(Pf.userAgent)||Pf.maxTouchPoints>2);var Wf={mac:Nf||/Mac/.test(Pf.platform),windows:/Win/.test(Pf.platform),linux:/Linux|X11/.test(Pf.platform),ie:Bf,ie_version:Rf?Df.documentMode||6:Qf?+Qf[1]:Ef?+Ef[1]:0,gecko:Lf,gecko_version:Lf?+(/Firefox\/(\d+)/.exec(Pf.userAgent)||[0,0])[1]:0,chrome:!!$f,chrome_version:$f?+$f[1]:0,ios:Nf,android:/Android\b/.test(Pf.userAgent),webkit:_f,safari:Vf,webkit_version:_f?+(/\bAppleWebKit\/(\d+)/.exec(Pf.userAgent)||[0,0])[1]:0,tabSize:null!=Df.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class Hf extends kf{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof Hf)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new Hf(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Sf(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?Wf.chrome||Wf.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=mf(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return Wf.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?hf(a,r<0):a||null}(this.dom,t,e)}}class qf extends kf{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(vf(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof qf&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(Tf(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new qf(this.mark,e,o)}domAtPos(t){return If(this,t)}coordsAt(t,e){return Xf(this,t,e)}}class Ff extends kf{static create(t,e,i){return new Ff(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=Ff.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof Ff&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof Ff&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?Sf.before(this.dom):Sf.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return hf(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class zf extends kf{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof zf&&t.side==this.side}split(){return new zf(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Sf.before(this.dom):Sf.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function If(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new Sf(i,0)}function Zf(t,e,i){let n,{children:s}=t;i>0&&e instanceof qf&&s.length&&(n=s[s.length-1])instanceof qf&&n.mark.eq(e.mark)?Zf(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function Xf(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&(i>0||jf(o,c)))&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=nf(e);return i[i.length-1]||null}(t)}function jf(t,e){let i=t.coordsAt(0,1),n=e.coordsAt(0,1);return i&&n&&n.top<i.bottom}function Yf(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}Hf.prototype.children=Ff.prototype.children=zf.prototype.children=xf;const Uf=Object.create(null);function Kf(t,e,i){if(t==e)return!0;t||(t=Uf),e||(e=Uf);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function Gf(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function Jf(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class tp{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var ep=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(ep||(ep={}));class ip extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new np(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new op(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=rp(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new op(t,e,i,n,t.widget||null,!0)}static line(t){return new sp(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}ip.none=Ri.empty;class np extends ip{constructor(t){let{start:e,end:i}=rp(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof np&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&Kf(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}np.prototype.point=!1;class sp extends ip{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof sp&&this.spec.class==t.spec.class&&Kf(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}sp.prototype.mapMode=De.TrackBefore,sp.prototype.point=!0;class op extends ip{constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?ep.WidgetRange:this.startSide<=0?ep.WidgetBefore:ep.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof op&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function rp(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function lp(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}op.prototype.point=!0;class ap extends kf{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof ap))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Tf(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new ap;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){Kf(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Zf(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Yf(e,this.attrs||{})),i&&(this.attrs=Yf({class:i},this.attrs||{}))}domAtPos(t){return If(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(vf(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(Gf(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&kf.get(n)instanceof qf;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=kf.get(n))||void 0===i?void 0:i.isEditable)||Wf.ios&&this.children.some((t=>t instanceof Hf))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof Hf)||/[^ -~]/.test(i.text))return null;let n=nf(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=Xf(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof ap&&0==this.children.length&&0==t.children.length&&Kf(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof ap)return s;if(o>e)break}n=o+s.breakAfter}return null}}class hp extends kf{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof hp&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?Sf.before(this.dom):Sf.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new hp(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return xf}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof hp&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof cp?null:hf(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class cp extends tp{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class dp{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof hp&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new ap),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(up(new zf(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof hp||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(up(new Hf(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof op){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof op)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new hp(i.widget||fp.block,r,i));else{let o=Ff.create(i.widget||fp.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(up(new zf(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(up(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new dp(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function up(t,e){for(let i of e)t=new qf(i,[t],t.length);return t}class fp extends tp{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}fp.inline=new fp("span"),fp.block=new fp("div");var pp=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(pp||(pp={}));const gp=pp.LTR,mp=pp.RTL;function Op(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const vp=Op("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),wp=Op("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),bp=Object.create(null),yp=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);bp[e]=i,bp[i]=-e}function Sp(t){return t<=247?vp[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?wp[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const xp=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class kp{get dir(){return this.level%2?mp:gp}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function Mp(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!Mp(n.inner,s.inner))return!1}return!0}const Cp=[];function Ap(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=Cp[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if(Cp[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new kp(a,p.from,u)),Tp(t,p.direction==gp!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?Cp[f]!=l:Cp[f]==l))break;f++}d?Ap(t,a,f,n+1,s,d,r):a<f&&r.push(new kp(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=Cp[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if(Cp[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new kp(p.to,a,u)),Tp(t,p.direction==gp!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?Cp[f-1]!=l:Cp[f-1]==l))break;f--}d?Ap(t,f,a,n+1,s,d,r):f<a&&r.push(new kp(f,a,u)),a=f}}function Tp(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=Sp(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),Cp[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=Cp[t];if(128==s)t<l-1&&e==Cp[t+1]&&24&e?s=Cp[t]=e:Cp[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==Cp[s];)s++;let o=t&&8==e||s<i&&8==Cp[s]?1==n?1:8:256;for(let e=t;e<s;e++)Cp[e]=o;t=s-1}else 8==s&&1==n&&(Cp[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=bp[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(yp[t+1]==-i){let e=yp[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&(Cp[r]=Cp[yp[t]]=i),l=t;break}}else{if(189==yp.length)break;yp[l++]=r,yp[l++]=e,yp[l++]=a}else if(2==(n=Cp[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=yp[e+2];if(2&i)break;if(t)yp[e+2]|=2;else{if(4&i)break;yp[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=Cp[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=Cp[r])break;r++}let h=1==o,c=h==(1==(r<e?Cp[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),Cp[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),Ap(t,s,o,e,i,n,r)}function Pp(t){return[new kp(0,t,0)]}let Dp="";function Ep(t,e,i,n,s){var o;let r=n.head-t.from,l=kp.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),Dp=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function Rp(t,e,i){for(let n=e;n<i;n++){let e=Sp(t.charCodeAt(n));if(1==e)return gp;if(2==e||4==e)return mp}return gp}const Qp=Fe.define(),Bp=Fe.define(),Lp=Fe.define(),$p=Fe.define(),_p=Fe.define(),Vp=Fe.define(),Np=Fe.define(),Wp=Fe.define(),Hp=Fe.define(),qp=Fe.define({combine:t=>t.some((t=>t))}),Fp=Fe.define({combine:t=>t.some((t=>t))}),zp=Fe.define();class Ip{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new Ip(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new Ip(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Zp=gi.define({map:(t,e)=>t.map(e)}),Xp=gi.define();function jp(t,e,i){let n=t.facet($p);n.length?n[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const Yp=Fe.define({combine:t=>!t.length||t[0]});let Up=0;const Kp=Fe.define();class Gp{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new Gp(Up++,t,i,n,(t=>{let e=[Kp.of(t)];return o&&e.push(ig.of((e=>{let i=e.plugin(t);return i?o(i):ip.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return Gp.define((e=>new t(e)),e)}}class Jp{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(jp(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){jp(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){jp(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const tg=Fe.define(),eg=Fe.define(),ig=Fe.define(),ng=Fe.define(),sg=Fe.define(),og=Fe.define();function rg(t,e){let i=t.state.facet(og);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=Rp(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const lg=Fe.define();function ag(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(lg)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const hg=Fe.define();class cg{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new cg(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new cg(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new cg(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class dg{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new cg(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new dg(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class ug extends kf{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ip.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new ap],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new cg(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=fg(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new cg(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=kf.get(e);if(i instanceof qf)c.push({node:e,deco:i.mark});else{if(i instanceof ap||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new np({inclusive:!0,attributes:Jf(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new cg(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Wf.ie||Wf.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new pg;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=cg.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=Wf.chrome||Wf.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof hp&&t.widget instanceof cp&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=dp.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=dp.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=dp.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);Af(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(Xp)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new Hf(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new qf(i,[e],e.length);let i=new ap;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=kf.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(Yp)||this.dom.tabIndex>-1)&&ef(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if(Wf.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new Sf(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(sf(l.node,l.offset,c.anchorNode,c.anchorOffset)&&sf(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{Wf.android&&Wf.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=Ju(this.view.root);if(t)if(r.empty){if(Wf.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?bf:yf)(l.node,l.offset);e&&(l=new Sf(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new Sf(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new Sf(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&sf(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=Ju(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=ap.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=kf.get(i.childNodes[n]);t instanceof ap&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=kf.get(i.childNodes[n]);t instanceof ap&&(e=t.domAtPos(t.length))}return e?new Sf(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=kf.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof ap)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof ap&&!(i instanceof ap&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof hp&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof ap))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof Hf))return null;let s=Me(n.text,i);if(s==i)return null;let o=mf(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==pp.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?nf(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?pp.RTL:pp.LTR}measureTextSize(){for(let t of this.children)if(t instanceof ap){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=nf(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new Cf(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(ip.replace({widget:new cp(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return ip.set(t)}updateDeco(){let t=1,e=this.view.state.facet(ig).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(ng).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(zp))try{if(e(this.view,t.range,t))return!0}catch(t){jp(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=ag(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=cf(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=df(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==pp.LTR)}}function fg(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=bf(i.focusNode,i.focusOffset),s=yf(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=kf.get(s.node);if(!e||e instanceof Hf&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=kf.get(n.node);!t||t instanceof Hf&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let pg=class{constructor(){this.changes=[]}compareRange(t,e){lp(t,e,this.changes)}comparePoint(t,e){lp(t,e,this.changes)}boundChange(t){lp(t,t,this.changes)}};function gg(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function mg(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Og(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function vg(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function wg(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function bg(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=nf(u);for(let f=0;f<t.length;f++){let p=t[f];s&&Og(s,p)&&(p=vg(wg(p,s.bottom),s.top));let g=gg(e,p),m=mg(i,p);if(0==g&&0==m)return 3==u.nodeType?yg(u,e,i):bg(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&Og(h,p)?h=wg(h,p.bottom):c&&Og(c,p)&&(c=vg(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?yg(n,u,i):d&&"false"!=n.contentEditable?bg(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function yg(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=mf(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if((Wf.chrome||Wf.gecko)&&mf(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function Sg(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=ep.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:xg(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:xg(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||Wf.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return mf(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||Wf.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():mf(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(af(O),v))}if(!O||!t.docView.dom.contains(O)){let e=ap.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=bg(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function xg(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function kg(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=Ep(s,o,r,l,i),h=Dp;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function Mg(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function Cg(t,e,i){let n=Mg(t.state.facet(sg).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const Ag="￿";class Tg{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Ag}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=kf.get(n),r=kf.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:rf(n))||rf(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=kf.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(Pg(t,i.node,i.offset)?e:0))}}function Pg(t,e,i){for(;;){if(!e||i<af(e))return!1;if(e==t)return!0;i=of(e)+1,e=e.parentNode}}class Dg{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Eg{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new Dg(i,n)),s==i&&o==n||e.push(new Dg(s,o))),e}(t),i=new Tg(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!tf(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!tf(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if((Wf.ios||Wf.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function Rg(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||Wf.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,Ag),e.text,l-n,a);h&&(Wf.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Ag+Ag&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(Ag))})}else n&&(!t.hasFocus&&t.state.facet(Yp)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(Wf.mac||Wf.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:Wf.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return Qg(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function Qg(t,e,i,n=-1){if(Wf.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(Wf.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&Of(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&Of(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&Of(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&fg(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet(Vp).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class Bg{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,Wf.safari&&t.contentDOM.addEventListener("input",(()=>null)),Wf.gecko&&function(t){rm.has(t)||(rm.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=kf.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(Lg(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(Lg(e.value,s))}}for(let t in Hg)i(t).handlers.push(Hg[t]);for(let t in qg)i(t).observers.push(qg[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&Vg.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),Wf.android&&Wf.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!Wf.ios||t.synthetic||t.altKey||t.metaKey||!((e=$g.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||_g.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,Of(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(Wf.safari&&!Wf.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Lg(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){jp(i.state,t)}}}const $g=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],_g="dthko",Vg=[16,17,18,20,91,92,224,225];function Ng(t){return.7*Math.max(0,t)+8}class Wg{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(sg).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(Qp);return i.length?i[0](e):Wf.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=Ju(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=tm(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=ag(this.view);t.clientX-h.left<=o+6?n=-Ng(o-t.clientX):t.clientX+h.right>=l-6&&(n=Ng(t.clientX-l)),t.clientY-h.top<=r+6?s=-Ng(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=Ng(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=Mg(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=Mg(this.atoms,n.from,-1),e=Mg(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const Hg=Object.create(null),qg=Object.create(null),Fg=Wf.ie&&Wf.ie_version<15||Wf.ios&&Wf.webkit_version<604;function zg(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function Ig(t,e){e=zg(t.state,Wp,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=im&&n.selection.ranges.every((t=>t.empty))&&im==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function Zg(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=ap.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}qg.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},Hg.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),qg.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},qg.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},Hg.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(Lp))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=Yg(t,e),n=tm(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=Yg(t,e),h=Zg(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=Zg(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new Wg(t,e,i,n)),n&&t.observer.ignore((()=>{gf(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let Xg=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function jg(t,e,i,n){let s=ap.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&Xg(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&Xg(i,n,l)?1:r&&r.bottom>=n?-1:1}function Yg(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:jg(t,i,e.clientX,e.clientY)}}const Ug=Wf.ie&&Wf.ie_version<=11;let Kg=null,Gg=0,Jg=0;function tm(t){if(!Ug)return t.detail;let e=Kg,i=Jg;return Kg=t,Jg=Date.now(),Gg=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(Gg+1)%3:1}function em(t,e,i,n){if(!(i=zg(t.state,Wp,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(Bp);return i.length?i[0](e):Wf.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}Hg.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",zg(t.state,Hp,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},Hg.dragend=t=>(t.inputState.draggedContent=null,!1),Hg.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&em(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return em(t,e,i,!0),!0}return!1},Hg.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=Fg?null:e.clipboardData;return i?(Ig(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),Ig(t,i.value)}),50)}(t),!1)};let im=null;Hg.copy=Hg.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:zg(t,Hp,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;im=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=Fg?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const nm=ui.define();function sm(t,e){let i=[];for(let n of t.facet(Np)){let s=n(t,e);s&&i.push(s)}return i.length?t.update({effects:i,annotations:nm.of(!0)}):null}function om(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=sm(t.state,e);i?t.dispatch(i):t.update([])}}),10)}qg.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),om(t)},qg.blur=t=>{t.observer.clearSelectionRange(),om(t)},qg.compositionstart=qg.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},qg.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Wf.chrome&&Wf.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},qg.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},Hg.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return Qg(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if(Wf.chrome&&Wf.android&&(s=$g.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return Wf.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),Wf.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>qg.compositionend(t,e)),20),!1};const rm=new Set,lm=["pre-wrap","normal","pre-line","break-spaces"];let am=!1;function hm(){am=!1}class cm{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return lm.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=lm.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class dm{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class um{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?ep.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof op?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new um(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var fm=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(fm||(fm={}));const pm=.001;class gm{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>pm&&(am=!0),this.height=t)}replace(t,e,i){return gm.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,fm.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,fm.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,fm.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=Sm.build(i.setDoc(o),t,h,c);s=mm(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new vm(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new bm(gm.of(t.slice(0,e)),o,gm.of(t.slice(i)))}}function mm(t,e){return t==e?t:(t.constructor!=e.constructor&&(am=!0),e)}gm.prototype.size=1;class Om extends gm{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new um(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class vm extends Om{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new um(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof vm||n instanceof wm&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof wm?n=new vm(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):gm.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class wm extends gm{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new um(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new um(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==fm.ByHeight)return this.blockAt(t,i,n,s);if(e==fm.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new um(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new um(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new um(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof wm?i[i.length-1]=new wm(t.length+n):i.push(null,new wm(n-1))}if(t>0){let e=i[0];e instanceof wm?i[0]=new wm(t+e.length):i.unshift(new wm(t-1),null)}return gm.of(i)}decomposeLeft(t,e){e.push(new wm(t-1),null)}decomposeRight(t,e){e.push(null,new wm(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new wm(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=pm&&(r=-2);let l=new vm(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new wm(s-o).updateHeight(t,o));let l=gm.of(i);return(r<0||Math.abs(l.height-this.height)>=pm||Math.abs(r-this.heightMetrics(t,e).perLine)>=pm)&&(am=!0),mm(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class bm extends gm{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==fm.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==fm.ByPosNoHeight?fm.ByPosNoHeight:fm.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,fm.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&ym(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),ym(s,t)}return gm.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?gm.of(this.break?[t,null,e]:[t,e]):(this.left=mm(this.left,t),this.right=mm(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function ym(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof wm&&(n=t[e+1])instanceof wm&&t.splice(e-1,3,new wm(i.length+1+n.length))}class Sm{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof vm?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new vm(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new Om(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new vm(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new wm(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof vm)return t;let e=new vm(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof vm||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new vm(0,-1));let i=t;for(let t of this.nodes)t instanceof vm&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new Sm(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class xm{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&lp(t,e,this.changes,5)}}function km(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function Mm(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class Cm{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return ip.replace({widget:new Am(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class Am extends tp{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Tm{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Rm,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=pp.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(eg).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new cm(e),this.stateDeco=t.facet(ig).filter((t=>"function"!=typeof t)),this.heightMap=gm.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new cg(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ip.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new Pm(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Rm:new Qm(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(Bm(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(ig).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=cg.extendWithRanges(n,function(t,e,i){let n=new xm;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);hm(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||am)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(Fp)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?pp.RTL:pp.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=df(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=wf(t.scrollDOM);let f=(this.printing?Mm:km)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),hm();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?gm.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new cg(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new dm(i.from,s))}am&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new Pm(n.lineAt(o-1e3*i,fm.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),fm.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,fm.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new Pm(n.lineAt(i-500,fm.ByHeight,s,0,0).from,n.lineAt(i+o+500,fm.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new Pm(this.heightMap.lineAt(i,fm.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,fm.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,fm.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,fm.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new Cm(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=pp.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new Cm(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=ep.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=Em(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=Dm(s,t),a=Dm(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=Em(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=Dm(s,c),a=Dm(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=Em(n,i)-Em(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){Cm.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=ip.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||Bm(this.heightMap.lineAt(t,fm.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||Bm(this.heightMap.lineAt(this.scaler.fromDOM(t),fm.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return Bm(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Pm{constructor(t,e){this.from=t,this.to=e}}function Dm({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function Em(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const Rm={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class Qm{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,fm.ByPos,t,0,0).top,r=e.lineAt(s,fm.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof Qm&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function Bm(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new um(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>Bm(t,e))):t._content)}const Lm=Fe.define({combine:t=>t.join(" ")}),$m=Fe.define({combine:t=>t.indexOf(!0)>-1}),_m=Yi.newName(),Vm=Yi.newName(),Nm=Yi.newName(),Wm={"&light":"."+Vm,"&dark":"."+Nm};function Hm(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const qm=Hm("."+_m,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Wm),Fm={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},zm=Wf.ie&&Wf.ie_version<=11;class Im{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new uf,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(Wf.ie&&Wf.ie_version<=11||Wf.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||Wf.chrome&&Wf.chrome_version<126||(this.editContext=new jm(t),t.state.facet(Yp)&&(t.contentDOM.editContext=this.editContext.editContext)),zm&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Yp)?i.root.activeElement!=this.dom:!ef(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(Wf.ie&&Wf.ie_version<=11||Wf.android&&Wf.chrome)&&!i.state.selection.main.empty&&n.focusNode&&sf(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Ju(t.root);if(!e)return!1;let i=Wf.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return Xm(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?Xm(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=ef(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,af(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=af(i))}else{if(i==t)return!0;n=of(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Fm),zm&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),zm&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&Of(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&ef(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new Eg(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=Rg(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=Zm(e,t.previousSibling||t.target.previousSibling,-1),n=Zm(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(Yp)!=t.state.facet(Yp)&&(t.view.contentDOM.editContext=t.state.facet(Yp)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function Zm(t,e,i){for(;e;){let n=kf.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function Xm(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return sf(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class jm{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if((Wf.mac||Wf.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);Qg(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(ip.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:Xp.of(ip.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=Ju(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class Ym{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new Tm(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(Zp)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(Kp).map((t=>new Jp(t)));for(let t of this.plugins)t.update(this);this.observer=new Im(this),this.inputState=new Bg(this),this.inputState.ensureHandlers(this.plugins),this.docView=new ug(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(nm)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=sm(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=dg.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new Ip(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(Zp)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=Gm.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(hg)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(Lm)!=e.state.facet(Lm)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(_p))try{t(e)}catch(t){jp(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!Rg(this,h)&&a.force&&Of(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new Tm(t),this.plugins=t.facet(Kp).map((t=>new Jp(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new ug(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(Kp),i=t.state.facet(Kp);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new Jp(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){jp(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(wf(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return jp(this.state,t),Km}})),h=dg.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=Km)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){jp(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(_p))t(e)}get themeClasses(){return _m+" "+(this.state.facet($m)?Nm:Vm)+" "+this.state.facet(Lm)}updateAttrs(){let t=Jm(this,tg,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Yp)?"true":"false",class:"cm-content",style:`${Wf.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),Jm(this,eg,e);let i=this.observer.ignore((()=>{let i=Gf(this.contentDOM,this.contentAttrs,e),n=Gf(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(Ym.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(hg);let t=this.state.facet(Ym.cspNonce);Yi.mount(this.root,this.styleModules.concat(qm).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Cg(this,t,kg(this,t,e,i))}moveByGroup(t,e){return Cg(this,t,kg(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=function(t,e,i){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let t;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;t&&(s.type!=ep.Text||t.type==s.type&&!(i<0?s.from<e:s.to>e))||(t=s)}}return t||n}return n}(t,e.head,e.assoc||-1),o=n&&s.type==ep.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==pp.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return Cg(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=Sg(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Sg(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return hf(i,s[kp.find(s,t-n.from,-1,e)].dir==pp.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(qp)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Um)return Pp(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||Mp(n.isolates,e=rg(this,t))))return n.order;e||(e=rg(this,t));let n=function(t,e,i){if(!t)return[new kp(0,0,e==mp?1:0)];if(e==gp&&!i.length&&!xp.test(t))return Pp(t.length);if(i.length)for(;t.length>Cp.length;)Cp[Cp.length]=256;let n=[],s=e==gp?0:1;return Tp(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new Gm(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Wf.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{gf(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return Zp.of(new Ip("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return Zp.of(new Ip(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return Gp.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return Gp.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[Lm.of(i),hg.of(Hm(`.${i}`,t))];return e&&e.dark&&n.push($m.of(!0)),n}static baseTheme(t){return Ge.lowest(hg.of(Hm("."+_m,t,Wm)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&kf.get(i)||kf.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}Ym.styleModule=hg,Ym.inputHandler=Vp,Ym.clipboardInputFilter=Wp,Ym.clipboardOutputFilter=Hp,Ym.scrollHandler=zp,Ym.focusChangeEffect=Np,Ym.perLineTextDirection=qp,Ym.exceptionSink=$p,Ym.updateListener=_p,Ym.editable=Yp,Ym.mouseSelectionStyle=Lp,Ym.dragMovesSelection=Bp,Ym.clickAddsSelectionRange=Qp,Ym.decorations=ig,Ym.outerDecorations=ng,Ym.atomicRanges=sg,Ym.bidiIsolatedRanges=og,Ym.scrollMargins=lg,Ym.darkTheme=$m,Ym.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),Ym.contentAttributes=eg,Ym.editorAttributes=tg,Ym.lineWrapping=Ym.contentAttributes.of({class:"cm-lineWrapping"}),Ym.announce=gi.define();const Um=4096,Km={};class Gm{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:pp.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new Gm(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function Jm(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&Yf(o,i)}return i}const tO=Wf.mac?"mac":Wf.windows?"win":Wf.linux?"linux":"key";function eO(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const iO=Ge.default(Ym.domEventHandlers({keydown(t,e){return function(t,e,i,n){lO=e;let s=on(e),o=Te(Ce(s,0))==s.length&&" "!=s,r="",l=!1,a=!1,h=!1;oO&&oO.view==i&&oO.scope==n&&(r=oO.prefix+" ",Vg.indexOf(e.keyCode)<0&&(a=!0,oO=null));let c,d,u=new Set,f=t=>{if(t){for(let e of t.run)if(!u.has(e)&&(u.add(e),e(i)))return t.stopPropagation&&(h=!0),!0;t.preventDefault&&(t.stopPropagation&&(h=!0),a=!0)}return!1},p=t[n];return p&&(f(p[r+eO(s,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Wf.windows&&e.ctrlKey&&e.altKey)&&(c=Gi[e.keyCode])&&c!=s?(f(p[r+eO(c,e,!0)])||e.shiftKey&&(d=Ji[e.keyCode])!=s&&d!=c&&f(p[r+eO(d,e,!1)]))&&(l=!0):o&&e.shiftKey&&f(p[r+eO(s,e,!0)])&&(l=!0),!l&&f(p._any)&&(l=!0)),a&&(l=!0),l&&h&&e.stopPropagation(),lO=null,l}(function(t){let e=t.facet(nO),i=sO.get(e);return i||sO.set(e,i=function(t,e=tO){let i=Object.create(null),n=Object.create(null),s=(t,e)=>{let i=n[t];if(null==i)n[t]=e;else if(i!=e)throw new Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},o=(t,n,o,r,l)=>{var a,h;let c=i[t]||(i[t]=Object.create(null)),d=n.split(/ (?!$)/).map((t=>function(t,e){const i=t.split(/-(?!$)/);let n,s,o,r,l=i[i.length-1];"Space"==l&&(l=" ");for(let t=0;t<i.length-1;++t){const l=i[t];if(/^(cmd|meta|m)$/i.test(l))r=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);"mac"==e?r=!0:s=!0}}return n&&(l="Alt-"+l),s&&(l="Ctrl-"+l),r&&(l="Meta-"+l),o&&(l="Shift-"+l),l}(t,e)));for(let e=1;e<d.length;e++){let i=d.slice(0,e).join(" ");s(i,!0),c[i]||(c[i]={preventDefault:!0,stopPropagation:!1,run:[e=>{let n=oO={view:e,prefix:i,scope:t};return setTimeout((()=>{oO==n&&(oO=null)}),rO),!0}]})}let u=d.join(" ");s(u,!1);let f=c[u]||(c[u]={preventDefault:!1,stopPropagation:!1,run:(null===(h=null===(a=c._any)||void 0===a?void 0:a.run)||void 0===h?void 0:h.slice())||[]});o&&f.run.push(o),r&&(f.preventDefault=!0),l&&(f.stopPropagation=!0)};for(let n of t){let t=n.scope?n.scope.split(" "):["editor"];if(n.any)for(let e of t){let t=i[e]||(i[e]=Object.create(null));t._any||(t._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:s}=n;for(let e in t)t[e].run.push((t=>s(t,lO)))}let s=n[e]||n.key;if(s)for(let e of t)o(e,s,n.run,n.preventDefault,n.stopPropagation),n.shift&&o(e,"Shift-"+s,n.shift,n.preventDefault,n.stopPropagation)}return i}(e.reduce(((t,e)=>t.concat(e)),[]))),i}(e.state),t,e,"editor")}})),nO=Fe.define({enables:iO}),sO=new WeakMap;let oO=null;const rO=4e3;let lO=null;const aO="-10000px";class hO{constructor(t,e,i,n){this.facet=e,this.createTooltipView=i,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter((t=>t));let s=null;this.tooltipViews=this.tooltips.map((t=>s=i(t,s)))}update(t,e){var i;let n=t.state.facet(this.facet),s=n.filter((t=>t));if(n===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let o=[],r=e?[]:null;for(let i=0;i<s.length;i++){let n=s[i],l=-1;if(n){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==n.create&&(l=t)}if(l<0)o[i]=this.createTooltipView(n,i?o[i-1]:null),r&&(r[i]=!!n.above);else{let n=o[i]=this.tooltipViews[l];r&&(r[i]=e[l]),n.update&&n.update(t)}}}for(let t of this.tooltipViews)o.indexOf(t)<0&&(this.removeTooltipView(t),null===(i=t.destroy)||void 0===i||i.call(t));return e&&(r.forEach(((t,i)=>e[i]=t)),e.length=r.length),this.input=n,this.tooltips=s,this.tooltipViews=o,!0}}function cO(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const dO=Fe.define({combine:t=>{var e,i,n;return{position:Wf.ios?"absolute":(null===(e=t.find((t=>t.position)))||void 0===e?void 0:e.position)||"fixed",parent:(null===(i=t.find((t=>t.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=t.find((t=>t.tooltipSpace)))||void 0===n?void 0:n.tooltipSpace)||cO}}}),uO=new WeakMap,fO=Gp.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(dO);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver((()=>this.measureSoon())):null,this.manager=new hO(t,OO,((t,e)=>this.createTooltip(t,e)),(t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()})),this.above=this.manager.tooltips.map((t=>!!t.above)),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let i=e||t.geometryChanged,n=t.state.facet(dO);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let t of this.manager.tooltipViews)t.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let t of this.manager.tooltipViews)this.container.appendChild(t.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(t,e){let i=t.create(this.view),n=e?e.dom:null;if(i.dom.classList.add("cm-tooltip"),t.arrow&&!i.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",i.dom.appendChild(t)}return i.dom.style.position=this.position,i.dom.style.top=aO,i.dom.style.left="0px",this.container.insertBefore(i.dom,n),i.mount&&i.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(i.dom),i}destroy(){var t,e,i;this.view.win.removeEventListener("resize",this.measureSoon);for(let e of this.manager.tooltipViews)e.dom.remove(),null===(t=e.destroy)||void 0===t||t.call(e);this.parent&&this.container.remove(),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),null===(i=this.intersectionObserver)||void 0===i||i.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,i=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:t}=this.manager.tooltipViews[0];if(Wf.gecko)i=t.offsetParent!=this.container.ownerDocument.body;else if(t.style.top==aO&&"0px"==t.style.left){let e=t.getBoundingClientRect();i=Math.abs(e.top+1e4)>1||Math.abs(e.left)>1}}if(i||"absolute"==this.position)if(this.parent){let i=this.parent.getBoundingClientRect();i.width&&i.height&&(t=i.width/this.parent.offsetWidth,e=i.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),s=ag(this.view);return{visible:{left:n.left+s.left,top:n.top+s.top,right:n.right-s.right,bottom:n.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map(((t,e)=>{let i=this.manager.tooltipViews[e];return i.getCoords?i.getCoords(t.pos):this.view.coordsAtPos(t.pos)})),size:this.manager.tooltipViews.map((({dom:t})=>t.getBoundingClientRect())),space:this.view.state.facet(dO).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:i}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let t of this.manager.tooltipViews)t.dom.style.position="absolute"}let{visible:i,space:n,scaleX:s,scaleY:o}=t,r=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],h=this.manager.tooltipViews[l],{dom:c}=h,d=t.pos[l],u=t.size[l];if(!d||!1!==a.clip&&(d.bottom<=Math.max(i.top,n.top)||d.top>=Math.min(i.bottom,n.bottom)||d.right<Math.max(i.left,n.left)-.1||d.left>Math.min(i.right,n.right)+.1)){c.style.top=aO;continue}let f=a.arrow?h.dom.querySelector(".cm-tooltip-arrow"):null,p=f?7:0,g=u.right-u.left,m=null!==(e=uO.get(h))&&void 0!==e?e:u.bottom-u.top,O=h.offset||mO,v=this.view.textDirection==pp.LTR,w=u.width>n.right-n.left?v?n.left:n.right-u.width:v?Math.max(n.left,Math.min(d.left-(f?14:0)+O.x,n.right-g)):Math.min(Math.max(n.left,d.left-g+(f?14:0)-O.x),n.right-g),b=this.above[l];!a.strictSide&&(b?d.top-m-p-O.y<n.top:d.bottom+m+p+O.y>n.bottom)&&b==n.bottom-d.bottom>d.top-n.top&&(b=this.above[l]=!b);let y=(b?d.top-n.top:n.bottom-d.bottom)-p;if(y<m&&!1!==h.resize){if(y<this.view.defaultLineHeight){c.style.top=aO;continue}uO.set(h,m),c.style.height=(m=y)/o+"px"}else c.style.height&&(c.style.height="");let S=b?d.top-m-p-O.y:d.bottom+p+O.y,x=w+g;if(!0!==h.overlap)for(let t of r)t.left<x&&t.right>w&&t.top<S+m&&t.bottom>S&&(S=b?t.top-m-2-p:t.bottom+p+2);if("absolute"==this.position?(c.style.top=(S-t.parent.top)/o+"px",pO(c,(w-t.parent.left)/s)):(c.style.top=S/o+"px",pO(c,w/s)),f){let t=d.left+(v?O.x:-O.x)-(w+14-7);f.style.left=t/s+"px"}!0!==h.overlap&&r.push({left:w,top:S,right:x,bottom:S+m}),c.classList.toggle("cm-tooltip-above",b),c.classList.toggle("cm-tooltip-below",!b),h.positioned&&h.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=aO}},{eventObservers:{scroll(){this.maybeMeasure()}}});function pO(t,e){let i=parseInt(t.style.left,10);(isNaN(i)||Math.abs(e-i)>1)&&(t.style.left=e+"px")}const gO=Ym.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),mO={x:0,y:0},OO=Fe.define({enables:[fO,gO]});function vO(t,e){let i=t.plugin(fO);if(!i)return null;let n=i.manager.tooltips.indexOf(e);return n<0?null:i.manager.tooltipViews[n]}class wO extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}wO.prototype.elementClass="",wO.prototype.toDOM=void 0,wO.prototype.mapMode=De.TrackBefore,wO.prototype.startSide=wO.prototype.endSide=-1,wO.prototype.point=!0;class bO{constructor(t,e,i,n){this.state=t,this.pos=e,this.explicit=i,this.view=n,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(t){let e=Pl(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),s=n.search(MO(t,!1));return s<0?null:{from:i+s,to:this.pos,text:n.slice(s)}}get aborted(){return null==this.abortListeners}addEventListener(t,e,i){"abort"==t&&this.abortListeners&&(this.abortListeners.push(e),i&&i.onDocChange&&(this.abortOnDocChange=!0))}}function yO(t){let e=Object.keys(t).join(""),i=/\w/.test(e);return i&&(e=e.replace(/\w/g,"")),`[${i?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function SO(t){let e=t.map((t=>"string"==typeof t?{label:t}:t)),[i,n]=e.every((t=>/^\w+$/.test(t.label)))?[/\w*$/,/\w+$/]:function(t){let e=Object.create(null),i=Object.create(null);for(let{label:n}of t){e[n[0]]=!0;for(let t=1;t<n.length;t++)i[n[t]]=!0}let n=yO(e)+yO(i)+"*$";return[new RegExp("^"+n),new RegExp(n)]}(e);return t=>{let s=t.matchBefore(n);return s||t.explicit?{from:s?s.from:t.pos,options:e,validFor:i}:null}}class xO{constructor(t,e,i,n){this.completion=t,this.source=e,this.match=i,this.score=n}}function kO(t){return t.selection.main.from}function MO(t,e){var i;let{source:n}=t,s=e&&"^"!=n[0],o="$"!=n[n.length-1];return s||o?new RegExp(`${s?"^":""}(?:${n})${o?"$":""}`,null!==(i=t.flags)&&void 0!==i?i:t.ignoreCase?"i":""):t}const CO=ui.define(),AO=new WeakMap;function TO(t){if(!Array.isArray(t))return t;let e=AO.get(t);return e||AO.set(t,e=SO(t)),e}const PO=gi.define(),DO=gi.define();class EO{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let e=0;e<t.length;){let i=Ce(t,e),n=Te(i);this.chars.push(i);let s=t.slice(e,e+n),o=s.toUpperCase();this.folded.push(Ce(o==s?s.toLowerCase():o,0)),e+=n}this.astral=t.length!=this.chars.length}ret(t,e){return this.score=t,this.matched=e,this}match(t){if(0==this.pattern.length)return this.ret(-100,[]);if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:s,byWord:o}=this;if(1==e.length){let n=Ce(t,0),s=Te(n),o=s==t.length?0:-100;if(n==e[0]);else{if(n!=i[0])return null;o+=-200}return this.ret(o,[0,s])}let r=t.indexOf(this.pattern);if(0==r)return this.ret(t.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=e.length,a=0;if(r<0){for(let s=0,o=Math.min(t.length,200);s<o&&a<l;){let o=Ce(t,s);o!=e[a]&&o!=i[a]||(n[a++]=s),s+=Te(o)}if(a<l)return null}let h=0,c=0,d=!1,u=0,f=-1,p=-1,g=/[a-z]/.test(t),m=!0;for(let n=0,a=Math.min(t.length,200),O=0;n<a&&c<l;){let a=Ce(t,n);r<0&&(h<l&&a==e[h]&&(s[h++]=n),u<l&&(a==e[u]||a==i[u]?(0==u&&(f=n),p=n+1,u++):u=0));let v,w=a<255?a>=48&&a<=57||a>=97&&a<=122?2:a>=65&&a<=90?1:0:(v=Ae(a))!=v.toLowerCase()?1:v!=v.toUpperCase()?2:0;(!n||1==w&&g||0==O&&0!=w)&&(e[c]==a||i[c]==a&&(d=!0)?o[c++]=n:o.length&&(m=!1)),O=w,n+=Te(a)}return c==l&&0==o[0]&&m?this.result((d?-200:0)-100,o,t):u==l&&0==f?this.ret(-200-t.length+(p==t.length?0:-100),[0,p]):r>-1?this.ret(-700-t.length,[r,r+this.pattern.length]):u==l?this.ret(-900-t.length,[f,p]):c==l?this.result((d?-200:0)-100-700+(m?0:-1100),o,t):2==e.length?null:this.result((n[0]?-700:0)-200-1100,n,t)}result(t,e,i){let n=[],s=0;for(let t of e){let e=t+(this.astral?Te(Ce(i,t)):1);s&&n[s-1]==t?n[s-1]=e:(n[s++]=t,n[s++]=e)}return this.ret(t-i.length,n)}}class RO{constructor(t){this.pattern=t,this.matched=[],this.score=0,this.folded=t.toLowerCase()}match(t){if(t.length<this.pattern.length)return null;let e=t.slice(0,this.pattern.length),i=e==this.pattern?0:e.toLowerCase()==this.folded?-200:null;return null==i?null:(this.matched=[0,e.length],this.score=i+(t.length==this.pattern.length?0:-100),this)}}const QO=Fe.define({combine(t){return Ai(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:LO,filterStrict:!1,compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,tooltipClass:(t,e)=>i=>BO(t(i),e(i)),optionClass:(t,e)=>i=>BO(t(i),e(i)),addToOptions:(t,e)=>t.concat(e),filterStrict:(t,e)=>t||e})}});function BO(t,e){return t?e?t+" "+e:t:e}function LO(t,e,i,n,s,o){let r,l,a=t.textDirection==pp.RTL,h=a,c=!1,d="top",u=e.left-s.left,f=s.right-e.right,p=n.right-n.left,g=n.bottom-n.top;if(h&&u<Math.min(p,f)?h=!1:!h&&f<Math.min(p,u)&&(h=!0),p<=(h?u:f))r=Math.max(s.top,Math.min(i.top,s.bottom-g))-e.top,l=Math.min(400,h?u:f);else{c=!0,l=Math.min(400,(a?e.right:s.right-e.left)-30);let t=s.bottom-e.bottom;t>=g||t>e.top?r=i.bottom-e.top:(d="bottom",r=e.bottom-i.top)}return{style:`${d}: ${r/((e.bottom-e.top)/o.offsetHeight)}px; max-width: ${l/((e.right-e.left)/o.offsetWidth)}px`,class:"cm-completionInfo-"+(c?a?"left-narrow":"right-narrow":h?"left":"right")}}function $O(t,e,i){if(t<=i)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let t=Math.floor(e/i);return{from:t*i,to:(t+1)*i}}let n=Math.floor((t-e)/i);return{from:t-(n+1)*i,to:t-n*i}}class _O{constructor(t,e,i){this.view=t,this.stateField=e,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:t=>this.placeInfo(t),key:this},this.space=null,this.currentClass="";let n=t.state.field(e),{options:s,selected:o}=n.open,r=t.state.facet(QO);this.optionContent=function(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(t){let e=document.createElement("div");return e.classList.add("cm-completionIcon"),t.type&&e.classList.add(...t.type.split(/\s+/g).map((t=>"cm-completionIcon-"+t))),e.setAttribute("aria-hidden","true"),e},position:20}),e.push({render(t,e,i,n){let s=document.createElement("span");s.className="cm-completionLabel";let o=t.displayLabel||t.label,r=0;for(let t=0;t<n.length;){let e=n[t++],i=n[t++];e>r&&s.appendChild(document.createTextNode(o.slice(r,e)));let l=s.appendChild(document.createElement("span"));l.appendChild(document.createTextNode(o.slice(e,i))),l.className="cm-completionMatchedText",r=i}return r<o.length&&s.appendChild(document.createTextNode(o.slice(r))),s},position:50},{render(t){if(!t.detail)return null;let e=document.createElement("span");return e.className="cm-completionDetail",e.textContent=t.detail,e},position:80}),e.sort(((t,e)=>t.position-e.position)).map((t=>t.render))}(r),this.optionClass=r.optionClass,this.tooltipClass=r.tooltipClass,this.range=$O(s.length,o,r.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(t.state),this.dom.addEventListener("mousedown",(i=>{let{options:n}=t.state.field(e).open;for(let e,s=i.target;s&&s!=this.dom;s=s.parentNode)if("LI"==s.nodeName&&(e=/-(\d+)$/.exec(s.id))&&+e[1]<n.length)return this.applyCompletion(t,n[+e[1]]),void i.preventDefault()})),this.dom.addEventListener("focusout",(e=>{let i=t.state.field(this.stateField,!1);i&&i.tooltip&&t.state.facet(QO).closeOnBlur&&e.relatedTarget!=t.contentDOM&&t.dispatch({effects:DO.of(null)})})),this.showOptions(s,n.id)}mount(){this.updateSel()}showOptions(t,e){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(t,e,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)}))}update(t){var e;let i=t.state.field(this.stateField),n=t.startState.field(this.stateField);if(this.updateTooltipClass(t.state),i!=n){let{options:s,selected:o,disabled:r}=i.open;n.open&&n.open.options==s||(this.range=$O(s.length,o,t.state.facet(QO).maxRenderedOptions),this.showOptions(s,i.id)),this.updateSel(),r!=(null===(e=n.open)||void 0===e?void 0:e.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!r)}}updateTooltipClass(t){let e=this.tooltipClass(t);if(e!=this.currentClass){for(let t of this.currentClass.split(" "))t&&this.dom.classList.remove(t);for(let t of e.split(" "))t&&this.dom.classList.add(t);this.currentClass=e}}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=$O(e.options.length,e.selected,this.view.state.facet(QO).maxRenderedOptions),this.showOptions(e.options,t.id)),this.updateSelectedOption(e.selected)){this.destroyInfo();let{completion:i}=e.options[e.selected],{info:n}=i;if(!n)return;let s="string"==typeof n?document.createTextNode(n):n(i);if(!s)return;"then"in s?s.then((e=>{e&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(e,i)})).catch((t=>jp(this.view.state,t,"completion info"))):this.addInfoPane(s,i)}}addInfoPane(t,e){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",null!=t.nodeType)i.appendChild(t),this.infoDestroy=null;else{let{dom:e,destroy:n}=t;i.appendChild(e),this.infoDestroy=n||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)"LI"==i.nodeName&&i.id?n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected"):n--;return e&&function(t,e){let i=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=i.height/t.offsetHeight;n.top<i.top?t.scrollTop-=(i.top-n.top)/s:n.bottom>i.bottom&&(t.scrollTop+=(n.bottom-i.bottom)/s)}(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),s=this.space;if(!s){let t=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:t.clientWidth,bottom:t.clientHeight}}return n.top>Math.min(s.bottom,e.bottom)-10||n.bottom<Math.max(s.top,e.top)+10?null:this.view.state.facet(QO).positionInfo(this.view,e,n,i,s,this.dom)}placeInfo(t){this.info&&(t?(t.style&&(this.info.style.cssText=t.style),this.info.className="cm-tooltip cm-completionInfo "+(t.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions")),n.addEventListener("mousedown",(t=>{t.target==n&&t.preventDefault()}));let s=null;for(let o=i.from;o<i.to;o++){let{completion:r,match:l}=t[o],{section:a}=r;if(a){let t="string"==typeof a?a:a.name;t!=s&&(o>i.from||0==i.from)&&(s=t,"string"!=typeof a&&a.header?n.appendChild(a.header(a)):n.appendChild(document.createElement("completion-section")).textContent=t)}const h=n.appendChild(document.createElement("li"));h.id=e+"-"+o,h.setAttribute("role","option");let c=this.optionClass(r);c&&(h.className=c);for(let t of this.optionContent){let e=t(r,this.view.state,this.view,l);e&&h.appendChild(e)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function VO(t,e){return i=>new _O(i,t,e)}function NO(t){return 100*(t.boost||0)+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}class WO{constructor(t,e,i,n,s,o){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=s,this.disabled=o}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new WO(this.options,zO(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,i,n,s,o){if(n&&!o&&t.some((t=>t.isPending)))return n.setDisabled();let r=function(t,e){let i=[],n=null,s=t=>{i.push(t);let{section:e}=t.completion;if(e){n||(n=[]);let t="string"==typeof e?e:e.name;n.some((e=>e.name==t))||n.push("string"==typeof e?{name:t}:e)}},o=e.facet(QO);for(let n of t)if(n.hasResult()){let t=n.result.getMatch;if(!1===n.result.filter)for(let e of n.result.options)s(new xO(e,n.source,t?t(e):[],1e9-i.length));else{let i,r=e.sliceDoc(n.from,n.to),l=o.filterStrict?new RO(r):new EO(r);for(let e of n.result.options)if(i=l.match(e.label)){let o=e.displayLabel?t?t(e,i.matched):[]:i.matched;s(new xO(e,n.source,o,i.score+(e.boost||0)))}}}if(n){let t=Object.create(null),e=0,s=(t,e)=>{var i,n;return(null!==(i=t.rank)&&void 0!==i?i:1e9)-(null!==(n=e.rank)&&void 0!==n?n:1e9)||(t.name<e.name?-1:1)};for(let i of n.sort(s))e-=1e5,t[i.name]=e;for(let e of i){let{section:i}=e.completion;i&&(e.score+=t["string"==typeof i?i:i.name])}}let r=[],l=null,a=o.compareCompletions;for(let t of i.sort(((t,e)=>e.score-t.score||a(t.completion,e.completion)))){let e=t.completion;!l||l.label!=e.label||l.detail!=e.detail||null!=l.type&&null!=e.type&&l.type!=e.type||l.apply!=e.apply||l.boost!=e.boost?r.push(t):NO(t.completion)>NO(l)&&(r[r.length-1]=t),l=t.completion}return r}(t,e);if(!r.length)return n&&t.some((t=>t.isPending))?n.setDisabled():null;let l=e.facet(QO).selectOnOpen?0:-1;if(n&&n.selected!=l&&-1!=n.selected){let t=n.options[n.selected].completion;for(let e=0;e<r.length;e++)if(r[e].completion==t){l=e;break}}return new WO(r,zO(i,l),{pos:t.reduce(((t,e)=>e.hasResult()?Math.min(t,e.from):t),1e8),create:JO,above:s.aboveCursor},n?n.timestamp:Date.now(),l,!1)}map(t){return new WO(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new WO(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class HO{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new HO(IO,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(t){let{state:e}=t,i=e.facet(QO),n=(i.override||e.languageDataAt("autocomplete",kO(e)).map(TO)).map((e=>(this.active.find((t=>t.source==e))||new XO(e,this.active.some((t=>0!=t.state))?1:0)).update(t,i)));n.length==this.active.length&&n.every(((t,e)=>t==this.active[e]))&&(n=this.active);let s=this.open,o=t.effects.some((t=>t.is(YO)));s&&t.docChanged&&(s=s.map(t.changes)),t.selection||n.some((e=>e.hasResult()&&t.changes.touchesRange(e.from,e.to)))||!function(t,e){if(t==e)return!0;for(let i=0,n=0;;){for(;i<t.length&&!t[i].hasResult();)i++;for(;n<e.length&&!e[n].hasResult();)n++;let s=i==t.length,o=n==e.length;if(s||o)return s==o;if(t[i++].result!=e[n++].result)return!1}}(n,this.active)||o?s=WO.build(n,e,this.id,s,i,o):s&&s.disabled&&!n.some((t=>t.isPending))&&(s=null),!s&&n.every((t=>!t.isPending))&&n.some((t=>t.hasResult()))&&(n=n.map((t=>t.hasResult()?new XO(t.source,0):t)));for(let e of t.effects)e.is(UO)&&(s=s&&s.setSelected(e.value,this.id));return n==this.active&&s==this.open?this:new HO(n,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?qO:FO}}const qO={"aria-autocomplete":"list"},FO={};function zO(t,e){let i={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(i["aria-activedescendant"]=t+"-"+e),i}const IO=[];function ZO(t,e){if(t.isUserEvent("input.complete")){let i=t.annotation(CO);if(i&&e.activateOnCompletion(i))return 12}let i=t.isUserEvent("input.type");return i&&e.activateOnTyping?5:i?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class XO{constructor(t,e,i=!1){this.source=t,this.state=e,this.explicit=i}hasResult(){return!1}get isPending(){return 1==this.state}update(t,e){let i=ZO(t,e),n=this;(8&i||16&i&&this.touches(t))&&(n=new XO(n.source,0)),4&i&&0==n.state&&(n=new XO(this.source,1)),n=n.updateFor(t,i);for(let e of t.effects)if(e.is(PO))n=new XO(n.source,1,e.value);else if(e.is(DO))n=new XO(n.source,0);else if(e.is(YO))for(let t of e.value)t.source==n.source&&(n=t);return n}updateFor(t,e){return this.map(t.changes)}map(t){return this}touches(t){return t.changes.touchesRange(kO(t.state))}}class jO extends XO{constructor(t,e,i,n,s,o){super(t,3,e),this.limit=i,this.result=n,this.from=s,this.to=o}hasResult(){return!0}updateFor(t,e){var i;if(!(3&e))return this.map(t.changes);let n=this.result;n.map&&!t.changes.empty&&(n=n.map(n,t.changes));let s=t.changes.mapPos(this.from),o=t.changes.mapPos(this.to,1),r=kO(t.state);if(r>o||!n||2&e&&(kO(t.startState)==this.from||r<this.limit))return new XO(this.source,4&e?1:0);let l=t.changes.mapPos(this.limit);return function(t,e,i,n){if(!t)return!1;let s=e.sliceDoc(i,n);return"function"==typeof t?t(s,i,n,e):MO(t,!0).test(s)}(n.validFor,t.state,s,o)?new jO(this.source,this.explicit,l,n,s,o):n.update&&(n=n.update(n,s,o,new bO(t.state,r,!1)))?new jO(this.source,this.explicit,l,n,n.from,null!==(i=n.to)&&void 0!==i?i:kO(t.state)):new XO(this.source,1,this.explicit)}map(t){return t.empty?this:(this.result.map?this.result.map(this.result,t):this.result)?new jO(this.source,this.explicit,t.mapPos(this.limit),this.result,t.mapPos(this.from),t.mapPos(this.to,1)):new XO(this.source,0)}touches(t){return t.changes.touchesRange(this.from,this.to)}}const YO=gi.define({map(t,e){return t.map((t=>t.map(e)))}}),UO=gi.define(),KO=Ue.define({create(){return HO.start()},update(t,e){return t.update(e)},provide:t=>[OO.from(t,(t=>t.tooltip)),Ym.contentAttributes.from(t,(t=>t.attrs))]});function GO(t,e){const i=e.completion.apply||e.completion.label;let n=t.state.field(KO).active.find((t=>t.source==e.source));return n instanceof jO&&("string"==typeof i?t.dispatch(Object.assign(Object.assign({},function(t,e,i,n){let{main:s}=t.selection,o=i-s.from,r=n-s.from;return Object.assign(Object.assign({},t.changeByRange((l=>{if(l!=s&&i!=n&&t.sliceDoc(l.from+o,l.from+r)!=t.sliceDoc(i,n))return{range:l};let a=t.toText(e);return{changes:{from:l.from+o,to:n==s.from?l.to:l.from+r,insert:a},range:We.cursor(l.from+o+a.length)}}))),{scrollIntoView:!0,userEvent:"input.complete"})}(t.state,i,n.from,n.to)),{annotations:CO.of(e.completion)})):i(t,e.completion,n.from,n.to),!0)}const JO=VO(KO,GO);function tv(t,e="option"){return i=>{let n=i.state.field(KO,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<i.state.facet(QO).interactionDelay)return!1;let s,o=1;"page"==e&&(s=vO(i,n.open.tooltip))&&(o=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:r}=n.open.options,l=n.open.selected>-1?n.open.selected+o*(t?1:-1):t?0:r-1;return l<0?l="page"==e?0:r-1:l>=r&&(l="page"==e?r-1:0),i.dispatch({effects:UO.of(l)}),!0}}const ev=t=>!!t.state.field(KO,!1)&&(t.dispatch({effects:PO.of(!0)}),!0);class iv{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const nv=Gp.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(KO).active)e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(KO),i=t.state.facet(QO);if(!t.selectionSet&&!t.docChanged&&t.startState.field(KO)==e)return;let n=t.transactions.some((t=>{let e=ZO(t,i);return 8&e||(t.selection||t.docChanged)&&!(3&e)}));for(let e=0;e<this.running.length;e++){let i=this.running[e];if(n||i.context.abortOnDocChange&&t.docChanged||i.updates.length+t.transactions.length>50&&Date.now()-i.time>1e3){for(let t of i.context.abortListeners)try{t()}catch(t){jp(this.view.state,t)}i.context.abortListeners=null,this.running.splice(e--,1)}else i.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some((t=>t.effects.some((t=>t.is(PO)))))&&(this.pendingStart=!0);let s=this.pendingStart?50:i.activateOnTypingDelay;if(this.debounceUpdate=e.active.some((t=>t.isPending&&!this.running.some((e=>e.active.source==t.source))))?setTimeout((()=>this.startUpdate()),s):-1,0!=this.composing)for(let e of t.transactions)e.isUserEvent("input.type")?this.composing=2:2==this.composing&&e.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(KO);for(let t of e.active)t.isPending&&!this.running.some((e=>e.active.source==t.source))&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout((()=>this.accept()),this.view.state.facet(QO).updateSyncTime))}startQuery(t){let{state:e}=this.view,i=kO(e),n=new bO(e,i,t.explicit,this.view),s=new iv(t,n);this.running.push(s),Promise.resolve(t.source(n)).then((t=>{s.context.aborted||(s.done=t||null,this.scheduleAccept())}),(t=>{this.view.dispatch({effects:DO.of(null)}),jp(this.view.state,t)}))}scheduleAccept(){this.running.every((t=>void 0!==t.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),this.view.state.facet(QO).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],i=this.view.state.facet(QO),n=this.view.state.field(KO);for(let s=0;s<this.running.length;s++){let o=this.running[s];if(void 0===o.done)continue;if(this.running.splice(s--,1),o.done){let n=kO(o.updates.length?o.updates[0].startState:this.view.state),s=Math.min(n,o.done.from+(o.active.explicit?0:1)),r=new jO(o.active.source,o.active.explicit,s,o.done,o.done.from,null!==(t=o.done.to)&&void 0!==t?t:n);for(let t of o.updates)r=r.update(t,i);if(r.hasResult()){e.push(r);continue}}let r=n.active.find((t=>t.source==o.active.source));if(r&&r.isPending)if(null==o.done){let t=new XO(o.active.source,0);for(let e of o.updates)t=t.update(e,i);t.isPending||e.push(t)}else this.startQuery(r)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:YO.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(KO,!1);if(e&&e.tooltip&&this.view.state.facet(QO).closeOnBlur){let i=e.open&&vO(this.view,e.open.tooltip);i&&i.dom.contains(t.relatedTarget)||setTimeout((()=>this.view.dispatch({effects:DO.of(null)})),10)}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:PO.of(!1)})),20),this.composing=0}}}),sv="object"==typeof navigator&&/Win/.test(navigator.platform),ov=Ge.highest(Ym.domEventHandlers({keydown(t,e){let i=e.state.field(KO,!1);if(!i||!i.open||i.open.disabled||i.open.selected<0||t.key.length>1||t.ctrlKey&&(!sv||!t.altKey)||t.metaKey)return!1;let n=i.open.options[i.open.selected],s=i.active.find((t=>t.source==n.source)),o=n.completion.commitCharacters||s.result.commitCharacters;return o&&o.indexOf(t.key)>-1&&GO(e,n),!1}})),rv=Ym.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class lv{constructor(t,e,i,n){this.field=t,this.line=e,this.from=i,this.to=n}}class av{constructor(t,e,i){this.field=t,this.from=e,this.to=i}map(t){let e=t.mapPos(this.from,-1,De.TrackDel),i=t.mapPos(this.to,1,De.TrackDel);return null==e||null==i?null:new av(this.field,e,i)}}class hv{constructor(t,e){this.lines=t,this.fieldPositions=e}instantiate(t,e){let i=[],n=[e],s=t.doc.lineAt(e),o=/^\s*/.exec(s.text)[0];for(let s of this.lines){if(i.length){let i=o,r=/^\t*/.exec(s)[0].length;for(let e=0;e<r;e++)i+=t.facet(Hl);n.push(e+i.length-r),s=i+s.slice(r)}i.push(s),e+=s.length+1}let r=this.fieldPositions.map((t=>new av(t.field,n[t.line]+t.from,n[t.line]+t.to)));return{text:i,ranges:r}}static parse(t){let e,i=[],n=[],s=[];for(let o of t.split(/\r\n?|\n/)){for(;e=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let t=e[1]?+e[1]:null,r=e[2]||e[3]||"",l=-1,a=r.replace(/\\[{}]/g,(t=>t[1]));for(let e=0;e<i.length;e++)(null!=t?i[e].seq==t:a&&i[e].name==a)&&(l=e);if(l<0){let e=0;for(;e<i.length&&(null==t||null!=i[e].seq&&i[e].seq<t);)e++;i.splice(e,0,{seq:t,name:a}),l=e;for(let t of s)t.field>=l&&t.field++}s.push(new lv(l,n.length,e.index,e.index+a.length)),o=o.slice(0,e.index)+r+o.slice(e.index+e[0].length)}o=o.replace(/\\([{}])/g,((t,e,i)=>{for(let t of s)t.line==n.length&&t.from>i&&(t.from--,t.to--);return e})),n.push(o)}return new hv(n,s)}}let cv=ip.widget({widget:new class extends tp{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),dv=ip.mark({class:"cm-snippetField"});class uv{constructor(t,e){this.ranges=t,this.active=e,this.deco=ip.set(t.map((t=>(t.from==t.to?cv:dv).range(t.from,t.to))))}map(t){let e=[];for(let i of this.ranges){let n=i.map(t);if(!n)return null;e.push(n)}return new uv(e,this.active)}selectionInsideField(t){return t.ranges.every((t=>this.ranges.some((e=>e.field==this.active&&e.from<=t.from&&e.to>=t.to))))}}const fv=gi.define({map(t,e){return t&&t.map(e)}}),pv=gi.define(),gv=Ue.define({create(){return null},update(t,e){for(let i of e.effects){if(i.is(fv))return i.value;if(i.is(pv)&&t)return new uv(t.ranges,i.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>Ym.decorations.from(t,(t=>t?t.deco:ip.none))});function mv(t,e){return We.create(t.filter((t=>t.field==e)).map((t=>We.range(t.from,t.to))))}function Ov(t){let e=hv.parse(t);return(t,i,n,s)=>{let{text:o,ranges:r}=e.instantiate(t.state,n),{main:l}=t.state.selection,a={changes:{from:n,to:s==l.from?l.to:s,insert:ge.of(o)},scrollIntoView:!0,annotations:i?[CO.of(i),mi.userEvent.of("input.complete")]:void 0};if(r.length&&(a.selection=mv(r,0)),r.some((t=>t.field>0))){let e=new uv(r,0),i=a.effects=[fv.of(e)];void 0===t.state.field(gv,!1)&&i.push(gi.appendConfig.of([gv,yv,xv,rv]))}t.dispatch(t.state.update(a))}}function vv(t){return({state:e,dispatch:i})=>{let n=e.field(gv,!1);if(!n||t<0&&0==n.active)return!1;let s=n.active+t,o=t>0&&!n.ranges.some((e=>e.field==s+t));return i(e.update({selection:mv(n.ranges,s),effects:fv.of(o?null:new uv(n.ranges,s)),scrollIntoView:!0})),!0}}const wv=[{key:"Tab",run:vv(1),shift:vv(-1)},{key:"Escape",run:({state:t,dispatch:e})=>!!t.field(gv,!1)&&(e(t.update({effects:fv.of(null)})),!0)}],bv=Fe.define({combine(t){return t.length?t[0]:wv}}),yv=Ge.highest(nO.compute([bv],(t=>t.facet(bv))));function Sv(t,e){return Object.assign(Object.assign({},e),{apply:Ov(t)})}const xv=Ym.domEventHandlers({mousedown(t,e){let i,n=e.state.field(gv,!1);if(!n||null==(i=e.posAtCoords({x:t.clientX,y:t.clientY})))return!1;let s=n.ranges.find((t=>t.from<=i&&t.to>=i));return!(!s||s.field==n.active||(e.dispatch({selection:mv(n.ranges,s.field),effects:fv.of(n.ranges.some((t=>t.field>s.field))?new uv(n.ranges,s.field):null),scrollIntoView:!0}),0))}}),kv={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Mv=gi.define({map(t,e){let i=e.mapPos(t,-1,De.TrackAfter);return null==i?void 0:i}}),Cv=new class extends Ti{};Cv.startSide=1,Cv.endSide=-1;const Av=Ue.define({create(){return Ri.empty},update(t,e){if(t=t.map(e.changes),e.selection){let i=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:t=>t>=i.from&&t<=i.to})}for(let i of e.effects)i.is(Mv)&&(t=t.update({add:[Cv.range(i.value,i.value+1)]}));return t}}),Tv="()[]{}<>«»»«［］｛｝";function Pv(t){for(let e=0;e<16;e+=2)if(Tv.charCodeAt(e)==t)return Tv.charAt(e+1);return Ae(t<128?t:t+1)}function Dv(t,e){return t.languageDataAt("closeBrackets",e)[0]||kv}const Ev="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),Rv=Ym.inputHandler.of(((t,e,i,n)=>{if((Ev?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let s=t.state.selection.main;if(n.length>2||2==n.length&&1==Te(Ce(n,0))||e!=s.from||i!=s.to)return!1;let o=function(t,e){let i=Dv(t,t.selection.main.head),n=i.brackets||kv.brackets;for(let s of n){let o=Pv(Ce(s,0));if(e==s)return o==s?Vv(t,s,n.indexOf(s+s+s)>-1,i):$v(t,s,o,i.before||kv.before);if(e==o&&Bv(t,t.selection.main.from))return _v(t,0,o)}return null}(t.state,n);return!!o&&(t.dispatch(o),!0)})),Qv=[{key:"Backspace",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Dv(t,t.selection.main.head).brackets||kv.brackets,n=null,s=t.changeByRange((e=>{if(e.empty){let n=function(t,e){let i=t.sliceString(e-2,e);return Te(Ce(i,0))==i.length?i:i.slice(1)}(t.doc,e.head);for(let s of i)if(s==n&&Lv(t.doc,e.head)==Pv(Ce(s,0)))return{changes:{from:e.head-s.length,to:e.head+s.length},range:We.cursor(e.head-s.length)}}return{range:n=e}}));return n||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!n}}];function Bv(t,e){let i=!1;return t.field(Av).between(0,t.doc.length,(t=>{t==e&&(i=!0)})),i}function Lv(t,e){let i=t.sliceString(e,e+2);return i.slice(0,Te(Ce(i,0)))}function $v(t,e,i,n){let s=null,o=t.changeByRange((o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:i,from:o.to}],effects:Mv.of(o.to+e.length),range:We.range(o.anchor+e.length,o.head+e.length)};let r=Lv(t.doc,o.head);return!r||/\s/.test(r)||n.indexOf(r)>-1?{changes:{insert:e+i,from:o.head},effects:Mv.of(o.head+e.length),range:We.cursor(o.head+e.length)}:{range:s=o}}));return s?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function _v(t,e,i){let n=null,s=t.changeByRange((e=>e.empty&&Lv(t.doc,e.head)==i?{changes:{from:e.head,to:e.head+i.length,insert:i},range:We.cursor(e.head+i.length)}:n={range:e}));return n?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Vv(t,e,i,n){let s=n.stringPrefixes||kv.stringPrefixes,o=null,r=t.changeByRange((n=>{if(!n.empty)return{changes:[{insert:e,from:n.from},{insert:e,from:n.to}],effects:Mv.of(n.to+e.length),range:We.range(n.anchor+e.length,n.head+e.length)};let r,l=n.head,a=Lv(t.doc,l);if(a==e){if(Nv(t,l))return{changes:{insert:e+e,from:l},effects:Mv.of(l+e.length),range:We.cursor(l+e.length)};if(Bv(t,l)){let n=i&&t.sliceDoc(l,l+3*e.length)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+n.length,insert:n},range:We.cursor(l+n.length)}}}else{if(i&&t.sliceDoc(l-2*e.length,l)==e+e&&(r=Wv(t,l-2*e.length,s))>-1&&Nv(t,r))return{changes:{insert:e+e+e+e,from:l},effects:Mv.of(l+e.length),range:We.cursor(l+e.length)};if(t.charCategorizer(l)(a)!=xi.Word&&Wv(t,l,s)>-1&&!function(t,e,i,n){let s=Pl(t).resolveInner(e,-1),o=n.reduce(((t,e)=>Math.max(t,e.length)),0);for(let r=0;r<5;r++){let r=t.sliceDoc(s.from,Math.min(s.to,s.from+i.length+o)),l=r.indexOf(i);if(!l||l>-1&&n.indexOf(r.slice(0,l))>-1){let e=s.firstChild;for(;e&&e.from==s.from&&e.to-e.from>i.length+l;){if(t.sliceDoc(e.to-i.length,e.to)==i)return!1;e=e.firstChild}return!0}let a=s.to==e&&s.parent;if(!a)break;s=a}return!1}(t,l,e,s))return{changes:{insert:e+e,from:l},effects:Mv.of(l+e.length),range:We.cursor(l+e.length)}}return{range:o=n}}));return o?null:t.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function Nv(t,e){let i=Pl(t).resolveInner(e+1);return i.parent&&i.from==e}function Wv(t,e,i){let n=t.charCategorizer(e);if(n(t.sliceDoc(e-1,e))!=xi.Word)return e;for(let s of i){let i=e-s.length;if(t.sliceDoc(i,e)==s&&n(t.sliceDoc(i-1,i))!=xi.Word)return i}return-1}const Hv=[{key:"Ctrl-Space",run:ev},{mac:"Alt-`",run:ev},{key:"Escape",run:t=>{let e=t.state.field(KO,!1);return!(!e||!e.active.some((t=>0!=t.state))||(t.dispatch({effects:DO.of(null)}),0))}},{key:"ArrowDown",run:tv(!0)},{key:"ArrowUp",run:tv(!1)},{key:"PageDown",run:tv(!0,"page")},{key:"PageUp",run:tv(!1,"page")},{key:"Enter",run:t=>{let e=t.state.field(KO,!1);return!(t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(QO).interactionDelay)&&GO(t,e.open.options[e.open.selected])}}],qv=Ge.highest(nO.computeN([QO],(t=>t.facet(QO).defaultKeymap?[Hv]:[]))),Fv=[Sv("function ${name}(${params}) {\n\t${}\n}",{label:"function",detail:"definition",type:"keyword"}),Sv("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n\t${}\n}",{label:"for",detail:"loop",type:"keyword"}),Sv("for (let ${name} of ${collection}) {\n\t${}\n}",{label:"for",detail:"of loop",type:"keyword"}),Sv("do {\n\t${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),Sv("while (${}) {\n\t${}\n}",{label:"while",detail:"loop",type:"keyword"}),Sv("try {\n\t${}\n} catch (${error}) {\n\t${}\n}",{label:"try",detail:"/ catch block",type:"keyword"}),Sv("if (${}) {\n\t${}\n}",{label:"if",detail:"block",type:"keyword"}),Sv("if (${}) {\n\t${}\n} else {\n\t${}\n}",{label:"if",detail:"/ else block",type:"keyword"}),Sv("class ${name} {\n\tconstructor(${params}) {\n\t\t${}\n\t}\n}",{label:"class",detail:"definition",type:"keyword"}),Sv('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),Sv('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],zv=Fv.concat([Sv("interface ${name} {\n\t${}\n}",{label:"interface",detail:"definition",type:"keyword"}),Sv("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),Sv("enum ${name} {\n\t${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),Iv=new F,Zv=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function Xv(t){return(e,i)=>{let n=e.node.getChild("VariableDefinition");return n&&i(n,t),!0}}const jv=["FunctionDeclaration"],Yv={FunctionDeclaration:Xv("function"),ClassDeclaration:Xv("class"),ClassExpression:()=>!0,EnumDeclaration:Xv("constant"),TypeAliasDeclaration:Xv("type"),NamespaceDeclaration:Xv("namespace"),VariableDefinition(t,e){t.matchContext(jv)||e(t,"variable")},TypeDefinition(t,e){e(t,"type")},__proto__:null};function Uv(t,e){let i=Iv.get(e);if(i)return i;let n=[],s=!0;function o(e,i){let s=t.sliceString(e.from,e.to);n.push({label:s,type:i})}return e.cursor(k.IncludeAnonymous).iterate((e=>{if(s)s=!1;else if(e.name){let t=Yv[e.name];if(t&&t(e,o)||Zv.has(e.name))return!1}else if(e.to-e.from>8192){for(let i of Uv(t,e.node))n.push(i);return!1}})),Iv.set(e,n),n}const Kv=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,Gv=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName","JSXText","JSXAttributeValue","JSXOpenTag","JSXCloseTag","JSXSelfClosingTag",".","?."];function Jv(t){let e=Pl(t.state).resolveInner(t.pos,-1);if(Gv.indexOf(e.name)>-1)return null;let i="VariableName"==e.name||e.to-e.from<20&&Kv.test(t.state.sliceDoc(e.from,e.to));if(!i&&!t.explicit)return null;let n=[];for(let i=e;i;i=i.parent)Zv.has(i.name)&&(n=n.concat(Uv(t.state.doc,i)));return{options:n,from:i?e.from:t.pos,validFor:Kv}}const tw=Tl.define({name:"javascript",parser:ne.configure({props:[Zl.add({IfStatement:ta({except:/^\s*({|else\b)/}),TryStatement:ta({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:t=>t.baseIndent,SwitchBody:t=>{let e=t.textAfter,i=/^\s*\}/.test(e),n=/^\s*(case|default)\b/.test(e);return t.baseIndent+(i?0:n?1:2)*t.unit},Block:Gl({closing:"}"}),ArrowFunction:t=>t.baseIndent+t.unit,"TemplateString BlockComment":()=>null,"Statement Property":ta({except:/^{/}),JSXElement(t){let e=/^\s*<\//.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},JSXEscape(t){let e=/\s*\}/.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},"JSXOpenTag JSXSelfClosingTag"(t){return t.column(t.node.from)+t.unit}}),ia.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":function(t){let e=t.firstChild,i=t.lastChild;return e&&e.to<i.from?{from:e.to,to:i.type.isError?t.to:i.from}:null},BlockComment(t){return{from:t.from+2,to:t.to-2}}})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),ew={test:t=>/^JSX/.test(t.name),facet:kl({commentTokens:{block:{open:"{/*",close:"*/}"}}})},iw=tw.configure({dialect:"ts"},"typescript"),nw=tw.configure({dialect:"jsx",props:[Ml.add((t=>t.isTop?[ew]:void 0))]}),sw=tw.configure({dialect:"jsx ts",props:[Ml.add((t=>t.isTop?[ew]:void 0))]},"typescript");let ow=t=>({label:t,type:"keyword"});const rw="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(ow),lw=rw.concat(["declare","implements","private","protected","public"].map(ow));function aw(t={}){let e=t.jsx?t.typescript?sw:nw:t.typescript?iw:tw,i=t.typescript?zv.concat(lw):Fv.concat(rw);return new Nl(e,[tw.data.of({autocomplete:(n=Gv,s=SO(i),t=>{for(let e=Pl(t.state).resolveInner(t.pos,-1);e;e=e.parent){if(n.indexOf(e.name)>-1)return null;if(e.type.isTop)break}return s(t)})}),tw.data.of({autocomplete:Jv}),t.jsx?dw:[]]);var n,s}function hw(t,e,i=t.length){for(let n=null==e?void 0:e.firstChild;n;n=n.nextSibling)if("JSXIdentifier"==n.name||"JSXBuiltin"==n.name||"JSXNamespacedName"==n.name||"JSXMemberExpression"==n.name)return t.sliceString(n.from,Math.min(n.to,i));return""}const cw="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),dw=Xu.inputHandler.of(((t,e,i,n,s)=>{if((cw?t.composing:t.compositionStarted)||t.state.readOnly||e!=i||">"!=n&&"/"!=n||!tw.isActiveAt(t.state,e,-1))return!1;let o=s(),{state:r}=o,l=r.changeByRange((t=>{var e;let i,{head:s}=t,o=Pl(r).resolveInner(s-1,-1);if("JSXStartTag"==o.name&&(o=o.parent),r.doc.sliceString(s-1,s)!=n||"JSXAttributeValue"==o.name&&o.to>s);else{if(">"==n&&"JSXFragmentTag"==o.name)return{range:t,changes:{from:s,insert:"</>"}};if("/"==n&&"JSXStartCloseTag"==o.name){let t=o.parent,n=t.parent;if(n&&t.from==s-2&&((i=hw(r.doc,n.firstChild,s))||"JSXFragmentTag"==(null===(e=n.firstChild)||void 0===e?void 0:e.name))){let t=`${i}>`;return{range:We.cursor(s+t.length,-1),changes:{from:s,insert:t}}}}else if(">"==n){let e=function(t){for(;;){if("JSXOpenTag"==t.name||"JSXSelfClosingTag"==t.name||"JSXFragmentTag"==t.name)return t;if("JSXEscape"==t.name||!t.parent)return null;t=t.parent}}(o);if(e&&"JSXOpenTag"==e.name&&!/^\/?>|^<\//.test(r.doc.sliceString(s,s+2))&&(i=hw(r.doc,e,s)))return{range:t,changes:{from:s,insert:`</${i}>`}}}}return{range:t}}));return!l.changes.empty&&(t.dispatch([o,r.update(l,{userEvent:"input.complete",scrollIntoView:!0})]),!0)}));function uw(){return uw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)({}).hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},uw.apply(null,arguments)}function fw(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function pw(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function gw(t,e){if(!e.anchorNode)return!1;try{return pw(t,e.anchorNode)}catch(t){return!1}}function mw(t){return 3==t.nodeType?Pw(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function Ow(t,e,i,n){return!!i&&(bw(t,e,i,n,-1)||bw(t,e,i,n,1))}function vw(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function ww(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function bw(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:yw(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=vw(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?yw(t):0}}}function yw(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Sw(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function xw(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function kw(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}class Mw{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?yw(e):0),i,Math.min(t.focusOffset,i?yw(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let Cw,Aw=null;function Tw(t){if(t.setActive)return t.setActive();if(Aw)return t.focus(Aw);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==Aw?{get preventScroll(){return Aw={preventScroll:!0},!0}}:void 0),!Aw){Aw=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function Pw(t,e,i=e){let n=Cw||(Cw=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function Dw(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function Ew(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function Rw(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function Qw(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=yw(i)}else{if(!i.parentNode||ww(i))return null;n=vw(i),i=i.parentNode}}}function Bw(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||ww(i))return null;n=vw(i)+1,i=i.parentNode}}}class Lw{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Lw(t.parentNode,vw(t),e)}static after(t,e){return new Lw(t.parentNode,vw(t)+1,e)}}const $w=[];class _w{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=_w.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=Vw(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=Vw(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==yw(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!_w.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=$w){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new Nw(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function Vw(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}_w.prototype.breakAfter=0;class Nw{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Ww(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function Hw(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,Ww(t,h,c,l,a,n,0,s,o)}let qw="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Fw="undefined"!=typeof document?document:{documentElement:{style:{}}};const zw=/Edge\/(\d+)/.exec(qw.userAgent),Iw=/MSIE \d/.test(qw.userAgent),Zw=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(qw.userAgent),Xw=!!(Iw||Zw||zw),jw=!Xw&&/gecko\/(\d+)/i.test(qw.userAgent),Yw=!Xw&&/Chrome\/(\d+)/.exec(qw.userAgent),Uw="webkitFontSmoothing"in Fw.documentElement.style,Kw=!Xw&&/Apple Computer/.test(qw.vendor),Gw=Kw&&(/Mobile\/\w+/.test(qw.userAgent)||qw.maxTouchPoints>2);var Jw={mac:Gw||/Mac/.test(qw.platform),windows:/Win/.test(qw.platform),linux:/Linux|X11/.test(qw.platform),ie:Xw,ie_version:Iw?Fw.documentMode||6:Zw?+Zw[1]:zw?+zw[1]:0,gecko:jw,gecko_version:jw?+(/Firefox\/(\d+)/.exec(qw.userAgent)||[0,0])[1]:0,chrome:!!Yw,chrome_version:Yw?+Yw[1]:0,ios:Gw,android:/Android\b/.test(qw.userAgent),webkit:Uw,safari:Kw,webkit_version:Uw?+(/\bAppleWebKit\/(\d+)/.exec(qw.userAgent)||[0,0])[1]:0,tabSize:null!=Fw.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class tb extends _w{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof tb)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new tb(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Lw(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?Jw.chrome||Jw.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=Pw(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return Jw.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?Sw(a,r<0):a||null}(this.dom,t,e)}}class eb extends _w{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(Ew(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof eb&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(Hw(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new eb(this.mark,e,o)}domAtPos(t){return sb(this,t)}coordsAt(t,e){return rb(this,t,e)}}class ib extends _w{static create(t,e,i){return new ib(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=ib.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof ib&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof ib&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?Lw.before(this.dom):Lw.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return Sw(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class nb extends _w{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof nb&&t.side==this.side}split(){return new nb(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?Lw.before(this.dom):Lw.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function sb(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new Lw(i,0)}function ob(t,e,i){let n,{children:s}=t;i>0&&e instanceof eb&&s.length&&(n=s[s.length-1])instanceof eb&&n.mark.eq(e.mark)?ob(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function rb(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&i>0)&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=mw(e);return i[i.length-1]||null}(t)}function lb(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}tb.prototype.children=ib.prototype.children=nb.prototype.children=$w;const ab=Object.create(null);function hb(t,e,i){if(t==e)return!0;t||(t=ab),e||(e=ab);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function cb(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function db(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class ub{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var fb=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(fb||(fb={}));class pb extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new gb(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new Ob(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=vb(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new Ob(t,e,i,n,t.widget||null,!0)}static line(t){return new mb(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}pb.none=Ri.empty;class gb extends pb{constructor(t){let{start:e,end:i}=vb(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof gb&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&hb(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}gb.prototype.point=!1;class mb extends pb{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof mb&&this.spec.class==t.spec.class&&hb(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}mb.prototype.mapMode=De.TrackBefore,mb.prototype.point=!0;class Ob extends pb{constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?fb.WidgetRange:this.startSide<=0?fb.WidgetBefore:fb.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof Ob&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function vb(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function wb(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}Ob.prototype.point=!0;class bb extends _w{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof bb))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Hw(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new bb;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){hb(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){ob(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=lb(e,this.attrs||{})),i&&(this.attrs=lb({class:i},this.attrs||{}))}domAtPos(t){return sb(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(Ew(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(cb(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&_w.get(n)instanceof eb;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=_w.get(n))||void 0===i?void 0:i.isEditable)||Jw.ios&&this.children.some((t=>t instanceof tb))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof tb)||/[^ -~]/.test(i.text))return null;let n=mw(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=rb(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof bb&&0==this.children.length&&0==t.children.length&&hb(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof bb)return s;if(o>e)break}n=o+s.breakAfter}return null}}class yb extends _w{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof yb&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?Lw.before(this.dom):Lw.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new yb(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return $w}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof yb&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof Sb?null:Sw(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class Sb extends ub{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class xb{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof yb&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new bb),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(kb(new nb(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof yb||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(kb(new tb(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof Ob){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof Ob)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new yb(i.widget||Mb.block,r,i));else{let o=ib.create(i.widget||Mb.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(kb(new nb(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(kb(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new xb(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function kb(t,e){for(let i of e)t=new eb(i,[t],t.length);return t}class Mb extends ub{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Mb.inline=new Mb("span"),Mb.block=new Mb("div");var Cb=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Cb||(Cb={}));const Ab=Cb.LTR,Tb=Cb.RTL;function Pb(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const Db=Pb("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Eb=Pb("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Rb=Object.create(null),Qb=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);Rb[e]=i,Rb[i]=-e}function Bb(t){return t<=247?Db[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?Eb[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const Lb=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class $b{get dir(){return this.level%2?Tb:Ab}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function _b(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!_b(n.inner,s.inner))return!1}return!0}const Vb=[];function Nb(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=Vb[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if(Vb[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new $b(a,p.from,u)),Wb(t,p.direction==Ab!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?Vb[f]!=l:Vb[f]==l))break;f++}d?Nb(t,a,f,n+1,s,d,r):a<f&&r.push(new $b(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=Vb[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if(Vb[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new $b(p.to,a,u)),Wb(t,p.direction==Ab!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?Vb[f-1]!=l:Vb[f-1]==l))break;f--}d?Nb(t,f,a,n+1,s,d,r):f<a&&r.push(new $b(f,a,u)),a=f}}function Wb(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=Bb(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),Vb[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=Vb[t];if(128==s)t<l-1&&e==Vb[t+1]&&24&e?s=Vb[t]=e:Vb[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==Vb[s];)s++;let o=t&&8==e||s<i&&8==Vb[s]?1==n?1:8:256;for(let e=t;e<s;e++)Vb[e]=o;t=s-1}else 8==s&&1==n&&(Vb[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=Rb[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(Qb[t+1]==-i){let e=Qb[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&(Vb[r]=Vb[Qb[t]]=i),l=t;break}}else{if(189==Qb.length)break;Qb[l++]=r,Qb[l++]=e,Qb[l++]=a}else if(2==(n=Vb[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=Qb[e+2];if(2&i)break;if(t)Qb[e+2]|=2;else{if(4&i)break;Qb[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=Vb[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=Vb[r])break;r++}let h=1==o,c=h==(1==(r<e?Vb[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),Vb[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),Nb(t,s,o,e,i,n,r)}function Hb(t){return[new $b(0,t,0)]}let qb="";function Fb(t,e,i,n,s){var o;let r=n.head-t.from,l=$b.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),qb=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function zb(t,e,i){for(let n=e;n<i;n++){let e=Bb(t.charCodeAt(n));if(1==e)return Ab;if(2==e||4==e)return Tb}return Ab}const Ib=Fe.define(),Zb=Fe.define(),Xb=Fe.define(),jb=Fe.define(),Yb=Fe.define(),Ub=Fe.define(),Kb=Fe.define(),Gb=Fe.define(),Jb=Fe.define(),ty=Fe.define({combine:t=>t.some((t=>t))}),ey=Fe.define({combine:t=>t.some((t=>t))}),iy=Fe.define();class ny{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new ny(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new ny(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const sy=gi.define({map:(t,e)=>t.map(e)}),oy=gi.define();function ry(t,e,i){let n=t.facet(jb);n.length?n[0](e):window.onerror?window.onerror(String(e),i,void 0,void 0,e):i?console.error(i+":",e):console.error(e)}const ly=Fe.define({combine:t=>!t.length||t[0]});let ay=0;const hy=Fe.define();class cy{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new cy(ay++,t,i,n,(t=>{let e=[hy.of(t)];return o&&e.push(py.of((e=>{let i=e.plugin(t);return i?o(i):pb.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return cy.define((e=>new t(e)),e)}}class dy{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(ry(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){ry(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){ry(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const uy=Fe.define(),fy=Fe.define(),py=Fe.define(),gy=Fe.define(),my=Fe.define(),Oy=Fe.define();function vy(t,e){let i=t.state.facet(Oy);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=zb(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const wy=Fe.define();function by(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(wy)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const yy=Fe.define();class Sy{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new Sy(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new Sy(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new Sy(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class xy{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new Sy(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new xy(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class ky extends _w{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=pb.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new bb],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Sy(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=My(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new Sy(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=_w.get(e);if(i instanceof eb)c.push({node:e,deco:i.mark});else{if(i instanceof bb||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new gb({inclusive:!0,attributes:db(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new Sy(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Jw.ie||Jw.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new Cy;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=Sy.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=Jw.chrome||Jw.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof yb&&t.widget instanceof Sb&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=xb.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=xb.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=xb.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);Ww(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(oy)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new tb(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new eb(i,[e],e.length);let i=new bb;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=_w.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(ly)||this.dom.tabIndex>-1)&&gw(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if(Jw.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new Lw(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(Ow(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Ow(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{Jw.android&&Jw.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=fw(this.view.root);if(t)if(r.empty){if(Jw.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?Qw:Bw)(l.node,l.offset);e&&(l=new Lw(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new Lw(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new Lw(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&Ow(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=fw(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=bb.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=_w.get(i.childNodes[n]);t instanceof bb&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=_w.get(i.childNodes[n]);t instanceof bb&&(e=t.domAtPos(t.length))}return e?new Lw(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=_w.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof bb)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof bb&&!(i instanceof bb&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof yb&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof bb))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof tb))return null;let s=Me(n.text,i);if(s==i)return null;let o=Pw(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==Cb.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?mw(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?Cb.RTL:Cb.LTR}measureTextSize(){for(let t of this.children)if(t instanceof bb){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=mw(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new Nw(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(pb.replace({widget:new Sb(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return pb.set(t)}updateDeco(){let t=1,e=this.view.state.facet(py).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(gy).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(iy))try{if(e(this.view,t.range,t))return!0}catch(t){ry(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=by(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=xw(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=kw(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==Cb.LTR)}}function My(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=Qw(i.focusNode,i.focusOffset),s=Bw(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=_w.get(s.node);if(!e||e instanceof tb&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=_w.get(n.node);!t||t instanceof tb&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let Cy=class{constructor(){this.changes=[]}compareRange(t,e){wb(t,e,this.changes)}comparePoint(t,e){wb(t,e,this.changes)}boundChange(t){wb(t,t,this.changes)}};function Ay(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Ty(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Py(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function Dy(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function Ey(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function Ry(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=mw(u);for(let f=0;f<t.length;f++){let p=t[f];s&&Py(s,p)&&(p=Dy(Ey(p,s.bottom),s.top));let g=Ay(e,p),m=Ty(i,p);if(0==g&&0==m)return 3==u.nodeType?Qy(u,e,i):Ry(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&Py(h,p)?h=Ey(h,p.bottom):c&&Py(c,p)&&(c=Dy(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?Qy(n,u,i):d&&"false"!=n.contentEditable?Ry(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function Qy(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=Pw(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if((Jw.chrome||Jw.gecko)&&Pw(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function By(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=fb.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:Ly(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:Ly(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||Jw.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return Pw(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||Jw.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():Pw(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(yw(O),v))}if(!O||!t.docView.dom.contains(O)){let e=bb.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=Ry(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function Ly(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function $y(t,e){let i=t.lineBlockAt(e);if(Array.isArray(i.type))for(let t of i.type)if(t.to>e||t.to==e&&(t.to==i.to||t.type==fb.Text))return t;return i}function _y(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=Fb(s,o,r,l,i),h=qb;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function Vy(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function Ny(t,e,i){let n=Vy(t.state.facet(my).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const Wy="￿";class Hy{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Wy}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=_w.get(n),r=_w.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:ww(n))||ww(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=_w.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(qy(t,i.node,i.offset)?e:0))}}function qy(t,e,i){for(;;){if(!e||i<yw(e))return!1;if(e==t)return!0;i=vw(e)+1,e=e.parentNode}}class Fy{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class zy{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new Fy(i,n)),s==i&&o==n||e.push(new Fy(s,o))),e}(t),i=new Hy(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!pw(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!pw(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if((Jw.ios||Jw.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function Iy(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||Jw.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,Wy),e.text,l-n,a);h&&(Jw.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==Wy+Wy&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(Wy))})}else n&&(!t.hasFocus&&t.state.facet(ly)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(Jw.mac||Jw.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:Jw.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return Zy(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function Zy(t,e,i,n=-1){if(Jw.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(Jw.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&Dw(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&Dw(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&Dw(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&My(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet(Ub).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class Xy{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,Jw.safari&&t.contentDOM.addEventListener("input",(()=>null)),Jw.gecko&&function(t){wS.has(t)||(wS.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=_w.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(jy(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(jy(e.value,s))}}for(let t in tS)i(t).handlers.push(tS[t]);for(let t in eS)i(t).observers.push(eS[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&Ky.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),Jw.android&&Jw.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!Jw.ios||t.synthetic||t.altKey||t.metaKey||!((e=Yy.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||Uy.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,Dw(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(Jw.safari&&!Jw.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function jy(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){ry(i.state,t)}}}const Yy=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Uy="dthko",Ky=[16,17,18,20,91,92,224,225];function Gy(t){return.7*Math.max(0,t)+8}class Jy{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(my).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(Ib);return i.length?i[0](e):Jw.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=fw(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=fS(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=by(this.view);t.clientX-h.left<=o+6?n=-Gy(o-t.clientX):t.clientX+h.right>=l-6&&(n=Gy(t.clientX-l)),t.clientY-h.top<=r+6?s=-Gy(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=Gy(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=Vy(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=Vy(this.atoms,n.from,-1),e=Vy(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const tS=Object.create(null),eS=Object.create(null),iS=Jw.ie&&Jw.ie_version<15||Jw.ios&&Jw.webkit_version<604;function nS(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function sS(t,e){e=nS(t.state,Gb,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=gS&&n.selection.ranges.every((t=>t.empty))&&gS==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function oS(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=bb.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}eS.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},tS.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),eS.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},eS.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},tS.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(Xb))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=aS(t,e),n=fS(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=aS(t,e),h=oS(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=oS(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new Jy(t,e,i,n)),n&&t.observer.ignore((()=>{Tw(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let rS=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function lS(t,e,i,n){let s=bb.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&rS(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&rS(i,n,l)?1:r&&r.bottom>=n?-1:1}function aS(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:lS(t,i,e.clientX,e.clientY)}}const hS=Jw.ie&&Jw.ie_version<=11;let cS=null,dS=0,uS=0;function fS(t){if(!hS)return t.detail;let e=cS,i=uS;return cS=t,uS=Date.now(),dS=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(dS+1)%3:1}function pS(t,e,i,n){if(!(i=nS(t.state,Gb,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(Zb);return i.length?i[0](e):Jw.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}tS.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",nS(t.state,Jb,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},tS.dragend=t=>(t.inputState.draggedContent=null,!1),tS.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&pS(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return pS(t,e,i,!0),!0}return!1},tS.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=iS?null:e.clipboardData;return i?(sS(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),sS(t,i.value)}),50)}(t),!1)};let gS=null;tS.copy=tS.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:nS(t,Jb,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;gS=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=iS?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const mS=ui.define();function OS(t,e){let i=[];for(let n of t.facet(Kb)){let s=n(t,e);s&&i.push(s)}return i?t.update({effects:i,annotations:mS.of(!0)}):null}function vS(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=OS(t.state,e);i?t.dispatch(i):t.update([])}}),10)}eS.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),vS(t)},eS.blur=t=>{t.observer.clearSelectionRange(),vS(t)},eS.compositionstart=eS.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},eS.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Jw.chrome&&Jw.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},eS.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},tS.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return Zy(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if(Jw.chrome&&Jw.android&&(s=Yy.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return Jw.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),Jw.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>eS.compositionend(t,e)),20),!1};const wS=new Set,bS=["pre-wrap","normal","pre-line","break-spaces"];let yS=!1;function SS(){yS=!1}class xS{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return bS.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=bS.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class kS{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class MS{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?fb.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Ob?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new MS(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var CS=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(CS||(CS={}));const AS=.001;class TS{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>AS&&(yS=!0),this.height=t)}replace(t,e,i){return TS.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,CS.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,CS.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,CS.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=LS.build(i.setDoc(o),t,h,c);s=PS(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new ES(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new QS(TS.of(t.slice(0,e)),o,TS.of(t.slice(i)))}}function PS(t,e){return t==e?t:(t.constructor!=e.constructor&&(yS=!0),e)}TS.prototype.size=1;class DS extends TS{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new MS(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ES extends DS{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new MS(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof ES||n instanceof RS&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof RS?n=new ES(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):TS.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class RS extends TS{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new MS(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new MS(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==CS.ByHeight)return this.blockAt(t,i,n,s);if(e==CS.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new MS(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new MS(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new MS(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof RS?i[i.length-1]=new RS(t.length+n):i.push(null,new RS(n-1))}if(t>0){let e=i[0];e instanceof RS?i[0]=new RS(t+e.length):i.unshift(new RS(t-1),null)}return TS.of(i)}decomposeLeft(t,e){e.push(new RS(t-1),null)}decomposeRight(t,e){e.push(null,new RS(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new RS(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=AS&&(r=-2);let l=new ES(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new RS(s-o).updateHeight(t,o));let l=TS.of(i);return(r<0||Math.abs(l.height-this.height)>=AS||Math.abs(r-this.heightMetrics(t,e).perLine)>=AS)&&(yS=!0),PS(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class QS extends TS{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==CS.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==CS.ByPosNoHeight?CS.ByPosNoHeight:CS.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,CS.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&BS(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),BS(s,t)}return TS.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?TS.of(this.break?[t,null,e]:[t,e]):(this.left=PS(this.left,t),this.right=PS(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function BS(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof RS&&(n=t[e+1])instanceof RS&&t.splice(e-1,3,new RS(i.length+1+n.length))}class LS{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof ES?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new ES(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new DS(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new ES(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new RS(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof ES)return t;let e=new ES(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof ES||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new ES(0,-1));let i=t;for(let t of this.nodes)t instanceof ES&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new LS(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class $S{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&wb(t,e,this.changes,5)}}function _S(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function VS(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class NS{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return pb.replace({widget:new WS(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class WS extends ub{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class HS{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IS,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Cb.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(fy).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new xS(e),this.stateDeco=t.facet(py).filter((t=>"function"!=typeof t)),this.heightMap=TS.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new Sy(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=pb.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new qS(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?IS:new ZS(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(XS(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(py).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=Sy.extendWithRanges(n,function(t,e,i){let n=new $S;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);SS(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||yS)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(ey)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?Cb.RTL:Cb.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=kw(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=Rw(t.scrollDOM);let f=(this.printing?VS:_S)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),SS();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?TS.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new Sy(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new kS(i.from,s))}yS&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new qS(n.lineAt(o-1e3*i,CS.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),CS.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,CS.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new qS(n.lineAt(i-500,CS.ByHeight,s,0,0).from,n.lineAt(i+o+500,CS.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new qS(this.heightMap.lineAt(i,CS.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,CS.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,CS.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,CS.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new NS(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=Cb.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new NS(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=fb.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=zS(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=FS(s,t),a=FS(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=zS(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=FS(s,c),a=FS(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=zS(n,i)-zS(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){NS.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=pb.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||XS(this.heightMap.lineAt(t,CS.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||XS(this.heightMap.lineAt(this.scaler.fromDOM(t),CS.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return XS(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class qS{constructor(t,e){this.from=t,this.to=e}}function FS({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function zS(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const IS={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class ZS{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,CS.ByPos,t,0,0).top,r=e.lineAt(s,CS.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof ZS&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function XS(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new MS(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>XS(t,e))):t._content)}const jS=Fe.define({combine:t=>t.join(" ")}),YS=Fe.define({combine:t=>t.indexOf(!0)>-1}),US=Yi.newName(),KS=Yi.newName(),GS=Yi.newName(),JS={"&light":"."+KS,"&dark":"."+GS};function tx(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const ex=tx("."+US,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},JS),ix={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},nx=Jw.ie&&Jw.ie_version<=11;class sx{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new Mw,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(Jw.ie&&Jw.ie_version<=11||Jw.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||Jw.chrome&&Jw.chrome_version<126||(this.editContext=new lx(t),t.state.facet(ly)&&(t.contentDOM.editContext=this.editContext.editContext)),nx&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(ly)?i.root.activeElement!=this.dom:!gw(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(Jw.ie&&Jw.ie_version<=11||Jw.android&&Jw.chrome)&&!i.state.selection.main.empty&&n.focusNode&&Ow(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=fw(t.root);if(!e)return!1;let i=Jw.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return rx(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?rx(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=gw(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,yw(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=yw(i))}else{if(i==t)return!0;n=vw(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,ix),nx&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),nx&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&Dw(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&gw(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new zy(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=Iy(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=ox(e,t.previousSibling||t.target.previousSibling,-1),n=ox(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(ly)!=t.state.facet(ly)&&(t.view.contentDOM.editContext=t.state.facet(ly)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function ox(t,e,i){for(;e;){let n=_w.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function rx(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return Ow(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class lx{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if((Jw.mac||Jw.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);Zy(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(pb.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:oy.of(pb.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=fw(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class ax{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new HS(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(sy)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(hy).map((t=>new dy(t)));for(let t of this.plugins)t.update(this);this.observer=new sx(this),this.inputState=new Xy(this),this.inputState.ensureHandlers(this.plugins),this.docView=new ky(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(mS)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=OS(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=xy.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new ny(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(sy)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=dx.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(yy)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(jS)!=e.state.facet(jS)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(Yb))try{t(e)}catch(t){ry(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!Iy(this,h)&&a.force&&Dw(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new HS(t),this.plugins=t.facet(hy).map((t=>new dy(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new ky(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(hy),i=t.state.facet(hy);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new dy(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){ry(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(Rw(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return ry(this.state,t),cx}})),h=xy.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=cx)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){ry(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(Yb))t(e)}get themeClasses(){return US+" "+(this.state.facet(YS)?GS:KS)+" "+this.state.facet(jS)}updateAttrs(){let t=ux(this,uy,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(ly)?"true":"false",class:"cm-content",style:`${Jw.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),ux(this,fy,e);let i=this.observer.ignore((()=>{let i=cb(this.contentDOM,this.contentAttrs,e),n=cb(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(ax.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(yy);let t=this.state.facet(ax.cspNonce);Yi.mount(this.root,this.styleModules.concat(ex).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Ny(this,t,_y(this,t,e,i))}moveByGroup(t,e){return Ny(this,t,_y(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=$y(t,e.head),o=n&&s.type==fb.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==Cb.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return Ny(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=By(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),By(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return Sw(i,s[$b.find(s,t-n.from,-1,e)].dir==Cb.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(ty)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>hx)return Hb(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||_b(n.isolates,e=vy(this,t))))return n.order;e||(e=vy(this,t));let n=function(t,e,i){if(!t)return[new $b(0,0,e==Tb?1:0)];if(e==Ab&&!i.length&&!Lb.test(t))return Hb(t.length);if(i.length)for(;t.length>Vb.length;)Vb[Vb.length]=256;let n=[],s=e==Ab?0:1;return Wb(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new dx(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||Jw.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{Tw(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return sy.of(new ny("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return sy.of(new ny(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return cy.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return cy.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[jS.of(i),yy.of(tx(`.${i}`,t))];return e&&e.dark&&n.push(YS.of(!0)),n}static baseTheme(t){return Ge.lowest(yy.of(tx("."+US,t,JS)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&_w.get(i)||_w.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}ax.styleModule=yy,ax.inputHandler=Ub,ax.clipboardInputFilter=Gb,ax.clipboardOutputFilter=Jb,ax.scrollHandler=iy,ax.focusChangeEffect=Kb,ax.perLineTextDirection=ty,ax.exceptionSink=jb,ax.updateListener=Yb,ax.editable=ly,ax.mouseSelectionStyle=Xb,ax.dragMovesSelection=Zb,ax.clickAddsSelectionRange=Ib,ax.decorations=py,ax.outerDecorations=gy,ax.atomicRanges=my,ax.bidiIsolatedRanges=Oy,ax.scrollMargins=wy,ax.darkTheme=YS,ax.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),ax.contentAttributes=fy,ax.editorAttributes=uy,ax.lineWrapping=ax.contentAttributes.of({class:"cm-lineWrapping"}),ax.announce=gi.define();const hx=4096,cx={};class dx{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:Cb.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new dx(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function ux(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&lb(o,i)}return i}const fx=Jw.mac?"mac":Jw.windows?"win":Jw.linux?"linux":"key";function px(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const gx=Ge.default(ax.domEventHandlers({keydown(t,e){return function(t,e,i,n){bx=e;let s=on(e),o=Te(Ce(s,0))==s.length&&" "!=s,r="",l=!1,a=!1,h=!1;vx&&vx.view==i&&vx.scope==n&&(r=vx.prefix+" ",Ky.indexOf(e.keyCode)<0&&(a=!0,vx=null));let c,d,u=new Set,f=t=>{if(t){for(let e of t.run)if(!u.has(e)&&(u.add(e),e(i)))return t.stopPropagation&&(h=!0),!0;t.preventDefault&&(t.stopPropagation&&(h=!0),a=!0)}return!1},p=t[n];return p&&(f(p[r+px(s,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Jw.windows&&e.ctrlKey&&e.altKey)&&(c=Gi[e.keyCode])&&c!=s?(f(p[r+px(c,e,!0)])||e.shiftKey&&(d=Ji[e.keyCode])!=s&&d!=c&&f(p[r+px(d,e,!1)]))&&(l=!0):o&&e.shiftKey&&f(p[r+px(s,e,!0)])&&(l=!0),!l&&f(p._any)&&(l=!0)),a&&(l=!0),l&&h&&e.stopPropagation(),bx=null,l}(function(t){let e=t.facet(mx),i=Ox.get(e);return i||Ox.set(e,i=function(t,e=fx){let i=Object.create(null),n=Object.create(null),s=(t,e)=>{let i=n[t];if(null==i)n[t]=e;else if(i!=e)throw new Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},o=(t,n,o,r,l)=>{var a,h;let c=i[t]||(i[t]=Object.create(null)),d=n.split(/ (?!$)/).map((t=>function(t,e){const i=t.split(/-(?!$)/);let n,s,o,r,l=i[i.length-1];"Space"==l&&(l=" ");for(let t=0;t<i.length-1;++t){const l=i[t];if(/^(cmd|meta|m)$/i.test(l))r=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);"mac"==e?r=!0:s=!0}}return n&&(l="Alt-"+l),s&&(l="Ctrl-"+l),r&&(l="Meta-"+l),o&&(l="Shift-"+l),l}(t,e)));for(let e=1;e<d.length;e++){let i=d.slice(0,e).join(" ");s(i,!0),c[i]||(c[i]={preventDefault:!0,stopPropagation:!1,run:[e=>{let n=vx={view:e,prefix:i,scope:t};return setTimeout((()=>{vx==n&&(vx=null)}),wx),!0}]})}let u=d.join(" ");s(u,!1);let f=c[u]||(c[u]={preventDefault:!1,stopPropagation:!1,run:(null===(h=null===(a=c._any)||void 0===a?void 0:a.run)||void 0===h?void 0:h.slice())||[]});o&&f.run.push(o),r&&(f.preventDefault=!0),l&&(f.stopPropagation=!0)};for(let n of t){let t=n.scope?n.scope.split(" "):["editor"];if(n.any)for(let e of t){let t=i[e]||(i[e]=Object.create(null));t._any||(t._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:s}=n;for(let e in t)t[e].run.push((t=>s(t,bx)))}let s=n[e]||n.key;if(s)for(let e of t)o(e,s,n.run,n.preventDefault,n.stopPropagation),n.shift&&o(e,"Shift-"+s,n.shift,n.preventDefault,n.stopPropagation)}return i}(e.reduce(((t,e)=>t.concat(e)),[]))),i}(e.state),t,e,"editor")}})),mx=Fe.define({enables:gx}),Ox=new WeakMap;let vx=null;const wx=4e3;let bx=null;class yx{constructor(t,e,i,n,s){this.className=t,this.left=e,this.top=i,this.width=n,this.height=s}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className==this.className&&(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",null!=this.width&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,e,i){if(i.empty){let n=t.coordsAtPos(i.head,i.assoc||1);if(!n)return[];let s=Sx(t);return[new yx(e,n.left-s.left,n.top-s.top,null,n.bottom-n.top)]}return function(t,e,i){if(i.to<=t.viewport.from||i.from>=t.viewport.to)return[];let n=Math.max(i.from,t.viewport.from),s=Math.min(i.to,t.viewport.to),o=t.textDirection==Cb.LTR,r=t.contentDOM,l=r.getBoundingClientRect(),a=Sx(t),h=r.querySelector(".cm-line"),c=h&&window.getComputedStyle(h),d=l.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),u=l.right-(c?parseInt(c.paddingRight):0),f=$y(t,n),p=$y(t,s),g=f.type==fb.Text?f:null,m=p.type==fb.Text?p:null;if(g&&(t.lineWrapping||f.widgetLineBreaks)&&(g=xx(t,n,1,g)),m&&(t.lineWrapping||p.widgetLineBreaks)&&(m=xx(t,s,-1,m)),g&&m&&g.from==m.from&&g.to==m.to)return v(w(i.from,i.to,g));{let e=g?w(i.from,null,g):b(f,!1),n=m?w(null,i.to,m):b(p,!0),s=[];return(g||f).to<(m||p).from-(g&&m?1:0)||f.widgetLineBreaks>1&&e.bottom+t.defaultLineHeight/2<n.top?s.push(O(d,e.bottom,u,n.top)):e.bottom<n.top&&t.elementAtHeight((e.bottom+n.top)/2).type==fb.Text&&(e.bottom=n.top=(e.bottom+n.top)/2),v(e).concat(s).concat(v(n))}function O(t,i,n,s){return new yx(e,t-a.left,i-a.top,n-t,s-i)}function v({top:t,bottom:e,horizontal:i}){let n=[];for(let s=0;s<i.length;s+=2)n.push(O(i[s],t,i[s+1],e));return n}function w(e,i,n){let s=1e9,r=-1e9,l=[];function a(e,i,a,h,c){let f=t.coordsAtPos(e,e==n.to?-2:2),p=t.coordsAtPos(a,a==n.from?2:-2);f&&p&&(s=Math.min(f.top,p.top,s),r=Math.max(f.bottom,p.bottom,r),c==Cb.LTR?l.push(o&&i?d:f.left,o&&h?u:p.right):l.push(!o&&h?d:p.left,!o&&i?u:f.right))}let h=null!=e?e:n.from,c=null!=i?i:n.to;for(let n of t.visibleRanges)if(n.to>h&&n.from<c)for(let s=Math.max(n.from,h),o=Math.min(n.to,c);;){let n=t.state.doc.lineAt(s);for(let r of t.bidiSpans(n)){let t=r.from+n.from,l=r.to+n.from;if(t>=o)break;l>s&&a(Math.max(t,s),null==e&&t<=h,Math.min(l,o),null==i&&l>=c,r.dir)}if(s=n.to+1,s>=o)break}return 0==l.length&&a(h,null==e,c,null==i,t.textDirection),{top:s,bottom:r,horizontal:l}}function b(t,e){let i=l.top+(e?t.top:t.bottom);return{top:i,bottom:i,horizontal:[]}}}(t,e,i)}}function Sx(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Cb.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function xx(t,e,i,n){let s=t.coordsAtPos(e,2*i);if(!s)return n;let o=t.dom.getBoundingClientRect(),r=(s.top+s.bottom)/2,l=t.posAtCoords({x:o.left+1,y:r}),a=t.posAtCoords({x:o.right-1,y:r});return null==l||null==a?n:{from:Math.max(n.from,Math.min(l,a)),to:Math.min(n.to,Math.max(l,a))}}class kx{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(Mx)!=t.state.facet(Mx)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){!1!==this.layer.updateOnDocViewUpdate&&t.requestMeasure(this.measureReq)}setOrder(t){let e=0,i=t.facet(Mx);for(;e<i.length&&i[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:e}=this.view;t==this.scaleX&&e==this.scaleY||(this.scaleX=t,this.scaleY=e,this.dom.style.transform=`scale(${1/t}, ${1/e})`)}draw(t){if(t.length!=this.drawn.length||t.some(((t,e)=>{return i=t,n=this.drawn[e],!(i.constructor==n.constructor&&i.eq(n));var i,n}))){let e=this.dom.firstChild,i=0;for(let n of t)n.update&&e&&n.constructor&&this.drawn[i].constructor&&n.update(e,this.drawn[i])?(e=e.nextSibling,i++):this.dom.insertBefore(n.draw(),e);for(;e;){let t=e.nextSibling;e.remove(),e=t}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Mx=Fe.define();function Cx(t){return[cy.define((e=>new kx(e,t))),Mx.of(t)]}const Ax=!(Jw.ios&&Jw.webkit&&Jw.webkit_version<534),Tx=Fe.define({combine(t){return Ai(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})}});function Px(t){return t.startState.facet(Tx)!=t.state.facet(Tx)}const Dx=Cx({above:!0,markers(t){let{state:e}=t,i=e.facet(Tx),n=[];for(let s of e.selection.ranges){let o=s==e.selection.main;if(s.empty?!o||Ax:i.drawRangeCursor){let e=o?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",i=s.empty?s:We.cursor(s.head,s.head>s.anchor?-1:1);for(let s of yx.forRange(t,e,i))n.push(s)}}return n},update(t,e){t.transactions.some((t=>t.selection))&&(e.style.animationName="cm-blink"==e.style.animationName?"cm-blink2":"cm-blink");let i=Px(t);return i&&Ex(t.state,e),t.docChanged||t.selectionSet||i},mount(t,e){Ex(e.state,t)},class:"cm-cursorLayer"});function Ex(t,e){e.style.animationDuration=t.facet(Tx).cursorBlinkRate+"ms"}const Rx=Cx({above:!1,markers(t){return t.state.selection.ranges.map((e=>e.empty?[]:yx.forRange(t,"cm-selectionBackground",e))).reduce(((t,e)=>t.concat(e)))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||Px(t)},class:"cm-selectionLayer"}),Qx={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};Ax&&(Qx[".cm-line"].caretColor=Qx[".cm-content"].caretColor="transparent !important");const Bx=Ge.highest(ax.theme(Qx)),Lx=gi.define({map(t,e){return null==t?null:e.mapPos(t)}}),$x=Ue.define({create(){return null},update(t,e){return null!=t&&(t=e.changes.mapPos(t)),e.effects.reduce(((t,e)=>e.is(Lx)?e.value:t),t)}}),_x=cy.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let i=t.state.field($x);null==i?null!=this.cursor&&(null===(e=this.cursor)||void 0===e||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field($x)!=i||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field($x),i=null!=e&&t.coordsAtPos(e);if(!i)return null;let n=t.scrollDOM.getBoundingClientRect();return{left:i.left-n.left+t.scrollDOM.scrollLeft*t.scaleX,top:i.top-n.top+t.scrollDOM.scrollTop*t.scaleY,height:i.bottom-i.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:i}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/i+"px",this.cursor.style.height=t.height/i+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field($x)!=t&&this.view.dispatch({effects:Lx.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){t.target!=this.view.contentDOM&&this.view.contentDOM.contains(t.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function Vx(t,e,i,n,s){e.lastIndex=0;for(let o,r=t.iterRange(i,n),l=i;!r.next().done;l+=r.value.length)if(!r.lineBreak)for(;o=e.exec(r.value);)s(l+o.index,o)}class Nx{constructor(t){const{regexp:e,decoration:i,decorate:n,boundary:s,maxLength:o=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,n)this.addMatch=(t,e,i,s)=>n(s,i,i+t[0].length,t,e);else if("function"==typeof i)this.addMatch=(t,e,n,s)=>{let o=i(t,e,n);o&&s(n,n+t[0].length,o)};else{if(!i)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(t,e,n,s)=>s(n,n+t[0].length,i)}this.boundary=s,this.maxLength=o}createDeco(t){let e=new Qi,i=e.add.bind(e);for(let{from:e,to:n}of function(t,e){let i=t.visibleRanges;if(1==i.length&&i[0].from==t.viewport.from&&i[0].to==t.viewport.to)return i;let n=[];for(let{from:s,to:o}of i)s=Math.max(t.state.doc.lineAt(s).from,s-e),o=Math.min(t.state.doc.lineAt(o).to,o+e),n.length&&n[n.length-1].to>=s?n[n.length-1].to=o:n.push({from:s,to:o});return n}(t,this.maxLength))Vx(t.state.doc,this.regexp,e,n,((e,n)=>this.addMatch(n,t,e,i)));return e.finish()}updateDeco(t,e){let i=1e9,n=-1;return t.docChanged&&t.changes.iterChanges(((e,s,o,r)=>{r>=t.view.viewport.from&&o<=t.view.viewport.to&&(i=Math.min(o,i),n=Math.max(r,n))})),t.viewportMoved||n-i>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),i,n):e}updateRange(t,e,i,n){for(let s of t.visibleRanges){let o=Math.max(s.from,i),r=Math.min(s.to,n);if(r>o){let i=t.state.doc.lineAt(o),n=i.to<r?t.state.doc.lineAt(r):i,l=Math.max(s.from,i.from),a=Math.min(s.to,n.to);if(this.boundary){for(;o>i.from;o--)if(this.boundary.test(i.text[o-1-i.from])){l=o;break}for(;r<n.to;r++)if(this.boundary.test(n.text[r-n.from])){a=r;break}}let h,c=[],d=(t,e,i)=>c.push(i.range(t,e));if(i==n)for(this.regexp.lastIndex=l-i.from;(h=this.regexp.exec(i.text))&&h.index<a-i.from;)this.addMatch(h,t,h.index+i.from,d);else Vx(t.state.doc,this.regexp,l,a,((e,i)=>this.addMatch(i,t,e,d)));e=e.update({filterFrom:l,filterTo:a,filter:(t,e)=>t<l||e>a,add:c})}}return e}}const Wx=null!=/x/.unicode?"gu":"g",Hx=new RegExp("[\0-\b\n--­؜​‎‏\u2028\u2029‭‮⁦⁧⁩\ufeff￹-￼]",Wx),qx={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Fx=null;const zx=Fe.define({combine(t){let e=Ai(t,{render:null,specialChars:Hx,addSpecialChars:null});return(e.replaceTabs=!function(){var t;if(null==Fx&&"undefined"!=typeof document&&document.body){let e=document.body.style;Fx=null!=(null!==(t=e.tabSize)&&void 0!==t?t:e.MozTabSize)}return Fx||!1}())&&(e.specialChars=new RegExp("\t|"+e.specialChars.source,Wx)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,Wx)),e}});let Ix=null;class Zx extends ub{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=function(t){return t>=32?"•":10==t?"␤":String.fromCharCode(9216+t)}(this.code),i=t.state.phrase("Control character")+" "+(qx[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,e);if(n)return n;let s=document.createElement("span");return s.textContent=e,s.title=i,s.setAttribute("aria-label",i),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class Xx extends ub{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="\t",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}const jx=pb.line({class:"cm-activeLine"}),Yx=cy.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,i=[];for(let n of t.state.selection.ranges){let s=t.lineBlockAt(n.head);s.from>e&&(i.push(jx.range(s.from)),e=s.from)}return pb.set(i)}},{decorations:t=>t.decorations});class Ux extends ub{constructor(t){super(),this.content=t}toDOM(t){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild("string"==typeof this.content?document.createTextNode(this.content):"function"==typeof this.content?this.content(t):this.content.cloneNode(!0)),"string"==typeof this.content?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(t){let e=t.firstChild?mw(t.firstChild):[];if(!e.length)return null;let i=window.getComputedStyle(t.parentNode),n=Sw(e[0],"rtl"!=i.direction),s=parseInt(i.lineHeight);return n.bottom-n.top>1.5*s?{left:n.left,right:n.right,top:n.top,bottom:n.top+s}:n}ignoreEvent(){return!1}}const Kx=2e3;function Gx(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1),n=t.state.doc.lineAt(i),s=i-n.from,o=s>Kx?-1:s==n.length?function(t,e){let i=t.coordsAtPos(t.viewport.from);return i?Math.round(Math.abs((i.left-e)/t.defaultCharacterWidth)):-1}(t,e.clientX):zi(n.text,t.state.tabSize,i-n.from);return{line:n.number,col:o,off:s}}const Jx={Alt:[18,t=>!!t.altKey],Control:[17,t=>!!t.ctrlKey],Shift:[16,t=>!!t.shiftKey],Meta:[91,t=>!!t.metaKey]},tk={style:"cursor: crosshair"};class ek extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}ek.prototype.elementClass="",ek.prototype.toDOM=void 0,ek.prototype.mapMode=De.TrackBefore,ek.prototype.startSide=ek.prototype.endSide=-1,ek.prototype.point=!0;const ik=Fe.define(),nk=Fe.define(),sk=Fe.define(),ok=Fe.define({combine:t=>t.some((t=>t))});function rk(t){let e=[lk];return t&&!1===t.fixed&&e.push(ok.of(!0)),e}const lk=cy.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(sk).map((e=>new dk(t,e)));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!t.state.facet(ok),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,i=t.view.viewport,n=Math.min(e.to,i.to)-Math.max(e.from,i.from);this.syncGutters(n<.8*(i.to-i.from))}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(ok)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let i=Ri.iter(this.view.state.facet(ik),this.view.viewport.from),n=[],s=this.gutters.map((t=>new ck(t,this.view.viewport,-this.view.documentPadding.top)));for(let t of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(t.type)){let e=!0;for(let o of t.type)if(o.type==fb.Text&&e){hk(i,n,o.from);for(let t of s)t.line(this.view,o,n);e=!1}else if(o.widget)for(let t of s)t.widget(this.view,o)}else if(t.type==fb.Text){hk(i,n,t.from);for(let e of s)e.line(this.view,t,n)}else if(t.widget)for(let e of s)e.widget(this.view,t);for(let t of s)t.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(sk),i=t.state.facet(sk),n=t.docChanged||t.heightChanged||t.viewportChanged||!Ri.eq(t.startState.facet(ik),t.state.facet(ik),t.view.viewport.from,t.view.viewport.to);if(e==i)for(let e of this.gutters)e.update(t)&&(n=!0);else{n=!0;let s=[];for(let n of i){let i=e.indexOf(n);i<0?s.push(new dk(this.view,n)):(this.gutters[i].update(t),s.push(this.gutters[i]))}for(let t of this.gutters)t.dom.remove(),s.indexOf(t)<0&&t.destroy();for(let t of s)this.dom.appendChild(t.dom);this.gutters=s}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>ax.scrollMargins.of((e=>{let i=e.plugin(t);return i&&0!=i.gutters.length&&i.fixed?e.textDirection==Cb.LTR?{left:i.dom.offsetWidth*e.scaleX}:{right:i.dom.offsetWidth*e.scaleX}:null}))});function ak(t){return Array.isArray(t)?t:[t]}function hk(t,e,i){for(;t.value&&t.from<=i;)t.from==i&&e.push(t.value),t.next()}class ck{constructor(t,e,i){this.gutter=t,this.height=i,this.i=0,this.cursor=Ri.iter(t.markers,e.from)}addElement(t,e,i){let{gutter:n}=this,s=(e.top-this.height)/t.scaleY,o=e.height/t.scaleY;if(this.i==n.elements.length){let e=new uk(t,o,s,i);n.elements.push(e),n.dom.appendChild(e.dom)}else n.elements[this.i].update(t,o,s,i);this.height=e.bottom,this.i++}line(t,e,i){let n=[];hk(this.cursor,n,e.from),i.length&&(n=n.concat(i));let s=this.gutter.config.lineMarker(t,e,n);s&&n.unshift(s);let o=this.gutter;(0!=n.length||o.config.renderEmptyElements)&&this.addElement(t,e,n)}widget(t,e){let i=this.gutter.config.widgetMarker(t,e.widget,e),n=i?[i]:null;for(let i of t.state.facet(nk)){let s=i(t,e.widget,e);s&&(n||(n=[])).push(s)}n&&this.addElement(t,e,n)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class dk{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,(n=>{let s,o=n.target;if(o!=this.dom&&this.dom.contains(o)){for(;o.parentNode!=this.dom;)o=o.parentNode;let t=o.getBoundingClientRect();s=(t.top+t.bottom)/2}else s=n.clientY;let r=t.lineBlockAtHeight(s-t.documentTop);e.domEventHandlers[i](t,r,n)&&n.preventDefault()}));this.markers=ak(e.markers(t)),e.initialSpacer&&(this.spacer=new uk(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=ak(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let e=this.config.updateSpacer(this.spacer.markers[0],t);e!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[e])}let i=t.view.viewport;return!Ri.eq(this.markers,e,i.from,i.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(t)}destroy(){for(let t of this.elements)t.destroy()}}class uk{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.height=e,this.dom.style.height=e+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),function(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].compare(e[i]))return!1;return!0}(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let s=0,o=0;;){let r=o,l=s<e.length?e[s++]:null,a=!1;if(l){let t=l.elementClass;t&&(i+=" "+t);for(let t=o;t<this.markers.length;t++)if(this.markers[t].compare(l)){r=t,a=!0;break}}else r=this.markers.length;for(;o<r;){let t=this.markers[o++];if(t.toDOM){t.destroy(n);let e=n.nextSibling;n.remove(),n=e}}if(!l)break;l.toDOM&&(a?n=n.nextSibling:this.dom.insertBefore(l.toDOM(t),n)),a&&o++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}const fk=Fe.define(),pk=Fe.define(),gk=Fe.define({combine(t){return Ai(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let t in e){let n=i[t],s=e[t];i[t]=n?(t,e,i)=>n(t,e,i)||s(t,e,i):s}return i}})}});class mk extends ek{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Ok(t,e){return t.state.facet(gk).formatNumber(e,t.state)}const vk=sk.compute([gk],(t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(fk)},lineMarker(t,e,i){return i.some((t=>t.toDOM))?null:new mk(Ok(t,t.state.doc.lineAt(e.from).number))},widgetMarker:(t,e,i)=>{for(let n of t.state.facet(pk)){let s=n(t,e,i);if(s)return s}return null},lineMarkerChange:t=>t.startState.facet(gk)!=t.state.facet(gk),initialSpacer(t){return new mk(Ok(t,wk(t.state.doc.lines)))},updateSpacer(t,e){let i=Ok(e.view,wk(e.view.state.doc.lines));return i==t.number?t:new mk(i)},domEventHandlers:t.facet(gk).domEventHandlers})));function wk(t){let e=9;for(;e<t;)e=10*e+9;return e}const bk=new class extends ek{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},yk=ik.compute(["selection"],(t=>{let e=[],i=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.head).from;s>i&&(i=s,e.push(bk.range(s)))}return Ri.of(e)}));function Sk(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function xk(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function kk(t,e){if(!e.anchorNode)return!1;try{return xk(t,e.anchorNode)}catch(t){return!1}}function Mk(t){return 3==t.nodeType?Vk(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function Ck(t,e,i,n){return!!i&&(Pk(t,e,i,n,-1)||Pk(t,e,i,n,1))}function Ak(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function Tk(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function Pk(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:Dk(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=Ak(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?Dk(t):0}}}function Dk(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function Ek(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function Rk(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function Qk(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}class Bk{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?Dk(e):0),i,Math.min(t.focusOffset,i?Dk(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let Lk,$k=null;function _k(t){if(t.setActive)return t.setActive();if($k)return t.focus($k);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==$k?{get preventScroll(){return $k={preventScroll:!0},!0}}:void 0),!$k){$k=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function Vk(t,e,i=e){let n=Lk||(Lk=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function Nk(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function Wk(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function Hk(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function qk(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=Dk(i)}else{if(!i.parentNode||Tk(i))return null;n=Ak(i),i=i.parentNode}}}function Fk(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||Tk(i))return null;n=Ak(i)+1,i=i.parentNode}}}class zk{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new zk(t.parentNode,Ak(t),e)}static after(t,e){return new zk(t.parentNode,Ak(t)+1,e)}}const Ik=[];class Zk{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=Zk.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=Xk(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=Xk(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==Dk(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!Zk.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=Ik){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new jk(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function Xk(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}Zk.prototype.breakAfter=0;class jk{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function Yk(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function Uk(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,Yk(t,h,c,l,a,n,0,s,o)}let Kk="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},Gk="undefined"!=typeof document?document:{documentElement:{style:{}}};const Jk=/Edge\/(\d+)/.exec(Kk.userAgent),tM=/MSIE \d/.test(Kk.userAgent),eM=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Kk.userAgent),iM=!!(tM||eM||Jk),nM=!iM&&/gecko\/(\d+)/i.test(Kk.userAgent),sM=!iM&&/Chrome\/(\d+)/.exec(Kk.userAgent),oM="webkitFontSmoothing"in Gk.documentElement.style,rM=!iM&&/Apple Computer/.test(Kk.vendor),lM=rM&&(/Mobile\/\w+/.test(Kk.userAgent)||Kk.maxTouchPoints>2);var aM={mac:lM||/Mac/.test(Kk.platform),windows:/Win/.test(Kk.platform),linux:/Linux|X11/.test(Kk.platform),ie:iM,ie_version:tM?Gk.documentMode||6:eM?+eM[1]:Jk?+Jk[1]:0,gecko:nM,gecko_version:nM?+(/Firefox\/(\d+)/.exec(Kk.userAgent)||[0,0])[1]:0,chrome:!!sM,chrome_version:sM?+sM[1]:0,ios:lM,android:/Android\b/.test(Kk.userAgent),webkit:oM,safari:rM,webkit_version:oM?+(/\bAppleWebKit\/(\d+)/.exec(Kk.userAgent)||[0,0])[1]:0,tabSize:null!=Gk.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class hM extends Zk{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof hM)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new hM(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new zk(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?aM.chrome||aM.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=Vk(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return aM.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?Ek(a,r<0):a||null}(this.dom,t,e)}}class cM extends Zk{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(Wk(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof cM&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(Uk(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new cM(this.mark,e,o)}domAtPos(t){return fM(this,t)}coordsAt(t,e){return gM(this,t,e)}}class dM extends Zk{static create(t,e,i){return new dM(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=dM.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof dM&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof dM&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?zk.before(this.dom):zk.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return Ek(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class uM extends Zk{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof uM&&t.side==this.side}split(){return new uM(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?zk.before(this.dom):zk.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function fM(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new zk(i,0)}function pM(t,e,i){let n,{children:s}=t;i>0&&e instanceof cM&&s.length&&(n=s[s.length-1])instanceof cM&&n.mark.eq(e.mark)?pM(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function gM(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&(i>0||mM(o,c)))&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=Mk(e);return i[i.length-1]||null}(t)}function mM(t,e){let i=t.coordsAt(0,1),n=e.coordsAt(0,1);return i&&n&&n.top<i.bottom}function OM(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}hM.prototype.children=dM.prototype.children=uM.prototype.children=Ik;const vM=Object.create(null);function wM(t,e,i){if(t==e)return!0;t||(t=vM),e||(e=vM);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function bM(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function yM(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class SM{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var xM=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(xM||(xM={}));class kM extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new MM(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new AM(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=TM(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new AM(t,e,i,n,t.widget||null,!0)}static line(t){return new CM(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}kM.none=Ri.empty;class MM extends kM{constructor(t){let{start:e,end:i}=TM(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof MM&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&wM(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}MM.prototype.point=!1;class CM extends kM{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof CM&&this.spec.class==t.spec.class&&wM(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}CM.prototype.mapMode=De.TrackBefore,CM.prototype.point=!0;class AM extends kM{constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?xM.WidgetRange:this.startSide<=0?xM.WidgetBefore:xM.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof AM&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function TM(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function PM(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}AM.prototype.point=!0;class DM extends Zk{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof DM))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Uk(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new DM;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){wM(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){pM(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=OM(e,this.attrs||{})),i&&(this.attrs=OM({class:i},this.attrs||{}))}domAtPos(t){return fM(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(Wk(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(bM(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&Zk.get(n)instanceof cM;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=Zk.get(n))||void 0===i?void 0:i.isEditable)||aM.ios&&this.children.some((t=>t instanceof hM))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof hM)||/[^ -~]/.test(i.text))return null;let n=Mk(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=gM(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof DM&&0==this.children.length&&0==t.children.length&&wM(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof DM)return s;if(o>e)break}n=o+s.breakAfter}return null}}class EM extends Zk{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof EM&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?zk.before(this.dom):zk.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new EM(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return Ik}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof EM&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof RM?null:Ek(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class RM extends SM{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class QM{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof EM&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new DM),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(BM(new uM(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof EM||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(BM(new hM(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof AM){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof AM)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new EM(i.widget||LM.block,r,i));else{let o=dM.create(i.widget||LM.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(BM(new uM(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(BM(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new QM(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function BM(t,e){for(let i of e)t=new cM(i,[t],t.length);return t}class LM extends SM{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}LM.inline=new LM("span"),LM.block=new LM("div");var $M=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}($M||($M={}));const _M=$M.LTR,VM=$M.RTL;function NM(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const WM=NM("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),HM=NM("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),qM=Object.create(null),FM=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);qM[e]=i,qM[i]=-e}function zM(t){return t<=247?WM[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?HM[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const IM=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ZM{get dir(){return this.level%2?VM:_M}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function XM(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!XM(n.inner,s.inner))return!1}return!0}const jM=[];function YM(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=jM[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if(jM[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new ZM(a,p.from,u)),UM(t,p.direction==_M!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?jM[f]!=l:jM[f]==l))break;f++}d?YM(t,a,f,n+1,s,d,r):a<f&&r.push(new ZM(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=jM[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if(jM[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new ZM(p.to,a,u)),UM(t,p.direction==_M!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?jM[f-1]!=l:jM[f-1]==l))break;f--}d?YM(t,f,a,n+1,s,d,r):f<a&&r.push(new ZM(f,a,u)),a=f}}function UM(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=zM(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),jM[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=jM[t];if(128==s)t<l-1&&e==jM[t+1]&&24&e?s=jM[t]=e:jM[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==jM[s];)s++;let o=t&&8==e||s<i&&8==jM[s]?1==n?1:8:256;for(let e=t;e<s;e++)jM[e]=o;t=s-1}else 8==s&&1==n&&(jM[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=qM[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(FM[t+1]==-i){let e=FM[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&(jM[r]=jM[FM[t]]=i),l=t;break}}else{if(189==FM.length)break;FM[l++]=r,FM[l++]=e,FM[l++]=a}else if(2==(n=jM[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=FM[e+2];if(2&i)break;if(t)FM[e+2]|=2;else{if(4&i)break;FM[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=jM[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=jM[r])break;r++}let h=1==o,c=h==(1==(r<e?jM[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),jM[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),YM(t,s,o,e,i,n,r)}function KM(t){return[new ZM(0,t,0)]}let GM="";function JM(t,e,i,n,s){var o;let r=n.head-t.from,l=ZM.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),GM=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function tC(t,e,i){for(let n=e;n<i;n++){let e=zM(t.charCodeAt(n));if(1==e)return _M;if(2==e||4==e)return VM}return _M}const eC=Fe.define(),iC=Fe.define(),nC=Fe.define(),sC=Fe.define(),oC=Fe.define(),rC=Fe.define(),lC=Fe.define(),aC=Fe.define(),hC=Fe.define(),cC=Fe.define({combine:t=>t.some((t=>t))}),dC=Fe.define({combine:t=>t.some((t=>t))}),uC=Fe.define();class fC{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new fC(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new fC(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const pC=gi.define({map:(t,e)=>t.map(e)}),gC=gi.define();function mC(t,e,i){let n=t.facet(sC);n.length?n[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const OC=Fe.define({combine:t=>!t.length||t[0]});let vC=0;const wC=Fe.define();class bC{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new bC(vC++,t,i,n,(t=>{let e=[wC.of(t)];return o&&e.push(kC.of((e=>{let i=e.plugin(t);return i?o(i):kM.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return bC.define((e=>new t(e)),e)}}class yC{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(mC(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){mC(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){mC(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const SC=Fe.define(),xC=Fe.define(),kC=Fe.define(),MC=Fe.define(),CC=Fe.define(),AC=Fe.define();function TC(t,e){let i=t.state.facet(AC);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=tC(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const PC=Fe.define();function DC(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(PC)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const EC=Fe.define();class RC{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new RC(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new RC(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new RC(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class QC{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new RC(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new QC(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class BC extends Zk{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=kM.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new DM],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new RC(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=LC(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new RC(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=Zk.get(e);if(i instanceof cM)c.push({node:e,deco:i.mark});else{if(i instanceof DM||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new MM({inclusive:!0,attributes:yM(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new RC(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(aM.ie||aM.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new $C;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=RC.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=aM.chrome||aM.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof EM&&t.widget instanceof RM&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=QM.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=QM.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=QM.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);Yk(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(gC)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new hM(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new cM(i,[e],e.length);let i=new DM;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=Zk.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(OC)||this.dom.tabIndex>-1)&&kk(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if(aM.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new zk(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(Ck(l.node,l.offset,c.anchorNode,c.anchorOffset)&&Ck(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{aM.android&&aM.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=Sk(this.view.root);if(t)if(r.empty){if(aM.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?qk:Fk)(l.node,l.offset);e&&(l=new zk(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new zk(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new zk(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&Ck(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=Sk(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=DM.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=Zk.get(i.childNodes[n]);t instanceof DM&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=Zk.get(i.childNodes[n]);t instanceof DM&&(e=t.domAtPos(t.length))}return e?new zk(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=Zk.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof DM)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof DM&&!(i instanceof DM&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof EM&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof DM))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof hM))return null;let s=Me(n.text,i);if(s==i)return null;let o=Vk(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==$M.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?Mk(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?$M.RTL:$M.LTR}measureTextSize(){for(let t of this.children)if(t instanceof DM){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=Mk(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new jk(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(kM.replace({widget:new RM(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return kM.set(t)}updateDeco(){let t=1,e=this.view.state.facet(kC).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(MC).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(uC))try{if(e(this.view,t.range,t))return!0}catch(t){mC(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=DC(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=Rk(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=Qk(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==$M.LTR)}}function LC(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=qk(i.focusNode,i.focusOffset),s=Fk(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=Zk.get(s.node);if(!e||e instanceof hM&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=Zk.get(n.node);!t||t instanceof hM&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let $C=class{constructor(){this.changes=[]}compareRange(t,e){PM(t,e,this.changes)}comparePoint(t,e){PM(t,e,this.changes)}boundChange(t){PM(t,t,this.changes)}};function _C(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function VC(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function NC(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function WC(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function HC(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function qC(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=Mk(u);for(let f=0;f<t.length;f++){let p=t[f];s&&NC(s,p)&&(p=WC(HC(p,s.bottom),s.top));let g=_C(e,p),m=VC(i,p);if(0==g&&0==m)return 3==u.nodeType?FC(u,e,i):qC(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&NC(h,p)?h=HC(h,p.bottom):c&&NC(c,p)&&(c=WC(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?FC(n,u,i):d&&"false"!=n.contentEditable?qC(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function FC(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=Vk(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if((aM.chrome||aM.gecko)&&Vk(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function zC(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=xM.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:IC(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:IC(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||aM.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return Vk(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||aM.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():Vk(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(Dk(O),v))}if(!O||!t.docView.dom.contains(O)){let e=DM.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=qC(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function IC(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function ZC(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=JM(s,o,r,l,i),h=GM;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function XC(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function jC(t,e,i){let n=XC(t.state.facet(CC).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const YC="￿";class UC{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=YC}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=Zk.get(n),r=Zk.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:Tk(n))||Tk(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=Zk.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(KC(t,i.node,i.offset)?e:0))}}function KC(t,e,i){for(;;){if(!e||i<Dk(e))return!1;if(e==t)return!0;i=Ak(e)+1,e=e.parentNode}}class GC{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class JC{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new GC(i,n)),s==i&&o==n||e.push(new GC(s,o))),e}(t),i=new UC(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!xk(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!xk(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if((aM.ios||aM.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function tA(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||aM.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,YC),e.text,l-n,a);h&&(aM.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==YC+YC&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(YC))})}else n&&(!t.hasFocus&&t.state.facet(OC)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(aM.mac||aM.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:aM.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return eA(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function eA(t,e,i,n=-1){if(aM.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(aM.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&Nk(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&Nk(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&Nk(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&LC(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet(rC).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class iA{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,aM.safari&&t.contentDOM.addEventListener("input",(()=>null)),aM.gecko&&function(t){TA.has(t)||(TA.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=Zk.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(nA(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(nA(e.value,s))}}for(let t in hA)i(t).handlers.push(hA[t]);for(let t in cA)i(t).observers.push(cA[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&rA.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),aM.android&&aM.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!aM.ios||t.synthetic||t.altKey||t.metaKey||!((e=sA.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||oA.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,Nk(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(aM.safari&&!aM.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function nA(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){mC(i.state,t)}}}const sA=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],oA="dthko",rA=[16,17,18,20,91,92,224,225];function lA(t){return.7*Math.max(0,t)+8}class aA{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(CC).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(eC);return i.length?i[0](e):aM.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=Sk(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=SA(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=DC(this.view);t.clientX-h.left<=o+6?n=-lA(o-t.clientX):t.clientX+h.right>=l-6&&(n=lA(t.clientX-l)),t.clientY-h.top<=r+6?s=-lA(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=lA(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=XC(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=XC(this.atoms,n.from,-1),e=XC(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const hA=Object.create(null),cA=Object.create(null),dA=aM.ie&&aM.ie_version<15||aM.ios&&aM.webkit_version<604;function uA(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function fA(t,e){e=uA(t.state,aC,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=kA&&n.selection.ranges.every((t=>t.empty))&&kA==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function pA(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=DM.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}cA.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},hA.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),cA.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},cA.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},hA.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(nC))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=OA(t,e),n=SA(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=OA(t,e),h=pA(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=pA(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new aA(t,e,i,n)),n&&t.observer.ignore((()=>{_k(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let gA=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function mA(t,e,i,n){let s=DM.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&gA(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&gA(i,n,l)?1:r&&r.bottom>=n?-1:1}function OA(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:mA(t,i,e.clientX,e.clientY)}}const vA=aM.ie&&aM.ie_version<=11;let wA=null,bA=0,yA=0;function SA(t){if(!vA)return t.detail;let e=wA,i=yA;return wA=t,yA=Date.now(),bA=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(bA+1)%3:1}function xA(t,e,i,n){if(!(i=uA(t.state,aC,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(iC);return i.length?i[0](e):aM.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}hA.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",uA(t.state,hC,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},hA.dragend=t=>(t.inputState.draggedContent=null,!1),hA.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&xA(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return xA(t,e,i,!0),!0}return!1},hA.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=dA?null:e.clipboardData;return i?(fA(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),fA(t,i.value)}),50)}(t),!1)};let kA=null;hA.copy=hA.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:uA(t,hC,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;kA=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=dA?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const MA=ui.define();function CA(t,e){let i=[];for(let n of t.facet(lC)){let s=n(t,e);s&&i.push(s)}return i.length?t.update({effects:i,annotations:MA.of(!0)}):null}function AA(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=CA(t.state,e);i?t.dispatch(i):t.update([])}}),10)}cA.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),AA(t)},cA.blur=t=>{t.observer.clearSelectionRange(),AA(t)},cA.compositionstart=cA.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},cA.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,aM.chrome&&aM.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},cA.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},hA.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return eA(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if(aM.chrome&&aM.android&&(s=sA.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return aM.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),aM.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>cA.compositionend(t,e)),20),!1};const TA=new Set,PA=["pre-wrap","normal","pre-line","break-spaces"];let DA=!1;function EA(){DA=!1}class RA{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return PA.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=PA.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class QA{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class BA{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?xM.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof AM?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new BA(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var LA=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(LA||(LA={}));const $A=.001;class _A{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>$A&&(DA=!0),this.height=t)}replace(t,e,i){return _A.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,LA.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,LA.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,LA.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=zA.build(i.setDoc(o),t,h,c);s=VA(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new WA(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new qA(_A.of(t.slice(0,e)),o,_A.of(t.slice(i)))}}function VA(t,e){return t==e?t:(t.constructor!=e.constructor&&(DA=!0),e)}_A.prototype.size=1;class NA extends _A{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new BA(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class WA extends NA{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new BA(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof WA||n instanceof HA&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof HA?n=new WA(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):_A.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HA extends _A{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new BA(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new BA(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==LA.ByHeight)return this.blockAt(t,i,n,s);if(e==LA.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new BA(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new BA(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new BA(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof HA?i[i.length-1]=new HA(t.length+n):i.push(null,new HA(n-1))}if(t>0){let e=i[0];e instanceof HA?i[0]=new HA(t+e.length):i.unshift(new HA(t-1),null)}return _A.of(i)}decomposeLeft(t,e){e.push(new HA(t-1),null)}decomposeRight(t,e){e.push(null,new HA(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new HA(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=$A&&(r=-2);let l=new WA(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new HA(s-o).updateHeight(t,o));let l=_A.of(i);return(r<0||Math.abs(l.height-this.height)>=$A||Math.abs(r-this.heightMetrics(t,e).perLine)>=$A)&&(DA=!0),VA(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class qA extends _A{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==LA.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==LA.ByPosNoHeight?LA.ByPosNoHeight:LA.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,LA.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&FA(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),FA(s,t)}return _A.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?_A.of(this.break?[t,null,e]:[t,e]):(this.left=VA(this.left,t),this.right=VA(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function FA(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof HA&&(n=t[e+1])instanceof HA&&t.splice(e-1,3,new HA(i.length+1+n.length))}class zA{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof WA?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new WA(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new NA(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new WA(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new HA(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof WA)return t;let e=new WA(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof WA||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new WA(0,-1));let i=t;for(let t of this.nodes)t instanceof WA&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new zA(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class IA{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&PM(t,e,this.changes,5)}}function ZA(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function XA(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class jA{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return kM.replace({widget:new YA(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class YA extends SM{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class UA{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=tT,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=$M.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(xC).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new RA(e),this.stateDeco=t.facet(kC).filter((t=>"function"!=typeof t)),this.heightMap=_A.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new RC(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=kM.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new KA(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?tT:new eT(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(iT(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(kC).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=RC.extendWithRanges(n,function(t,e,i){let n=new IA;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);EA(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||DA)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(dC)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?$M.RTL:$M.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=Qk(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=Hk(t.scrollDOM);let f=(this.printing?XA:ZA)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),EA();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?_A.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new RC(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new QA(i.from,s))}DA&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new KA(n.lineAt(o-1e3*i,LA.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),LA.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,LA.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new KA(n.lineAt(i-500,LA.ByHeight,s,0,0).from,n.lineAt(i+o+500,LA.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new KA(this.heightMap.lineAt(i,LA.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,LA.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,LA.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,LA.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new jA(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=$M.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new jA(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=xM.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=JA(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=GA(s,t),a=GA(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=JA(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=GA(s,c),a=GA(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=JA(n,i)-JA(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){jA.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=kM.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||iT(this.heightMap.lineAt(t,LA.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||iT(this.heightMap.lineAt(this.scaler.fromDOM(t),LA.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return iT(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class KA{constructor(t,e){this.from=t,this.to=e}}function GA({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function JA(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const tT={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class eT{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,LA.ByPos,t,0,0).top,r=e.lineAt(s,LA.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof eT&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function iT(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new BA(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>iT(t,e))):t._content)}const nT=Fe.define({combine:t=>t.join(" ")}),sT=Fe.define({combine:t=>t.indexOf(!0)>-1}),oT=Yi.newName(),rT=Yi.newName(),lT=Yi.newName(),aT={"&light":"."+rT,"&dark":"."+lT};function hT(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const cT=hT("."+oT,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},aT),dT={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},uT=aM.ie&&aM.ie_version<=11;class fT{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new Bk,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(aM.ie&&aM.ie_version<=11||aM.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||aM.chrome&&aM.chrome_version<126||(this.editContext=new mT(t),t.state.facet(OC)&&(t.contentDOM.editContext=this.editContext.editContext)),uT&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(OC)?i.root.activeElement!=this.dom:!kk(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(aM.ie&&aM.ie_version<=11||aM.android&&aM.chrome)&&!i.state.selection.main.empty&&n.focusNode&&Ck(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=Sk(t.root);if(!e)return!1;let i=aM.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return gT(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?gT(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=kk(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,Dk(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=Dk(i))}else{if(i==t)return!0;n=Ak(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,dT),uT&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),uT&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&Nk(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&kk(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new JC(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=tA(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=pT(e,t.previousSibling||t.target.previousSibling,-1),n=pT(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(OC)!=t.state.facet(OC)&&(t.view.contentDOM.editContext=t.state.facet(OC)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function pT(t,e,i){for(;e;){let n=Zk.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function gT(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return Ck(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class mT{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if((aM.mac||aM.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);eA(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(kM.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:gC.of(kM.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=Sk(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class OT{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new UA(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(pC)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(wC).map((t=>new yC(t)));for(let t of this.plugins)t.update(this);this.observer=new fT(this),this.inputState=new iA(this),this.inputState.ensureHandlers(this.plugins),this.docView=new BC(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(MA)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=CA(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=QC.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new fC(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(pC)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=bT.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(EC)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(nT)!=e.state.facet(nT)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(oC))try{t(e)}catch(t){mC(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!tA(this,h)&&a.force&&Nk(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new UA(t),this.plugins=t.facet(wC).map((t=>new yC(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new BC(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(wC),i=t.state.facet(wC);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new yC(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){mC(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(Hk(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return mC(this.state,t),wT}})),h=QC.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=wT)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){mC(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(oC))t(e)}get themeClasses(){return oT+" "+(this.state.facet(sT)?lT:rT)+" "+this.state.facet(nT)}updateAttrs(){let t=yT(this,SC,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(OC)?"true":"false",class:"cm-content",style:`${aM.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),yT(this,xC,e);let i=this.observer.ignore((()=>{let i=bM(this.contentDOM,this.contentAttrs,e),n=bM(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(OT.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(EC);let t=this.state.facet(OT.cspNonce);Yi.mount(this.root,this.styleModules.concat(cT).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return jC(this,t,ZC(this,t,e,i))}moveByGroup(t,e){return jC(this,t,ZC(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=function(t,e,i){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let t;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;t&&(s.type!=xM.Text||t.type==s.type&&!(i<0?s.from<e:s.to>e))||(t=s)}}return t||n}return n}(t,e.head,e.assoc||-1),o=n&&s.type==xM.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==$M.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return jC(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=zC(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),zC(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return Ek(i,s[ZM.find(s,t-n.from,-1,e)].dir==$M.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(cC)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>vT)return KM(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||XM(n.isolates,e=TC(this,t))))return n.order;e||(e=TC(this,t));let n=function(t,e,i){if(!t)return[new ZM(0,0,e==VM?1:0)];if(e==_M&&!i.length&&!IM.test(t))return KM(t.length);if(i.length)for(;t.length>jM.length;)jM[jM.length]=256;let n=[],s=e==_M?0:1;return UM(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new bT(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||aM.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{_k(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return pC.of(new fC("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return pC.of(new fC(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return bC.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return bC.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[nT.of(i),EC.of(hT(`.${i}`,t))];return e&&e.dark&&n.push(sT.of(!0)),n}static baseTheme(t){return Ge.lowest(EC.of(hT("."+oT,t,aT)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&Zk.get(i)||Zk.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}OT.styleModule=EC,OT.inputHandler=rC,OT.clipboardInputFilter=aC,OT.clipboardOutputFilter=hC,OT.scrollHandler=uC,OT.focusChangeEffect=lC,OT.perLineTextDirection=cC,OT.exceptionSink=sC,OT.updateListener=oC,OT.editable=OC,OT.mouseSelectionStyle=nC,OT.dragMovesSelection=iC,OT.clickAddsSelectionRange=eC,OT.decorations=kC,OT.outerDecorations=MC,OT.atomicRanges=CC,OT.bidiIsolatedRanges=AC,OT.scrollMargins=PC,OT.darkTheme=sT,OT.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),OT.contentAttributes=xC,OT.editorAttributes=SC,OT.lineWrapping=OT.contentAttributes.of({class:"cm-lineWrapping"}),OT.announce=gi.define();const vT=4096,wT={};class bT{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:$M.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new bT(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function yT(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&OM(o,i)}return i}class ST extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}function xT(t,e){return({state:i,dispatch:n})=>{if(i.readOnly)return!1;let s=t(e,i);return!!s&&(n(i.update(s)),!0)}}ST.prototype.elementClass="",ST.prototype.toDOM=void 0,ST.prototype.mapMode=De.TrackBefore,ST.prototype.startSide=ST.prototype.endSide=-1,ST.prototype.point=!0;const kT=xT(DT,0),MT=xT(PT,0),CT=xT(((t,e)=>PT(t,e,function(t){let e=[];for(let i of t.selection.ranges){let n=t.doc.lineAt(i.from),s=i.to<=n.to?n:t.doc.lineAt(i.to);s.from>n.from&&s.from==i.to&&(s=i.to==n.to+1?n:t.doc.lineAt(i.to-1));let o=e.length-1;o>=0&&e[o].to>n.from?e[o].to=s.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:s.to})}return e}(e))),0);function AT(t,e){let i=t.languageDataAt("commentTokens",e,1);return i.length?i[0]:{}}const TT=50;function PT(t,e,i=e.selection.ranges){let n=i.map((t=>AT(e,t.from).block));if(!n.every((t=>t)))return null;let s=i.map(((t,i)=>function(t,{open:e,close:i},n,s){let o,r,l=t.sliceDoc(n-TT,n),a=t.sliceDoc(s,s+TT),h=/\s*$/.exec(l)[0].length,c=/^\s*/.exec(a)[0].length,d=l.length-h;if(l.slice(d-e.length,d)==e&&a.slice(c,c+i.length)==i)return{open:{pos:n-h,margin:h&&1},close:{pos:s+c,margin:c&&1}};s-n<=2*TT?o=r=t.sliceDoc(n,s):(o=t.sliceDoc(n,n+TT),r=t.sliceDoc(s-TT,s));let u=/^\s*/.exec(o)[0].length,f=/\s*$/.exec(r)[0].length,p=r.length-f-i.length;return o.slice(u,u+e.length)==e&&r.slice(p,p+i.length)==i?{open:{pos:n+u+e.length,margin:/\s/.test(o.charAt(u+e.length))?1:0},close:{pos:s-f-i.length,margin:/\s/.test(r.charAt(p-1))?1:0}}:null}(e,n[i],t.from,t.to)));if(2!=t&&!s.every((t=>t)))return{changes:e.changes(i.map(((t,e)=>s[e]?[]:[{from:t.from,insert:n[e].open+" "},{from:t.to,insert:" "+n[e].close}])))};if(1!=t&&s.some((t=>t))){let t=[];for(let e,i=0;i<s.length;i++)if(e=s[i]){let s=n[i],{open:o,close:r}=e;t.push({from:o.pos-s.open.length,to:o.pos+o.margin},{from:r.pos-r.margin,to:r.pos+s.close.length})}return{changes:t}}return null}function DT(t,e,i=e.selection.ranges){let n=[],s=-1;for(let{from:t,to:o}of i){let i=n.length,r=1e9,l=AT(e,t).line;if(l){for(let i=t;i<=o;){let a=e.doc.lineAt(i);if(a.from>s&&(t==o||o>a.from)){s=a.from;let t=/^\s*/.exec(a.text)[0].length,e=t==a.length,i=a.text.slice(t,t+l.length)==l?t:-1;t<a.text.length&&t<r&&(r=t),n.push({line:a,comment:i,token:l,indent:t,empty:e,single:!1})}i=a.to+1}if(r<1e9)for(let t=i;t<n.length;t++)n[t].indent<n[t].line.text.length&&(n[t].indent=r);n.length==i+1&&(n[i].single=!0)}}if(2!=t&&n.some((t=>t.comment<0&&(!t.empty||t.single)))){let t=[];for(let{line:e,token:i,indent:s,empty:o,single:r}of n)!r&&o||t.push({from:e.from+s,insert:i+" "});let i=e.changes(t);return{changes:i,selection:e.selection.map(i,1)}}if(1!=t&&n.some((t=>t.comment>=0))){let t=[];for(let{line:e,comment:i,token:s}of n)if(i>=0){let n=e.from+i,o=n+s.length;" "==e.text[o-e.from]&&o++,t.push({from:n,to:o})}return{changes:t}}return null}const ET=ui.define(),RT=ui.define(),QT=Fe.define(),BT=Fe.define({combine(t){return Ai(t,{minDepth:100,newGroupDelay:500,joinToEvent:(t,e)=>e},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,e)=>(i,n)=>t(i,n)||e(i,n)})}}),LT=Ue.define({create(){return KT.empty},update(t,e){let i=e.state.facet(BT),n=e.annotation(ET);if(n){let s=HT.fromTransaction(e,n.selection),o=n.side,r=0==o?t.undone:t.done;return r=s?qT(r,r.length,i.minDepth,s):ZT(r,e.startState.selection),new KT(0==o?n.rest:r,0==o?r:n.rest)}let s=e.annotation(RT);if("full"!=s&&"before"!=s||(t=t.isolate()),!1===e.annotation(mi.addToHistory))return e.changes.empty?t:t.addMapping(e.changes.desc);let o=HT.fromTransaction(e),r=e.annotation(mi.time),l=e.annotation(mi.userEvent);return o?t=t.addChanges(o,r,l,i,e):e.selection&&(t=t.addSelection(e.startState.selection,r,l,i.newGroupDelay)),"full"!=s&&"after"!=s||(t=t.isolate()),t},toJSON(t){return{done:t.done.map((t=>t.toJSON())),undone:t.undone.map((t=>t.toJSON()))}},fromJSON(t){return new KT(t.done.map(HT.fromJSON),t.undone.map(HT.fromJSON))}});function $T(t,e){return function({state:i,dispatch:n}){if(!e&&i.readOnly)return!1;let s=i.field(LT,!1);if(!s)return!1;let o=s.pop(t,i,e);return!!o&&(n(o),!0)}}const _T=$T(0,!1),VT=$T(1,!1),NT=$T(0,!0),WT=$T(1,!0);class HT{constructor(t,e,i,n,s){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=s}setSelAfter(t){return new HT(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:null===(t=this.changes)||void 0===t?void 0:t.toJSON(),mapped:null===(e=this.mapped)||void 0===e?void 0:e.toJSON(),startSelection:null===(i=this.startSelection)||void 0===i?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map((t=>t.toJSON()))}}static fromJSON(t){return new HT(t.changes&&Re.fromJSON(t.changes),[],t.mapped&&Ee.fromJSON(t.mapped),t.startSelection&&We.fromJSON(t.startSelection),t.selectionsAfter.map(We.fromJSON))}static fromTransaction(t,e){let i=zT;for(let e of t.startState.facet(QT)){let n=e(t);n.length&&(i=i.concat(n))}return!i.length&&t.changes.empty?null:new HT(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,zT)}static selection(t){return new HT(void 0,zT,void 0,void 0,t)}}function qT(t,e,i,n){let s=e+1>i+20?e-i-1:0,o=t.slice(s,e);return o.push(n),o}function FT(t,e){return t.length?e.length?t.concat(e):t:e}const zT=[],IT=200;function ZT(t,e){if(t.length){let i=t[t.length-1],n=i.selectionsAfter.slice(Math.max(0,i.selectionsAfter.length-IT));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),qT(t,t.length-1,1e9,i.setSelAfter(n)))}return[HT.selection([e])]}function XT(t){let e=t[t.length-1],i=t.slice();return i[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),i}function jT(t,e){if(!t.length)return t;let i=t.length,n=zT;for(;i;){let s=YT(t[i-1],e,n);if(s.changes&&!s.changes.empty||s.effects.length){let e=t.slice(0,i);return e[i-1]=s,e}e=s.mapped,i--,n=s.selectionsAfter}return n.length?[HT.selection(n)]:zT}function YT(t,e,i){let n=FT(t.selectionsAfter.length?t.selectionsAfter.map((t=>t.map(e))):zT,i);if(!t.changes)return HT.selection(n);let s=t.changes.map(e),o=e.mapDesc(t.changes,!0),r=t.mapped?t.mapped.composeDesc(o):o;return new HT(s,gi.mapEffects(t.effects,e),r,t.startSelection.map(o),n)}const UT=/^(input\.type|delete)($|\.)/;class KT{constructor(t,e,i=0,n=void 0){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new KT(this.done,this.undone):this}addChanges(t,e,i,n,s){let o=this.done,r=o[o.length-1];return o=r&&r.changes&&!r.changes.empty&&t.changes&&(!i||UT.test(i))&&(!r.selectionsAfter.length&&e-this.prevTime<n.newGroupDelay&&n.joinToEvent(s,function(t,e){let i=[],n=!1;return t.iterChangedRanges(((t,e)=>i.push(t,e))),e.iterChangedRanges(((t,e,s,o)=>{for(let t=0;t<i.length;){let e=i[t++],r=i[t++];o>=e&&s<=r&&(n=!0)}})),n}(r.changes,t.changes))||"input.type.compose"==i)?qT(o,o.length-1,n.minDepth,new HT(t.changes.compose(r.changes),FT(gi.mapEffects(t.effects,r.changes),r.effects),r.mapped,r.startSelection,zT)):qT(o,o.length,n.minDepth,t),new KT(o,zT,e,i)}addSelection(t,e,i,n){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:zT;return s.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&(o=s[s.length-1],r=t,o.ranges.length==r.ranges.length&&0===o.ranges.filter(((t,e)=>t.empty!=r.ranges[e].empty)).length)?this:new KT(ZT(this.done,t),this.undone,e,i);var o,r}addMapping(t){return new KT(jT(this.done,t),jT(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=0==t?this.done:this.undone;if(0==n.length)return null;let s=n[n.length-1],o=s.selectionsAfter[0]||e.selection;if(i&&s.selectionsAfter.length)return e.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:ET.of({side:t,rest:XT(n),selection:o}),userEvent:0==t?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let i=1==n.length?zT:n.slice(0,n.length-1);return s.mapped&&(i=jT(i,s.mapped)),e.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:ET.of({side:t,rest:i,selection:o}),filter:!1,userEvent:0==t?"undo":"redo",scrollIntoView:!0})}return null}}KT.empty=new KT(zT,zT);const GT=[{key:"Mod-z",run:_T,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:VT,preventDefault:!0},{linux:"Ctrl-Shift-z",run:VT,preventDefault:!0},{key:"Mod-u",run:NT,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:WT,preventDefault:!0}];function JT(t,e){return We.create(t.ranges.map(e),t.mainIndex)}function tP(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function eP({state:t,dispatch:e},i){let n=JT(t.selection,i);return!n.eq(t.selection,!0)&&(e(tP(t,n)),!0)}function iP(t,e){return We.cursor(e?t.to:t.from)}function nP(t,e){return eP(t,(i=>i.empty?t.moveByChar(i,e):iP(i,e)))}function sP(t){return t.textDirectionAt(t.state.selection.main.head)==$M.LTR}const oP=t=>nP(t,!sP(t)),rP=t=>nP(t,sP(t));function lP(t,e){return eP(t,(i=>i.empty?t.moveByGroup(i,e):iP(i,e)))}function aP(t,e,i){if(e.type.prop(i))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function hP(t,e,i){let n,s,o=Pl(t).resolveInner(e.head),r=i?O.closedBy:O.openedBy;for(let n=e.head;;){let e=i?o.childAfter(n):o.childBefore(n);if(!e)break;aP(t,e,r)?o=e:n=i?e.to:e.from}return s=o.type.prop(r)&&(n=i?Fa(t,o.from,1):Fa(t,o.to,-1))&&n.matched?i?n.end.to:n.end.from:i?o.to:o.from,We.cursor(s,i?-1:1)}function cP(t,e){return eP(t,(i=>{if(!i.empty)return iP(i,e);let n=t.moveVertically(i,e);return n.head!=i.head?n:t.moveToLineBoundary(i,e)}))}"undefined"!=typeof Intl&&Intl.Segmenter;const dP=t=>cP(t,!1),uP=t=>cP(t,!0);function fP(t){let e,i=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,s=0;if(i){for(let e of t.state.facet(OT.scrollMargins)){let i=e(t);(null==i?void 0:i.top)&&(n=Math.max(null==i?void 0:i.top,n)),(null==i?void 0:i.bottom)&&(s=Math.max(null==i?void 0:i.bottom,s))}e=t.scrollDOM.clientHeight-n-s}else e=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:s,selfScroll:i,height:Math.max(t.defaultLineHeight,e-5)}}function pP(t,e){let i,n=fP(t),{state:s}=t,o=JT(s.selection,(i=>i.empty?t.moveVertically(i,e,n.height):iP(i,e)));if(o.eq(s.selection))return!1;if(n.selfScroll){let e=t.coordsAtPos(s.selection.main.head),r=t.scrollDOM.getBoundingClientRect(),l=r.top+n.marginTop,a=r.bottom-n.marginBottom;e&&e.top>l&&e.bottom<a&&(i=OT.scrollIntoView(o.main.head,{y:"start",yMargin:e.top-l}))}return t.dispatch(tP(s,o),{effects:i}),!0}const gP=t=>pP(t,!1),mP=t=>pP(t,!0);function OP(t,e,i){let n=t.lineBlockAt(e.head),s=t.moveToLineBoundary(e,i);if(s.head==e.head&&s.head!=(i?n.to:n.from)&&(s=t.moveToLineBoundary(e,i,!1)),!i&&s.head==n.from&&n.length){let i=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;i&&e.head!=n.from+i&&(s=We.cursor(n.from+i))}return s}function vP(t,e){let i=JT(t.state.selection,(t=>{let i=e(t);return We.range(t.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)}));return!i.eq(t.state.selection)&&(t.dispatch(tP(t.state,i)),!0)}function wP(t,e){return vP(t,(i=>t.moveByChar(i,e)))}const bP=t=>wP(t,!sP(t)),yP=t=>wP(t,sP(t));function SP(t,e){return vP(t,(i=>t.moveByGroup(i,e)))}function xP(t,e){return vP(t,(i=>t.moveVertically(i,e)))}const kP=t=>xP(t,!1),MP=t=>xP(t,!0);function CP(t,e){return vP(t,(i=>t.moveVertically(i,e,fP(t).height)))}const AP=t=>CP(t,!1),TP=t=>CP(t,!0),PP=({state:t,dispatch:e})=>(e(tP(t,{anchor:0})),!0),DP=({state:t,dispatch:e})=>(e(tP(t,{anchor:t.doc.length})),!0),EP=({state:t,dispatch:e})=>(e(tP(t,{anchor:t.selection.main.anchor,head:0})),!0),RP=({state:t,dispatch:e})=>(e(tP(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0);function QP(t,e){if(t.state.readOnly)return!1;let i="delete.selection",{state:n}=t,s=n.changeByRange((n=>{let{from:s,to:o}=n;if(s==o){let r=e(n);r<s?(i="delete.backward",r=BP(t,r,!1)):r>s&&(i="delete.forward",r=BP(t,r,!0)),s=Math.min(s,r),o=Math.max(o,r)}else s=BP(t,s,!1),o=BP(t,o,!0);return s==o?{range:n}:{changes:{from:s,to:o},range:We.cursor(s,s<n.head?-1:1)}}));return!s.changes.empty&&(t.dispatch(n.update(s,{scrollIntoView:!0,userEvent:i,effects:"delete.selection"==i?OT.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function BP(t,e,i){if(t instanceof OT)for(let n of t.state.facet(OT.atomicRanges).map((e=>e(t))))n.between(e,e,((t,n)=>{t<e&&n>e&&(e=i?n:t)}));return e}const LP=(t,e,i)=>QP(t,(n=>{let s,o,r=n.from,{state:l}=t,a=l.doc.lineAt(r);if(i&&!e&&r>a.from&&r<a.from+200&&!/[^ \t]/.test(s=a.text.slice(0,r-a.from))){if("\t"==s[s.length-1])return r-1;let t=zi(s,l.tabSize)%ql(l)||ql(l);for(let e=0;e<t&&" "==s[s.length-1-e];e++)r--;o=r}else o=Me(a.text,r-a.from,e,e)+a.from,o==r&&a.number!=(e?l.doc.lines:1)?o+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(a.text.slice(o-a.from,r-a.from))&&(o=Me(a.text,o-a.from,!1,!1)+a.from);return o})),$P=t=>LP(t,!1,!0),_P=t=>LP(t,!0,!1),VP=(t,e)=>QP(t,(i=>{let n=i.head,{state:s}=t,o=s.doc.lineAt(n),r=s.charCategorizer(n);for(let t=null;;){if(n==(e?o.to:o.from)){n==i.head&&o.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let l=Me(o.text,n-o.from,e)+o.from,a=o.text.slice(Math.min(n,l)-o.from,Math.max(n,l)-o.from),h=r(a);if(null!=t&&h!=t)break;" "==a&&n==i.head||(t=h),n=l}return n})),NP=t=>VP(t,!1);function WP(t){let e=[],i=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.from),o=t.doc.lineAt(n.to);if(n.empty||n.to!=o.from||(o=t.doc.lineAt(n.to-1)),i>=s.number){let t=e[e.length-1];t.to=o.to,t.ranges.push(n)}else e.push({from:s.from,to:o.to,ranges:[n]});i=o.number+1}return e}function HP(t,e,i){if(t.readOnly)return!1;let n=[],s=[];for(let e of WP(t)){if(i?e.to==t.doc.length:0==e.from)continue;let o=t.doc.lineAt(i?e.to+1:e.from-1),r=o.length+1;if(i){n.push({from:e.to,to:o.to},{from:e.from,insert:o.text+t.lineBreak});for(let i of e.ranges)s.push(We.range(Math.min(t.doc.length,i.anchor+r),Math.min(t.doc.length,i.head+r)))}else{n.push({from:o.from,to:e.from},{from:e.to,insert:t.lineBreak+o.text});for(let t of e.ranges)s.push(We.range(t.anchor-r,t.head-r))}}return!!n.length&&(e(t.update({changes:n,scrollIntoView:!0,selection:We.create(s,t.selection.mainIndex),userEvent:"move.line"})),!0)}function qP(t,e,i){if(t.readOnly)return!1;let n=[];for(let e of WP(t))i?n.push({from:e.from,insert:t.doc.slice(e.from,e.to)+t.lineBreak}):n.push({from:e.to,insert:t.lineBreak+t.doc.slice(e.from,e.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const FP=zP(!1);function zP(t){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let n=e.changeByRange((i=>{let{from:n,to:s}=i,o=e.doc.lineAt(n),r=!t&&n==s&&function(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let i,n=Pl(t).resolveInner(e),s=n.childBefore(e),o=n.childAfter(e);return s&&o&&s.to<=e&&o.from>=e&&(i=s.type.prop(O.closedBy))&&i.indexOf(o.name)>-1&&t.doc.lineAt(s.to).from==t.doc.lineAt(o.from).from&&!/\S/.test(t.sliceDoc(s.to,o.from))?{from:s.to,to:o.from}:null}(e,n);t&&(n=s=(s<=o.to?o:e.doc.lineAt(s)).to);let l=new Il(e,{simulateBreak:n,simulateDoubleBreak:!!r}),a=zl(l,n);for(null==a&&(a=zi(/^\s*/.exec(e.doc.lineAt(n).text)[0],e.tabSize));s<o.to&&/\s/.test(o.text[s-o.from]);)s++;r?({from:n,to:s}=r):n>o.from&&n<o.from+100&&!/\S/.test(o.text.slice(0,n))&&(n=o.from);let h=["",Fl(e,a)];return r&&h.push(Fl(e,l.lineIndent(o.from,-1))),{changes:{from:n,to:s,insert:ge.of(h)},range:We.cursor(n+1+h[1].length)}}));return i(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function IP(t,e){let i=-1;return t.changeByRange((n=>{let s=[];for(let o=n.from;o<=n.to;){let r=t.doc.lineAt(o);r.number>i&&(n.empty||n.to>r.from)&&(e(r,s,n),i=r.number),o=r.to+1}let o=t.changes(s);return{changes:s,range:We.range(o.mapPos(n.anchor,1),o.mapPos(n.head,1))}}))}const ZP=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(IP(t,((e,i)=>{i.push({from:e.from,insert:t.facet(Hl)})})),{userEvent:"input.indent"})),!0),XP=({state:t,dispatch:e})=>!t.readOnly&&(e(t.update(IP(t,((e,i)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let s=zi(n,t.tabSize),o=0,r=Fl(t,Math.max(0,s-ql(t)));for(;o<n.length&&o<r.length&&n.charCodeAt(o)==r.charCodeAt(o);)o++;i.push({from:e.from+o,to:e.from+n.length,insert:r.slice(o)})})),{userEvent:"delete.dedent"})),!0),jP=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:t=>eP(t,(e=>hP(t.state,e,!sP(t)))),shift:t=>vP(t,(e=>hP(t.state,e,!sP(t))))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t=>eP(t,(e=>hP(t.state,e,sP(t)))),shift:t=>vP(t,(e=>hP(t.state,e,sP(t))))},{key:"Alt-ArrowUp",run:({state:t,dispatch:e})=>HP(t,e,!1)},{key:"Shift-Alt-ArrowUp",run:({state:t,dispatch:e})=>qP(t,e,!1)},{key:"Alt-ArrowDown",run:({state:t,dispatch:e})=>HP(t,e,!0)},{key:"Shift-Alt-ArrowDown",run:({state:t,dispatch:e})=>qP(t,e,!0)},{key:"Escape",run:({state:t,dispatch:e})=>{let i=t.selection,n=null;return i.ranges.length>1?n=We.create([i.main]):i.main.empty||(n=We.create([We.cursor(i.main.head)])),!!n&&(e(tP(t,n)),!0)}},{key:"Mod-Enter",run:zP(!0)},{key:"Alt-l",mac:"Ctrl-l",run:({state:t,dispatch:e})=>{let i=WP(t).map((({from:e,to:i})=>We.range(e,Math.min(i+1,t.doc.length))));return e(t.update({selection:We.create(i),userEvent:"select"})),!0}},{key:"Mod-i",run:({state:t,dispatch:e})=>{let i=JT(t.selection,(e=>{let i=Pl(t),n=i.resolveStack(e.from,1);if(e.empty){let t=i.resolveStack(e.from,-1);t.node.from>=n.node.from&&t.node.to<=n.node.to&&(n=t)}for(let t=n;t;t=t.next){let{node:i}=t;if((i.from<e.from&&i.to>=e.to||i.to>e.to&&i.from<=e.from)&&t.next)return We.range(i.to,i.from)}return e}));return!i.eq(t.selection)&&(e(tP(t,i)),!0)},preventDefault:!0},{key:"Mod-[",run:XP},{key:"Mod-]",run:ZP},{key:"Mod-Alt-\\",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=Object.create(null),n=new Il(t,{overrideIndentation:t=>{let e=i[t];return null==e?-1:e}}),s=IP(t,((e,s,o)=>{let r=zl(n,e.from);if(null==r)return;/\S/.test(e.text)||(r=0);let l=/^\s*/.exec(e.text)[0],a=Fl(t,r);(l!=a||o.from<e.from+l.length)&&(i[e.from]=r,s.push({from:e.from,to:e.from+l.length,insert:a}))}));return s.changes.empty||e(t.update(s,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:t=>{if(t.state.readOnly)return!1;let{state:e}=t,i=e.changes(WP(e).map((({from:t,to:i})=>(t>0?t--:i<e.doc.length&&i++,{from:t,to:i})))),n=JT(e.selection,(e=>{let i;if(t.lineWrapping){let n=t.lineBlockAt(e.head),s=t.coordsAtPos(e.head,e.assoc||1);s&&(i=n.bottom+t.documentTop-s.bottom+t.defaultLineHeight/2)}return t.moveVertically(e,!0,i)})).map(i);return t.dispatch({changes:i,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:({state:t,dispatch:e})=>function(t,e,i){let n=!1,s=JT(t.selection,(e=>{let s=Fa(t,e.head,-1)||Fa(t,e.head,1)||e.head>0&&Fa(t,e.head-1,1)||e.head<t.doc.length&&Fa(t,e.head+1,-1);if(!s||!s.end)return e;n=!0;let o=s.start.from==e.head?s.end.to:s.end.from;return i?We.range(e.anchor,o):We.cursor(o)}));return!!n&&(e(tP(t,s)),!0)}(t,e,!1)},{key:"Mod-/",run:t=>{let{state:e}=t,i=e.doc.lineAt(e.selection.main.from),n=AT(t.state,i.from);return n.line?kT(t):!!n.block&&CT(t)}},{key:"Alt-A",run:MT},{key:"Ctrl-m",mac:"Shift-Alt-m",run:t=>(t.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:oP,shift:bP,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:t=>lP(t,!sP(t)),shift:t=>SP(t,!sP(t)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:t=>eP(t,(e=>OP(t,e,!sP(t)))),shift:t=>vP(t,(e=>OP(t,e,!sP(t)))),preventDefault:!0},{key:"ArrowRight",run:rP,shift:yP,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:t=>lP(t,sP(t)),shift:t=>SP(t,sP(t)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:t=>eP(t,(e=>OP(t,e,sP(t)))),shift:t=>vP(t,(e=>OP(t,e,sP(t)))),preventDefault:!0},{key:"ArrowUp",run:dP,shift:kP,preventDefault:!0},{mac:"Cmd-ArrowUp",run:PP,shift:EP},{mac:"Ctrl-ArrowUp",run:gP,shift:AP},{key:"ArrowDown",run:uP,shift:MP,preventDefault:!0},{mac:"Cmd-ArrowDown",run:DP,shift:RP},{mac:"Ctrl-ArrowDown",run:mP,shift:TP},{key:"PageUp",run:gP,shift:AP},{key:"PageDown",run:mP,shift:TP},{key:"Home",run:t=>eP(t,(e=>OP(t,e,!1))),shift:t=>vP(t,(e=>OP(t,e,!1))),preventDefault:!0},{key:"Mod-Home",run:PP,shift:EP},{key:"End",run:t=>eP(t,(e=>OP(t,e,!0))),shift:t=>vP(t,(e=>OP(t,e,!0))),preventDefault:!0},{key:"Mod-End",run:DP,shift:RP},{key:"Enter",run:FP,shift:FP},{key:"Mod-a",run:({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0)},{key:"Backspace",run:$P,shift:$P},{key:"Delete",run:_P},{key:"Mod-Backspace",mac:"Alt-Backspace",run:NP},{key:"Mod-Delete",mac:"Alt-Delete",run:t=>VP(t,!0)},{mac:"Mod-Backspace",run:t=>QP(t,(e=>{let i=t.moveToLineBoundary(e,!1).head;return e.head>i?i:Math.max(0,e.head-1)}))},{mac:"Mod-Delete",run:t=>QP(t,(e=>{let i=t.moveToLineBoundary(e,!0).head;return e.head<i?i:Math.min(t.state.doc.length,e.head+1)}))}].concat([{key:"Ctrl-b",run:oP,shift:bP,preventDefault:!0},{key:"Ctrl-f",run:rP,shift:yP},{key:"Ctrl-p",run:dP,shift:kP},{key:"Ctrl-n",run:uP,shift:MP},{key:"Ctrl-a",run:t=>eP(t,(e=>We.cursor(t.lineBlockAt(e.head).from,1))),shift:t=>vP(t,(e=>We.cursor(t.lineBlockAt(e.head).from)))},{key:"Ctrl-e",run:t=>eP(t,(e=>We.cursor(t.lineBlockAt(e.head).to,-1))),shift:t=>vP(t,(e=>We.cursor(t.lineBlockAt(e.head).to)))},{key:"Ctrl-d",run:_P},{key:"Ctrl-h",run:$P},{key:"Ctrl-k",run:t=>QP(t,(e=>{let i=t.lineBlockAt(e.head).to;return e.head<i?i:Math.min(t.state.doc.length,e.head+1)}))},{key:"Ctrl-Alt-h",run:NP},{key:"Ctrl-o",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:ge.of(["",""])},range:We.cursor(t.from)})));return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange((e=>{if(!e.empty||0==e.from||e.from==t.doc.length)return{range:e};let i=e.from,n=t.doc.lineAt(i),s=i==n.from?i-1:Me(n.text,i-n.from,!1)+n.from,o=i==n.to?i+1:Me(n.text,i-n.from,!0)+n.from;return{changes:{from:s,to:o,insert:t.doc.slice(i,o).append(t.doc.slice(s,i))},range:We.cursor(o)}}));return!i.changes.empty&&(e(t.update(i,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:mP}].map((t=>({mac:t.key,run:t.run,shift:t.shift}))))),YP={key:"Tab",run:ZP,shift:XP};function UP(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function KP(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function GP(t,e){if(!e.anchorNode)return!1;try{return KP(t,e.anchorNode)}catch(t){return!1}}function JP(t){return 3==t.nodeType?uD(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function tD(t,e,i,n){return!!i&&(nD(t,e,i,n,-1)||nD(t,e,i,n,1))}function eD(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function iD(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function nD(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:sD(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=eD(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?sD(t):0}}}function sD(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function oD(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function rD(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function lD(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}class aD{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?sD(e):0),i,Math.min(t.focusOffset,i?sD(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let hD,cD=null;function dD(t){if(t.setActive)return t.setActive();if(cD)return t.focus(cD);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==cD?{get preventScroll(){return cD={preventScroll:!0},!0}}:void 0),!cD){cD=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function uD(t,e,i=e){let n=hD||(hD=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function fD(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function pD(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function gD(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function mD(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=sD(i)}else{if(!i.parentNode||iD(i))return null;n=eD(i),i=i.parentNode}}}function OD(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||iD(i))return null;n=eD(i)+1,i=i.parentNode}}}class vD{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new vD(t.parentNode,eD(t),e)}static after(t,e){return new vD(t.parentNode,eD(t)+1,e)}}const wD=[];class bD{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=bD.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=yD(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=yD(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==sD(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!bD.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=wD){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new SD(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function yD(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}bD.prototype.breakAfter=0;class SD{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function xD(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function kD(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,xD(t,h,c,l,a,n,0,s,o)}let MD="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},CD="undefined"!=typeof document?document:{documentElement:{style:{}}};const AD=/Edge\/(\d+)/.exec(MD.userAgent),TD=/MSIE \d/.test(MD.userAgent),PD=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(MD.userAgent),DD=!!(TD||PD||AD),ED=!DD&&/gecko\/(\d+)/i.test(MD.userAgent),RD=!DD&&/Chrome\/(\d+)/.exec(MD.userAgent),QD="webkitFontSmoothing"in CD.documentElement.style,BD=!DD&&/Apple Computer/.test(MD.vendor),LD=BD&&(/Mobile\/\w+/.test(MD.userAgent)||MD.maxTouchPoints>2);var $D={mac:LD||/Mac/.test(MD.platform),windows:/Win/.test(MD.platform),linux:/Linux|X11/.test(MD.platform),ie:DD,ie_version:TD?CD.documentMode||6:PD?+PD[1]:AD?+AD[1]:0,gecko:ED,gecko_version:ED?+(/Firefox\/(\d+)/.exec(MD.userAgent)||[0,0])[1]:0,chrome:!!RD,chrome_version:RD?+RD[1]:0,ios:LD,android:/Android\b/.test(MD.userAgent),webkit:QD,safari:BD,webkit_version:QD?+(/\bAppleWebKit\/(\d+)/.exec(MD.userAgent)||[0,0])[1]:0,tabSize:null!=CD.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class _D extends bD{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof _D)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new _D(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new vD(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?$D.chrome||$D.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=uD(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return $D.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?oD(a,r<0):a||null}(this.dom,t,e)}}class VD extends bD{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(pD(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof VD&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(kD(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new VD(this.mark,e,o)}domAtPos(t){return HD(this,t)}coordsAt(t,e){return FD(this,t,e)}}class ND extends bD{static create(t,e,i){return new ND(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=ND.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof ND&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof ND&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?vD.before(this.dom):vD.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return oD(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class WD extends bD{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof WD&&t.side==this.side}split(){return new WD(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?vD.before(this.dom):vD.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function HD(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new vD(i,0)}function qD(t,e,i){let n,{children:s}=t;i>0&&e instanceof VD&&s.length&&(n=s[s.length-1])instanceof VD&&n.mark.eq(e.mark)?qD(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function FD(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&(i>0||zD(o,c)))&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=JP(e);return i[i.length-1]||null}(t)}function zD(t,e){let i=t.coordsAt(0,1),n=e.coordsAt(0,1);return i&&n&&n.top<i.bottom}function ID(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}_D.prototype.children=ND.prototype.children=WD.prototype.children=wD;const ZD=Object.create(null);function XD(t,e,i){if(t==e)return!0;t||(t=ZD),e||(e=ZD);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function jD(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function YD(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class UD{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var KD=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(KD||(KD={}));class GD extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new JD(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new eE(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=iE(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new eE(t,e,i,n,t.widget||null,!0)}static line(t){return new tE(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}GD.none=Ri.empty;class JD extends GD{constructor(t){let{start:e,end:i}=iE(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof JD&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&XD(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}JD.prototype.point=!1;class tE extends GD{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof tE&&this.spec.class==t.spec.class&&XD(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}tE.prototype.mapMode=De.TrackBefore,tE.prototype.point=!0;class eE extends GD{constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?KD.WidgetRange:this.startSide<=0?KD.WidgetBefore:KD.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof eE&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function iE(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function nE(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}eE.prototype.point=!0;class sE extends bD{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof sE))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),kD(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new sE;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){XD(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){qD(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=ID(e,this.attrs||{})),i&&(this.attrs=ID({class:i},this.attrs||{}))}domAtPos(t){return HD(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(pD(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(jD(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&bD.get(n)instanceof VD;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=bD.get(n))||void 0===i?void 0:i.isEditable)||$D.ios&&this.children.some((t=>t instanceof _D))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof _D)||/[^ -~]/.test(i.text))return null;let n=JP(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=FD(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof sE&&0==this.children.length&&0==t.children.length&&XD(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof sE)return s;if(o>e)break}n=o+s.breakAfter}return null}}class oE extends bD{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof oE&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?vD.before(this.dom):vD.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new oE(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return wD}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof oE&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof rE?null:oD(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class rE extends UD{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class lE{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof oE&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new sE),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(aE(new WD(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof oE||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(aE(new _D(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof eE){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof eE)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new oE(i.widget||hE.block,r,i));else{let o=ND.create(i.widget||hE.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(aE(new WD(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(aE(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new lE(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function aE(t,e){for(let i of e)t=new VD(i,[t],t.length);return t}class hE extends UD{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}hE.inline=new hE("span"),hE.block=new hE("div");var cE=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(cE||(cE={}));const dE=cE.LTR,uE=cE.RTL;function fE(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const pE=fE("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),gE=fE("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),mE=Object.create(null),OE=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);mE[e]=i,mE[i]=-e}function vE(t){return t<=247?pE[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?gE[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const wE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class bE{get dir(){return this.level%2?uE:dE}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function yE(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!yE(n.inner,s.inner))return!1}return!0}const SE=[];function xE(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=SE[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if(SE[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new bE(a,p.from,u)),kE(t,p.direction==dE!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?SE[f]!=l:SE[f]==l))break;f++}d?xE(t,a,f,n+1,s,d,r):a<f&&r.push(new bE(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=SE[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if(SE[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new bE(p.to,a,u)),kE(t,p.direction==dE!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?SE[f-1]!=l:SE[f-1]==l))break;f--}d?xE(t,f,a,n+1,s,d,r):f<a&&r.push(new bE(f,a,u)),a=f}}function kE(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=vE(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),SE[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=SE[t];if(128==s)t<l-1&&e==SE[t+1]&&24&e?s=SE[t]=e:SE[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==SE[s];)s++;let o=t&&8==e||s<i&&8==SE[s]?1==n?1:8:256;for(let e=t;e<s;e++)SE[e]=o;t=s-1}else 8==s&&1==n&&(SE[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=mE[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(OE[t+1]==-i){let e=OE[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&(SE[r]=SE[OE[t]]=i),l=t;break}}else{if(189==OE.length)break;OE[l++]=r,OE[l++]=e,OE[l++]=a}else if(2==(n=SE[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=OE[e+2];if(2&i)break;if(t)OE[e+2]|=2;else{if(4&i)break;OE[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=SE[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=SE[r])break;r++}let h=1==o,c=h==(1==(r<e?SE[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),SE[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),xE(t,s,o,e,i,n,r)}function ME(t){return[new bE(0,t,0)]}let CE="";function AE(t,e,i,n,s){var o;let r=n.head-t.from,l=bE.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),CE=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function TE(t,e,i){for(let n=e;n<i;n++){let e=vE(t.charCodeAt(n));if(1==e)return dE;if(2==e||4==e)return uE}return dE}const PE=Fe.define(),DE=Fe.define(),EE=Fe.define(),RE=Fe.define(),QE=Fe.define(),BE=Fe.define(),LE=Fe.define(),$E=Fe.define(),_E=Fe.define(),VE=Fe.define({combine:t=>t.some((t=>t))}),NE=Fe.define({combine:t=>t.some((t=>t))}),WE=Fe.define();class HE{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new HE(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new HE(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const qE=gi.define({map:(t,e)=>t.map(e)}),FE=gi.define();function zE(t,e,i){let n=t.facet(RE);n.length?n[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const IE=Fe.define({combine:t=>!t.length||t[0]});let ZE=0;const XE=Fe.define();class jE{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new jE(ZE++,t,i,n,(t=>{let e=[XE.of(t)];return o&&e.push(GE.of((e=>{let i=e.plugin(t);return i?o(i):GD.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return jE.define((e=>new t(e)),e)}}class YE{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(zE(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){zE(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){zE(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const UE=Fe.define(),KE=Fe.define(),GE=Fe.define(),JE=Fe.define(),tR=Fe.define(),eR=Fe.define();function iR(t,e){let i=t.state.facet(eR);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=TE(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const nR=Fe.define();function sR(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(nR)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const oR=Fe.define();class rR{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new rR(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new rR(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new rR(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class lR{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new rR(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new lR(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class aR extends bD{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=GD.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new sE],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new rR(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=hR(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new rR(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=bD.get(e);if(i instanceof VD)c.push({node:e,deco:i.mark});else{if(i instanceof sE||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new JD({inclusive:!0,attributes:YD(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new rR(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,($D.ie||$D.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new cR;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=rR.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=$D.chrome||$D.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof oE&&t.widget instanceof rE&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=lE.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=lE.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=lE.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);xD(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(FE)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new _D(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new VD(i,[e],e.length);let i=new sE;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=bD.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(IE)||this.dom.tabIndex>-1)&&GP(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if($D.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new vD(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(tD(l.node,l.offset,c.anchorNode,c.anchorOffset)&&tD(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{$D.android&&$D.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=UP(this.view.root);if(t)if(r.empty){if($D.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?mD:OD)(l.node,l.offset);e&&(l=new vD(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new vD(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new vD(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&tD(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=UP(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=sE.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=bD.get(i.childNodes[n]);t instanceof sE&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=bD.get(i.childNodes[n]);t instanceof sE&&(e=t.domAtPos(t.length))}return e?new vD(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=bD.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof sE)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof sE&&!(i instanceof sE&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof oE&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof sE))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof _D))return null;let s=Me(n.text,i);if(s==i)return null;let o=uD(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==cE.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?JP(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?cE.RTL:cE.LTR}measureTextSize(){for(let t of this.children)if(t instanceof sE){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=JP(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new SD(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(GD.replace({widget:new rE(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return GD.set(t)}updateDeco(){let t=1,e=this.view.state.facet(GE).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(JE).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(WE))try{if(e(this.view,t.range,t))return!0}catch(t){zE(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=sR(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=rD(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=lD(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==cE.LTR)}}function hR(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=mD(i.focusNode,i.focusOffset),s=OD(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=bD.get(s.node);if(!e||e instanceof _D&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=bD.get(n.node);!t||t instanceof _D&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let cR=class{constructor(){this.changes=[]}compareRange(t,e){nE(t,e,this.changes)}comparePoint(t,e){nE(t,e,this.changes)}boundChange(t){nE(t,t,this.changes)}};function dR(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function uR(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function fR(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function pR(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function gR(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function mR(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=JP(u);for(let f=0;f<t.length;f++){let p=t[f];s&&fR(s,p)&&(p=pR(gR(p,s.bottom),s.top));let g=dR(e,p),m=uR(i,p);if(0==g&&0==m)return 3==u.nodeType?OR(u,e,i):mR(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&fR(h,p)?h=gR(h,p.bottom):c&&fR(c,p)&&(c=pR(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?OR(n,u,i):d&&"false"!=n.contentEditable?mR(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function OR(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=uD(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if(($D.chrome||$D.gecko)&&uD(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function vR(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=KD.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:wR(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:wR(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||$D.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return uD(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||$D.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():uD(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(sD(O),v))}if(!O||!t.docView.dom.contains(O)){let e=sE.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=mR(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function wR(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function bR(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=AE(s,o,r,l,i),h=CE;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function yR(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function SR(t,e,i){let n=yR(t.state.facet(tR).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const xR="￿";class kR{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=xR}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=bD.get(n),r=bD.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:iD(n))||iD(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=bD.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(MR(t,i.node,i.offset)?e:0))}}function MR(t,e,i){for(;;){if(!e||i<sD(e))return!1;if(e==t)return!0;i=eD(e)+1,e=e.parentNode}}class CR{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class AR{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new CR(i,n)),s==i&&o==n||e.push(new CR(s,o))),e}(t),i=new kR(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!KP(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!KP(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if(($D.ios||$D.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function TR(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||$D.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,xR),e.text,l-n,a);h&&($D.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==xR+xR&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(xR))})}else n&&(!t.hasFocus&&t.state.facet(IE)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:($D.mac||$D.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:$D.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return PR(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function PR(t,e,i,n=-1){if($D.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if($D.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&fD(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&fD(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&fD(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&hR(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet(BE).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class DR{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,$D.safari&&t.contentDOM.addEventListener("input",(()=>null)),$D.gecko&&function(t){iQ.has(t)||(iQ.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=bD.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(ER(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(ER(e.value,s))}}for(let t in _R)i(t).handlers.push(_R[t]);for(let t in VR)i(t).observers.push(VR[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&BR.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),$D.android&&$D.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!$D.ios||t.synthetic||t.altKey||t.metaKey||!((e=RR.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||QR.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,fD(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!($D.safari&&!$D.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function ER(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){zE(i.state,t)}}}const RR=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],QR="dthko",BR=[16,17,18,20,91,92,224,225];function LR(t){return.7*Math.max(0,t)+8}class $R{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(tR).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(PE);return i.length?i[0](e):$D.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=UP(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=UR(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=sR(this.view);t.clientX-h.left<=o+6?n=-LR(o-t.clientX):t.clientX+h.right>=l-6&&(n=LR(t.clientX-l)),t.clientY-h.top<=r+6?s=-LR(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=LR(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=yR(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=yR(this.atoms,n.from,-1),e=yR(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const _R=Object.create(null),VR=Object.create(null),NR=$D.ie&&$D.ie_version<15||$D.ios&&$D.webkit_version<604;function WR(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function HR(t,e){e=WR(t.state,$E,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=GR&&n.selection.ranges.every((t=>t.empty))&&GR==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function qR(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=sE.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}VR.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},_R.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),VR.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},VR.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},_R.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(EE))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=IR(t,e),n=UR(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=IR(t,e),h=qR(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=qR(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new $R(t,e,i,n)),n&&t.observer.ignore((()=>{dD(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let FR=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function zR(t,e,i,n){let s=sE.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&FR(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&FR(i,n,l)?1:r&&r.bottom>=n?-1:1}function IR(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:zR(t,i,e.clientX,e.clientY)}}const ZR=$D.ie&&$D.ie_version<=11;let XR=null,jR=0,YR=0;function UR(t){if(!ZR)return t.detail;let e=XR,i=YR;return XR=t,YR=Date.now(),jR=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(jR+1)%3:1}function KR(t,e,i,n){if(!(i=WR(t.state,$E,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(DE);return i.length?i[0](e):$D.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}_R.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",WR(t.state,_E,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},_R.dragend=t=>(t.inputState.draggedContent=null,!1),_R.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&KR(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return KR(t,e,i,!0),!0}return!1},_R.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=NR?null:e.clipboardData;return i?(HR(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),HR(t,i.value)}),50)}(t),!1)};let GR=null;_R.copy=_R.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:WR(t,_E,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;GR=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=NR?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const JR=ui.define();function tQ(t,e){let i=[];for(let n of t.facet(LE)){let s=n(t,e);s&&i.push(s)}return i.length?t.update({effects:i,annotations:JR.of(!0)}):null}function eQ(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=tQ(t.state,e);i?t.dispatch(i):t.update([])}}),10)}VR.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),eQ(t)},VR.blur=t=>{t.observer.clearSelectionRange(),eQ(t)},VR.compositionstart=VR.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},VR.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,$D.chrome&&$D.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},VR.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},_R.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return PR(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if($D.chrome&&$D.android&&(s=RR.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return $D.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),$D.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>VR.compositionend(t,e)),20),!1};const iQ=new Set,nQ=["pre-wrap","normal","pre-line","break-spaces"];let sQ=!1;function oQ(){sQ=!1}class rQ{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return nQ.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=nQ.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class lQ{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class aQ{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?KD.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof eE?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new aQ(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var hQ=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(hQ||(hQ={}));const cQ=.001;class dQ{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>cQ&&(sQ=!0),this.height=t)}replace(t,e,i){return dQ.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,hQ.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,hQ.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,hQ.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=vQ.build(i.setDoc(o),t,h,c);s=uQ(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new pQ(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new mQ(dQ.of(t.slice(0,e)),o,dQ.of(t.slice(i)))}}function uQ(t,e){return t==e?t:(t.constructor!=e.constructor&&(sQ=!0),e)}dQ.prototype.size=1;class fQ extends dQ{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new aQ(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class pQ extends fQ{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new aQ(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof pQ||n instanceof gQ&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof gQ?n=new pQ(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):dQ.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class gQ extends dQ{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new aQ(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new aQ(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==hQ.ByHeight)return this.blockAt(t,i,n,s);if(e==hQ.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new aQ(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new aQ(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new aQ(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof gQ?i[i.length-1]=new gQ(t.length+n):i.push(null,new gQ(n-1))}if(t>0){let e=i[0];e instanceof gQ?i[0]=new gQ(t+e.length):i.unshift(new gQ(t-1),null)}return dQ.of(i)}decomposeLeft(t,e){e.push(new gQ(t-1),null)}decomposeRight(t,e){e.push(null,new gQ(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new gQ(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=cQ&&(r=-2);let l=new pQ(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new gQ(s-o).updateHeight(t,o));let l=dQ.of(i);return(r<0||Math.abs(l.height-this.height)>=cQ||Math.abs(r-this.heightMetrics(t,e).perLine)>=cQ)&&(sQ=!0),uQ(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class mQ extends dQ{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==hQ.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==hQ.ByPosNoHeight?hQ.ByPosNoHeight:hQ.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,hQ.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&OQ(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),OQ(s,t)}return dQ.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?dQ.of(this.break?[t,null,e]:[t,e]):(this.left=uQ(this.left,t),this.right=uQ(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function OQ(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof gQ&&(n=t[e+1])instanceof gQ&&t.splice(e-1,3,new gQ(i.length+1+n.length))}class vQ{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof pQ?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new pQ(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new fQ(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new pQ(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new gQ(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof pQ)return t;let e=new pQ(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof pQ||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new pQ(0,-1));let i=t;for(let t of this.nodes)t instanceof pQ&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new vQ(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class wQ{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&nE(t,e,this.changes,5)}}function bQ(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function yQ(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class SQ{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return GD.replace({widget:new xQ(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class xQ extends UD{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class kQ{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=TQ,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=cE.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(KE).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new rQ(e),this.stateDeco=t.facet(GE).filter((t=>"function"!=typeof t)),this.heightMap=dQ.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new rR(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=GD.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new MQ(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?TQ:new PQ(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(DQ(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(GE).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=rR.extendWithRanges(n,function(t,e,i){let n=new wQ;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);oQ(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||sQ)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(NE)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?cE.RTL:cE.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=lD(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=gD(t.scrollDOM);let f=(this.printing?yQ:bQ)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),oQ();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?dQ.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new rR(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new lQ(i.from,s))}sQ&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new MQ(n.lineAt(o-1e3*i,hQ.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),hQ.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,hQ.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new MQ(n.lineAt(i-500,hQ.ByHeight,s,0,0).from,n.lineAt(i+o+500,hQ.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new MQ(this.heightMap.lineAt(i,hQ.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,hQ.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,hQ.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,hQ.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new SQ(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=cE.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new SQ(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=KD.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=AQ(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=CQ(s,t),a=CQ(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=AQ(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=CQ(s,c),a=CQ(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=AQ(n,i)-AQ(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){SQ.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=GD.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||DQ(this.heightMap.lineAt(t,hQ.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||DQ(this.heightMap.lineAt(this.scaler.fromDOM(t),hQ.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return DQ(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class MQ{constructor(t,e){this.from=t,this.to=e}}function CQ({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function AQ(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const TQ={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class PQ{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,hQ.ByPos,t,0,0).top,r=e.lineAt(s,hQ.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof PQ&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function DQ(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new aQ(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>DQ(t,e))):t._content)}const EQ=Fe.define({combine:t=>t.join(" ")}),RQ=Fe.define({combine:t=>t.indexOf(!0)>-1}),QQ=Yi.newName(),BQ=Yi.newName(),LQ=Yi.newName(),$Q={"&light":"."+BQ,"&dark":"."+LQ};function _Q(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const VQ=_Q("."+QQ,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},$Q),NQ={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},WQ=$D.ie&&$D.ie_version<=11;class HQ{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new aD,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);($D.ie&&$D.ie_version<=11||$D.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||$D.chrome&&$D.chrome_version<126||(this.editContext=new zQ(t),t.state.facet(IE)&&(t.contentDOM.editContext=this.editContext.editContext)),WQ&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(IE)?i.root.activeElement!=this.dom:!GP(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):($D.ie&&$D.ie_version<=11||$D.android&&$D.chrome)&&!i.state.selection.main.empty&&n.focusNode&&tD(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=UP(t.root);if(!e)return!1;let i=$D.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return FQ(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?FQ(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=GP(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,sD(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=sD(i))}else{if(i==t)return!0;n=eD(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,NQ),WQ&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),WQ&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&fD(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&GP(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new AR(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=TR(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=qQ(e,t.previousSibling||t.target.previousSibling,-1),n=qQ(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(IE)!=t.state.facet(IE)&&(t.view.contentDOM.editContext=t.state.facet(IE)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function qQ(t,e,i){for(;e;){let n=bD.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function FQ(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return tD(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class zQ{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if(($D.mac||$D.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);PR(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(GD.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:FE.of(GD.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=UP(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class IQ{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new kQ(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(qE)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(XE).map((t=>new YE(t)));for(let t of this.plugins)t.update(this);this.observer=new HQ(this),this.inputState=new DR(this),this.inputState.ensureHandlers(this.plugins),this.docView=new aR(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(JR)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=tQ(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=lR.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new HE(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(qE)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=jQ.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(oR)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(EQ)!=e.state.facet(EQ)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(QE))try{t(e)}catch(t){zE(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!TR(this,h)&&a.force&&fD(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new kQ(t),this.plugins=t.facet(XE).map((t=>new YE(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new aR(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(XE),i=t.state.facet(XE);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new YE(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){zE(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(gD(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return zE(this.state,t),XQ}})),h=lR.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=XQ)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){zE(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(QE))t(e)}get themeClasses(){return QQ+" "+(this.state.facet(RQ)?LQ:BQ)+" "+this.state.facet(EQ)}updateAttrs(){let t=YQ(this,UE,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(IE)?"true":"false",class:"cm-content",style:`${$D.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),YQ(this,KE,e);let i=this.observer.ignore((()=>{let i=jD(this.contentDOM,this.contentAttrs,e),n=jD(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(IQ.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(oR);let t=this.state.facet(IQ.cspNonce);Yi.mount(this.root,this.styleModules.concat(VQ).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return SR(this,t,bR(this,t,e,i))}moveByGroup(t,e){return SR(this,t,bR(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=function(t,e,i){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let t;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;t&&(s.type!=KD.Text||t.type==s.type&&!(i<0?s.from<e:s.to>e))||(t=s)}}return t||n}return n}(t,e.head,e.assoc||-1),o=n&&s.type==KD.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==cE.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return SR(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=vR(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),vR(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return oD(i,s[bE.find(s,t-n.from,-1,e)].dir==cE.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(VE)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>ZQ)return ME(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||yE(n.isolates,e=iR(this,t))))return n.order;e||(e=iR(this,t));let n=function(t,e,i){if(!t)return[new bE(0,0,e==uE?1:0)];if(e==dE&&!i.length&&!wE.test(t))return ME(t.length);if(i.length)for(;t.length>SE.length;)SE[SE.length]=256;let n=[],s=e==dE?0:1;return kE(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new jQ(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||$D.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{dD(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return qE.of(new HE("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return qE.of(new HE(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return jE.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return jE.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[EQ.of(i),oR.of(_Q(`.${i}`,t))];return e&&e.dark&&n.push(RQ.of(!0)),n}static baseTheme(t){return Ge.lowest(oR.of(_Q("."+QQ,t,$Q)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&bD.get(i)||bD.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}IQ.styleModule=oR,IQ.inputHandler=BE,IQ.clipboardInputFilter=$E,IQ.clipboardOutputFilter=_E,IQ.scrollHandler=WE,IQ.focusChangeEffect=LE,IQ.perLineTextDirection=VE,IQ.exceptionSink=RE,IQ.updateListener=QE,IQ.editable=IE,IQ.mouseSelectionStyle=EE,IQ.dragMovesSelection=DE,IQ.clickAddsSelectionRange=PE,IQ.decorations=GE,IQ.outerDecorations=JE,IQ.atomicRanges=tR,IQ.bidiIsolatedRanges=eR,IQ.scrollMargins=nR,IQ.darkTheme=RQ,IQ.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),IQ.contentAttributes=KE,IQ.editorAttributes=UE,IQ.lineWrapping=IQ.contentAttributes.of({class:"cm-lineWrapping"}),IQ.announce=gi.define();const ZQ=4096,XQ={};class jQ{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:cE.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new jQ(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function YQ(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&ID(o,i)}return i}const UQ=$D.mac?"mac":$D.windows?"win":$D.linux?"linux":"key";function KQ(t,e,i){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),!1!==i&&e.shiftKey&&(t="Shift-"+t),t}const GQ=Ge.default(IQ.domEventHandlers({keydown(t,e){return oB(eB(e.state),t,e,"editor")}})),JQ=Fe.define({enables:GQ}),tB=new WeakMap;function eB(t){let e=t.facet(JQ),i=tB.get(e);return i||tB.set(e,i=function(t,e=UQ){let i=Object.create(null),n=Object.create(null),s=(t,e)=>{let i=n[t];if(null==i)n[t]=e;else if(i!=e)throw new Error("Key binding "+t+" is used both as a regular binding and as a multi-stroke prefix")},o=(t,n,o,r,l)=>{var a,h;let c=i[t]||(i[t]=Object.create(null)),d=n.split(/ (?!$)/).map((t=>function(t,e){const i=t.split(/-(?!$)/);let n,s,o,r,l=i[i.length-1];"Space"==l&&(l=" ");for(let t=0;t<i.length-1;++t){const l=i[t];if(/^(cmd|meta|m)$/i.test(l))r=!0;else if(/^a(lt)?$/i.test(l))n=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else{if(!/^mod$/i.test(l))throw new Error("Unrecognized modifier name: "+l);"mac"==e?r=!0:s=!0}}return n&&(l="Alt-"+l),s&&(l="Ctrl-"+l),r&&(l="Meta-"+l),o&&(l="Shift-"+l),l}(t,e)));for(let e=1;e<d.length;e++){let i=d.slice(0,e).join(" ");s(i,!0),c[i]||(c[i]={preventDefault:!0,stopPropagation:!1,run:[e=>{let n=iB={view:e,prefix:i,scope:t};return setTimeout((()=>{iB==n&&(iB=null)}),nB),!0}]})}let u=d.join(" ");s(u,!1);let f=c[u]||(c[u]={preventDefault:!1,stopPropagation:!1,run:(null===(h=null===(a=c._any)||void 0===a?void 0:a.run)||void 0===h?void 0:h.slice())||[]});o&&f.run.push(o),r&&(f.preventDefault=!0),l&&(f.stopPropagation=!0)};for(let n of t){let t=n.scope?n.scope.split(" "):["editor"];if(n.any)for(let e of t){let t=i[e]||(i[e]=Object.create(null));t._any||(t._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:s}=n;for(let e in t)t[e].run.push((t=>s(t,sB)))}let s=n[e]||n.key;if(s)for(let e of t)o(e,s,n.run,n.preventDefault,n.stopPropagation),n.shift&&o(e,"Shift-"+s,n.shift,n.preventDefault,n.stopPropagation)}return i}(e.reduce(((t,e)=>t.concat(e)),[]))),i}let iB=null;const nB=4e3;let sB=null;function oB(t,e,i,n){sB=e;let s=on(e),o=Te(Ce(s,0))==s.length&&" "!=s,r="",l=!1,a=!1,h=!1;iB&&iB.view==i&&iB.scope==n&&(r=iB.prefix+" ",BR.indexOf(e.keyCode)<0&&(a=!0,iB=null));let c,d,u=new Set,f=t=>{if(t){for(let e of t.run)if(!u.has(e)&&(u.add(e),e(i)))return t.stopPropagation&&(h=!0),!0;t.preventDefault&&(t.stopPropagation&&(h=!0),a=!0)}return!1},p=t[n];return p&&(f(p[r+KQ(s,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!($D.windows&&e.ctrlKey&&e.altKey)&&(c=Gi[e.keyCode])&&c!=s?(f(p[r+KQ(c,e,!0)])||e.shiftKey&&(d=Ji[e.keyCode])!=s&&d!=c&&f(p[r+KQ(d,e,!1)]))&&(l=!0):o&&e.shiftKey&&f(p[r+KQ(s,e,!0)])&&(l=!0),!l&&f(p._any)&&(l=!0)),a&&(l=!0),l&&h&&e.stopPropagation(),sB=null,l}const rB=Fe.define({combine(t){let e,i;for(let n of t)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}});function lB(t,e){let i=t.plugin(aB),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}const aB=jE.fromClass(class{constructor(t){this.input=t.state.facet(dB),this.specs=this.input.filter((t=>t)),this.panels=this.specs.map((e=>e(t)));let e=t.state.facet(rB);this.top=new hB(t,!0,e.topContainer),this.bottom=new hB(t,!1,e.bottomContainer),this.top.sync(this.panels.filter((t=>t.top))),this.bottom.sync(this.panels.filter((t=>!t.top)));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet(rB);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new hB(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new hB(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=t.state.facet(dB);if(i!=this.input){let e=i.filter((t=>t)),n=[],s=[],o=[],r=[];for(let i of e){let e,l=this.specs.indexOf(i);l<0?(e=i(t.view),r.push(e)):(e=this.panels[l],e.update&&e.update(t)),n.push(e),(e.top?s:o).push(e)}this.specs=e,this.panels=n,this.top.sync(s),this.bottom.sync(o);for(let t of r)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>IQ.scrollMargins.of((e=>{let i=e.plugin(t);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}}))});class hB{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=cB(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=cB(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function cB(t){let e=t.nextSibling;return t.remove(),e}const dB=Fe.define({enables:aB});class uB extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}function fB(){var t=arguments[0];"string"==typeof t&&(t=document.createElement(t));var e=1,i=arguments[1];if(i&&"object"==typeof i&&null==i.nodeType&&!Array.isArray(i)){for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var s=i[n];"string"==typeof s?t.setAttribute(n,s):null!=s&&(t[n]=s)}e++}for(;e<arguments.length;e++)pB(t,arguments[e]);return t}function pB(t,e){if("string"==typeof e)t.appendChild(document.createTextNode(e));else if(null==e);else if(null!=e.nodeType)t.appendChild(e);else{if(!Array.isArray(e))throw new RangeError("Unsupported child node: "+e);for(var i=0;i<e.length;i++)pB(t,e[i])}}uB.prototype.elementClass="",uB.prototype.toDOM=void 0,uB.prototype.mapMode=De.TrackBefore,uB.prototype.startSide=uB.prototype.endSide=-1,uB.prototype.point=!0;const gB="function"==typeof String.prototype.normalize?t=>t.normalize("NFKD"):t=>t;class mB{constructor(t,e,i=0,n=t.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,n),this.bufferStart=i,this.normalize=s?t=>s(gB(t)):gB,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Ce(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=Ae(t),i=this.bufferStart+this.bufferPos;this.bufferPos+=Te(t);let n=this.normalize(e);if(n.length)for(let t=0,s=i;;t++){let o=n.charCodeAt(t),r=this.match(o,s,this.bufferPos+this.bufferStart);if(t==n.length-1){if(r)return this.value=r,this;break}s==i&&t<e.length&&e.charCodeAt(t)==o&&s++}}}match(t,e,i){let n=null;for(let e=0;e<this.matches.length;e+=2){let s=this.matches[e],o=!1;this.query.charCodeAt(s)==t&&(s==this.query.length-1?n={from:this.matches[e+1],to:i}:(this.matches[e]++,o=!0)),o||(this.matches.splice(e,2),e-=2)}return this.query.charCodeAt(0)==t&&(1==this.query.length?n={from:e,to:i}:this.matches.push(1,e)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}"undefined"!=typeof Symbol&&(mB.prototype[Symbol.iterator]=function(){return this});const OB={from:-1,to:-1,match:/.*/.exec("")},vB="gm"+(null==/x/.unicode?"":"u");class wB{constructor(t,e,i,n=0,s=t.length){if(this.text=t,this.to=s,this.curLine="",this.done=!1,this.value=OB,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new SB(t,e,i,n,s);this.re=new RegExp(e,vB+((null==i?void 0:i.ignoreCase)?"i":"")),this.test=null==i?void 0:i.test,this.iter=t.iter();let o=t.lineAt(n);this.curLineStart=o.from,this.matchPos=xB(t,n),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let i=this.curLineStart+e.index,n=i+e[0].length;if(this.matchPos=xB(this.text,n+(i==n?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<n||i>this.value.to)&&(!this.test||this.test(i,n,e)))return this.value={from:i,to:n,match:e},this;t=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),t=0}}}}const bB=new WeakMap;class yB{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,i){let n=bB.get(t);if(!n||n.from>=i||n.to<=e){let n=new yB(e,t.sliceString(e,i));return bB.set(t,n),n}if(n.from==e&&n.to==i)return n;let{text:s,from:o}=n;return o>e&&(s=t.sliceString(e,o)+s,o=e),n.to<i&&(s+=t.sliceString(n.to,i)),bB.set(t,new yB(o,s)),new yB(e,s.slice(e-o,i-o))}}class SB{constructor(t,e,i,n,s){this.text=t,this.to=s,this.done=!1,this.value=OB,this.matchPos=xB(t,n),this.re=new RegExp(e,vB+((null==i?void 0:i.ignoreCase)?"i":"")),this.test=null==i?void 0:i.test,this.flat=yB.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e){let t=this.flat.from+e.index,i=t+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(t,i,e)))return this.value={from:t,to:i,match:e},this.matchPos=xB(this.text,i+(t==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=yB.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function xB(t,e){if(e>=t.length)return e;let i,n=t.lineAt(e);for(;e<n.to&&(i=n.text.charCodeAt(e-n.from))>=56320&&i<57344;)e++;return e}function kB(t){let e=fB("input",{class:"cm-textfield",name:"line",value:String(t.state.doc.lineAt(t.state.selection.main.head).number)});function i(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!i)return;let{state:n}=t,s=n.doc.lineAt(n.selection.main.head),[,o,r,l,a]=i,h=l?+l.slice(1):0,c=r?+r:s.number;if(r&&a){let t=c/100;o&&(t=t*("-"==o?-1:1)+s.number/n.doc.lines),c=Math.round(n.doc.lines*t)}else r&&o&&(c=c*("-"==o?-1:1)+s.number);let d=n.doc.line(Math.max(1,Math.min(n.doc.lines,c))),u=We.cursor(d.from+Math.max(0,Math.min(h,d.length)));t.dispatch({effects:[MB.of(!1),IQ.scrollIntoView(u.from,{y:"center"})],selection:u}),t.focus()}return{dom:fB("form",{class:"cm-gotoLine",onkeydown:e=>{27==e.keyCode?(e.preventDefault(),t.dispatch({effects:MB.of(!1)}),t.focus()):13==e.keyCode&&(e.preventDefault(),i())},onsubmit:t=>{t.preventDefault(),i()}},fB("label",t.state.phrase("Go to line"),": ",e)," ",fB("button",{class:"cm-button",type:"submit"},t.state.phrase("go")),fB("button",{name:"close",onclick:()=>{t.dispatch({effects:MB.of(!1)}),t.focus()},"aria-label":t.state.phrase("close"),type:"button"},["×"]))}}"undefined"!=typeof Symbol&&(wB.prototype[Symbol.iterator]=SB.prototype[Symbol.iterator]=function(){return this});const MB=gi.define(),CB=Ue.define({create(){return!0},update(t,e){for(let i of e.effects)i.is(MB)&&(t=i.value);return t},provide:t=>dB.from(t,(t=>t?kB:null))}),AB=IQ.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),TB={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},PB=Fe.define({combine(t){return Ai(t,TB,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})}}),DB=GD.mark({class:"cm-selectionMatch"}),EB=GD.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function RB(t,e,i,n){return!(0!=i&&t(e.sliceDoc(i-1,i))==xi.Word||n!=e.doc.length&&t(e.sliceDoc(n,n+1))==xi.Word)}const QB=jE.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.selectionSet||t.docChanged||t.viewportChanged)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=t.state.facet(PB),{state:i}=t,n=i.selection;if(n.ranges.length>1)return GD.none;let s,o=n.main,r=null;if(o.empty){if(!e.highlightWordAroundCursor)return GD.none;let t=i.wordAt(o.head);if(!t)return GD.none;r=i.charCategorizer(o.head),s=i.sliceDoc(t.from,t.to)}else{let t=o.to-o.from;if(t<e.minSelectionLength||t>200)return GD.none;if(e.wholeWords){if(s=i.sliceDoc(o.from,o.to),r=i.charCategorizer(o.head),!RB(r,i,o.from,o.to)||!function(t,e,i,n){return t(e.sliceDoc(i,i+1))==xi.Word&&t(e.sliceDoc(n-1,n))==xi.Word}(r,i,o.from,o.to))return GD.none}else if(s=i.sliceDoc(o.from,o.to),!s)return GD.none}let l=[];for(let n of t.visibleRanges){let t=new mB(i.doc,s,n.from,n.to);for(;!t.next().done;){let{from:n,to:s}=t.value;if((!r||RB(r,i,n,s))&&(o.empty&&n<=o.from&&s>=o.to?l.push(EB.range(n,s)):(n>=o.to||s<=o.from)&&l.push(DB.range(n,s)),l.length>e.maxMatches))return GD.none}}return GD.set(l)}},{decorations:t=>t.decorations}),BB=IQ.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),LB=Fe.define({combine(t){return Ai(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:t=>new cL(t),scrollToMatch:t=>IQ.scrollIntoView(t)})}});class $B{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||function(t){try{return new RegExp(t,vB),!0}catch(t){return!1}}(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,((t,e)=>"n"==e?"\n":"r"==e?"\r":"t"==e?"\t":"\\"))}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new FB(this):new NB(this)}getCursor(t,e=0,i){let n=t.doc?t:Ci.create({doc:t});return null==i&&(i=n.doc.length),this.regexp?WB(this,n,e,i):VB(this,n,e,i)}}class _B{constructor(t){this.spec=t}}function VB(t,e,i,n){return new mB(e.doc,t.unquoted,i,n,t.caseSensitive?void 0:t=>t.toLowerCase(),t.wholeWord?function(t,e){return(i,n,s,o)=>((o>i||o+s.length<n)&&(o=Math.max(0,i-2),s=t.sliceString(o,Math.min(t.length,n+2))),!(e(HB(s,i-o))==xi.Word&&e(qB(s,i-o))==xi.Word||e(qB(s,n-o))==xi.Word&&e(HB(s,n-o))==xi.Word))}(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}class NB extends _B{constructor(t){super(t)}nextMatch(t,e,i){let n=VB(this.spec,t,i,t.doc.length).nextOverlapping();if(n.done){let i=Math.min(t.doc.length,e+this.spec.unquoted.length);n=VB(this.spec,t,0,i).nextOverlapping()}return n.done||n.value.from==e&&n.value.to==i?null:n.value}prevMatchInRange(t,e,i){for(let n=i;;){let i=Math.max(e,n-1e4-this.spec.unquoted.length),s=VB(this.spec,t,i,n),o=null;for(;!s.nextOverlapping().done;)o=s.value;if(o)return o;if(i==e)return null;n-=1e4}}prevMatch(t,e,i){let n=this.prevMatchInRange(t,0,e);return n||(n=this.prevMatchInRange(t,Math.max(0,i-this.spec.unquoted.length),t.doc.length)),!n||n.from==e&&n.to==i?null:n}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,e){let i=VB(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let s=VB(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,t.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}function WB(t,e,i,n){return new wB(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?(s=e.charCategorizer(e.selection.main.head),(t,e,i)=>!i[0].length||(s(HB(i.input,i.index))!=xi.Word||s(qB(i.input,i.index))!=xi.Word)&&(s(qB(i.input,i.index+i[0].length))!=xi.Word||s(HB(i.input,i.index+i[0].length))!=xi.Word)):void 0},i,n);var s}function HB(t,e){return t.slice(Me(t,e,!1),e)}function qB(t,e){return t.slice(e,Me(t,e))}class FB extends _B{nextMatch(t,e,i){let n=WB(this.spec,t,i,t.doc.length).next();return n.done&&(n=WB(this.spec,t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=1;;n++){let s=Math.max(e,i-1e4*n),o=WB(this.spec,t,s,i),r=null;for(;!o.next().done;)r=o.value;if(r&&(s==e||r.from>s+10))return r;if(s==e)return null}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,((e,i)=>{if("&"==i)return t.match[0];if("$"==i)return"$";for(let e=i.length;e>0;e--){let n=+i.slice(0,e);if(n>0&&n<t.match.length)return t.match[n]+i.slice(e)}return e}))}matchAll(t,e){let i=WB(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let s=WB(this.spec,t,Math.max(0,e-250),Math.min(i+250,t.doc.length));for(;!s.next().done;)n(s.value.from,s.value.to)}}const zB=gi.define(),IB=gi.define(),ZB=Ue.define({create(t){return new XB(sL(t).create(),null)},update(t,e){for(let i of e.effects)i.is(zB)?t=new XB(i.value.create(),t.panel):i.is(IB)&&(t=new XB(t.query,i.value?nL:null));return t},provide:t=>dB.from(t,(t=>t.panel))});class XB{constructor(t,e){this.query=t,this.panel=e}}const jB=GD.mark({class:"cm-searchMatch"}),YB=GD.mark({class:"cm-searchMatch cm-searchMatch-selected"}),UB=jE.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(ZB))}update(t){let e=t.state.field(ZB);(e!=t.startState.field(ZB)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return GD.none;let{view:i}=this,n=new Qi;for(let e=0,s=i.visibleRanges,o=s.length;e<o;e++){let{from:r,to:l}=s[e];for(;e<o-1&&l>s[e+1].from-500;)l=s[++e].to;t.highlight(i.state,r,l,((t,e)=>{let s=i.state.selection.ranges.some((i=>i.from==t&&i.to==e));n.add(t,e,s?YB:jB)}))}return n.finish()}},{decorations:t=>t.decorations});function KB(t){return e=>{let i=e.state.field(ZB,!1);return i&&i.query.spec.valid?t(e,i):lL(e)}}const GB=KB(((t,{query:e})=>{let{to:i}=t.state.selection.main,n=e.nextMatch(t.state,i,i);if(!n)return!1;let s=We.single(n.from,n.to),o=t.state.facet(LB);return t.dispatch({selection:s,effects:[pL(t,n),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),rL(t),!0})),JB=KB(((t,{query:e})=>{let{state:i}=t,{from:n}=i.selection.main,s=e.prevMatch(i,n,n);if(!s)return!1;let o=We.single(s.from,s.to),r=t.state.facet(LB);return t.dispatch({selection:o,effects:[pL(t,s),r.scrollToMatch(o.main,t)],userEvent:"select.search"}),rL(t),!0})),tL=KB(((t,{query:e})=>{let i=e.matchAll(t.state,1e3);return!(!i||!i.length||(t.dispatch({selection:We.create(i.map((t=>We.range(t.from,t.to)))),userEvent:"select.search.matches"}),0))})),eL=KB(((t,{query:e})=>{let{state:i}=t,{from:n,to:s}=i.selection.main;if(i.readOnly)return!1;let o=e.nextMatch(i,n,n);if(!o)return!1;let r,l,a=o,h=[],c=[];if(a.from==n&&a.to==s&&(l=i.toText(e.getReplacement(a)),h.push({from:a.from,to:a.to,insert:l}),a=e.nextMatch(i,a.from,a.to),c.push(IQ.announce.of(i.phrase("replaced match on line $",i.doc.lineAt(n).number)+"."))),a){let e=0==h.length||h[0].from>=o.to?0:o.to-o.from-l.length;r=We.single(a.from-e,a.to-e),c.push(pL(t,a)),c.push(i.facet(LB).scrollToMatch(r.main,t))}return t.dispatch({changes:h,selection:r,effects:c,userEvent:"input.replace"}),!0})),iL=KB(((t,{query:e})=>{if(t.state.readOnly)return!1;let i=e.matchAll(t.state,1e9).map((t=>{let{from:i,to:n}=t;return{from:i,to:n,insert:e.getReplacement(t)}}));if(!i.length)return!1;let n=t.state.phrase("replaced $ matches",i.length)+".";return t.dispatch({changes:i,effects:IQ.announce.of(n),userEvent:"input.replace.all"}),!0}));function nL(t){return t.state.facet(LB).createPanel(t)}function sL(t,e){var i,n,s,o,r;let l=t.selection.main,a=l.empty||l.to>l.from+100?"":t.sliceDoc(l.from,l.to);if(e&&!a)return e;let h=t.facet(LB);return new $B({search:(null!==(i=null==e?void 0:e.literal)&&void 0!==i?i:h.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:null!==(n=null==e?void 0:e.caseSensitive)&&void 0!==n?n:h.caseSensitive,literal:null!==(s=null==e?void 0:e.literal)&&void 0!==s?s:h.literal,regexp:null!==(o=null==e?void 0:e.regexp)&&void 0!==o?o:h.regexp,wholeWord:null!==(r=null==e?void 0:e.wholeWord)&&void 0!==r?r:h.wholeWord})}function oL(t){let e=lB(t,nL);return e&&e.dom.querySelector("[main-field]")}function rL(t){let e=oL(t);e&&e==t.root.activeElement&&e.select()}const lL=t=>{let e=t.state.field(ZB,!1);if(e&&e.panel){let i=oL(t);if(i&&i!=t.root.activeElement){let n=sL(t.state,e.query.spec);n.valid&&t.dispatch({effects:zB.of(n)}),i.focus(),i.select()}}else t.dispatch({effects:[IB.of(!0),e?zB.of(sL(t.state,e.query.spec)):gi.appendConfig.of(mL)]});return!0},aL=t=>{let e=t.state.field(ZB,!1);if(!e||!e.panel)return!1;let i=lB(t,nL);return i&&i.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:IB.of(!1)}),!0},hL=[{key:"Mod-f",run:lL,scope:"editor search-panel"},{key:"F3",run:GB,shift:JB,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:GB,shift:JB,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:aL,scope:"editor search-panel"},{key:"Mod-Shift-l",run:({state:t,dispatch:e})=>{let i=t.selection;if(i.ranges.length>1||i.main.empty)return!1;let{from:n,to:s}=i.main,o=[],r=0;for(let e=new mB(t.doc,t.sliceDoc(n,s));!e.next().done;){if(o.length>1e3)return!1;e.value.from==n&&(r=o.length),o.push(We.range(e.value.from,e.value.to))}return e(t.update({selection:We.create(o,r),userEvent:"select.search.matches"})),!0}},{key:"Mod-Alt-g",run:t=>{let e=lB(t,kB);if(!e){let i=[MB.of(!0)];null==t.state.field(CB,!1)&&i.push(gi.appendConfig.of([CB,AB])),t.dispatch({effects:i}),e=lB(t,kB)}return e&&e.dom.querySelector("input").select(),!0}},{key:"Mod-d",run:({state:t,dispatch:e})=>{let{ranges:i}=t.selection;if(i.some((t=>t.from===t.to)))return(({state:t,dispatch:e})=>{let{selection:i}=t,n=We.create(i.ranges.map((e=>t.wordAt(e.head)||We.cursor(e.head))),i.mainIndex);return!n.eq(i)&&(e(t.update({selection:n})),!0)})({state:t,dispatch:e});let n=t.sliceDoc(i[0].from,i[0].to);if(t.selection.ranges.some((e=>t.sliceDoc(e.from,e.to)!=n)))return!1;let s=function(t,e){let{main:i,ranges:n}=t.selection,s=t.wordAt(i.head),o=s&&s.from==i.from&&s.to==i.to;for(let i=!1,s=new mB(t.doc,e,n[n.length-1].to);;){if(s.next(),!s.done){if(i&&n.some((t=>t.from==s.value.from)))continue;if(o){let e=t.wordAt(s.value.from);if(!e||e.from!=s.value.from||e.to!=s.value.to)continue}return s.value}if(i)return null;s=new mB(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),i=!0}}(t,n);return!!s&&(e(t.update({selection:t.selection.addRange(We.range(s.from,s.to),!1),effects:IQ.scrollIntoView(s.to)})),!0)},preventDefault:!0}];class cL{constructor(t){this.view=t;let e=this.query=t.state.field(ZB).query.spec;function i(t,e,i){return fB("button",{class:"cm-button",name:t,onclick:e,type:"button"},i)}this.commit=this.commit.bind(this),this.searchField=fB("input",{value:e.search,placeholder:dL(t,"Find"),"aria-label":dL(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=fB("input",{value:e.replace,placeholder:dL(t,"Replace"),"aria-label":dL(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=fB("input",{type:"checkbox",name:"case",form:"",checked:e.caseSensitive,onchange:this.commit}),this.reField=fB("input",{type:"checkbox",name:"re",form:"",checked:e.regexp,onchange:this.commit}),this.wordField=fB("input",{type:"checkbox",name:"word",form:"",checked:e.wholeWord,onchange:this.commit}),this.dom=fB("div",{onkeydown:t=>this.keydown(t),class:"cm-search"},[this.searchField,i("next",(()=>GB(t)),[dL(t,"next")]),i("prev",(()=>JB(t)),[dL(t,"previous")]),i("select",(()=>tL(t)),[dL(t,"all")]),fB("label",null,[this.caseField,dL(t,"match case")]),fB("label",null,[this.reField,dL(t,"regexp")]),fB("label",null,[this.wordField,dL(t,"by word")]),...t.state.readOnly?[]:[fB("br"),this.replaceField,i("replace",(()=>eL(t)),[dL(t,"replace")]),i("replaceAll",(()=>iL(t)),[dL(t,"replace all")])],fB("button",{name:"close",onclick:()=>aL(t),"aria-label":dL(t,"close"),type:"button"},["×"])])}commit(){let t=new $B({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:zB.of(t)}))}keydown(t){var e,i;i=t,oB(eB((e=this.view).state),i,e,"search-panel")?t.preventDefault():13==t.keyCode&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?JB:GB)(this.view)):13==t.keyCode&&t.target==this.replaceField&&(t.preventDefault(),eL(this.view))}update(t){for(let e of t.transactions)for(let t of e.effects)t.is(zB)&&!t.value.eq(this.query)&&this.setQuery(t.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(LB).top}}function dL(t,e){return t.state.phrase(e)}const uL=30,fL=/[\s\.,:;?!]/;function pL(t,{from:e,to:i}){let n=t.state.doc.lineAt(e),s=t.state.doc.lineAt(i).to,o=Math.max(n.from,e-uL),r=Math.min(s,i+uL),l=t.state.sliceDoc(o,r);if(o!=n.from)for(let t=0;t<uL;t++)if(!fL.test(l[t+1])&&fL.test(l[t])){l=l.slice(t);break}if(r!=s)for(let t=l.length-1;t>l.length-uL;t--)if(!fL.test(l[t-1])&&fL.test(l[t])){l=l.slice(0,t);break}return IQ.announce.of(`${t.state.phrase("current match")}. ${l} ${t.state.phrase("on line")} ${n.number}.`)}const gL=IQ.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),mL=[ZB,Ge.low(UB),gL];function OL(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function vL(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function wL(t,e){if(!e.anchorNode)return!1;try{return vL(t,e.anchorNode)}catch(t){return!1}}function bL(t){return 3==t.nodeType?QL(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function yL(t,e,i,n){return!!i&&(kL(t,e,i,n,-1)||kL(t,e,i,n,1))}function SL(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function xL(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function kL(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:ML(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=SL(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?ML(t):0}}}function ML(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function CL(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function AL(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function TL(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}class PL{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?ML(e):0),i,Math.min(t.focusOffset,i?ML(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let DL,EL=null;function RL(t){if(t.setActive)return t.setActive();if(EL)return t.focus(EL);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==EL?{get preventScroll(){return EL={preventScroll:!0},!0}}:void 0),!EL){EL=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function QL(t,e,i=e){let n=DL||(DL=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function BL(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function LL(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function $L(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function _L(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=ML(i)}else{if(!i.parentNode||xL(i))return null;n=SL(i),i=i.parentNode}}}function VL(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||xL(i))return null;n=SL(i)+1,i=i.parentNode}}}class NL{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new NL(t.parentNode,SL(t),e)}static after(t,e){return new NL(t.parentNode,SL(t)+1,e)}}const WL=[];class HL{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=HL.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=qL(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=qL(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==ML(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!HL.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=WL){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new FL(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function qL(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}HL.prototype.breakAfter=0;class FL{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function zL(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function IL(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,zL(t,h,c,l,a,n,0,s,o)}let ZL="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},XL="undefined"!=typeof document?document:{documentElement:{style:{}}};const jL=/Edge\/(\d+)/.exec(ZL.userAgent),YL=/MSIE \d/.test(ZL.userAgent),UL=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ZL.userAgent),KL=!!(YL||UL||jL),GL=!KL&&/gecko\/(\d+)/i.test(ZL.userAgent),JL=!KL&&/Chrome\/(\d+)/.exec(ZL.userAgent),t$="webkitFontSmoothing"in XL.documentElement.style,e$=!KL&&/Apple Computer/.test(ZL.vendor),i$=e$&&(/Mobile\/\w+/.test(ZL.userAgent)||ZL.maxTouchPoints>2);var n$={mac:i$||/Mac/.test(ZL.platform),windows:/Win/.test(ZL.platform),linux:/Linux|X11/.test(ZL.platform),ie:KL,ie_version:YL?XL.documentMode||6:UL?+UL[1]:jL?+jL[1]:0,gecko:GL,gecko_version:GL?+(/Firefox\/(\d+)/.exec(ZL.userAgent)||[0,0])[1]:0,chrome:!!JL,chrome_version:JL?+JL[1]:0,ios:i$,android:/Android\b/.test(ZL.userAgent),webkit:t$,safari:e$,webkit_version:t$?+(/\bAppleWebKit\/(\d+)/.exec(ZL.userAgent)||[0,0])[1]:0,tabSize:null!=XL.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class s$ extends HL{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof s$)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new s$(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new NL(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?n$.chrome||n$.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=QL(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return n$.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?CL(a,r<0):a||null}(this.dom,t,e)}}class o$ extends HL{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(LL(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof o$&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(IL(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new o$(this.mark,e,o)}domAtPos(t){return a$(this,t)}coordsAt(t,e){return c$(this,t,e)}}class r$ extends HL{static create(t,e,i){return new r$(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=r$.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof r$&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof r$&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?NL.before(this.dom):NL.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return CL(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class l$ extends HL{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof l$&&t.side==this.side}split(){return new l$(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?NL.before(this.dom):NL.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function a$(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new NL(i,0)}function h$(t,e,i){let n,{children:s}=t;i>0&&e instanceof o$&&s.length&&(n=s[s.length-1])instanceof o$&&n.mark.eq(e.mark)?h$(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function c$(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&(i>0||d$(o,c)))&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=bL(e);return i[i.length-1]||null}(t)}function d$(t,e){let i=t.coordsAt(0,1),n=e.coordsAt(0,1);return i&&n&&n.top<i.bottom}function u$(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}s$.prototype.children=r$.prototype.children=l$.prototype.children=WL;const f$=Object.create(null);function p$(t,e,i){if(t==e)return!0;t||(t=f$),e||(e=f$);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function g$(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function m$(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class O${eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var v$=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(v$||(v$={}));class w$ extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new b$(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new S$(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=x$(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new S$(t,e,i,n,t.widget||null,!0)}static line(t){return new y$(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}w$.none=Ri.empty;class b$ extends w${constructor(t){let{start:e,end:i}=x$(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof b$&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&p$(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}b$.prototype.point=!1;class y$ extends w${constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof y$&&this.spec.class==t.spec.class&&p$(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}y$.prototype.mapMode=De.TrackBefore,y$.prototype.point=!0;class S$ extends w${constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?v$.WidgetRange:this.startSide<=0?v$.WidgetBefore:v$.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof S$&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function x$(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function k$(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}S$.prototype.point=!0;class M$ extends HL{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof M$))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),IL(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new M$;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){p$(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){h$(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=u$(e,this.attrs||{})),i&&(this.attrs=u$({class:i},this.attrs||{}))}domAtPos(t){return a$(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(LL(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(g$(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&HL.get(n)instanceof o$;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=HL.get(n))||void 0===i?void 0:i.isEditable)||n$.ios&&this.children.some((t=>t instanceof s$))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof s$)||/[^ -~]/.test(i.text))return null;let n=bL(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=c$(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof M$&&0==this.children.length&&0==t.children.length&&p$(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof M$)return s;if(o>e)break}n=o+s.breakAfter}return null}}class C$ extends HL{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof C$&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?NL.before(this.dom):NL.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new C$(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return WL}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof C$&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof A$?null:CL(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class A$ extends O${constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class T${constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof C$&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new M$),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(P$(new l$(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof C$||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(P$(new s$(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof S$){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof S$)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new C$(i.widget||D$.block,r,i));else{let o=r$.create(i.widget||D$.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(P$(new l$(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(P$(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new T$(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function P$(t,e){for(let i of e)t=new o$(i,[t],t.length);return t}class D$ extends O${constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}D$.inline=new D$("span"),D$.block=new D$("div");var E$=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(E$||(E$={}));const R$=E$.LTR,Q$=E$.RTL;function B$(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const L$=B$("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),$$=B$("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),_$=Object.create(null),V$=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);_$[e]=i,_$[i]=-e}function N$(t){return t<=247?L$[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?$$[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const W$=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class H${get dir(){return this.level%2?Q$:R$}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function q$(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!q$(n.inner,s.inner))return!1}return!0}const F$=[];function z$(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=F$[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if(F$[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new H$(a,p.from,u)),I$(t,p.direction==R$!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?F$[f]!=l:F$[f]==l))break;f++}d?z$(t,a,f,n+1,s,d,r):a<f&&r.push(new H$(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=F$[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if(F$[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new H$(p.to,a,u)),I$(t,p.direction==R$!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?F$[f-1]!=l:F$[f-1]==l))break;f--}d?z$(t,f,a,n+1,s,d,r):f<a&&r.push(new H$(f,a,u)),a=f}}function I$(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=N$(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),F$[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=F$[t];if(128==s)t<l-1&&e==F$[t+1]&&24&e?s=F$[t]=e:F$[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==F$[s];)s++;let o=t&&8==e||s<i&&8==F$[s]?1==n?1:8:256;for(let e=t;e<s;e++)F$[e]=o;t=s-1}else 8==s&&1==n&&(F$[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=_$[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(V$[t+1]==-i){let e=V$[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&(F$[r]=F$[V$[t]]=i),l=t;break}}else{if(189==V$.length)break;V$[l++]=r,V$[l++]=e,V$[l++]=a}else if(2==(n=F$[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=V$[e+2];if(2&i)break;if(t)V$[e+2]|=2;else{if(4&i)break;V$[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=F$[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=F$[r])break;r++}let h=1==o,c=h==(1==(r<e?F$[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),F$[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),z$(t,s,o,e,i,n,r)}function Z$(t){return[new H$(0,t,0)]}let X$="";function j$(t,e,i,n,s){var o;let r=n.head-t.from,l=H$.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),X$=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function Y$(t,e,i){for(let n=e;n<i;n++){let e=N$(t.charCodeAt(n));if(1==e)return R$;if(2==e||4==e)return Q$}return R$}const U$=Fe.define(),K$=Fe.define(),G$=Fe.define(),J$=Fe.define(),t_=Fe.define(),e_=Fe.define(),i_=Fe.define(),n_=Fe.define(),s_=Fe.define(),o_=Fe.define({combine:t=>t.some((t=>t))}),r_=Fe.define({combine:t=>t.some((t=>t))}),l_=Fe.define();class a_{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new a_(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new a_(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const h_=gi.define({map:(t,e)=>t.map(e)}),c_=gi.define();function d_(t,e,i){let n=t.facet(J$);n.length?n[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const u_=Fe.define({combine:t=>!t.length||t[0]});let f_=0;const p_=Fe.define();class g_{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new g_(f_++,t,i,n,(t=>{let e=[p_.of(t)];return o&&e.push(w_.of((e=>{let i=e.plugin(t);return i?o(i):w$.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return g_.define((e=>new t(e)),e)}}class m_{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(d_(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){d_(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){d_(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const O_=Fe.define(),v_=Fe.define(),w_=Fe.define(),b_=Fe.define(),y_=Fe.define(),S_=Fe.define();function x_(t,e){let i=t.state.facet(S_);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=Y$(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const k_=Fe.define();function M_(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(k_)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const C_=Fe.define();class A_{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new A_(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new A_(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new A_(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class T_{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new A_(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new T_(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class P_ extends HL{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=w$.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new M$],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new A_(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=D_(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new A_(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=HL.get(e);if(i instanceof o$)c.push({node:e,deco:i.mark});else{if(i instanceof M$||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new b$({inclusive:!0,attributes:m$(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new A_(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(n$.ie||n$.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new E_;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=A_.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=n$.chrome||n$.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof C$&&t.widget instanceof A$&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=T$.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=T$.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=T$.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);zL(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(c_)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new s$(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new o$(i,[e],e.length);let i=new M$;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=HL.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(u_)||this.dom.tabIndex>-1)&&wL(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if(n$.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new NL(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(yL(l.node,l.offset,c.anchorNode,c.anchorOffset)&&yL(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{n$.android&&n$.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=OL(this.view.root);if(t)if(r.empty){if(n$.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?_L:VL)(l.node,l.offset);e&&(l=new NL(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new NL(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new NL(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&yL(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=OL(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=M$.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=HL.get(i.childNodes[n]);t instanceof M$&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=HL.get(i.childNodes[n]);t instanceof M$&&(e=t.domAtPos(t.length))}return e?new NL(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=HL.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof M$)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof M$&&!(i instanceof M$&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof C$&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof M$))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof s$))return null;let s=Me(n.text,i);if(s==i)return null;let o=QL(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==E$.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?bL(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?E$.RTL:E$.LTR}measureTextSize(){for(let t of this.children)if(t instanceof M$){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=bL(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new FL(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(w$.replace({widget:new A$(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return w$.set(t)}updateDeco(){let t=1,e=this.view.state.facet(w_).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(b_).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(l_))try{if(e(this.view,t.range,t))return!0}catch(t){d_(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=M_(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=AL(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=TL(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==E$.LTR)}}function D_(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=_L(i.focusNode,i.focusOffset),s=VL(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=HL.get(s.node);if(!e||e instanceof s$&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=HL.get(n.node);!t||t instanceof s$&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let E_=class{constructor(){this.changes=[]}compareRange(t,e){k$(t,e,this.changes)}comparePoint(t,e){k$(t,e,this.changes)}boundChange(t){k$(t,t,this.changes)}};function R_(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Q_(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function B_(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function L_(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function $_(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function __(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=bL(u);for(let f=0;f<t.length;f++){let p=t[f];s&&B_(s,p)&&(p=L_($_(p,s.bottom),s.top));let g=R_(e,p),m=Q_(i,p);if(0==g&&0==m)return 3==u.nodeType?V_(u,e,i):__(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&B_(h,p)?h=$_(h,p.bottom):c&&B_(c,p)&&(c=L_(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?V_(n,u,i):d&&"false"!=n.contentEditable?__(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function V_(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=QL(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if((n$.chrome||n$.gecko)&&QL(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function N_(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=v$.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:W_(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:W_(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||n$.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return QL(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||n$.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():QL(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(ML(O),v))}if(!O||!t.docView.dom.contains(O)){let e=M$.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=__(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function W_(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function H_(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=j$(s,o,r,l,i),h=X$;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function q_(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function F_(t,e,i){let n=q_(t.state.facet(y_).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const z_="￿";class I_{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=z_}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=HL.get(n),r=HL.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:xL(n))||xL(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=HL.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(Z_(t,i.node,i.offset)?e:0))}}function Z_(t,e,i){for(;;){if(!e||i<ML(e))return!1;if(e==t)return!0;i=SL(e)+1,e=e.parentNode}}class X_{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class j_{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new X_(i,n)),s==i&&o==n||e.push(new X_(s,o))),e}(t),i=new I_(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!vL(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!vL(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if((n$.ios||n$.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function Y_(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||n$.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,z_),e.text,l-n,a);h&&(n$.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==z_+z_&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(z_))})}else n&&(!t.hasFocus&&t.state.facet(u_)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(n$.mac||n$.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:n$.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return U_(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function U_(t,e,i,n=-1){if(n$.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(n$.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&BL(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&BL(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&BL(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&D_(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet(e_).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class K_{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,n$.safari&&t.contentDOM.addEventListener("input",(()=>null)),n$.gecko&&function(t){xV.has(t)||(xV.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=HL.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(G_(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(G_(e.value,s))}}for(let t in sV)i(t).handlers.push(sV[t]);for(let t in oV)i(t).observers.push(oV[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&eV.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),n$.android&&n$.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!n$.ios||t.synthetic||t.altKey||t.metaKey||!((e=J_.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||tV.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,BL(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(n$.safari&&!n$.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function G_(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){d_(i.state,t)}}}const J_=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],tV="dthko",eV=[16,17,18,20,91,92,224,225];function iV(t){return.7*Math.max(0,t)+8}class nV{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(y_).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(U$);return i.length?i[0](e):n$.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=OL(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=OV(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=M_(this.view);t.clientX-h.left<=o+6?n=-iV(o-t.clientX):t.clientX+h.right>=l-6&&(n=iV(t.clientX-l)),t.clientY-h.top<=r+6?s=-iV(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=iV(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=q_(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=q_(this.atoms,n.from,-1),e=q_(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const sV=Object.create(null),oV=Object.create(null),rV=n$.ie&&n$.ie_version<15||n$.ios&&n$.webkit_version<604;function lV(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function aV(t,e){e=lV(t.state,n_,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=wV&&n.selection.ranges.every((t=>t.empty))&&wV==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function hV(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=M$.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}oV.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},sV.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),oV.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},oV.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},sV.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(G$))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=uV(t,e),n=OV(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=uV(t,e),h=hV(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=hV(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new nV(t,e,i,n)),n&&t.observer.ignore((()=>{RL(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let cV=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function dV(t,e,i,n){let s=M$.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&cV(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&cV(i,n,l)?1:r&&r.bottom>=n?-1:1}function uV(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:dV(t,i,e.clientX,e.clientY)}}const fV=n$.ie&&n$.ie_version<=11;let pV=null,gV=0,mV=0;function OV(t){if(!fV)return t.detail;let e=pV,i=mV;return pV=t,mV=Date.now(),gV=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(gV+1)%3:1}function vV(t,e,i,n){if(!(i=lV(t.state,n_,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(K$);return i.length?i[0](e):n$.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}sV.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",lV(t.state,s_,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},sV.dragend=t=>(t.inputState.draggedContent=null,!1),sV.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&vV(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return vV(t,e,i,!0),!0}return!1},sV.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=rV?null:e.clipboardData;return i?(aV(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),aV(t,i.value)}),50)}(t),!1)};let wV=null;sV.copy=sV.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:lV(t,s_,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;wV=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=rV?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const bV=ui.define();function yV(t,e){let i=[];for(let n of t.facet(i_)){let s=n(t,e);s&&i.push(s)}return i.length?t.update({effects:i,annotations:bV.of(!0)}):null}function SV(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=yV(t.state,e);i?t.dispatch(i):t.update([])}}),10)}oV.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),SV(t)},oV.blur=t=>{t.observer.clearSelectionRange(),SV(t)},oV.compositionstart=oV.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},oV.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,n$.chrome&&n$.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},oV.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},sV.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return U_(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if(n$.chrome&&n$.android&&(s=J_.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return n$.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),n$.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>oV.compositionend(t,e)),20),!1};const xV=new Set,kV=["pre-wrap","normal","pre-line","break-spaces"];let MV=!1;function CV(){MV=!1}class AV{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return kV.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=kV.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class TV{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class PV{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?v$.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof S$?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new PV(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var DV=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(DV||(DV={}));const EV=.001;class RV{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>EV&&(MV=!0),this.height=t)}replace(t,e,i){return RV.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,DV.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,DV.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,DV.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=NV.build(i.setDoc(o),t,h,c);s=QV(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new LV(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new _V(RV.of(t.slice(0,e)),o,RV.of(t.slice(i)))}}function QV(t,e){return t==e?t:(t.constructor!=e.constructor&&(MV=!0),e)}RV.prototype.size=1;class BV extends RV{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new PV(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class LV extends BV{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new PV(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof LV||n instanceof $V&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof $V?n=new LV(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):RV.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class $V extends RV{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new PV(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new PV(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==DV.ByHeight)return this.blockAt(t,i,n,s);if(e==DV.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new PV(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new PV(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new PV(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof $V?i[i.length-1]=new $V(t.length+n):i.push(null,new $V(n-1))}if(t>0){let e=i[0];e instanceof $V?i[0]=new $V(t+e.length):i.unshift(new $V(t-1),null)}return RV.of(i)}decomposeLeft(t,e){e.push(new $V(t-1),null)}decomposeRight(t,e){e.push(null,new $V(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new $V(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=EV&&(r=-2);let l=new LV(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new $V(s-o).updateHeight(t,o));let l=RV.of(i);return(r<0||Math.abs(l.height-this.height)>=EV||Math.abs(r-this.heightMetrics(t,e).perLine)>=EV)&&(MV=!0),QV(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class _V extends RV{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==DV.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==DV.ByPosNoHeight?DV.ByPosNoHeight:DV.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,DV.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&VV(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),VV(s,t)}return RV.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?RV.of(this.break?[t,null,e]:[t,e]):(this.left=QV(this.left,t),this.right=QV(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function VV(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof $V&&(n=t[e+1])instanceof $V&&t.splice(e-1,3,new $V(i.length+1+n.length))}class NV{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof LV?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new LV(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new BV(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new LV(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new $V(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof LV)return t;let e=new LV(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof LV||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new LV(0,-1));let i=t;for(let t of this.nodes)t instanceof LV&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new NV(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class WV{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&k$(t,e,this.changes,5)}}function HV(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function qV(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class FV{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return w$.replace({widget:new zV(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class zV extends O${constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class IV{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=YV,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=E$.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(v_).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new AV(e),this.stateDeco=t.facet(w_).filter((t=>"function"!=typeof t)),this.heightMap=RV.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new A_(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=w$.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new ZV(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?YV:new UV(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(KV(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(w_).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=A_.extendWithRanges(n,function(t,e,i){let n=new WV;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);CV(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||MV)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(r_)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?E$.RTL:E$.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=TL(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=$L(t.scrollDOM);let f=(this.printing?qV:HV)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),CV();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?RV.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new A_(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new TV(i.from,s))}MV&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new ZV(n.lineAt(o-1e3*i,DV.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),DV.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,DV.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new ZV(n.lineAt(i-500,DV.ByHeight,s,0,0).from,n.lineAt(i+o+500,DV.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new ZV(this.heightMap.lineAt(i,DV.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,DV.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,DV.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,DV.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new FV(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=E$.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new FV(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=v$.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=jV(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=XV(s,t),a=XV(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=jV(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=XV(s,c),a=XV(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=jV(n,i)-jV(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){FV.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=w$.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||KV(this.heightMap.lineAt(t,DV.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||KV(this.heightMap.lineAt(this.scaler.fromDOM(t),DV.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return KV(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class ZV{constructor(t,e){this.from=t,this.to=e}}function XV({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function jV(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const YV={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class UV{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,DV.ByPos,t,0,0).top,r=e.lineAt(s,DV.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof UV&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function KV(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new PV(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>KV(t,e))):t._content)}const GV=Fe.define({combine:t=>t.join(" ")}),JV=Fe.define({combine:t=>t.indexOf(!0)>-1}),tN=Yi.newName(),eN=Yi.newName(),iN=Yi.newName(),nN={"&light":"."+eN,"&dark":"."+iN};function sN(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const oN=sN("."+tN,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},nN),rN={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},lN=n$.ie&&n$.ie_version<=11;class aN{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new PL,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(n$.ie&&n$.ie_version<=11||n$.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||n$.chrome&&n$.chrome_version<126||(this.editContext=new dN(t),t.state.facet(u_)&&(t.contentDOM.editContext=this.editContext.editContext)),lN&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(u_)?i.root.activeElement!=this.dom:!wL(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(n$.ie&&n$.ie_version<=11||n$.android&&n$.chrome)&&!i.state.selection.main.empty&&n.focusNode&&yL(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=OL(t.root);if(!e)return!1;let i=n$.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return cN(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?cN(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=wL(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,ML(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=ML(i))}else{if(i==t)return!0;n=SL(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,rN),lN&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),lN&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&BL(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&wL(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new j_(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=Y_(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=hN(e,t.previousSibling||t.target.previousSibling,-1),n=hN(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(u_)!=t.state.facet(u_)&&(t.view.contentDOM.editContext=t.state.facet(u_)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function hN(t,e,i){for(;e;){let n=HL.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function cN(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return yL(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class dN{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if((n$.mac||n$.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);U_(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(w$.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:c_.of(w$.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=OL(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class uN{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new IV(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(h_)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(p_).map((t=>new m_(t)));for(let t of this.plugins)t.update(this);this.observer=new aN(this),this.inputState=new K_(this),this.inputState.ensureHandlers(this.plugins),this.docView=new P_(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(bV)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=yV(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=T_.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new a_(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(h_)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=gN.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(C_)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(GV)!=e.state.facet(GV)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(t_))try{t(e)}catch(t){d_(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!Y_(this,h)&&a.force&&BL(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new IV(t),this.plugins=t.facet(p_).map((t=>new m_(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new P_(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(p_),i=t.state.facet(p_);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new m_(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){d_(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if($L(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return d_(this.state,t),pN}})),h=T_.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=pN)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){d_(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(t_))t(e)}get themeClasses(){return tN+" "+(this.state.facet(JV)?iN:eN)+" "+this.state.facet(GV)}updateAttrs(){let t=mN(this,O_,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(u_)?"true":"false",class:"cm-content",style:`${n$.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),mN(this,v_,e);let i=this.observer.ignore((()=>{let i=g$(this.contentDOM,this.contentAttrs,e),n=g$(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(uN.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(C_);let t=this.state.facet(uN.cspNonce);Yi.mount(this.root,this.styleModules.concat(oN).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return F_(this,t,H_(this,t,e,i))}moveByGroup(t,e){return F_(this,t,H_(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=function(t,e,i){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let t;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;t&&(s.type!=v$.Text||t.type==s.type&&!(i<0?s.from<e:s.to>e))||(t=s)}}return t||n}return n}(t,e.head,e.assoc||-1),o=n&&s.type==v$.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==E$.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return F_(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=N_(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),N_(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return CL(i,s[H$.find(s,t-n.from,-1,e)].dir==E$.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(o_)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>fN)return Z$(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||q$(n.isolates,e=x_(this,t))))return n.order;e||(e=x_(this,t));let n=function(t,e,i){if(!t)return[new H$(0,0,e==Q$?1:0)];if(e==R$&&!i.length&&!W$.test(t))return Z$(t.length);if(i.length)for(;t.length>F$.length;)F$[F$.length]=256;let n=[],s=e==R$?0:1;return I$(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new gN(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||n$.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{RL(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return h_.of(new a_("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return h_.of(new a_(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return g_.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return g_.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[GV.of(i),C_.of(sN(`.${i}`,t))];return e&&e.dark&&n.push(JV.of(!0)),n}static baseTheme(t){return Ge.lowest(C_.of(sN("."+tN,t,nN)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&HL.get(i)||HL.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}uN.styleModule=C_,uN.inputHandler=e_,uN.clipboardInputFilter=n_,uN.clipboardOutputFilter=s_,uN.scrollHandler=l_,uN.focusChangeEffect=i_,uN.perLineTextDirection=o_,uN.exceptionSink=J$,uN.updateListener=t_,uN.editable=u_,uN.mouseSelectionStyle=G$,uN.dragMovesSelection=K$,uN.clickAddsSelectionRange=U$,uN.decorations=w_,uN.outerDecorations=b_,uN.atomicRanges=y_,uN.bidiIsolatedRanges=S_,uN.scrollMargins=k_,uN.darkTheme=JV,uN.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),uN.contentAttributes=v_,uN.editorAttributes=O_,uN.lineWrapping=uN.contentAttributes.of({class:"cm-lineWrapping"}),uN.announce=gi.define();const fN=4096,pN={};class gN{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:E$.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new gN(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function mN(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&u$(o,i)}return i}const ON="-10000px";class vN{constructor(t,e,i,n){this.facet=e,this.createTooltipView=i,this.removeTooltipView=n,this.input=t.state.facet(e),this.tooltips=this.input.filter((t=>t));let s=null;this.tooltipViews=this.tooltips.map((t=>s=i(t,s)))}update(t,e){var i;let n=t.state.facet(this.facet),s=n.filter((t=>t));if(n===this.input){for(let e of this.tooltipViews)e.update&&e.update(t);return!1}let o=[],r=e?[]:null;for(let i=0;i<s.length;i++){let n=s[i],l=-1;if(n){for(let t=0;t<this.tooltips.length;t++){let e=this.tooltips[t];e&&e.create==n.create&&(l=t)}if(l<0)o[i]=this.createTooltipView(n,i?o[i-1]:null),r&&(r[i]=!!n.above);else{let n=o[i]=this.tooltipViews[l];r&&(r[i]=e[l]),n.update&&n.update(t)}}}for(let t of this.tooltipViews)o.indexOf(t)<0&&(this.removeTooltipView(t),null===(i=t.destroy)||void 0===i||i.call(t));return e&&(r.forEach(((t,i)=>e[i]=t)),e.length=r.length),this.input=n,this.tooltips=s,this.tooltipViews=o,!0}}function wN(t){let e=t.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const bN=Fe.define({combine:t=>{var e,i,n;return{position:n$.ios?"absolute":(null===(e=t.find((t=>t.position)))||void 0===e?void 0:e.position)||"fixed",parent:(null===(i=t.find((t=>t.parent)))||void 0===i?void 0:i.parent)||null,tooltipSpace:(null===(n=t.find((t=>t.tooltipSpace)))||void 0===n?void 0:n.tooltipSpace)||wN}}}),yN=new WeakMap,SN=g_.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(bN);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver="function"==typeof ResizeObserver?new ResizeObserver((()=>this.measureSoon())):null,this.manager=new vN(t,CN,((t,e)=>this.createTooltip(t,e)),(t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()})),this.above=this.manager.tooltips.map((t=>!!t.above)),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let i=e||t.geometryChanged,n=t.state.facet(bN);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let t of this.manager.tooltipViews)t.dom.style.position=this.position;i=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let t of this.manager.tooltipViews)this.container.appendChild(t.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(t,e){let i=t.create(this.view),n=e?e.dom:null;if(i.dom.classList.add("cm-tooltip"),t.arrow&&!i.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",i.dom.appendChild(t)}return i.dom.style.position=this.position,i.dom.style.top=ON,i.dom.style.left="0px",this.container.insertBefore(i.dom,n),i.mount&&i.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(i.dom),i}destroy(){var t,e,i;this.view.win.removeEventListener("resize",this.measureSoon);for(let e of this.manager.tooltipViews)e.dom.remove(),null===(t=e.destroy)||void 0===t||t.call(e);this.parent&&this.container.remove(),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),null===(i=this.intersectionObserver)||void 0===i||i.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,i=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:t}=this.manager.tooltipViews[0];if(n$.gecko)i=t.offsetParent!=this.container.ownerDocument.body;else if(t.style.top==ON&&"0px"==t.style.left){let e=t.getBoundingClientRect();i=Math.abs(e.top+1e4)>1||Math.abs(e.left)>1}}if(i||"absolute"==this.position)if(this.parent){let i=this.parent.getBoundingClientRect();i.width&&i.height&&(t=i.width/this.parent.offsetWidth,e=i.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),s=M_(this.view);return{visible:{left:n.left+s.left,top:n.top+s.top,right:n.right-s.right,bottom:n.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map(((t,e)=>{let i=this.manager.tooltipViews[e];return i.getCoords?i.getCoords(t.pos):this.view.coordsAtPos(t.pos)})),size:this.manager.tooltipViews.map((({dom:t})=>t.getBoundingClientRect())),space:this.view.state.facet(bN).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:i}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let t of this.manager.tooltipViews)t.dom.style.position="absolute"}let{visible:i,space:n,scaleX:s,scaleY:o}=t,r=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],h=this.manager.tooltipViews[l],{dom:c}=h,d=t.pos[l],u=t.size[l];if(!d||!1!==a.clip&&(d.bottom<=Math.max(i.top,n.top)||d.top>=Math.min(i.bottom,n.bottom)||d.right<Math.max(i.left,n.left)-.1||d.left>Math.min(i.right,n.right)+.1)){c.style.top=ON;continue}let f=a.arrow?h.dom.querySelector(".cm-tooltip-arrow"):null,p=f?7:0,g=u.right-u.left,m=null!==(e=yN.get(h))&&void 0!==e?e:u.bottom-u.top,O=h.offset||MN,v=this.view.textDirection==E$.LTR,w=u.width>n.right-n.left?v?n.left:n.right-u.width:v?Math.max(n.left,Math.min(d.left-(f?14:0)+O.x,n.right-g)):Math.min(Math.max(n.left,d.left-g+(f?14:0)-O.x),n.right-g),b=this.above[l];!a.strictSide&&(b?d.top-m-p-O.y<n.top:d.bottom+m+p+O.y>n.bottom)&&b==n.bottom-d.bottom>d.top-n.top&&(b=this.above[l]=!b);let y=(b?d.top-n.top:n.bottom-d.bottom)-p;if(y<m&&!1!==h.resize){if(y<this.view.defaultLineHeight){c.style.top=ON;continue}yN.set(h,m),c.style.height=(m=y)/o+"px"}else c.style.height&&(c.style.height="");let S=b?d.top-m-p-O.y:d.bottom+p+O.y,x=w+g;if(!0!==h.overlap)for(let t of r)t.left<x&&t.right>w&&t.top<S+m&&t.bottom>S&&(S=b?t.top-m-2-p:t.bottom+p+2);if("absolute"==this.position?(c.style.top=(S-t.parent.top)/o+"px",xN(c,(w-t.parent.left)/s)):(c.style.top=S/o+"px",xN(c,w/s)),f){let t=d.left+(v?O.x:-O.x)-(w+14-7);f.style.left=t/s+"px"}!0!==h.overlap&&r.push({left:w,top:S,right:x,bottom:S+m}),c.classList.toggle("cm-tooltip-above",b),c.classList.toggle("cm-tooltip-below",!b),h.positioned&&h.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=ON}},{eventObservers:{scroll(){this.maybeMeasure()}}});function xN(t,e){let i=parseInt(t.style.left,10);(isNaN(i)||Math.abs(e-i)>1)&&(t.style.left=e+"px")}const kN=uN.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),MN={x:0,y:0},CN=Fe.define({enables:[SN,kN]}),AN=Fe.define({combine:t=>t.reduce(((t,e)=>t.concat(e)),[])});class TN{static create(t){return new TN(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new vN(t,AN,((t,e)=>this.createHostedView(t,e)),(t=>t.dom.remove()))}createHostedView(t,e){let i=t.create(this.view);return i.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(i.dom,e?e.dom.nextSibling:this.dom.firstChild),this.mounted&&i.mount&&i.mount(this.view),i}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let e of this.manager.tooltipViews)null===(t=e.destroy)||void 0===t||t.call(e)}passProp(t){let e;for(let i of this.manager.tooltipViews){let n=i[t];if(void 0!==n)if(void 0===e)e=n;else if(e!==n)return}return e}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const PN=CN.compute([AN],(t=>{let e=t.facet(AN);return 0===e.length?null:{pos:Math.min(...e.map((t=>t.pos))),end:Math.max(...e.map((t=>{var e;return null!==(e=t.end)&&void 0!==e?e:t.pos}))),create:TN.create,above:e[0].above,arrow:e.some((t=>t.arrow))}}));class DN{constructor(t,e,i,n,s){this.view=t,this.source=e,this.field=i,this.setHover=n,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:e}=this,i=t.docView.nearest(e.target);if(!i)return;let n,s=1;if(i instanceof r$)n=i.posAtStart;else{if(n=t.posAtCoords(e),null==n)return;let i=t.coordsAtPos(n);if(!i||e.y<i.top||e.y>i.bottom||e.x<i.left-t.defaultCharacterWidth||e.x>i.right+t.defaultCharacterWidth)return;let o=t.bidiSpans(t.state.doc.lineAt(n)).find((t=>t.from<=n&&t.to>=n)),r=o&&o.dir==E$.RTL?-1:1;s=e.x<i.left?-r:r}let o=this.source(t,n,s);if(null==o?void 0:o.then){let e=this.pending={pos:n};o.then((i=>{this.pending==e&&(this.pending=null,!i||Array.isArray(i)&&!i.length||t.dispatch({effects:this.setHover.of(Array.isArray(i)?i:[i])}))}),(e=>d_(t.state,e,"hover tooltip")))}else!o||Array.isArray(o)&&!o.length||t.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let t=this.view.plugin(SN),e=t?t.manager.tooltips.findIndex((t=>t.create==TN.create)):-1;return e>-1?t.manager.tooltipViews[e]:null}mousemove(t){var e,i;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:s}=this;if(n.length&&s&&!function(t,e){let i,{left:n,right:s,top:o,bottom:r}=t.getBoundingClientRect();if(i=t.querySelector(".cm-tooltip-arrow")){let t=i.getBoundingClientRect();o=Math.min(t.top,o),r=Math.max(t.bottom,r)}return e.clientX>=n-EN&&e.clientX<=s+EN&&e.clientY>=o-EN&&e.clientY<=r+EN}(s.dom,t)||this.pending){let{pos:s}=n[0]||this.pending,o=null!==(i=null===(e=n[0])||void 0===e?void 0:e.end)&&void 0!==i?i:s;(s==o?this.view.posAtCoords(this.lastMove)==s:function(t,e,i,n,s){let o=t.scrollDOM.getBoundingClientRect(),r=t.documentTop+t.documentPadding.top+t.contentHeight;if(o.left>n||o.right<n||o.top>s||Math.min(o.bottom,r)<s)return!1;let l=t.posAtCoords({x:n,y:s},!1);return l>=e&&l<=i}(this.view,s,o,t.clientX,t.clientY))||(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:e}=this;if(e.length){let{tooltip:e}=this;e&&e.dom.contains(t.relatedTarget)?this.watchTooltipLeave(e.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let e=i=>{t.removeEventListener("mouseleave",e),this.active.length&&!this.view.dom.contains(i.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",e)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const EN=4;function RN(t,e={}){let i=gi.define(),n=Ue.define({create(){return[]},update(t,n){if(t.length&&(e.hideOnChange&&(n.docChanged||n.selection)?t=[]:e.hideOn&&(t=t.filter((t=>!e.hideOn(n,t)))),n.docChanged)){let e=[];for(let i of t){let t=n.changes.mapPos(i.pos,-1,De.TrackDel);if(null!=t){let s=Object.assign(Object.create(null),i);s.pos=t,null!=s.end&&(s.end=n.changes.mapPos(s.end)),e.push(s)}}t=e}for(let e of n.effects)e.is(i)&&(t=e.value),e.is(QN)&&(t=[]);return t},provide:t=>AN.from(t)});return{active:n,extension:[n,g_.define((s=>new DN(s,t,n,i,e.hoverTime||300))),PN]}}const QN=gi.define(),BN=Fe.define({combine(t){let e,i;for(let n of t)e=e||n.topContainer,i=i||n.bottomContainer;return{topContainer:e,bottomContainer:i}}}),LN=g_.fromClass(class{constructor(t){this.input=t.state.facet(VN),this.specs=this.input.filter((t=>t)),this.panels=this.specs.map((e=>e(t)));let e=t.state.facet(BN);this.top=new $N(t,!0,e.topContainer),this.bottom=new $N(t,!1,e.bottomContainer),this.top.sync(this.panels.filter((t=>t.top))),this.bottom.sync(this.panels.filter((t=>!t.top)));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(t){let e=t.state.facet(BN);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new $N(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new $N(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=t.state.facet(VN);if(i!=this.input){let e=i.filter((t=>t)),n=[],s=[],o=[],r=[];for(let i of e){let e,l=this.specs.indexOf(i);l<0?(e=i(t.view),r.push(e)):(e=this.panels[l],e.update&&e.update(t)),n.push(e),(e.top?s:o).push(e)}this.specs=e,this.panels=n,this.top.sync(s),this.bottom.sync(o);for(let t of r)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}else for(let e of this.panels)e.update&&e.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>uN.scrollMargins.of((e=>{let i=e.plugin(t);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}}))});class $N{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=_N(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=_N(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function _N(t){let e=t.nextSibling;return t.remove(),e}const VN=Fe.define({enables:LN});class NN extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}NN.prototype.elementClass="",NN.prototype.toDOM=void 0,NN.prototype.mapMode=De.TrackBefore,NN.prototype.startSide=NN.prototype.endSide=-1,NN.prototype.point=!0;class WN{constructor(t,e,i){this.from=t,this.to=e,this.diagnostic=i}}class HN{constructor(t,e,i){this.diagnostics=t,this.panel=e,this.selected=i}static init(t,e,i){let n=i.facet(GN).markerFilter;n&&(t=n(t,i));let s=t.slice().sort(((t,e)=>t.from-e.from||t.to-e.to)),o=new Qi,r=[],l=0;for(let t=0;;){let e,n,a=t==s.length?null:s[t];if(!a&&!r.length)break;for(r.length?(e=l,n=r.reduce(((t,e)=>Math.min(t,e.to)),a&&a.from>e?a.from:1e8)):(e=a.from,n=a.to,r.push(a),t++);t<s.length;){let i=s[t];if(i.from!=e||!(i.to>i.from||i.to==e)){n=Math.min(i.from,n);break}r.push(i),t++,n=Math.min(i.to,n)}let h=lW(r);if(r.some((t=>t.from==t.to||t.from==t.to-1&&i.doc.lineAt(t.from).to==t.from)))o.add(e,e,w$.widget({widget:new eW(h),diagnostics:r.slice()}));else{let t=r.reduce(((t,e)=>e.markClass?t+" "+e.markClass:t),"");o.add(e,n,w$.mark({class:"cm-lintRange cm-lintRange-"+h+t,diagnostics:r.slice(),inclusiveEnd:r.some((t=>t.to>n))}))}l=n;for(let t=0;t<r.length;t++)r[t].to<=l&&r.splice(t--,1)}let a=o.finish();return new HN(a,e,qN(a))}}function qN(t,e=null,i=0){let n=null;return t.between(i,1e9,((t,i,{spec:s})=>{if(!(e&&s.diagnostics.indexOf(e)<0))if(n){if(s.diagnostics.indexOf(n.diagnostic)<0)return!1;n=new WN(n.from,i,n.diagnostic)}else n=new WN(t,i,e||s.diagnostics[0])})),n}const FN=gi.define(),zN=gi.define(),IN=gi.define(),ZN=Ue.define({create(){return new HN(w$.none,null,null)},update(t,e){if(e.docChanged&&t.diagnostics.size){let i=t.diagnostics.map(e.changes),n=null,s=t.panel;if(t.selected){let s=e.changes.mapPos(t.selected.from,1);n=qN(i,t.selected.diagnostic,s)||qN(i,null,s)}!i.size&&s&&e.state.facet(GN).autoPanel&&(s=null),t=new HN(i,s,n)}for(let i of e.effects)if(i.is(FN)){let n=e.state.facet(GN).autoPanel?i.value.length?nW.open:null:t.panel;t=HN.init(i.value,n,e.state)}else i.is(zN)?t=new HN(t.diagnostics,i.value?nW.open:null,t.selected):i.is(IN)&&(t=new HN(t.diagnostics,t.panel,i.value));return t},provide:t=>[VN.from(t,(t=>t.panel)),uN.decorations.from(t,(t=>t.diagnostics))]}),XN=w$.mark({class:"cm-lintRange cm-lintRange-active"});function jN(t,e,i){let n,{diagnostics:s}=t.state.field(ZN),o=-1,r=-1;s.between(e-(i<0?1:0),e+(i>0?1:0),((t,s,{spec:l})=>{if(e>=t&&e<=s&&(t==s||(e>t||i>0)&&(e<s||i<0)))return n=l.diagnostics,o=t,r=s,!1}));let l=t.state.facet(GN).tooltipFilter;return n&&l&&(n=l(n,t.state)),n?{pos:o,end:r,above:t.state.doc.lineAt(o).to<r,create(){return{dom:YN(t,n)}}}:null}function YN(t,e){return fB("ul",{class:"cm-tooltip-lint"},e.map((e=>tW(t,e,!1))))}const UN=t=>{let e=t.state.field(ZN,!1);return!(!e||!e.panel||(t.dispatch({effects:zN.of(!1)}),0))},KN=[{key:"Mod-Shift-m",run:t=>{let e=t.state.field(ZN,!1);var i,n;e&&e.panel||t.dispatch({effects:(i=t.state,n=[zN.of(!0)],i.field(ZN,!1)?n:n.concat(gi.appendConfig.of(aW)))});let s=function(t,e){let i=t.plugin(LN),n=i?i.specs.indexOf(e):-1;return n>-1?i.panels[n]:null}(t,nW.open);return s&&s.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:t=>{let e=t.state.field(ZN,!1);if(!e)return!1;let i=t.state.selection.main,n=e.diagnostics.iter(i.to+1);return!(!n.value&&(n=e.diagnostics.iter(0),!n.value||n.from==i.from&&n.to==i.to)||(t.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0}),0))}}],GN=Fe.define({combine(t){return Object.assign({sources:t.map((t=>t.source)).filter((t=>null!=t))},Ai(t.map((t=>t.config)),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(t,e)=>t?e?i=>t(i)||e(i):t:e}))}});function JN(t){let e=[];if(t)t:for(let{name:i}of t){for(let t=0;t<i.length;t++){let n=i[t];if(/[a-zA-Z]/.test(n)&&!e.some((t=>t.toLowerCase()==n.toLowerCase()))){e.push(n);continue t}}e.push("")}return e}function tW(t,e,i){var n;let s=i?JN(e.actions):[];return fB("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},fB("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(t):e.message),null===(n=e.actions)||void 0===n?void 0:n.map(((i,n)=>{let o=!1,r=n=>{if(n.preventDefault(),o)return;o=!0;let s=qN(t.state.field(ZN).diagnostics,e);s&&i.apply(t,s.from,s.to)},{name:l}=i,a=s[n]?l.indexOf(s[n]):-1,h=a<0?l:[l.slice(0,a),fB("u",l.slice(a,a+1)),l.slice(a+1)];return fB("button",{type:"button",class:"cm-diagnosticAction",onclick:r,onmousedown:r,"aria-label":` Action: ${l}${a<0?"":` (access key "${s[n]})"`}.`},h)})),e.source&&fB("div",{class:"cm-diagnosticSource"},e.source))}class eW extends O${constructor(t){super(),this.sev=t}eq(t){return t.sev==this.sev}toDOM(){return fB("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class iW{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=tW(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class nW{constructor(t){this.view=t,this.items=[],this.list=fB("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e=>{if(27==e.keyCode)UN(this.view),this.view.focus();else if(38==e.keyCode||33==e.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==e.keyCode||34==e.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==e.keyCode)this.moveSelection(0);else if(35==e.keyCode)this.moveSelection(this.items.length-1);else if(13==e.keyCode)this.view.focus();else{if(!(e.keyCode>=65&&e.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:i}=this.items[this.selectedIndex],n=JN(i.actions);for(let s=0;s<n.length;s++)if(n[s].toUpperCase().charCodeAt(0)==e.keyCode){let e=qN(this.view.state.field(ZN).diagnostics,i);e&&i.actions[s].apply(t,e.from,e.to)}}}e.preventDefault()},onclick:t=>{for(let e=0;e<this.items.length;e++)this.items[e].dom.contains(t.target)&&this.moveSelection(e)}}),this.dom=fB("div",{class:"cm-panel-lint"},this.list,fB("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>UN(this.view)},"×")),this.update()}get selectedIndex(){let t=this.view.state.field(ZN).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(ZN),i=0,n=!1,s=null,o=new Set;for(t.between(0,this.view.state.doc.length,((t,r,{spec:l})=>{for(let t of l.diagnostics){if(o.has(t))continue;o.add(t);let r,l=-1;for(let e=i;e<this.items.length;e++)if(this.items[e].diagnostic==t){l=e;break}l<0?(r=new iW(this.view,t),this.items.splice(i,0,r),n=!0):(r=this.items[l],l>i&&(this.items.splice(i,l-i),n=!0)),e&&r.diagnostic==e.diagnostic?r.dom.hasAttribute("aria-selected")||(r.dom.setAttribute("aria-selected","true"),s=r):r.dom.hasAttribute("aria-selected")&&r.dom.removeAttribute("aria-selected"),i++}}));i<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();0==this.items.length&&(this.items.push(new iW(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:t,panel:e})=>{let i=e.height/this.list.offsetHeight;t.top<e.top?this.list.scrollTop-=(e.top-t.top)/i:t.bottom>e.bottom&&(this.list.scrollTop+=(t.bottom-e.bottom)/i)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let e=t;t=e.nextSibling,e.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;t!=i.dom;)e();t=i.dom.nextSibling}else this.list.insertBefore(i.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=qN(this.view.state.field(ZN).diagnostics,this.items[t].diagnostic);e&&this.view.dispatch({selection:{anchor:e.from,head:e.to},scrollIntoView:!0,effects:IN.of(e)})}static open(t){return new nW(t)}}function sW(t){return function(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const oW=uN.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:sW("#d11")},".cm-lintRange-warning":{backgroundImage:sW("orange")},".cm-lintRange-info":{backgroundImage:sW("#999")},".cm-lintRange-hint":{backgroundImage:sW("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function rW(t){return"error"==t?4:"warning"==t?3:"info"==t?2:1}function lW(t){let e="hint",i=1;for(let n of t){let t=rW(n.severity);t>i&&(i=t,e=n.severity)}return e}const aW=[ZN,uN.decorations.compute([ZN],(t=>{let{selected:e,panel:i}=t.field(ZN);return e&&i&&e.from!=e.to?w$.set([XN.range(e.from,e.to)]):w$.none})),RN(jN,{hideOn:function(t,e){let i=e.pos,n=e.end||i,s=t.state.facet(GN).hideOn(t,i,n);if(null!=s)return s;let o=t.startState.doc.lineAt(e.pos);return!(!t.effects.some((t=>t.is(FN)))&&!t.changes.touchesRange(o.from,Math.max(o.to,n)))}}),oW];var hW=function(t){void 0===t&&(t={});var{crosshairCursor:e=!1}=t,i=[];!1!==t.closeBracketsKeymap&&(i=i.concat(Qv)),!1!==t.defaultKeymap&&(i=i.concat(jP)),!1!==t.searchKeymap&&(i=i.concat(hL)),!1!==t.historyKeymap&&(i=i.concat(GT)),!1!==t.foldKeymap&&(i=i.concat(pa)),!1!==t.completionKeymap&&(i=i.concat(Hv)),!1!==t.lintKeymap&&(i=i.concat(KN));var n=[];return!1!==t.lineNumbers&&n.push(function(t={}){return[gk.of(t),rk(),vk]}()),!1!==t.highlightActiveLineGutter&&n.push(yk),!1!==t.highlightSpecialChars&&n.push(function(t={}){return[zx.of(t),Ix||(Ix=cy.fromClass(class{constructor(t){this.view=t,this.decorations=pb.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(zx)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new Nx({regexp:t.specialChars,decoration:(e,i,n)=>{let{doc:s}=i.state,o=Ce(e[0],0);if(9==o){let t=s.lineAt(n),e=i.state.tabSize,o=zi(t.text,e,n-t.from);return pb.replace({widget:new Xx((e-o%e)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[o]||(this.decorationCache[o]=pb.replace({widget:new Zx(t,o)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(zx);t.startState.facet(zx)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))]}()),!1!==t.history&&n.push(function(t={}){return[LT,BT.of(t),OT.domEventHandlers({beforeinput(t,e){let i="historyUndo"==t.inputType?_T:"historyRedo"==t.inputType?VT:null;return!!i&&(t.preventDefault(),i(e))}})]}()),!1!==t.foldGutter&&n.push(function(t={}){let e=Object.assign(Object.assign({},ya),t),i=new Sa(e,!0),n=new Sa(e,!1),s=so.fromClass(class{constructor(t){this.from=t.viewport.from,this.markers=this.buildMarkers(t)}update(t){(t.docChanged||t.viewportChanged||t.startState.facet(Vl)!=t.state.facet(Vl)||t.startState.field(ha,!1)!=t.state.field(ha,!1)||Pl(t.startState)!=Pl(t.state)||e.foldingChanged(t))&&(this.markers=this.buildMarkers(t.view))}buildMarkers(t){let e=new Qi;for(let s of t.viewportLineBlocks){let o=ca(t.state,s.from,s.to)?n:sa(t.state,s.from,s.to)?i:null;o&&e.add(s.from,s.from,o)}return e.finish()}}),{domEventHandlers:o}=e;return[s,fl({class:"cm-foldGutter",markers(t){var e;return(null===(e=t.plugin(s))||void 0===e?void 0:e.markers)||Ri.empty},initialSpacer(){return new Sa(e,!1)},domEventHandlers:Object.assign(Object.assign({},o),{click:(t,e,i)=>{if(o.click&&o.click(t,e,i))return!0;let n=ca(t.state,e.from,e.to);if(n)return t.dispatch({effects:la.of(n)}),!0;let s=sa(t.state,e.from,e.to);return!!s&&(t.dispatch({effects:ra.of(s)}),!0)}})}),Oa()]}()),!1!==t.drawSelection&&n.push(function(t={}){return[Tx.of(t),Dx,Rx,Bx,ey.of(!0)]}()),!1!==t.dropCursor&&n.push([$x,_x]),!1!==t.allowMultipleSelections&&n.push(Ci.allowMultipleSelections.of(!0)),!1!==t.indentOnInput&&n.push(Ci.transactionFilter.of((t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let i=t.newDoc,{head:n}=t.newSelection.main,s=i.lineAt(n);if(n>s.from+200)return t;let o=i.sliceString(s.from,n);if(!e.some((t=>t.test(o))))return t;let{state:r}=t,l=-1,a=[];for(let{head:t}of r.selection.ranges){let e=r.doc.lineAt(t);if(e.from==l)continue;l=e.from;let i=zl(r,e.from);if(null==i)continue;let n=/^\s*/.exec(e.text)[0],s=Fl(r,i);n!=s&&a.push({from:e.from,to:e.from+n.length,insert:s})}return a.length?[t,{changes:a,sequential:!0}]:t}))),!1!==t.syntaxHighlighting&&n.push(Ta(Ea,{fallback:!0})),!1!==t.bracketMatching&&n.push(function(t={}){return[Ba.of(t),Na]}()),!1!==t.closeBrackets&&n.push([Rv,Av]),!1!==t.autocompletion&&n.push(function(t={}){return[ov,KO,QO.of(t),nv,qv,rv]}()),!1!==t.rectangularSelection&&n.push(function(){let t=t=>t.altKey&&0==t.button;return ax.mouseSelectionStyle.of(((e,i)=>t(i)?function(t,e){let i=Gx(t,e),n=t.state.selection;return i?{update(t){if(t.docChanged){let e=t.changes.mapPos(t.startState.doc.line(i.line).from),s=t.state.doc.lineAt(e);i={line:s.number,col:i.col,off:Math.min(i.off,s.length)},n=n.map(t.changes)}},get(e,s,o){let r=Gx(t,e);if(!r)return n;let l=function(t,e,i){let n=Math.min(e.line,i.line),s=Math.max(e.line,i.line),o=[];if(e.off>Kx||i.off>Kx||e.col<0||i.col<0){let r=Math.min(e.off,i.off),l=Math.max(e.off,i.off);for(let e=n;e<=s;e++){let i=t.doc.line(e);i.length<=l&&o.push(We.range(i.from+r,i.to+l))}}else{let r=Math.min(e.col,i.col),l=Math.max(e.col,i.col);for(let e=n;e<=s;e++){let i=t.doc.line(e),n=Ii(i.text,r,t.tabSize,!0);if(n<0)o.push(We.cursor(i.to));else{let e=Ii(i.text,l,t.tabSize);o.push(We.range(i.from+n,i.from+e))}}}return o}(t.state,i,r);return l.length?o?We.create(l.concat(n.ranges)):We.create(l):n}}:null}(e,i):null))}()),!1!==e&&n.push(function(t={}){let[e,i]=Jx[t.key||"Alt"],n=cy.fromClass(class{constructor(t){this.view=t,this.isDown=!1}set(t){this.isDown!=t&&(this.isDown=t,this.view.update([]))}},{eventObservers:{keydown(t){this.set(t.keyCode==e||i(t))},keyup(t){t.keyCode!=e&&i(t)||this.set(!1)},mousemove(t){this.set(i(t))}}});return[n,ax.contentAttributes.of((t=>{var e;return(null===(e=t.plugin(n))||void 0===e?void 0:e.isDown)?tk:null}))]}()),!1!==t.highlightActiveLine&&n.push(Yx),!1!==t.highlightSelectionMatches&&n.push(function(){let t=[BB,QB];return t}()),t.tabSize&&"number"==typeof t.tabSize&&n.push(Hl.of(" ".repeat(t.tabSize))),n.concat([mx.of(i.flat())]).filter(Boolean)};function cW(t){let e;return e=11==t.nodeType?t.getSelection?t:t.ownerDocument:t,e.getSelection()}function dW(t,e){return!!e&&(t==e||t.contains(1!=e.nodeType?e.parentNode:e))}function uW(t,e){if(!e.anchorNode)return!1;try{return dW(t,e.anchorNode)}catch(t){return!1}}function fW(t){return 3==t.nodeType?CW(t,0,t.nodeValue.length).getClientRects():1==t.nodeType?t.getClientRects():[]}function pW(t,e,i,n){return!!i&&(OW(t,e,i,n,-1)||OW(t,e,i,n,1))}function gW(t){for(var e=0;;e++)if(!(t=t.previousSibling))return e}function mW(t){return 1==t.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function OW(t,e,i,n,s){for(;;){if(t==i&&e==n)return!0;if(e==(s<0?0:vW(t))){if("DIV"==t.nodeName)return!1;let i=t.parentNode;if(!i||1!=i.nodeType)return!1;e=gW(t)+(s<0?0:1),t=i}else{if(1!=t.nodeType)return!1;if(1==(t=t.childNodes[e+(s<0?-1:0)]).nodeType&&"false"==t.contentEditable)return!1;e=s<0?vW(t):0}}}function vW(t){return 3==t.nodeType?t.nodeValue.length:t.childNodes.length}function wW(t,e){let i=e?t.left:t.right;return{left:i,right:i,top:t.top,bottom:t.bottom}}function bW(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function yW(t,e){let i=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(e.width-t.offsetWidth)<1)&&(i=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:i,scaleY:n}}class SW{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:e,focusNode:i}=t;this.set(e,Math.min(t.anchorOffset,e?vW(e):0),i,Math.min(t.focusOffset,i?vW(i):0))}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let xW,kW=null;function MW(t){if(t.setActive)return t.setActive();if(kW)return t.focus(kW);let e=[];for(let i=t;i&&(e.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(t.focus(null==kW?{get preventScroll(){return kW={preventScroll:!0},!0}}:void 0),!kW){kW=!1;for(let t=0;t<e.length;){let i=e[t++],n=e[t++],s=e[t++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=s&&(i.scrollLeft=s)}}}function CW(t,e,i=e){let n=xW||(xW=document.createRange());return n.setEnd(t,i),n.setStart(t,e),n}function AW(t,e,i,n){let s={key:e,code:e,keyCode:i,which:i,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let o=new KeyboardEvent("keydown",s);o.synthetic=!0,t.dispatchEvent(o);let r=new KeyboardEvent("keyup",s);return r.synthetic=!0,t.dispatchEvent(r),o.defaultPrevented||r.defaultPrevented}function TW(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function PW(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function DW(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n>0)return{node:i,offset:n};if(1==i.nodeType&&n>0){if("false"==i.contentEditable)return null;i=i.childNodes[n-1],n=vW(i)}else{if(!i.parentNode||mW(i))return null;n=gW(i),i=i.parentNode}}}function EW(t,e){for(let i=t,n=e;;){if(3==i.nodeType&&n<i.nodeValue.length)return{node:i,offset:n};if(1==i.nodeType&&n<i.childNodes.length){if("false"==i.contentEditable)return null;i=i.childNodes[n],n=0}else{if(!i.parentNode||mW(i))return null;n=gW(i)+1,i=i.parentNode}}}class RW{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new RW(t.parentNode,gW(t),e)}static after(t,e){return new RW(t.parentNode,gW(t)+1,e)}}const QW=[];class BW{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,e){if(2&this.flags){let i,n=this.dom,s=null;for(let o of this.children){if(7&o.flags){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let t=BW.get(i);(!t||!t.parent&&t.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(t,e),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,e&&!e.written&&e.node==n&&i!=o.dom&&(e.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=LW(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&e&&e.node==n&&(e.written=!0);i;)i=LW(i)}else if(1&this.flags)for(let i of this.children)7&i.flags&&(i.sync(t,e),i.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=0==vW(t)?0:0==e?-1:1;for(;;){let e=t.parentNode;if(e==this.dom)break;0==n&&e.firstChild!=e.lastChild&&(n=t==e.firstChild?-1:1),t=e}i=n<0?t:t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!BW.get(i);)i=i.nextSibling;if(!i)return this.length;for(let t=0,e=0;;t++){let n=this.children[t];if(n.dom==i)return e;e+=n.length+n.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,s=-1,o=-1,r=-1;for(let l=0,a=i,h=i;l<this.children.length;l++){let i=this.children[l],c=a+i.length;if(a<t&&c>e)return i.domBoundsAround(t,e,a);if(c>=t&&-1==n&&(n=l,s=a),a>e&&i.dom.parentNode==this.dom){o=l,r=h;break}h=c,a=c+i.breakAfter}return{from:s,to:r<0?i+this.length:r,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.flags|=2),1&e.flags)return;e.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,7&this.flags&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=QW){this.markDirty();for(let n=t;n<e;n++){let t=this.children[n];t.parent==this&&i.indexOf(t)<0&&t.destroy()}i.length<250?this.children.splice(t,e-t,...i):this.children=[].concat(this.children.slice(0,t),i,this.children.slice(e));for(let t=0;t<i.length;t++)i[t].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new $W(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==t?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,e,i,n,s,o){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!(8&(this.flags|t.flags))}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}function LW(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}BW.prototype.breakAfter=0;class $W{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function _W(t,e,i,n,s,o,r,l,a){let{children:h}=t,c=h.length?h[e]:null,d=o.length?o[o.length-1]:null,u=d?d.breakAfter:r;if(!(e==n&&c&&!r&&!u&&o.length<2&&c.merge(i,s,o.length?d:null,0==i,l,a))){if(n<h.length){let t=h[n];t&&(s<t.length||t.breakAfter&&(null==d?void 0:d.breakAfter))?(e==n&&(t=t.split(s),s=0),!u&&d&&t.merge(0,s,d,!0,0,a)?o[o.length-1]=t:((s||t.children.length&&!t.children[0].length)&&t.merge(0,s,null,!1,0,a),o.push(t))):(null==t?void 0:t.breakAfter)&&(d?d.breakAfter=1:r=1),n++}for(c&&(c.breakAfter=r,i>0&&(!r&&o.length&&c.merge(i,c.length,o[0],!1,l,0)?c.breakAfter=o.shift().breakAfter:(i<c.length||c.children.length&&0==c.children[c.children.length-1].length)&&c.merge(i,c.length,null,!1,l,0),e++));e<n&&o.length;)if(h[n-1].become(o[o.length-1]))n--,o.pop(),a=o.length?0:l;else{if(!h[e].become(o[0]))break;e++,o.shift(),l=o.length?0:a}!o.length&&e&&n<h.length&&!h[e-1].breakAfter&&h[n].merge(0,0,h[e-1],!1,l,a)&&e--,(e<n||o.length)&&t.replaceChildren(e,n,o)}}function VW(t,e,i,n,s,o){let r=t.childCursor(),{i:l,off:a}=r.findPos(i,1),{i:h,off:c}=r.findPos(e,-1),d=e-i;for(let t of n)d+=t.length;t.length+=d,_W(t,h,c,l,a,n,0,s,o)}let NW="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},WW="undefined"!=typeof document?document:{documentElement:{style:{}}};const HW=/Edge\/(\d+)/.exec(NW.userAgent),qW=/MSIE \d/.test(NW.userAgent),FW=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(NW.userAgent),zW=!!(qW||FW||HW),IW=!zW&&/gecko\/(\d+)/i.test(NW.userAgent),ZW=!zW&&/Chrome\/(\d+)/.exec(NW.userAgent),XW="webkitFontSmoothing"in WW.documentElement.style,jW=!zW&&/Apple Computer/.test(NW.vendor),YW=jW&&(/Mobile\/\w+/.test(NW.userAgent)||NW.maxTouchPoints>2);var UW={mac:YW||/Mac/.test(NW.platform),windows:/Win/.test(NW.platform),linux:/Linux|X11/.test(NW.platform),ie:zW,ie_version:qW?WW.documentMode||6:FW?+FW[1]:HW?+HW[1]:0,gecko:IW,gecko_version:IW?+(/Firefox\/(\d+)/.exec(NW.userAgent)||[0,0])[1]:0,chrome:!!ZW,chrome_version:ZW?+ZW[1]:0,ios:YW,android:/Android\b/.test(NW.userAgent),webkit:XW,safari:jW,webkit_version:XW?+(/\bAppleWebKit\/(\d+)/.exec(NW.userAgent)||[0,0])[1]:0,tabSize:null!=WW.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};class KW extends BW{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,e){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(e&&e.node==this.dom&&(e.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){3==t.nodeType&&this.createDOM(t)}merge(t,e,i){return!(8&this.flags||i&&(!(i instanceof KW)||this.length-(e-t)+i.length>256||8&i.flags)||(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),0))}split(t){let e=new KW(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e.flags|=8&this.flags,e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new RW(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return function(t,e,i){let n=t.nodeValue.length;e>n&&(e=n);let s=e,o=e,r=0;0==e&&i<0||e==n&&i>=0?UW.chrome||UW.gecko||(e?(s--,r=1):o<n&&(o++,r=-1)):i<0?s--:o<n&&o++;let l=CW(t,s,o).getClientRects();if(!l.length)return null;let a=l[(r?r<0:i>=0)?0:l.length-1];return UW.safari&&!r&&0==a.width&&(a=Array.prototype.find.call(l,(t=>t.width))||a),r?wW(a,r<0):a||null}(this.dom,t,e)}}class GW extends BW{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let t of e)t.setParent(this)}setAttrs(t){if(TW(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!(8&(this.flags|t.flags))}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,e){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,e)}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof GW&&i.mark.eq(this.mark))||t&&s<=0||e<this.length&&o<=0)||(VW(this,t,e,i?i.children.slice():[],s-1,o-1),this.markDirty(),0))}split(t){let e=[],i=0,n=-1,s=0;for(let o of this.children){let r=i+o.length;r>t&&e.push(i<t?o.split(t-i):o),n<0&&i>=t&&(n=s),i=r,s++}let o=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new GW(this.mark,e,o)}domAtPos(t){return eH(this,t)}coordsAt(t,e){return nH(this,t,e)}}class JW extends BW{static create(t,e,i){return new JW(t,e,i)}constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}split(t){let e=JW.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof JW&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}become(t){return t instanceof JW&&t.side==this.side&&this.widget.constructor==t.widget.constructor&&(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(0==this.length)return ge.empty;let t=this;for(;t.parent;)t=t.parent;let{view:e}=t,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):ge.empty}domAtPos(t){return(this.length?0==t:this.side>0)?RW.before(this.dom):RW.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.widget.coordsAt(this.dom,t,e);if(i)return i;let n=this.dom.getClientRects(),s=null;if(!n.length)return null;let o=this.side?this.side<0:t>0;for(let e=o?n.length-1:0;s=n[e],!(t>0?0==e:e==n.length-1||s.top<s.bottom);e+=o?-1:1);return wW(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class tH extends BW{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof tH&&t.side==this.side}split(){return new tH(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?RW.before(this.dom):RW.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return ge.empty}get isHidden(){return!0}}function eH(t,e){let i=t.dom,{children:n}=t,s=0;for(let t=0;s<n.length;s++){let o=n[s],r=t+o.length;if(!(r==t&&o.getSide()<=0)){if(e>t&&e<r&&o.dom.parentNode==i)return o.domAtPos(e-t);if(e<=t)break;t=r}}for(let t=s;t>0;t--){let e=n[t-1];if(e.dom.parentNode==i)return e.domAtPos(e.length)}for(let t=s;t<n.length;t++){let e=n[t];if(e.dom.parentNode==i)return e.domAtPos(0)}return new RW(i,0)}function iH(t,e,i){let n,{children:s}=t;i>0&&e instanceof GW&&s.length&&(n=s[s.length-1])instanceof GW&&n.mark.eq(e.mark)?iH(n,e.children[0],i-1):(s.push(e),e.setParent(t)),t.length+=e.length}function nH(t,e,i){let n=null,s=-1,o=null,r=-1;!function t(e,l){for(let a=0,h=0;a<e.children.length&&h<=l;a++){let c=e.children[a],d=h+c.length;d>=l&&(c.children.length?t(c,l-h):(!o||o.isHidden&&(i>0||sH(o,c)))&&(d>l||h==d&&c.getSide()>0)?(o=c,r=l-h):(h<l||h==d&&c.getSide()<0&&!c.isHidden)&&(n=c,s=l-h)),h=d}}(t,e);let l=(i<0?n:o)||n||o;return l?l.coordsAt(Math.max(0,l==n?s:r),i):function(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let i=fW(e);return i[i.length-1]||null}(t)}function sH(t,e){let i=t.coordsAt(0,1),n=e.coordsAt(0,1);return i&&n&&n.top<i.bottom}function oH(t,e){for(let i in t)"class"==i&&e.class?e.class+=" "+t.class:"style"==i&&e.style?e.style+=";"+t.style:e[i]=t[i];return e}KW.prototype.children=JW.prototype.children=tH.prototype.children=QW;const rH=Object.create(null);function lH(t,e,i){if(t==e)return!0;t||(t=rH),e||(e=rH);let n=Object.keys(t),s=Object.keys(e);if(n.length-(i&&n.indexOf(i)>-1?1:0)!=s.length-(i&&s.indexOf(i)>-1?1:0))return!1;for(let o of n)if(o!=i&&(-1==s.indexOf(o)||t[o]!==e[o]))return!1;return!0}function aH(t,e,i){let n=!1;if(e)for(let s in e)i&&s in i||(n=!0,"style"==s?t.style.cssText="":t.removeAttribute(s));if(i)for(let s in i)e&&e[s]==i[s]||(n=!0,"style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n}function hH(t){let e=Object.create(null);for(let i=0;i<t.attributes.length;i++){let n=t.attributes[i];e[n.name]=n.value}return e}class cH{eq(t){return!1}updateDOM(t,e){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,e,i){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}var dH=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(dH||(dH={}));class uH extends Ti{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new fH(t)}static widget(t){let e=Math.max(-1e4,Math.min(1e4,t.side||0)),i=!!t.block;return e+=i&&!t.inlineOrder?e>0?3e8:-4e8:e>0?1e8:-1e8,new gH(t,e,e,i,t.widget||null,!1)}static replace(t){let e,i,n=!!t.block;if(t.isBlockGap)e=-5e8,i=4e8;else{let{start:s,end:o}=mH(t,n);e=(s?n?-3e8:-1:5e8)-1,i=1+(o?n?2e8:1:-6e8)}return new gH(t,e,i,n,t.widget||null,!0)}static line(t){return new pH(t)}static set(t,e=!1){return Ri.of(t,e)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}uH.none=Ri.empty;class fH extends uH{constructor(t){let{start:e,end:i}=mH(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var e,i;return this==t||t instanceof fH&&this.tagName==t.tagName&&(this.class||(null===(e=this.attrs)||void 0===e?void 0:e.class))==(t.class||(null===(i=t.attrs)||void 0===i?void 0:i.class))&&lH(this.attrs,t.attrs,"class")}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}fH.prototype.point=!1;class pH extends uH{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof pH&&this.spec.class==t.spec.class&&lH(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}pH.prototype.mapMode=De.TrackBefore,pH.prototype.point=!0;class gH extends uH{constructor(t,e,i,n,s,o){super(e,i,s,t),this.block=n,this.isReplace=o,this.mapMode=n?e<=0?De.TrackBefore:De.TrackAfter:De.TrackDel}get type(){return this.startSide!=this.endSide?dH.WidgetRange:this.startSide<=0?dH.WidgetBefore:dH.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof gH&&((e=this.widget)==(i=t.widget)||!!(e&&i&&e.compare(i)))&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide;var e,i}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}function mH(t,e=!1){let{inclusiveStart:i,inclusiveEnd:n}=t;return null==i&&(i=t.inclusive),null==n&&(n=t.inclusive),{start:null!=i?i:e,end:null!=n?n:e}}function OH(t,e,i,n=0){let s=i.length-1;s>=0&&i[s]+n>=t?i[s]=Math.max(i[s],e):i.push(t,e)}gH.prototype.point=!0;class vH extends BW{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,s,o){if(i){if(!(i instanceof vH))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),VW(this,t,e,i?i.children.slice():[],s,o),!0}split(t){let e=new vH;if(e.breakAfter=this.breakAfter,0==this.length)return e;let{i:i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let t=i;t<this.children.length;t++)e.append(this.children[t],0);for(;i>0&&0==this.children[i-1].length;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){lH(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){iH(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=oH(e,this.attrs||{})),i&&(this.attrs=oH({class:i},this.attrs||{}))}domAtPos(t){return eH(this,t)}reuseDOM(t){"DIV"==t.nodeName&&(this.setDOM(t),this.flags|=6)}sync(t,e){var i;this.dom?4&this.flags&&(TW(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(aH(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,e);let n=this.dom.lastChild;for(;n&&BW.get(n)instanceof GW;)n=n.lastChild;if(!(n&&this.length&&("BR"==n.nodeName||0!=(null===(i=BW.get(n))||void 0===i?void 0:i.isEditable)||UW.ios&&this.children.some((t=>t instanceof KW))))){let t=document.createElement("BR");t.cmIgnore=!0,this.dom.appendChild(t)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let t,e=0;for(let i of this.children){if(!(i instanceof KW)||/[^ -~]/.test(i.text))return null;let n=fW(i.dom);if(1!=n.length)return null;e+=n[0].width,t=n[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(t,e){let i=nH(this,t,e);if(!this.children.length&&i&&this.parent){let{heightOracle:t}=this.parent.view.viewState,e=i.bottom-i.top;if(Math.abs(e-t.lineHeight)<2&&t.textHeight<e){let n=(e-t.textHeight)/2;return{top:i.top+n,bottom:i.bottom-n,left:i.left,right:i.left}}}return i}become(t){return t instanceof vH&&0==this.children.length&&0==t.children.length&&lH(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let s=t.children[i],o=n+s.length;if(o>=e){if(s instanceof vH)return s;if(o>e)break}n=o+s.breakAfter}return null}}class wH extends BW{constructor(t,e,i){super(),this.widget=t,this.length=e,this.deco=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,s,o){return!(i&&(!(i instanceof wH&&this.widget.compare(i.widget))||t>0&&s<=0||e<this.length&&o<=0)||(this.length=t+(i?i.length:0)+(this.length-e),0))}domAtPos(t){return 0==t?RW.before(this.dom):RW.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new wH(this.widget,e,this.deco);return i.breakAfter=this.breakAfter,i}get children(){return QW}sync(t){this.dom&&this.widget.updateDOM(this.dom,t)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):ge.empty}domBoundsAround(){return null}become(t){return t instanceof wH&&t.widget.constructor==this.widget.constructor&&(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,e){return this.widget.coordsAt(this.dom,t,e)||(this.widget instanceof bH?null:wW(this.dom.getBoundingClientRect(),this.length?0==t:e<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:e,endSide:i}=this.deco;return e!=i&&(t<0?e<0:i>0)}}class bH extends cH{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class yH{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof wH&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new vH),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(SH(new tH(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||t&&this.content.length&&this.content[this.content.length-1]instanceof wH||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:e,lineBreak:i,done:n}=this.cursor.next(this.skip);if(this.skip=0,n)throw new Error("Ran out of text content when drawing inline views");if(i){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}this.text=e,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(SH(new KW(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,s,o){if(this.disallowBlockEffectsFor[o]&&i instanceof gH){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let r=e-t;if(i instanceof gH)if(i.block)i.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new wH(i.widget||xH.block,r,i));else{let o=JW.create(i.widget||xH.inline,r,r?0:i.startSide),l=this.atCursorPos&&!o.isEditable&&s<=n.length&&(t<e||i.startSide>0),a=!o.isEditable&&(t<e||s>n.length||i.startSide<=0),h=this.getLine();2!=this.pendingBuffer||l||o.isEditable||(this.pendingBuffer=0),this.flushBuffer(n),l&&(h.append(SH(new tH(1),n),s),s=n.length+Math.max(0,s-n.length)),h.append(SH(o,n),s),this.atCursorPos=a,this.pendingBuffer=a?t<e||s>n.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=n.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);r&&(this.textOff+r<=this.text.length?this.textOff+=r:(this.skip+=r-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=s)}static build(t,e,i,n,s){let o=new yH(t,e,i,s);return o.openEnd=Ri.spans(n,e,i,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function SH(t,e){for(let i of e)t=new GW(i,[t],t.length);return t}class xH extends cH{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}xH.inline=new xH("span"),xH.block=new xH("div");var kH=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(kH||(kH={}));const MH=kH.LTR,CH=kH.RTL;function AH(t){let e=[];for(let i=0;i<t.length;i++)e.push(1<<+t[i]);return e}const TH=AH("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),PH=AH("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),DH=Object.create(null),EH=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),i=t.charCodeAt(1);DH[e]=i,DH[i]=-e}function RH(t){return t<=247?TH[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?PH[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const QH=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BH{get dir(){return this.level%2?CH:MH}constructor(t,e,i){this.from=t,this.to=e,this.level=i}side(t,e){return this.dir==e==t?this.to:this.from}forward(t,e){return t==(this.dir==e)}static find(t,e,i,n){let s=-1;for(let o=0;o<t.length;o++){let r=t[o];if(r.from<=e&&r.to>=e){if(r.level==i)return o;(s<0||(0!=n?n<0?r.from<e:r.to>e:t[s].level>r.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function LH(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!LH(n.inner,s.inner))return!1}return!0}const $H=[];function _H(t,e,i,n,s,o,r){let l=n%2?2:1;if(n%2==s%2)for(let a=e,h=0;a<i;){let e=!0,c=!1;if(h==o.length||a<o[h].from){let t=$H[a];t!=l&&(e=!1,c=16==t)}let d=e||1!=l?null:[],u=e?n:n+1,f=a;t:for(;;)if(h<o.length&&f==o[h].from){if(c)break t;let p=o[h];if(!e)for(let t=p.to,e=h+1;;){if(t==i)break t;if(!(e<o.length&&o[e].from==t)){if($H[t]==l)break t;break}t=o[e++].to}h++,d?d.push(p):(p.from>a&&r.push(new BH(a,p.from,u)),VH(t,p.direction==MH!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.to),f=p.to}else{if(f==i||(e?$H[f]!=l:$H[f]==l))break;f++}d?_H(t,a,f,n+1,s,d,r):a<f&&r.push(new BH(a,f,u)),a=f}else for(let a=i,h=o.length;a>e;){let i=!0,c=!1;if(!h||a>o[h-1].to){let t=$H[a-1];t!=l&&(i=!1,c=16==t)}let d=i||1!=l?null:[],u=i?n:n+1,f=a;t:for(;;)if(h&&f==o[h-1].to){if(c)break t;let p=o[--h];if(!i)for(let t=p.from,i=h;;){if(t==e)break t;if(!i||o[i-1].to!=t){if($H[t-1]==l)break t;break}t=o[--i].from}d?d.push(p):(p.to<a&&r.push(new BH(p.to,a,u)),VH(t,p.direction==MH!=!(u%2)?n+1:n,s,p.inner,p.from,p.to,r),a=p.from),f=p.from}else{if(f==e||(i?$H[f-1]!=l:$H[f-1]==l))break;f--}d?_H(t,f,a,n+1,s,d,r):f<a&&r.push(new BH(f,a,u)),a=f}}function VH(t,e,i,n,s,o,r){let l=e%2?2:1;!function(t,e,i,n,s){for(let o=0;o<=n.length;o++){let r=o?n[o-1].to:e,l=o<n.length?n[o].from:i,a=o?256:s;for(let e=r,i=a,n=a;e<l;e++){let s=RH(t.charCodeAt(e));512==s?s=i:8==s&&4==n&&(s=16),$H[e]=4==s?2:s,7&s&&(n=s),i=s}for(let t=r,e=a,n=a;t<l;t++){let s=$H[t];if(128==s)t<l-1&&e==$H[t+1]&&24&e?s=$H[t]=e:$H[t]=256;else if(64==s){let s=t+1;for(;s<l&&64==$H[s];)s++;let o=t&&8==e||s<i&&8==$H[s]?1==n?1:8:256;for(let e=t;e<s;e++)$H[e]=o;t=s-1}else 8==s&&1==n&&($H[t]=1);e=s,7&s&&(n=s)}}}(t,s,o,n,l),function(t,e,i,n,s){let o=1==s?2:1;for(let r=0,l=0,a=0;r<=n.length;r++){let h=r?n[r-1].to:e,c=r<n.length?n[r].from:i;for(let e,i,n,r=h;r<c;r++)if(i=DH[e=t.charCodeAt(r)])if(i<0){for(let t=l-3;t>=0;t-=3)if(EH[t+1]==-i){let e=EH[t+2],i=2&e?s:4&e?1&e?o:s:0;i&&($H[r]=$H[EH[t]]=i),l=t;break}}else{if(189==EH.length)break;EH[l++]=r,EH[l++]=e,EH[l++]=a}else if(2==(n=$H[r])||1==n){let t=n==s;a=t?0:1;for(let e=l-3;e>=0;e-=3){let i=EH[e+2];if(2&i)break;if(t)EH[e+2]|=2;else{if(4&i)break;EH[e+2]|=4}}}}}(t,s,o,n,l),function(t,e,i,n){for(let s=0,o=n;s<=i.length;s++){let r=s?i[s-1].to:t,l=s<i.length?i[s].from:e;for(let a=r;a<l;){let r=$H[a];if(256==r){let r=a+1;for(;;)if(r==l){if(s==i.length)break;r=i[s++].to,l=s<i.length?i[s].from:e}else{if(256!=$H[r])break;r++}let h=1==o,c=h==(1==(r<e?$H[r]:n))?h?1:2:n;for(let e=r,n=s,o=n?i[n-1].to:t;e>a;)e==o&&(e=i[--n].from,o=n?i[n-1].to:t),$H[--e]=c;a=r}else o=r,a++}}}(s,o,n,l),_H(t,s,o,e,i,n,r)}function NH(t){return[new BH(0,t,0)]}let WH="";function HH(t,e,i,n,s){var o;let r=n.head-t.from,l=BH.find(e,r,null!==(o=n.bidiLevel)&&void 0!==o?o:-1,n.assoc),a=e[l],h=a.side(s,i);if(r==h){let t=l+=s?1:-1;if(t<0||t>=e.length)return null;a=e[l=t],r=a.side(!s,i),h=a.side(s,i)}let c=Me(t.text,r,a.forward(s,i));(c<a.from||c>a.to)&&(c=h),WH=t.text.slice(Math.min(r,c),Math.max(r,c));let d=l==(s?e.length-1:0)?null:e[l+(s?1:-1)];return d&&c==h&&d.level+(s?0:1)<a.level?We.cursor(d.side(!s,i)+t.from,d.forward(s,i)?1:-1,d.level):We.cursor(c+t.from,a.forward(s,i)?-1:1,a.level)}function qH(t,e,i){for(let n=e;n<i;n++){let e=RH(t.charCodeAt(n));if(1==e)return MH;if(2==e||4==e)return CH}return MH}const FH=Fe.define(),zH=Fe.define(),IH=Fe.define(),ZH=Fe.define(),XH=Fe.define(),jH=Fe.define(),YH=Fe.define(),UH=Fe.define(),KH=Fe.define(),GH=Fe.define({combine:t=>t.some((t=>t))}),JH=Fe.define({combine:t=>t.some((t=>t))}),tq=Fe.define();class eq{constructor(t,e="nearest",i="nearest",n=5,s=5,o=!1){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=s,this.isSnapshot=o}map(t){return t.empty?this:new eq(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new eq(We.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const iq=gi.define({map:(t,e)=>t.map(e)}),nq=gi.define();function sq(t,e,i){let n=t.facet(ZH);n.length?n[0](e):window.onerror&&window.onerror(String(e),i,void 0,void 0,e)||(i?console.error(i+":",e):console.error(e))}const oq=Fe.define({combine:t=>!t.length||t[0]});let rq=0;const lq=Fe.define();class aq{constructor(t,e,i,n,s){this.id=t,this.create=e,this.domEventHandlers=i,this.domEventObservers=n,this.extension=s(this)}static define(t,e){const{eventHandlers:i,eventObservers:n,provide:s,decorations:o}=e||{};return new aq(rq++,t,i,n,(t=>{let e=[lq.of(t)];return o&&e.push(uq.of((e=>{let i=e.plugin(t);return i?o(i):uH.none}))),s&&e.push(s(t)),e}))}static fromClass(t,e){return aq.define((e=>new t(e)),e)}}class hq{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(e){if(sq(t.state,e,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(t){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){sq(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(null===(e=this.value)||void 0===e?void 0:e.destroy)try{this.value.destroy()}catch(e){sq(t.state,e,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const cq=Fe.define(),dq=Fe.define(),uq=Fe.define(),fq=Fe.define(),pq=Fe.define(),gq=Fe.define();function mq(t,e){let i=t.state.facet(gq);if(!i.length)return i;let n=i.map((e=>e instanceof Function?e(t):e)),s=[];return Ri.spans(n,e.from,e.to,{point(){},span(t,i,n,o){let r=t-e.from,l=i-e.from,a=s;for(let t=n.length-1;t>=0;t--,o--){let i,s=n[t].spec.bidiIsolate;if(null==s&&(s=qH(e.text,r,l)),o>0&&a.length&&(i=a[a.length-1]).to==r&&i.direction==s)i.to=l,a=i.inner;else{let t={from:r,to:l,direction:s,inner:[]};a.push(t),a=t.inner}}}}),s}const Oq=Fe.define();function vq(t){let e=0,i=0,n=0,s=0;for(let o of t.state.facet(Oq)){let r=o(t);r&&(null!=r.left&&(e=Math.max(e,r.left)),null!=r.right&&(i=Math.max(i,r.right)),null!=r.top&&(n=Math.max(n,r.top)),null!=r.bottom&&(s=Math.max(s,r.bottom)))}return{left:e,right:i,top:n,bottom:s}}const wq=Fe.define();class bq{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new bq(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(0==e.length)return t;let i=[];for(let n=0,s=0,o=0,r=0;;n++){let l=n==t.length?null:t[n],a=o-r,h=l?l.fromB:1e9;for(;s<e.length&&e[s]<h;){let t=e[s],n=e[s+1],o=Math.max(r,t),l=Math.min(h,n);if(o<=l&&new bq(o+a,l+a,o,l).addToSet(i),n>h)break;s+=2}if(!l)return i;new bq(l.fromA,l.toA,l.fromB,l.toB).addToSet(i),o=l.toA,r=l.toB}}}class yq{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=Re.empty(this.startState.doc.length);for(let t of i)this.changes=this.changes.compose(t.changes);let n=[];this.changes.iterChangedRanges(((t,e,i,s)=>n.push(new bq(t,e,i,s)))),this.changedRanges=n}static create(t,e,i){return new yq(t,e,i)}get viewportChanged(){return(4&this.flags)>0}get viewportMoved(){return(8&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(18&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((t=>t.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class Sq extends BW{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=uH.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new vH],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new bq(0,0,0,t.state.doc.length)],0,null)}update(t){var e;let i=t.changedRanges;this.minWidth>0&&i.length&&(i.every((({fromA:t,toA:e})=>e<this.minWidthFrom||t>this.minWidthTo))?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let n=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&((null===(e=this.domChanged)||void 0===e?void 0:e.newSel)?n=this.domChanged.newSel.head:function(t,e){let i=!1;return e&&t.iterChangedRanges(((t,n)=>{t<e.to&&n>e.from&&(i=!0)})),i}(t.changes,this.hasComposition)||t.selectionSet||(n=t.state.selection.main.head));let s=n>-1?function(t,e,i){let n=xq(t,i);if(!n)return null;let{node:s,from:o,to:r}=n,l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(t.state.doc.sliceString(n.from,n.to)!=l)return null;let a=e.invertedDesc,h=new bq(a.mapPos(o),a.mapPos(r),o,r),c=[];for(let e=s.parentNode;;e=e.parentNode){let i=BW.get(e);if(i instanceof GW)c.push({node:e,deco:i.mark});else{if(i instanceof vH||"DIV"==e.nodeName&&e.parentNode==t.contentDOM)return{range:h,text:s,marks:c,line:e};if(e==t.contentDOM)return null;c.push({node:e,deco:new fH({inclusive:!0,attributes:hH(e),tagName:e.tagName.toLowerCase()})})}}}(this.view,t.changes,n):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:e,to:n}=this.hasComposition;i=new bq(e,n,t.changes.mapPos(e,-1),t.changes.mapPos(n,1)).addToSet(i.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(UW.ie||UW.chrome)&&!s&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let o=function(t,e,i){let n=new kq;return Ri.compare(t,e,i,n),n.changes}(this.decorations,this.updateDeco(),t.changes);return i=bq.extendWithRanges(i,o),!!(7&this.flags||0!=i.length)&&(this.updateInner(i,t.startState.doc.length,s),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e,i){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e,i);let{observer:n}=this.view;n.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let t=UW.chrome||UW.ios?{node:n.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,t),this.flags&=-8,t&&(t.written||n.selectionRange.focusNode!=t.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((t=>t.flags&=-9));let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let t of this.children)t instanceof wH&&t.widget instanceof bH&&s.push(t.dom);n.updateGaps(s)}updateChildren(t,e,i){let n=i?i.range.addToSet(t.slice()):t,s=this.childCursor(e);for(let t=n.length-1;;t--){let e=t>=0?n[t]:null;if(!e)break;let o,r,l,a,{fromA:h,toA:c,fromB:d,toB:u}=e;if(i&&i.range.fromB<u&&i.range.toB>d){let t=yH.build(this.view.state.doc,d,i.range.fromB,this.decorations,this.dynamicDecorationMap),e=yH.build(this.view.state.doc,i.range.toB,u,this.decorations,this.dynamicDecorationMap);r=t.breakAtStart,l=t.openStart,a=e.openEnd;let n=this.compositionView(i);e.breakAtStart?n.breakAfter=1:e.content.length&&n.merge(n.length,n.length,e.content[0],!1,e.openStart,0)&&(n.breakAfter=e.content[0].breakAfter,e.content.shift()),t.content.length&&n.merge(0,0,t.content[t.content.length-1],!0,0,t.openEnd)&&t.content.pop(),o=t.content.concat(n).concat(e.content)}else({content:o,breakAtStart:r,openStart:l,openEnd:a}=yH.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:f,off:p}=s.findPos(c,1),{i:g,off:m}=s.findPos(h,-1);_W(this,g,m,f,p,o,r,l,a)}i&&this.fixCompositionDOM(i)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let e of t.transactions)for(let t of e.effects)t.is(nq)&&(this.editContextFormatting=t.value)}compositionView(t){let e=new KW(t.text.nodeValue);e.flags|=8;for(let{deco:i}of t.marks)e=new GW(i,[e],e.length);let i=new vH;return i.append(e,0),i}fixCompositionDOM(t){let e=(t,e)=>{e.flags|=8|(e.children.some((t=>7&t.flags))?1:0),this.markedForComposition.add(e);let i=BW.get(t);i&&i!=e&&(i.dom=null),e.setDOM(t)},i=this.childPos(t.range.fromB,1),n=this.children[i.i];e(t.line,n);for(let s=t.marks.length-1;s>=-1;s--)i=n.childPos(i.off,1),n=n.children[i.i],e(s>=0?t.marks[s].node:t.text,n)}updateSelection(t=!1,e=!1){!t&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let i=this.view.root.activeElement,n=i==this.dom,s=!n&&!(this.view.state.facet(oq)||this.dom.tabIndex>-1)&&uW(this.dom,this.view.observer.selectionRange)&&!(i&&this.dom.contains(i));if(!(n||e||s))return;let o=this.forceSelection;this.forceSelection=!1;let r=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(r.anchor)),a=r.empty?l:this.moveToLine(this.domAtPos(r.head));if(UW.gecko&&r.empty&&!this.hasComposition&&1==(h=l).node.nodeType&&h.node.firstChild&&(0==h.offset||"false"==h.node.childNodes[h.offset-1].contentEditable)&&(h.offset==h.node.childNodes.length||"false"==h.node.childNodes[h.offset].contentEditable)){let t=document.createTextNode("");this.view.observer.ignore((()=>l.node.insertBefore(t,l.node.childNodes[l.offset]||null))),l=a=new RW(t,0),o=!0}var h;let c=this.view.observer.selectionRange;!o&&c.focusNode&&(pW(l.node,l.offset,c.anchorNode,c.anchorOffset)&&pW(a.node,a.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,r))||(this.view.observer.ignore((()=>{UW.android&&UW.chrome&&this.dom.contains(c.focusNode)&&function(t,e){for(let i=t;i&&i!=e;i=i.assignedSlot||i.parentNode)if(1==i.nodeType&&"false"==i.contentEditable)return!0;return!1}(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let t=cW(this.view.root);if(t)if(r.empty){if(UW.gecko){let t=(e=l.node,n=l.offset,1!=e.nodeType?0:(n&&"false"==e.childNodes[n-1].contentEditable?1:0)|(n<e.childNodes.length&&"false"==e.childNodes[n].contentEditable?2:0));if(t&&3!=t){let e=(1==t?DW:EW)(l.node,l.offset);e&&(l=new RW(e.node,e.offset))}}t.collapse(l.node,l.offset),null!=r.bidiLevel&&void 0!==t.caretBidiLevel&&(t.caretBidiLevel=r.bidiLevel)}else if(t.extend){t.collapse(l.node,l.offset);try{t.extend(a.node,a.offset)}catch(t){}}else{let e=document.createRange();r.anchor>r.head&&([l,a]=[a,l]),e.setEnd(a.node,a.offset),e.setStart(l.node,l.offset),t.removeAllRanges(),t.addRange(e)}var e,n;s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),i&&i.focus())})),this.view.observer.setSelectionRange(l,a)),this.impreciseAnchor=l.precise?null:new RW(c.anchorNode,c.anchorOffset),this.impreciseHead=a.precise?null:new RW(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(t,e){return this.hasComposition&&e.empty&&pW(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==e.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,e=t.state.selection.main,i=cW(t.root),{anchorNode:n,anchorOffset:s}=t.observer.selectionRange;if(!(i&&e.empty&&e.assoc&&i.modify))return;let o=vH.find(this,e.head);if(!o)return;let r=o.posAtStart;if(e.head==r||e.head==r+o.length)return;let l=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!l||!a||l.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let c=t.observer.selectionRange;t.docView.posFromDOM(c.anchorNode,c.anchorOffset)!=e.from&&i.collapse(n,s)}moveToLine(t){let e,i=this.dom;if(t.node!=i)return t;for(let n=t.offset;!e&&n<i.childNodes.length;n++){let t=BW.get(i.childNodes[n]);t instanceof vH&&(e=t.domAtPos(0))}for(let n=t.offset-1;!e&&n>=0;n--){let t=BW.get(i.childNodes[n]);t instanceof vH&&(e=t.domAtPos(t.length))}return e?new RW(e.node,e.offset,!0):t}nearest(t){for(let e=t;e;){let t=BW.get(e);if(t&&t.rootView==this)return t;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let t=this.children[e];if(i<t.length||t instanceof vH)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){let i=null,n=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let r=this.children[o],l=s-r.breakAfter,a=l-r.length;if(l<t)break;if(a<=t&&(a<t||r.covers(-1))&&(l>t||r.covers(1))&&(!i||r instanceof vH&&!(i instanceof vH&&e>=0)))i=r,n=a;else if(i&&a==t&&l==t&&r instanceof wH&&Math.abs(e)<2){if(r.deco.startSide<0)break;o&&(i=null)}s=a}return i?i.coordsAt(t-n,e):null}coordsForChar(t){let{i:e,off:i}=this.childPos(t,1),n=this.children[e];if(!(n instanceof vH))return null;for(;n.children.length;){let{i:t,off:e}=n.childPos(i,1);for(;;t++){if(t==n.children.length)return null;if((n=n.children[t]).length)break}i=e}if(!(n instanceof KW))return null;let s=Me(n.text,i);if(s==i)return null;let o=CW(n.dom,i,s).getClientRects();for(let t=0;t<o.length;t++){let e=o[t];if(t==o.length-1||e.top<e.bottom&&e.left<e.right)return e}return null}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,r=-1,l=this.view.textDirection==kH.LTR;for(let t=0,a=0;a<this.children.length;a++){let h=this.children[a],c=t+h.length;if(c>n)break;if(t>=i){let i=h.dom.getBoundingClientRect();if(e.push(i.height),o){let e=h.dom.lastChild,n=e?fW(e):[];if(n.length){let e=n[n.length-1],o=l?e.right-i.left:i.right-e.left;o>r&&(r=o,this.minWidth=s,this.minWidthFrom=t,this.minWidthTo=c)}}}t=c+h.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return"rtl"==getComputedStyle(this.children[e].dom).direction?kH.RTL:kH.LTR}measureTextSize(){for(let t of this.children)if(t instanceof vH){let e=t.measureTextSize();if(e)return e}let t,e,i,n=document.createElement("div");return n.className="cm-line",n.style.width="99999px",n.style.position="absolute",n.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(n);let s=fW(n.firstChild)[0];t=n.getBoundingClientRect().height,e=s?s.width/27:7,i=s?s.height:t,n.remove()})),{lineHeight:t,charWidth:e,textHeight:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new $W(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let s=n==e.viewports.length?null:e.viewports[n],o=s?s.from-1:this.length;if(o>i){let n=(e.lineBlockAt(o).bottom-e.lineBlockAt(i).top)/this.view.scaleY;t.push(uH.replace({widget:new bH(n),block:!0,inclusive:!0,isBlockGap:!0}).range(i,o))}if(!s)break;i=s.to+1}return uH.set(t)}updateDeco(){let t=1,e=this.view.state.facet(uq).map((e=>(this.dynamicDecorationMap[t++]="function"==typeof e)?e(this.view):e)),i=!1,n=this.view.state.facet(fq).map(((t,e)=>{let n="function"==typeof t;return n&&(i=!0),n?t(this.view):t}));for(n.length&&(this.dynamicDecorationMap[t++]=i,e.push(Ri.join(n))),this.decorations=[this.editContextFormatting,...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let e=this.view.viewState.lineBlockAt(t.range.head);return this.view.scrollDOM.scrollTop=e.top-t.yMargin,void(this.view.scrollDOM.scrollLeft=t.xMargin)}for(let e of this.view.state.facet(tq))try{if(e(this.view,t.range,t))return!0}catch(t){sq(this.view.state,t,"scroll handler")}let e,{range:i}=t,n=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1);if(!n)return;!i.empty&&(e=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(n={left:Math.min(n.left,e.left),top:Math.min(n.top,e.top),right:Math.max(n.right,e.right),bottom:Math.max(n.bottom,e.bottom)});let s=vq(this.view),o={left:n.left-s.left,top:n.top-s.top,right:n.right+s.right,bottom:n.bottom+s.bottom},{offsetWidth:r,offsetHeight:l}=this.view.scrollDOM;!function(t,e,i,n,s,o,r,l){let a=t.ownerDocument,h=a.defaultView||window;for(let c=t,d=!1;c&&!d;)if(1==c.nodeType){let t,u=c==a.body,f=1,p=1;if(u)t=bW(h);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let e=c.getBoundingClientRect();({scaleX:f,scaleY:p}=yW(c,e)),t={left:e.left,right:e.left+c.clientWidth*f,top:e.top,bottom:e.top+c.clientHeight*p}}let g=0,m=0;if("nearest"==s)e.top<t.top?(m=e.top-(t.top+r),i>0&&e.bottom>t.bottom+m&&(m=e.bottom-t.bottom+r)):e.bottom>t.bottom&&(m=e.bottom-t.bottom+r,i<0&&e.top-m<t.top&&(m=e.top-(t.top+r)));else{let n=e.bottom-e.top,o=t.bottom-t.top;m=("center"==s&&n<=o?e.top+n/2-o/2:"start"==s||"center"==s&&i<0?e.top-r:e.bottom-o+r)-t.top}if("nearest"==n?e.left<t.left?(g=e.left-(t.left+o),i>0&&e.right>t.right+g&&(g=e.right-t.right+o)):e.right>t.right&&(g=e.right-t.right+o,i<0&&e.left<t.left+g&&(g=e.left-(t.left+o))):g=("center"==n?e.left+(e.right-e.left)/2-(t.right-t.left)/2:"start"==n==l?e.left-o:e.right-(t.right-t.left)+o)-t.left,g||m)if(u)h.scrollBy(g,m);else{let t=0,i=0;if(m){let t=c.scrollTop;c.scrollTop+=m/p,i=(c.scrollTop-t)*p}if(g){let e=c.scrollLeft;c.scrollLeft+=g/f,t=(c.scrollLeft-e)*f}e={left:e.left-t,top:e.top-i,right:e.right-t,bottom:e.bottom-i},t&&Math.abs(t-g)<1&&(n="nearest"),i&&Math.abs(i-m)<1&&(s="nearest")}if(u)break;(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)&&(e={left:Math.max(e.left,t.left),right:Math.min(e.right,t.right),top:Math.max(e.top,t.top),bottom:Math.min(e.bottom,t.bottom)}),c=c.assignedSlot||c.parentNode}else{if(11!=c.nodeType)break;c=c.host}}(this.view.scrollDOM,o,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,r),-r),Math.max(Math.min(t.yMargin,l),-l),this.view.textDirection==kH.LTR)}}function xq(t,e){let i=t.observer.selectionRange;if(!i.focusNode)return null;let n=DW(i.focusNode,i.focusOffset),s=EW(i.focusNode,i.focusOffset),o=n||s;if(s&&n&&s.node!=n.node){let e=BW.get(s.node);if(!e||e instanceof KW&&e.text!=s.node.nodeValue)o=s;else if(t.docView.lastCompositionAfterCursor){let t=BW.get(n.node);!t||t instanceof KW&&t.text!=n.node.nodeValue||(o=s)}}if(t.docView.lastCompositionAfterCursor=o!=n,!o)return null;let r=e-o.offset;return{from:r,to:r+o.node.nodeValue.length,node:o.node}}let kq=class{constructor(){this.changes=[]}compareRange(t,e){OH(t,e,this.changes)}comparePoint(t,e){OH(t,e,this.changes)}boundChange(t){OH(t,t,this.changes)}};function Mq(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function Cq(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Aq(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function Tq(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function Pq(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function Dq(t,e,i){let n,s,o,r,l,a,h,c,d=!1;for(let u=t.firstChild;u;u=u.nextSibling){let t=fW(u);for(let f=0;f<t.length;f++){let p=t[f];s&&Aq(s,p)&&(p=Tq(Pq(p,s.bottom),s.top));let g=Mq(e,p),m=Cq(i,p);if(0==g&&0==m)return 3==u.nodeType?Eq(u,e,i):Dq(u,e,i);if(!n||r>m||r==m&&o>g){n=u,s=p,o=g,r=m;let l=m?i<p.top?-1:1:g?e<p.left?-1:1:0;d=!l||(l>0?f<t.length-1:f>0)}0==g?i>p.bottom&&(!h||h.bottom<p.bottom)?(l=u,h=p):i<p.top&&(!c||c.top>p.top)&&(a=u,c=p):h&&Aq(h,p)?h=Pq(h,p.bottom):c&&Aq(c,p)&&(c=Tq(c,p.top))}}if(h&&h.bottom>=i?(n=l,s=h):c&&c.top<=i&&(n=a,s=c),!n)return{node:t,offset:0};let u=Math.max(s.left,Math.min(s.right,e));return 3==n.nodeType?Eq(n,u,i):d&&"false"!=n.contentEditable?Dq(n,u,i):{node:t,offset:Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0)}}function Eq(t,e,i){let n=t.nodeValue.length,s=-1,o=1e9,r=0;for(let l=0;l<n;l++){let n=CW(t,l,l+1).getClientRects();for(let a=0;a<n.length;a++){let h=n[a];if(h.top==h.bottom)continue;r||(r=e-h.left);let c=(h.top>i?h.top-i:i-h.bottom)-1;if(h.left-1<=e&&h.right+1>=e&&c<o){let i=e>=(h.left+h.right)/2,n=i;if((UW.chrome||UW.gecko)&&CW(t,l).getBoundingClientRect().left==h.right&&(n=!i),c<=0)return{node:t,offset:l+(n?1:0)};s=l+(n?1:0),o=c}}}return{node:t,offset:s>-1?s:r>0?t.nodeValue.length:0}}function Rq(t,e,i,n=-1){var s,o;let r,l=t.contentDOM.getBoundingClientRect(),a=l.top+t.viewState.paddingTop,{docHeight:h}=t.viewState,{x:c,y:d}=e,u=d-a;if(u<0)return 0;if(u>h)return t.state.doc.length;for(let e=t.viewState.heightOracle.textHeight/2,s=!1;r=t.elementAtHeight(u),r.type!=dH.Text;)for(;u=n>0?r.bottom+e:r.top-e,!(u>=0&&u<=h);){if(s)return i?null:0;s=!0,n=-n}d=a+u;let f=r.from;if(f<t.viewport.from)return 0==t.viewport.from?0:i?null:Qq(t,l,r,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:i?null:Qq(t,l,r,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,m=g.elementFromPoint(c,d);m&&!t.contentDOM.contains(m)&&(m=null),m||(c=Math.max(l.left+1,Math.min(l.right-1,c)),m=g.elementFromPoint(c,d),m&&!t.contentDOM.contains(m)&&(m=null));let O,v=-1;if(m&&0!=(null===(s=t.docView.nearest(m))||void 0===s?void 0:s.isEditable)){if(p.caretPositionFromPoint){let t=p.caretPositionFromPoint(c,d);t&&({offsetNode:O,offset:v}=t)}else if(p.caretRangeFromPoint){let e=p.caretRangeFromPoint(c,d);e&&(({startContainer:O,startOffset:v}=e),(!t.contentDOM.contains(O)||UW.safari&&function(t,e,i){let n;if(3!=t.nodeType||e!=(n=t.nodeValue.length))return!1;for(let e=t.nextSibling;e;e=e.nextSibling)if(1!=e.nodeType||"BR"!=e.nodeName)return!1;return CW(t,n-1,n).getBoundingClientRect().left>i}(O,v,c)||UW.chrome&&function(t,e,i){if(0!=e)return!1;for(let e=t;;){let t=e.parentNode;if(!t||1!=t.nodeType||t.firstChild!=e)return!1;if(t.classList.contains("cm-line"))break;e=t}return i-(1==t.nodeType?t.getBoundingClientRect():CW(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect()).left>5}(O,v,c))&&(O=void 0))}O&&(v=Math.min(vW(O),v))}if(!O||!t.docView.dom.contains(O)){let e=vH.find(t.docView,f);if(!e)return u>r.top+r.height/2?r.to:r.from;({node:O,offset:v}=Dq(e.dom,c,d))}let w=t.docView.nearest(O);if(!w)return null;if(w.isWidget&&1==(null===(o=w.dom)||void 0===o?void 0:o.nodeType)){let t=w.dom.getBoundingClientRect();return e.y<t.top||e.y<=t.bottom&&e.x<=(t.left+t.right)/2?w.posAtStart:w.posAtEnd}return w.localPosFromDOM(O,v)+w.posAtStart}function Qq(t,e,i,n,s){let o=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&i.height>1.5*t.defaultLineHeight){let e=t.viewState.heightOracle.textHeight;o+=Math.floor((s-i.top-.5*(t.defaultLineHeight-e))/e)*t.viewState.heightOracle.lineLength}let r=t.state.sliceDoc(i.from,i.to);return i.from+Ii(r,o,t.state.tabSize)}function Bq(t,e,i,n){let s=t.state.doc.lineAt(e.head),o=t.bidiSpans(s),r=t.textDirectionAt(s.from);for(let l=e,a=null;;){let e=HH(s,o,r,l,i),h=WH;if(!e){if(s.number==(i?t.state.doc.lines:1))return l;h="\n",s=t.state.doc.line(s.number+(i?1:-1)),o=t.bidiSpans(s),e=t.visualLineSide(s,!i)}if(a){if(!a(h))return l}else{if(!n)return e;a=n(h)}l=e}}function Lq(t,e,i){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,((t,s,o)=>{if(e>t&&e<s){let o=n||i||(e-t<s-e?-1:1);e=o<0?t:s,n=o}}));if(!n)return e}}function $q(t,e,i){let n=Lq(t.state.facet(pq).map((e=>e(t))),i.from,e.head>i.from?-1:1);return n==i.from?i:We.cursor(n,n<i.from?1:-1)}const _q="￿";class Vq{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(Ci.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=_q}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n);let t=this.text.length;this.readNode(n);let s=n.nextSibling;if(s==e)break;let o=BW.get(n),r=BW.get(s);(o&&r?o.breakAfter:(o?o.breakAfter:mW(n))||mW(s)&&("BR"!=n.nodeName||n.cmIgnore)&&this.text.length>t)&&this.lineBreak(),n=s}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let s,o=-1,r=1;if(this.lineSeparator?(o=e.indexOf(this.lineSeparator,i),r=this.lineSeparator.length):(s=n.exec(e))&&(o=s.index,r=s[0].length),this.append(e.slice(i,o<0?e.length:o)),o<0)break;if(this.lineBreak(),r>1)for(let e of this.points)e.node==t&&e.pos>this.text.length&&(e.pos-=r-1);i=o+r}}readNode(t){if(t.cmIgnore)return;let e=BW.get(t),i=e&&e.overrideDOMText;if(null!=i){this.findPointInside(t,i.length);for(let t=i.iter();!t.next().done;)t.lineBreak?this.lineBreak():this.append(t.value)}else 3==t.nodeType?this.readTextNode(t):"BR"==t.nodeName?t.nextSibling&&this.lineBreak():1==t.nodeType&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(3==t.nodeType?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+(Nq(t,i.node,i.offset)?e:0))}}function Nq(t,e,i){for(;;){if(!e||i<vW(e))return!1;if(e==t)return!0;i=gW(e)+1,e=e.parentNode}}class Wq{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class Hq{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="",this.domChanged=e>-1;let{impreciseHead:s,impreciseAnchor:o}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let e=s||o?[]:function(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}=t.observer.selectionRange;return i&&(e.push(new Wq(i,n)),s==i&&o==n||e.push(new Wq(s,o))),e}(t),i=new Vq(e,t.state);i.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=i.text,this.newSel=function(t,e){if(0==t.length)return null;let i=t[0].pos,n=2==t.length?t[1].pos:i;return i>-1&&n>-1?We.single(i+e,n+e):null}(e,this.bounds.from)}else{let e=t.observer.selectionRange,i=s&&s.node==e.focusNode&&s.offset==e.focusOffset||!dW(t.contentDOM,e.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(e.focusNode,e.focusOffset),n=o&&o.node==e.anchorNode&&o.offset==e.anchorOffset||!dW(t.contentDOM,e.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(e.anchorNode,e.anchorOffset),r=t.viewport;if((UW.ios||UW.chrome)&&t.state.selection.main.empty&&i!=n&&(r.from>0||r.to<t.state.doc.length)){let e=Math.min(i,n),s=Math.max(i,n),o=r.from-e,l=r.to-s;0!=o&&1!=o&&0!=e||0!=l&&-1!=l&&s!=t.state.doc.length||(i=0,n=t.state.doc.length)}this.newSel=We.single(n,i)}}}function qq(t,e){let i,{newSel:n}=e,s=t.state.selection.main,o=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:n,to:r}=e.bounds,l=s.from,a=null;(8===o||UW.android&&e.text.length<r-n)&&(l=s.to,a="end");let h=function(t,e,i,n){let s=Math.min(t.length,e.length),o=0;for(;o<s&&t.charCodeAt(o)==e.charCodeAt(o);)o++;if(o==s&&t.length==e.length)return null;let r=t.length,l=e.length;for(;r>0&&l>0&&t.charCodeAt(r-1)==e.charCodeAt(l-1);)r--,l--;return"end"==n&&(i-=r+Math.max(0,o-Math.min(r,l))-o),r<o&&t.length<e.length?(o-=i<=o&&i>=r?o-i:0,l=o+(l-r),r=o):l<o&&(o-=i<=o&&i>=l?o-i:0,r=o+(r-l),l=o),{from:o,toA:r,toB:l}}(t.state.doc.sliceString(n,r,_q),e.text,l-n,a);h&&(UW.chrome&&13==o&&h.toB==h.from+2&&e.text.slice(h.from,h.toB)==_q+_q&&h.toB--,i={from:n+h.from,to:n+h.toA,insert:ge.of(e.text.slice(h.from,h.toB).split(_q))})}else n&&(!t.hasFocus&&t.state.facet(oq)||n.main.eq(s))&&(n=null);if(!i&&!n)return!1;if(!i&&e.typeOver&&!s.empty&&n&&n.main.empty?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:(UW.mac||UW.android)&&i&&i.from==i.to&&i.from==s.head-1&&/^\. ?$/.test(i.insert.toString())&&"off"==t.contentDOM.getAttribute("autocorrect")?(n&&2==i.insert.length&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:i.from,to:i.to,insert:ge.of([i.insert.toString().replace("."," ")])}):i&&i.from>=s.from&&i.to<=s.to&&(i.from!=s.from||i.to!=s.to)&&s.to-s.from-(i.to-i.from)<=4?i={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,i.from).append(i.insert).append(t.state.doc.slice(i.to,s.to))}:UW.chrome&&i&&i.from==i.to&&i.from==s.head&&"\n "==i.insert.toString()&&t.lineWrapping&&(n&&(n=We.single(n.main.anchor-1,n.main.head-1)),i={from:s.from,to:s.to,insert:ge.of([" "])}),i)return Fq(t,i,n,o);if(n&&!n.main.eq(s)){let e=!1,i="select";return t.inputState.lastSelectionTime>Date.now()-50&&("select"==t.inputState.lastSelectionOrigin&&(e=!0),i=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:e,userEvent:i}),!0}return!1}function Fq(t,e,i,n=-1){if(UW.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(UW.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&" "==t.state.sliceDoc(e.from,s.from))&&1==e.insert.length&&2==e.insert.lines&&AW(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&0==e.insert.length||8==n&&e.insert.length<e.to-e.from&&e.to>s.head)&&AW(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&0==e.insert.length&&AW(t.contentDOM,"Delete",46)))return!0;let o,r=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let l=()=>o||(o=function(t,e,i){let n,s=t.state,o=s.selection.main;if(e.from>=o.from&&e.to<=o.to&&e.to-e.from>=(o.to-o.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let i=o.from<e.from?s.sliceDoc(o.from,e.from):"",r=o.to>e.to?s.sliceDoc(e.to,o.to):"";n=s.replaceSelection(t.state.toText(i+e.insert.sliceString(0,void 0,t.state.lineBreak)+r))}else{let r=s.changes(e),l=i&&i.main.to<=r.newLength?i.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=o.to&&e.to>=o.to-10){let a,h=t.state.sliceDoc(e.from,e.to),c=i&&xq(t,i.main.head);if(c){let t=e.insert.length-(e.to-e.from);a={from:c.from,to:c.to-t}}else a=t.state.doc.lineAt(o.head);let d=o.to-e.to,u=o.to-o.from;n=s.changeByRange((i=>{if(i.from==o.from&&i.to==o.to)return{changes:r,range:l||i.map(r)};let n=i.to-d,c=n-h.length;if(i.to-i.from!=u||t.state.sliceDoc(c,n)!=h||i.to>=a.from&&i.from<=a.to)return{range:i};let f=s.changes({from:c,to:n,insert:e.insert}),p=i.to-o.to;return{changes:f,range:l?We.range(Math.max(0,l.anchor+p),Math.max(0,l.head+p)):i.map(f)}}))}else n={changes:r,selection:l&&s.selection.replaceRange(l)}}let r="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,r+=".compose",t.inputState.compositionFirstChange&&(r+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:r,scrollIntoView:!0})}(t,e,i));return t.state.facet(jH).some((i=>i(t,e.from,e.to,r,l)))||t.dispatch(l()),!0}class zq{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,UW.safari&&t.contentDOM.addEventListener("input",(()=>null)),UW.gecko&&function(t){mF.has(t)||(mF.add(t),t.addEventListener("copy",(()=>{})),t.addEventListener("cut",(()=>{})))}(t.contentDOM.ownerDocument)}handleEvent(t){(function(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let i,n=e.target;n!=t.contentDOM;n=n.parentNode)if(!n||11==n.nodeType||(i=BW.get(n))&&i.ignoreEvent(e))return!1;return!0})(this.view,t)&&!this.ignoreDuringComposition(t)&&("keydown"==t.type&&this.keydown(t)||(0!=this.view.updateState?Promise.resolve().then((()=>this.runHandlers(t.type,t))):this.runHandlers(t.type,t)))}runHandlers(t,e){let i=this.handlers[t];if(i){for(let t of i.observers)t(this.view,e);for(let t of i.handlers){if(e.defaultPrevented)break;if(t(this.view,e)){e.preventDefault();break}}}}ensureHandlers(t){let e=function(t){let e=Object.create(null);function i(t){return e[t]||(e[t]={observers:[],handlers:[]})}for(let e of t){let t=e.spec;if(t&&t.domEventHandlers)for(let n in t.domEventHandlers){let s=t.domEventHandlers[n];s&&i(n).handlers.push(Iq(e.value,s))}if(t&&t.domEventObservers)for(let n in t.domEventObservers){let s=t.domEventObservers[n];s&&i(n).observers.push(Iq(e.value,s))}}for(let t in Kq)i(t).handlers.push(Kq[t]);for(let t in Gq)i(t).observers.push(Gq[t]);return e}(t),i=this.handlers,n=this.view.contentDOM;for(let t in e)if("scroll"!=t){let s=!e[t].handlers.length,o=i[t];o&&s!=!o.handlers.length&&(n.removeEventListener(t,this.handleEvent),o=null),o||n.addEventListener(t,this.handleEvent,{passive:s})}for(let t in i)"scroll"==t||e[t]||n.removeEventListener(t,this.handleEvent);this.handlers=e}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),9==t.keyCode&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&27!=t.keyCode&&jq.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),UW.android&&UW.chrome&&!t.synthetic&&(13==t.keyCode||8==t.keyCode))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let e;return!UW.ios||t.synthetic||t.altKey||t.metaKey||!((e=Zq.find((e=>e.keyCode==t.keyCode)))&&!t.ctrlKey||Xq.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(229!=t.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=e||t,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(t){let e=this.pendingIOSKey;return!!e&&!("Enter"==e.key&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString()))&&(this.pendingIOSKey=void 0,AW(this.view.contentDOM,e.key,e.keyCode,e instanceof KeyboardEvent?e:void 0))}ignoreDuringComposition(t){return!!/^key/.test(t.type)&&(this.composing>0||!!(UW.safari&&!UW.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Iq(t,e){return(i,n)=>{try{return e.call(t,n,i)}catch(t){sq(i.state,t)}}}const Zq=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Xq="dthko",jq=[16,17,18,20,91,92,224,225];function Yq(t){return.7*Math.max(0,t)+8}class Uq{constructor(t,e,i,n){this.view=t,this.startEvent=e,this.style=i,this.mustSelect=n,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=e,this.scrollParents=function(t){let e,i,n=t.ownerDocument;for(let s=t.parentNode;s&&!(s==n.body||e&&i);)if(1==s.nodeType)!i&&s.scrollHeight>s.clientHeight&&(i=s),!e&&s.scrollWidth>s.clientWidth&&(e=s),s=s.assignedSlot||s.parentNode;else{if(11!=s.nodeType)break;s=s.host}return{x:e,y:i}}(t.contentDOM),this.atoms=t.state.facet(pq).map((e=>e(t)));let s=t.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(Ci.allowMultipleSelections)&&function(t,e){let i=t.state.facet(FH);return i.length?i[0](e):UW.mac?e.metaKey:e.ctrlKey}(t,e),this.dragging=!(!function(t,e){let{main:i}=t.state.selection;if(i.empty)return!1;let n=cW(t.root);if(!n||0==n.rangeCount)return!0;let s=n.getRangeAt(0).getClientRects();for(let t=0;t<s.length;t++){let i=s[t];if(i.left<=e.clientX&&i.right>=e.clientX&&i.top<=e.clientY&&i.bottom>=e.clientY)return!0}return!1}(t,e)||1!=cF(e))&&null}start(t){!1===this.dragging&&this.select(t)}move(t){if(0==t.buttons)return this.destroy();if(this.dragging||null==this.dragging&&(e=this.startEvent,i=t,Math.max(Math.abs(e.clientX-i.clientX),Math.abs(e.clientY-i.clientY))<10))return;var e,i;this.select(this.lastEvent=t);let n=0,s=0,o=0,r=0,l=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:o,right:l}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:r,bottom:a}=this.scrollParents.y.getBoundingClientRect());let h=vq(this.view);t.clientX-h.left<=o+6?n=-Yq(o-t.clientX):t.clientX+h.right>=l-6&&(n=Yq(t.clientX-l)),t.clientY-h.top<=r+6?s=-Yq(r-t.clientY):t.clientY+h.bottom>=a-6&&(s=Yq(t.clientY-a)),this.setScrollSpeed(n,s)}up(t){null==this.dragging&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,e){this.scrollSpeed={x:t,y:e},t||e?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:e}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),e&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=e,e=0),(t||e)&&this.view.win.scrollBy(t,e),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(t){let e=null;for(let i=0;i<t.ranges.length;i++){let n=t.ranges[i],s=null;if(n.empty){let t=Lq(this.atoms,n.from,0);t!=n.from&&(s=We.cursor(t,-1))}else{let t=Lq(this.atoms,n.from,-1),e=Lq(this.atoms,n.to,1);t==n.from&&e==n.to||(s=We.range(n.from==n.anchor?t:e,n.from==n.head?t:e))}s&&(e||(e=t.ranges.slice()),e[i]=s)}return e?We.create(e,t.mainIndex):t}select(t){let{view:e}=this,i=this.skipAtoms(this.style.get(t,this.extend,this.multiple));!this.mustSelect&&i.eq(e.state.selection,!1===this.dragging)||this.view.dispatch({selection:i,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some((t=>t.isUserEvent("input.type")))?this.destroy():this.style.update(t)&&setTimeout((()=>this.select(this.lastEvent)),20)}}const Kq=Object.create(null),Gq=Object.create(null),Jq=UW.ie&&UW.ie_version<15||UW.ios&&UW.webkit_version<604;function tF(t,e,i){for(let n of t.facet(e))i=n(i,t);return i}function eF(t,e){e=tF(t.state,UH,e);let i,{state:n}=t,s=1,o=n.toText(e),r=o.lines==n.selection.ranges.length;if(null!=uF&&n.selection.ranges.every((t=>t.empty))&&uF==o.toString()){let t=-1;i=n.changeByRange((i=>{let l=n.doc.lineAt(i.from);if(l.from==t)return{range:i};t=l.from;let a=n.toText((r?o.line(s++).text:e)+n.lineBreak);return{changes:{from:l.from,insert:a},range:We.cursor(i.from+a.length)}}))}else i=r?n.changeByRange((t=>{let e=o.line(s++);return{changes:{from:t.from,to:t.to,insert:e.text},range:We.cursor(t.from+e.length)}})):n.replaceSelection(o);t.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}function iF(t,e,i,n){if(1==n)return We.cursor(e,i);if(2==n)return function(t,e,i=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),o=e-s.from;if(0==s.length)return We.cursor(e);0==o?i=1:o==s.length&&(i=-1);let r=o,l=o;i<0?r=Me(s.text,o,!1):l=Me(s.text,o);let a=n(s.text.slice(r,l));for(;r>0;){let t=Me(s.text,r,!1);if(n(s.text.slice(t,r))!=a)break;r=t}for(;l<s.length;){let t=Me(s.text,l);if(n(s.text.slice(l,t))!=a)break;l=t}return We.range(r+s.from,l+s.from)}(t.state,e,i);{let i=vH.find(t.docView,e),n=t.state.doc.lineAt(i?i.posAtEnd:e),s=i?i.posAtStart:n.from,o=i?i.posAtEnd:n.to;return o<t.state.doc.length&&o==n.to&&o++,We.range(s,o)}}Gq.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft},Kq.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),27==e.keyCode&&0!=t.inputState.tabFocusMode&&(t.inputState.tabFocusMode=Date.now()+2e3),!1),Gq.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")},Gq.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")},Kq.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let n of t.state.facet(IH))if(i=n(t,e),i)break;if(i||0!=e.button||(i=function(t,e){let i=oF(t,e),n=cF(e),s=t.state.selection;return{update(t){t.docChanged&&(i.pos=t.changes.mapPos(i.pos),s=s.map(t.changes))},get(e,o,r){let l,a=oF(t,e),h=iF(t,a.pos,a.bias,n);if(i.pos!=a.pos&&!o){let e=iF(t,i.pos,i.bias,n),s=Math.min(e.from,h.from),o=Math.max(e.to,h.to);h=s<h.from?We.range(s,o):We.range(o,s)}return o?s.replaceRange(s.main.extend(h.from,h.to)):r&&1==n&&s.ranges.length>1&&(l=function(t,e){for(let i=0;i<t.ranges.length;i++){let{from:n,to:s}=t.ranges[i];if(n<=e&&s>=e)return We.create(t.ranges.slice(0,i).concat(t.ranges.slice(i+1)),t.mainIndex==i?0:t.mainIndex-(t.mainIndex>i?1:0))}return null}(s,a.pos))?l:r?s.addRange(h):We.create([h])}}}(t,e)),i){let n=!t.hasFocus;t.inputState.startMouseSelection(new Uq(t,e,i,n)),n&&t.observer.ignore((()=>{MW(t.contentDOM);let e=t.root.activeElement;e&&!e.contains(t.contentDOM)&&e.blur()}));let s=t.inputState.mouseSelection;if(s)return s.start(e),!1===s.dragging}return!1};let nF=(t,e,i)=>e>=i.top&&e<=i.bottom&&t>=i.left&&t<=i.right;function sF(t,e,i,n){let s=vH.find(t.docView,e);if(!s)return 1;let o=e-s.posAtStart;if(0==o)return 1;if(o==s.length)return-1;let r=s.coordsAt(o,-1);if(r&&nF(i,n,r))return-1;let l=s.coordsAt(o,1);return l&&nF(i,n,l)?1:r&&r.bottom>=n?-1:1}function oF(t,e){let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:i,bias:sF(t,i,e.clientX,e.clientY)}}const rF=UW.ie&&UW.ie_version<=11;let lF=null,aF=0,hF=0;function cF(t){if(!rF)return t.detail;let e=lF,i=hF;return lF=t,hF=Date.now(),aF=!e||i>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(aF+1)%3:1}function dF(t,e,i,n){if(!(i=tF(t.state,UH,i)))return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:o}=t.inputState,r=n&&o&&function(t,e){let i=t.state.facet(zH);return i.length?i[0](e):UW.mac?!e.altKey:!e.ctrlKey}(t,e)?{from:o.from,to:o.to}:null,l={from:s,insert:i},a=t.state.changes(r?[r,l]:l);t.focus(),t.dispatch({changes:a,selection:{anchor:a.mapPos(s,-1),head:a.mapPos(s,1)},userEvent:r?"move.drop":"input.drop"}),t.inputState.draggedContent=null}Kq.dragstart=(t,e)=>{let{selection:{main:i}}=t.state;if(e.target.draggable){let n=t.docView.nearest(e.target);if(n&&n.isWidget){let t=n.posAtStart,e=t+n.length;(t>=i.to||e<=i.from)&&(i=We.range(t,e))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=i,e.dataTransfer&&(e.dataTransfer.setData("Text",tF(t.state,KH,t.state.sliceDoc(i.from,i.to))),e.dataTransfer.effectAllowed="copyMove"),!1},Kq.dragend=t=>(t.inputState.draggedContent=null,!1),Kq.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let i=e.dataTransfer.files;if(i&&i.length){let n=Array(i.length),s=0,o=()=>{++s==i.length&&dF(t,e,n.filter((t=>null!=t)).join(t.state.lineBreak),!1)};for(let t=0;t<i.length;t++){let e=new FileReader;e.onerror=o,e.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(e.result)||(n[t]=e.result),o()},e.readAsText(i[t])}return!0}{let i=e.dataTransfer.getData("Text");if(i)return dF(t,e,i,!0),!0}return!1},Kq.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let i=Jq?null:e.clipboardData;return i?(eF(t,i.getData("text/plain")||i.getData("text/uri-list")),!0):(function(t){let e=t.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout((()=>{t.focus(),i.remove(),eF(t,i.value)}),50)}(t),!1)};let uF=null;Kq.copy=Kq.cut=(t,e)=>{let{text:i,ranges:n,linewise:s}=function(t){let e=[],i=[],n=!1;for(let n of t.selection.ranges)n.empty||(e.push(t.sliceDoc(n.from,n.to)),i.push(n));if(!e.length){let s=-1;for(let{from:n}of t.selection.ranges){let o=t.doc.lineAt(n);o.number>s&&(e.push(o.text),i.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:tF(t,KH,e.join(t.lineBreak)),ranges:i,linewise:n}}(t.state);if(!i&&!s)return!1;uF=s?i:null,"cut"!=e.type||t.state.readOnly||t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let o=Jq?null:e.clipboardData;return o?(o.clearData(),o.setData("text/plain",i),!0):(function(t,e){let i=t.dom.parentNode;if(!i)return;let n=i.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout((()=>{n.remove(),t.focus()}),50)}(t,i),!1)};const fF=ui.define();function pF(t,e){let i=[];for(let n of t.facet(YH)){let s=n(t,e);s&&i.push(s)}return i.length?t.update({effects:i,annotations:fF.of(!0)}):null}function gF(t){setTimeout((()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let i=pF(t.state,e);i?t.dispatch(i):t.update([])}}),10)}Gq.focus=t=>{t.inputState.lastFocusTime=Date.now(),t.scrollDOM.scrollTop||!t.inputState.lastScrollTop&&!t.inputState.lastScrollLeft||(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),gF(t)},Gq.blur=t=>{t.observer.clearSelectionRange(),gF(t)},Gq.compositionstart=Gq.compositionupdate=t=>{t.observer.editContext||(null==t.inputState.compositionFirstChange&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))},Gq.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,UW.chrome&&UW.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then((()=>t.observer.flush())):setTimeout((()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])}),50))},Gq.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()},Kq.beforeinput=(t,e)=>{var i,n;if("insertReplacementText"==e.inputType&&t.observer.editContext){let n=null===(i=e.dataTransfer)||void 0===i?void 0:i.getData("text/plain"),s=e.getTargetRanges();if(n&&s.length){let e=s[0],i=t.posAtDOM(e.startContainer,e.startOffset),o=t.posAtDOM(e.endContainer,e.endOffset);return Fq(t,{from:i,to:o,insert:t.state.toText(n)},null),!0}}let s;if(UW.chrome&&UW.android&&(s=Zq.find((t=>t.inputType==e.inputType)))&&(t.observer.delayAndroidKey(s.key,s.keyCode),"Backspace"==s.key||"Delete"==s.key)){let e=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var i;((null===(i=window.visualViewport)||void 0===i?void 0:i.height)||0)>e+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())}),100)}return UW.ios&&"deleteContentForward"==e.inputType&&t.observer.flushSoon(),UW.safari&&"insertText"==e.inputType&&t.inputState.composing>=0&&setTimeout((()=>Gq.compositionend(t,e)),20),!1};const mF=new Set,OF=["pre-wrap","normal","pre-line","break-spaces"];let vF=!1;function wF(){vF=!1}class bF{constructor(t){this.lineWrapping=t,this.doc=ge.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.max(0,Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength))),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return OF.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(10*n)]||(e=!0,this.heightSamples[Math.floor(10*n)]=!0)}return e}refresh(t,e,i,n,s,o){let r=OF.indexOf(t)>-1,l=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=r;if(this.lineWrapping=r,this.lineHeight=e,this.charWidth=i,this.textHeight=n,this.lineLength=s,l){this.heightSamples={};for(let t=0;t<o.length;t++){let e=o[t];e<0?t++:this.heightSamples[Math.floor(10*e)]=!0}}return l}}class yF{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class SF{constructor(t,e,i,n,s){this.from=t,this.length=e,this.top=i,this.height=n,this._content=s}get type(){return"number"==typeof this._content?dH.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof gH?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(t){let e=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new SF(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var xF=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(xF||(xF={}));const kF=.001;class MF{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(2&this.flags)>0}set outdated(t){this.flags=(t?2:0)|-3&this.flags}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>kF&&(vF=!0),this.height=t)}replace(t,e,i){return MF.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let s=this,o=i.doc;for(let r=n.length-1;r>=0;r--){let{fromA:l,toA:a,fromB:h,toB:c}=n[r],d=s.lineAt(l,xF.ByPosNoHeight,i.setDoc(e),0,0),u=d.to>=a?d:s.lineAt(a,xF.ByPosNoHeight,i,0,0);for(c+=u.to-a,a=u.to;r>0&&d.from<=n[r-1].toA;)l=n[r-1].fromA,h=n[r-1].fromB,r--,l<d.from&&(d=s.lineAt(l,xF.ByPosNoHeight,i,0,0));h+=d.from-l,l=d.from;let f=RF.build(i.setDoc(o),t,h,c);s=CF(s,s.replace(l,a,f))}return s.updateHeight(i,0)}static empty(){return new TF(0,0)}static of(t){if(1==t.length)return t[0];let e=0,i=t.length,n=0,s=0;for(;;)if(e==i)if(n>2*s){let s=t[e-1];s.break?t.splice(--e,1,s.left,null,s.right):t.splice(--e,1,s.left,s.right),i+=1+s.break,n-=s.size}else{if(!(s>2*n))break;{let e=t[i];e.break?t.splice(i,1,e.left,null,e.right):t.splice(i,1,e.left,e.right),i+=2+e.break,s-=e.size}}else if(n<s){let i=t[e++];i&&(n+=i.size)}else{let e=t[--i];e&&(s+=e.size)}let o=0;return null==t[e-1]?(o=1,e--):null==t[e]&&(o=1,i++),new DF(MF.of(t.slice(0,e)),o,MF.of(t.slice(i)))}}function CF(t,e){return t==e?t:(t.constructor!=e.constructor&&(vF=!0),e)}MF.prototype.size=1;class AF extends MF{constructor(t,e,i){super(t,e),this.deco=i}blockAt(t,e,i,n){return new SF(n,this.length,i,this.height,this.deco||0)}lineAt(t,e,i,n,s){return this.blockAt(0,i,n,s)}forEachLine(t,e,i,n,s,o){t<=s+this.length&&e>=s&&o(this.blockAt(0,i,n,s))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class TF extends AF{constructor(t,e){super(t,e,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,e,i,n){return new SF(n,this.length,i,this.height,this.breaks)}replace(t,e,i){let n=i[0];return 1==i.length&&(n instanceof TF||n instanceof PF&&4&n.flags)&&Math.abs(this.length-n.length)<10?(n instanceof PF?n=new TF(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):MF.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(n.heights[n.index++]):(i||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class PF extends MF{constructor(t){super(t,0)}heightMetrics(t,e){let i,n=t.doc.lineAt(e).number,s=t.doc.lineAt(e+this.length).number,o=s-n+1,r=0;if(t.lineWrapping){let e=Math.min(this.height,t.lineHeight*o);i=e/o,this.length>o+1&&(r=(this.height-e)/(this.length-o-1))}else i=this.height/o;return{firstLine:n,lastLine:s,perLine:i,perChar:r}}blockAt(t,e,i,n){let{firstLine:s,lastLine:o,perLine:r,perChar:l}=this.heightMetrics(e,n);if(e.lineWrapping){let s=n+(t<e.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-i)/this.height))*this.length)),o=e.doc.lineAt(s),a=r+o.length*l,h=Math.max(i,t-a/2);return new SF(o.from,o.length,h,a,0)}{let n=Math.max(0,Math.min(o-s,Math.floor((t-i)/r))),{from:l,length:a}=e.doc.line(s+n);return new SF(l,a,i+r*n,r,0)}}lineAt(t,e,i,n,s){if(e==xF.ByHeight)return this.blockAt(t,i,n,s);if(e==xF.ByPosNoHeight){let{from:e,to:n}=i.doc.lineAt(t);return new SF(e,n-e,0,0,0)}let{firstLine:o,perLine:r,perChar:l}=this.heightMetrics(i,s),a=i.doc.lineAt(t),h=r+a.length*l,c=a.number-o,d=n+r*c+l*(a.from-s-c);return new SF(a.from,a.length,Math.max(n,Math.min(d,n+this.height-h)),h,0)}forEachLine(t,e,i,n,s,o){t=Math.max(t,s),e=Math.min(e,s+this.length);let{firstLine:r,perLine:l,perChar:a}=this.heightMetrics(i,s);for(let h=t,c=n;h<=e;){let e=i.doc.lineAt(h);if(h==t){let i=e.number-r;c+=l*i+a*(t-s-i)}let n=l+a*e.length;o(new SF(e.from,e.length,c,n,0)),c+=n,h=e.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let t=i[i.length-1];t instanceof PF?i[i.length-1]=new PF(t.length+n):i.push(null,new PF(n-1))}if(t>0){let e=i[0];e instanceof PF?i[0]=new PF(t+e.length):i.unshift(new PF(t-1),null)}return MF.of(i)}decomposeLeft(t,e){e.push(new PF(t-1),null)}decomposeRight(t,e){e.push(null,new PF(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let s=e+this.length;if(n&&n.from<=e+this.length&&n.more){let i=[],o=Math.max(e,n.from),r=-1;for(n.from>e&&i.push(new PF(n.from-e-1).updateHeight(t,e));o<=s&&n.more;){let e=t.doc.lineAt(o).length;i.length&&i.push(null);let s=n.heights[n.index++];-1==r?r=s:Math.abs(s-r)>=kF&&(r=-2);let l=new TF(e,s);l.outdated=!1,i.push(l),o+=e+1}o<=s&&i.push(null,new PF(s-o).updateHeight(t,o));let l=MF.of(i);return(r<0||Math.abs(l.height-this.height)>=kF||Math.abs(r-this.heightMetrics(t,e).perLine)>=kF)&&(vF=!0),CF(this,l)}return(i||this.outdated)&&(this.setHeight(t.heightForGap(e,e+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class DF extends MF{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return 1&this.flags}blockAt(t,e,i,n){let s=i+this.left.height;return t<s?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,s,n+this.left.length+this.break)}lineAt(t,e,i,n,s){let o=n+this.left.height,r=s+this.left.length+this.break,l=e==xF.ByHeight?t<o:t<r,a=l?this.left.lineAt(t,e,i,n,s):this.right.lineAt(t,e,i,o,r);if(this.break||(l?a.to<r:a.from>r))return a;let h=e==xF.ByPosNoHeight?xF.ByPosNoHeight:xF.ByPos;return l?a.join(this.right.lineAt(r,h,i,o,r)):this.left.lineAt(r,h,i,n,s).join(a)}forEachLine(t,e,i,n,s,o){let r=n+this.left.height,l=s+this.left.length+this.break;if(this.break)t<l&&this.left.forEachLine(t,e,i,n,s,o),e>=l&&this.right.forEachLine(t,e,i,r,l,o);else{let a=this.lineAt(l,xF.ByPos,i,n,s);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,s,o),a.to>=t&&a.from<=e&&o(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,r,l,o)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let s=[];t>0&&this.decomposeLeft(t,s);let o=s.length;for(let t of i)s.push(t);if(t>0&&EF(s,o-1),e<this.length){let t=s.length;this.decomposeRight(e,s),EF(s,t)}return MF.of(s)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?MF.of(this.break?[t,null,e]:[t,e]):(this.left=CF(this.left,t),this.right=CF(this.right,e),this.setHeight(t.height+e.height),this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:s,right:o}=this,r=e+s.length+this.break,l=null;return n&&n.from<=e+s.length&&n.more?l=s=s.updateHeight(t,e,i,n):s.updateHeight(t,e,i),n&&n.from<=r+o.length&&n.more?l=o=o.updateHeight(t,r,i,n):o.updateHeight(t,r,i),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function EF(t,e){let i,n;null==t[e]&&(i=t[e-1])instanceof PF&&(n=t[e+1])instanceof PF&&t.splice(e-1,3,new PF(i.length+1+n.length))}class RF{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let t=Math.min(e,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof TF?i.length+=t-this.pos:(t>this.pos||!this.isCovered)&&this.nodes.push(new TF(t-this.pos,-1)),this.writtenTo=t,e>t&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0,s=i.widget?i.widget.lineBreaks:0;n<0&&(n=this.oracle.lineHeight);let o=e-t;i.block?this.addBlock(new AF(o,n,i)):(o||s||n>=5)&&this.addLineDeco(n,s,o)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new TF(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new PF(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof TF)return t;let e=new TF(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine();let e=t.deco;e&&e.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,e&&e.endSide>0&&(this.covering=t)}addLineDeco(t,e,i){let n=this.ensureLine();n.length+=i,n.collapsed+=i,n.widgetHeight=Math.max(n.widgetHeight,t),n.breaks+=e,this.writtenTo=this.pos=this.pos+i}finish(t){let e=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||e instanceof TF||this.isCovered?(this.writtenTo<this.pos||null==e)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new TF(0,-1));let i=t;for(let t of this.nodes)t instanceof TF&&t.updateHeight(this.oracle,i),i+=t?t.length:1;return this.nodes}static build(t,e,i,n){let s=new RF(i,t);return Ri.spans(e,i,n,s,0),s.finish(i)}}class QF{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&OH(t,e,this.changes,5)}}function BF(t,e){let i=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,o=Math.max(0,i.left),r=Math.min(s.innerWidth,i.right),l=Math.max(0,i.top),a=Math.min(s.innerHeight,i.bottom);for(let e=t.parentNode;e&&e!=n.body;)if(1==e.nodeType){let i=e,n=window.getComputedStyle(i);if((i.scrollHeight>i.clientHeight||i.scrollWidth>i.clientWidth)&&"visible"!=n.overflow){let n=i.getBoundingClientRect();o=Math.max(o,n.left),r=Math.min(r,n.right),l=Math.max(l,n.top),a=Math.min(e==t.parentNode?s.innerHeight:a,n.bottom)}e="absolute"==n.position||"fixed"==n.position?i.offsetParent:i.parentNode}else{if(11!=e.nodeType)break;e=e.host}return{left:o-i.left,right:Math.max(o,r)-i.left,top:l-(i.top+e),bottom:Math.max(l,a)-(i.top+e)}}function LF(t,e){let i=t.getBoundingClientRect();return{left:0,right:i.right-i.left,top:e,bottom:i.bottom-(i.top+e)}}class $F{constructor(t,e,i,n){this.from=t,this.to=e,this.size=i,this.displaySize=n}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],s=e[i];if(n.from!=s.from||n.to!=s.to||n.size!=s.size)return!1}return!0}draw(t,e){return uH.replace({widget:new _F(this.displaySize*(e?t.scaleY:t.scaleX),e)}).range(this.from,this.to)}}class _F extends cH{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class VF{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=qF,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=kH.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(dq).some((t=>"function"!=typeof t&&"cm-lineWrapping"==t.class));this.heightOracle=new bF(e),this.stateDeco=t.facet(uq).filter((t=>"function"!=typeof t)),this.heightMap=MF.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle.setDoc(t.doc),[new bq(0,0,0,t.doc.length)]);for(let t=0;t<2&&(this.viewport=this.getViewport(0,null),this.updateForViewport());t++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=uH.set(this.lineGaps.map((t=>t.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some((({from:t,to:e})=>n>=t&&n<=e))){let{from:e,to:i}=this.lineBlockAt(n);t.push(new NF(e,i))}}return this.viewports=t.sort(((t,e)=>t.from-e.from)),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?qF:new FF(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(t=>{this.viewportLines.push(zF(t,this.scaler))}))}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(uq).filter((t=>"function"!=typeof t));let n=t.changedRanges,s=bq.extendWithRanges(n,function(t,e,i){let n=new QF;return Ri.compare(t,e,i,n,0),n.changes}(i,this.stateDeco,t?t.changes:Re.empty(this.state.doc.length))),o=this.heightMap.height,r=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);wF(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||vF)&&(t.flags|=2),r?(this.scrollAnchorPos=t.changes.mapPos(r.from,-1),this.scrollAnchorHeight=r.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=o);let l=s.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<l.from||e.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,e));let a=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,t.flags|=this.updateForViewport(),(a||!t.changes.empty||2&t.flags)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(JH)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,s=i.whiteSpace;this.defaultTextDirection="rtl"==i.direction?kH.RTL:kH.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),r=e.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=r.height;this.contentDOMHeight=r.height,this.mustMeasureContent=!1;let a=0,h=0;if(r.width&&r.height){let{scaleX:t,scaleY:i}=yW(e,r);(t>.005&&Math.abs(this.scaleX-t)>.005||i>.005&&Math.abs(this.scaleY-i)>.005)&&(this.scaleX=t,this.scaleY=i,a|=16,o=l=!0)}let c=(parseInt(i.paddingTop)||0)*this.scaleY,d=(parseInt(i.paddingBottom)||0)*this.scaleY;this.paddingTop==c&&this.paddingBottom==d||(this.paddingTop=c,this.paddingBottom=d,a|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(l=!0),this.editorWidth=t.scrollDOM.clientWidth,a|=16);let u=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=PW(t.scrollDOM);let f=(this.printing?LF:BF)(e,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let m=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(m!=this.inView&&(this.inView=m,m&&(l=!0)),!this.inView&&!this.scrollTarget&&!function(t){let e=t.getBoundingClientRect(),i=t.ownerDocument.defaultView||window;return e.left<i.innerWidth&&e.right>0&&e.top<i.innerHeight&&e.bottom>0}(t.dom))return 0;let O=r.width;if(this.contentDOMWidth==O&&this.editorHeight==t.scrollDOM.clientHeight||(this.contentDOMWidth=r.width,this.editorHeight=t.scrollDOM.clientHeight,a|=16),l){let e=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(e)&&(o=!0),o||n.lineWrapping&&Math.abs(O-this.contentDOMWidth)>n.charWidth){let{lineHeight:i,charWidth:r,textHeight:l}=t.docView.measureTextSize();o=i>0&&n.refresh(s,i,r,l,O/r,e),o&&(t.docView.minWidth=0,a|=16)}p>0&&g>0?h=Math.max(p,g):p<0&&g<0&&(h=Math.min(p,g)),wF();for(let i of this.viewports){let s=i.from==this.viewport.from?e:t.docView.measureVisibleLineHeights(i);this.heightMap=(o?MF.empty().applyChanges(this.stateDeco,ge.empty,this.heightOracle,[new bq(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,o,new yF(i.from,s))}vF&&(a|=2)}let v=!this.viewportIsAppropriate(this.viewport,h)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(2&a&&(a|=this.updateScaler()),this.viewport=this.getViewport(h,this.scrollTarget),a|=this.updateForViewport()),(2&a||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,t)),a|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),a}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:r}=this,l=new NF(n.lineAt(o-1e3*i,xF.ByHeight,s,0,0).from,n.lineAt(r+1e3*(1-i),xF.ByHeight,s,0,0).to);if(e){let{head:t}=e.range;if(t<l.from||t>l.to){let i,o=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),r=n.lineAt(t,xF.ByPos,s,0,0);i="center"==e.y?(r.top+r.bottom)/2-o/2:"start"==e.y||"nearest"==e.y&&t<l.from?r.top:r.bottom-o,l=new NF(n.lineAt(i-500,xF.ByHeight,s,0,0).from,n.lineAt(i+o+500,xF.ByHeight,s,0,0).to)}}return l}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new NF(this.heightMap.lineAt(i,xF.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(n,xF.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,xF.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(e,xF.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:r}=this;return(0==t||n<=o-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||s>=r+Math.max(10,Math.min(i,250)))&&n>o-2e3&&s<r+2e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new $F(e.mapPos(n.from),e.mapPos(n.to),n.size,n.displaySize));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,s=n>>1,o=n<<1;if(this.defaultTextDirection!=kH.LTR&&!i)return[];let r=[],l=(n,o,a,h)=>{if(o-n<s)return;let c=this.state.selection.main,d=[c.from];c.empty||d.push(c.to);for(let t of d)if(t>n&&t<o)return l(n,t-10,a,h),void l(t+10,o,a,h);let u=function(t,e){for(let i of t)if(e(i))return i}(t,(t=>t.from>=a.from&&t.to<=a.to&&Math.abs(t.from-n)<s&&Math.abs(t.to-o)<s&&!d.some((e=>t.from<e&&t.to>e))));if(!u){if(o<a.to&&e&&i&&e.visibleRanges.some((t=>t.from<=o&&t.to>=o))){let t=e.moveToLineBoundary(We.cursor(o),!1,!0).head;t>n&&(o=t)}let t=this.gapSize(a,n,o,h);u=new $F(n,o,t,i||t<2e6?t:2e6)}r.push(u)},a=e=>{if(e.length<o||e.type!=dH.Text)return;let s=function(t,e,i){let n=[],s=t,o=0;return Ri.spans(i,t,e,{span(){},point(t,e){t>s&&(n.push({from:s,to:t}),o+=t-s),s=e}},20),s<e&&(n.push({from:s,to:e}),o+=e-s),{total:o,ranges:n}}(e.from,e.to,this.stateDeco);if(s.total<o)return;let r,a,h=this.scrollTarget?this.scrollTarget.range.head:null;if(i){let t,i,o=n/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=h){let n=HF(s,h),r=((this.visibleBottom-this.visibleTop)/2+o)/e.height;t=n-r,i=n+r}else t=(this.visibleTop-e.top-o)/e.height,i=(this.visibleBottom-e.top+o)/e.height;r=WF(s,t),a=WF(s,i)}else{let i=s.total*this.heightOracle.charWidth,o=n*this.heightOracle.charWidth,l=0;if(i>2e6)for(let i of t)i.from>=e.from&&i.from<e.to&&i.size!=i.displaySize&&i.from*this.heightOracle.charWidth+l<this.pixelViewport.left&&(l=i.size-i.displaySize);let c,d,u=this.pixelViewport.left+l,f=this.pixelViewport.right+l;if(null!=h){let t=HF(s,h),e=((f-u)/2+o)/i;c=t-e,d=t+e}else c=(u-o)/i,d=(f+o)/i;r=WF(s,c),a=WF(s,d)}r>e.from&&l(e.from,r,e,s),a<e.to&&l(a,e.to,e,s)};for(let t of this.viewportLines)Array.isArray(t.type)?t.type.forEach(a):a(t);return r}gapSize(t,e,i,n){let s=HF(n,i)-HF(n,e);return this.heightOracle.lineWrapping?t.height*s:n.total*this.heightOracle.charWidth*s}updateLineGaps(t){$F.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=uH.set(t.map((t=>t.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(t){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let i=[];Ri.spans(e,this.viewport.from,this.viewport.to,{span(t,e){i.push({from:t,to:e})},point(){}},20);let n=0;if(i.length!=this.visibleRanges.length)n=12;else for(let e=0;e<i.length&&!(8&n);e++){let s=this.visibleRanges[e],o=i[e];s.from==o.from&&s.to==o.to||(n|=4,t&&t.mapPos(s.from,-1)==o.from&&t.mapPos(s.to,1)==o.to||(n|=8))}return this.visibleRanges=i,n}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find((e=>e.from<=t&&e.to>=t))||zF(this.heightMap.lineAt(t,xF.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find((e=>e.top<=t&&e.bottom>=t))||zF(this.heightMap.lineAt(this.scaler.fromDOM(t),xF.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let e=this.lineBlockAtHeight(t+8);return e.from>=this.viewport.from||this.viewportLines[0].top-t>200?e:this.viewportLines[0]}elementAtHeight(t){return zF(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class NF{constructor(t,e){this.from=t,this.to=e}}function WF({total:t,ranges:e},i){if(i<=0)return e[0].from;if(i>=1)return e[e.length-1].to;let n=Math.floor(t*i);for(let t=0;;t++){let{from:i,to:s}=e[t],o=s-i;if(n<=o)return i+n;n-=o}}function HF(t,e){let i=0;for(let{from:n,to:s}of t.ranges){if(e<=s){i+=e-n;break}i+=s-n}return i/t.total}const qF={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class FF{constructor(t,e,i){let n=0,s=0,o=0;this.viewports=i.map((({from:i,to:s})=>{let o=e.lineAt(i,xF.ByPos,t,0,0).top,r=e.lineAt(s,xF.ByPos,t,0,0).bottom;return n+=r-o,{from:i,to:s,top:o,bottom:r,domTop:0,domBottom:0}})),this.scale=(7e6-n)/(e.height-n);for(let t of this.viewports)t.domTop=o+(t.top-s)*this.scale,o=t.domBottom=t.domTop+(t.bottom-t.top),s=t.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.top)return n+(t-i)*this.scale;if(t<=s.bottom)return s.domTop+(t-s.top);i=s.bottom,n=s.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let s=e<this.viewports.length?this.viewports[e]:null;if(!s||t<s.domTop)return i+(t-n)/this.scale;if(t<=s.domBottom)return s.top+(t-s.domTop);i=s.bottom,n=s.domBottom}}eq(t){return t instanceof FF&&this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every(((e,i)=>e.from==t.viewports[i].from&&e.to==t.viewports[i].to))}}function zF(t,e){if(1==e.scale)return t;let i=e.toDOM(t.top),n=e.toDOM(t.bottom);return new SF(t.from,t.length,i,n-i,Array.isArray(t._content)?t._content.map((t=>zF(t,e))):t._content)}const IF=Fe.define({combine:t=>t.join(" ")}),ZF=Fe.define({combine:t=>t.indexOf(!0)>-1}),XF=Yi.newName(),jF=Yi.newName(),YF=Yi.newName(),UF={"&light":"."+jF,"&dark":"."+YF};function KF(t,e,i){return new Yi(e,{finish(e){return/&/.test(e)?e.replace(/&\w*/,(e=>{if("&"==e)return t;if(!i||!i[e])throw new RangeError(`Unsupported selector: ${e}`);return i[e]})):t+" "+e}})}const GF=KF("."+XF,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},UF),JF={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},tz=UW.ie&&UW.ie_version<=11;class ez{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new SW,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver((e=>{for(let t of e)this.queue.push(t);(UW.ie&&UW.ie_version<=11||UW.ios&&t.composing)&&e.some((t=>"childList"==t.type&&t.removedNodes.length||"characterData"==t.type&&t.oldValue.length>t.target.nodeValue.length))?this.flushSoon():this.flush()})),!window.EditContext||!1===t.constructor.EDIT_CONTEXT||UW.chrome&&UW.chrome_version<126||(this.editContext=new sz(t),t.state.facet(oq)&&(t.contentDOM.editContext=this.editContext.editContext)),tz&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var t;(null===(t=this.view.docView)||void 0===t?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(t){("change"!=t.type&&t.type||t.matches)&&(this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some(((e,i)=>e!=t[i])))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(oq)?i.root.activeElement!=this.dom:!uW(this.dom,n))return;let s=n.anchorNode&&i.docView.nearest(n.anchorNode);s&&s.ignoreEvent(t)?e||(this.selectionChanged=!1):(UW.ie&&UW.ie_version<=11||UW.android&&UW.chrome)&&!i.state.selection.main.empty&&n.focusNode&&pW(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=cW(t.root);if(!e)return!1;let i=UW.safari&&11==t.root.nodeType&&t.root.activeElement==this.dom&&function(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return nz(t,i)}let i=null;function n(t){t.preventDefault(),t.stopImmediatePropagation(),i=t.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),i?nz(t,i):null}(this.view,e)||e;if(!i||this.selectionRange.eq(i))return!1;let n=uW(this.dom,i);return n&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&function(t,e){let i=e.focusNode,n=e.focusOffset;if(!i||e.anchorNode!=i||e.anchorOffset!=n)return!1;for(n=Math.min(n,vW(i));;)if(n){if(1!=i.nodeType)return!1;let t=i.childNodes[n-1];"false"==t.contentEditable?n--:(i=t,n=vW(i))}else{if(i==t)return!0;n=gW(i),i=i.parentNode}}(this.dom,i)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(i),n&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(1==i.nodeType)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else{if(11!=i.nodeType)break;i=i.host}if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);for(let t of this.scrollTargets=e)t.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,JF),tz&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),tz&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let t=()=>{let t=this.delayedAndroidKey;t&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=t.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&t.force&&AW(this.dom,t.key,t.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(t)}this.delayedAndroidKey&&"Enter"!=t||(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(null===(i=this.delayedAndroidKey)||void 0===i?void 0:i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let s of t){let t=this.readMutation(s);t&&(t.typeOver&&(n=!0),-1==e?({from:e,to:i}=t):(e=Math.min(t.from,e),i=Math.max(t.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&uW(this.dom,this.selectionRange);if(t<0&&!n)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new Hq(this.view,t,e,i);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return this.view.requestMeasure(),!1;let i=this.view.state,n=qq(this.view,e);return this.view.state==i&&(e.domChanged||e.newSel&&!e.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty("attributes"==t.type),"attributes"==t.type&&(e.flags|=4),"childList"==t.type){let i=iz(e,t.previousSibling||t.target.previousSibling,-1),n=iz(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}return"characterData"==t.type?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(oq)!=t.state.facet(oq)&&(t.view.contentDOM.editContext=t.state.facet(oq)?this.editContext.editContext:null))}destroy(){var t,e,i;this.stop(),null===(t=this.intersection)||void 0===t||t.disconnect(),null===(e=this.gapIntersection)||void 0===e||e.disconnect(),null===(i=this.resizeScroll)||void 0===i||i.disconnect();for(let t of this.scrollTargets)t.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function iz(t,e,i){for(;e;){let n=BW.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:i>0?e.nextSibling:e.previousSibling}return null}function nz(t,e){let i=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset,r=t.docView.domAtPos(t.state.selection.main.anchor);return pW(r.node,r.offset,s,o)&&([i,n,s,o]=[s,o,i,n]),{anchorNode:i,anchorOffset:n,focusNode:s,focusOffset:o}}class sz{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let e=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=e=>{let i=t.state.selection.main,{anchor:n,head:s}=i,o=this.toEditorPos(e.updateRangeStart),r=this.toEditorPos(e.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:e.updateRangeStart,editorBase:o,drifted:!1});let l={from:o,to:r,insert:ge.of(e.text.split("\n"))};if(l.from==this.from&&n<this.from?l.from=n:l.to==this.to&&n>this.to&&(l.to=n),l.from!=l.to||l.insert.length){if((UW.mac||UW.android)&&l.from==s-1&&/^\. ?$/.test(e.text)&&"off"==t.contentDOM.getAttribute("autocorrect")&&(l={from:o,to:r,insert:ge.of([e.text.replace("."," ")])}),this.pendingContextChange=l,!t.state.readOnly){let i=this.to-this.from+(l.to-l.from+l.insert.length);Fq(t,l,We.single(this.toEditorPos(e.selectionStart,i),this.toEditorPos(e.selectionEnd,i)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))}else{let n=We.single(this.toEditorPos(e.selectionStart),this.toEditorPos(e.selectionEnd));n.main.eq(i)||t.dispatch({selection:n,userEvent:"select"})}},this.handlers.characterboundsupdate=i=>{let n=[],s=null;for(let e=this.toEditorPos(i.rangeStart),o=this.toEditorPos(i.rangeEnd);e<o;e++){let i=t.coordsForChar(e);s=i&&new DOMRect(i.left,i.top,i.right-i.left,i.bottom-i.top)||s||new DOMRect,n.push(s)}e.updateCharacterBounds(i.rangeStart,n)},this.handlers.textformatupdate=e=>{let i=[];for(let t of e.getTextFormats()){let e=t.underlineStyle,n=t.underlineThickness;if("None"!=e&&"None"!=n){let s=this.toEditorPos(t.rangeStart),o=this.toEditorPos(t.rangeEnd);if(s<o){let t=`text-decoration: underline ${"Dashed"==e?"dashed ":"Squiggle"==e?"wavy ":""}${"Thin"==n?1:2}px`;i.push(uH.mark({attributes:{style:t}}).range(s,o))}}}t.dispatch({effects:nq.of(uH.set(i))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:e}=this.composing;this.composing=null,e&&this.reset(t.state)}};for(let t in this.handlers)e.addEventListener(t,this.handlers[t]);this.measureReq={read:t=>{this.editContext.updateControlBounds(t.contentDOM.getBoundingClientRect());let e=cW(t.root);e&&e.rangeCount&&this.editContext.updateSelectionBounds(e.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let e=0,i=!1,n=this.pendingContextChange;return t.changes.iterChanges(((s,o,r,l,a)=>{if(i)return;let h=a.length-(o-s);if(n&&o>=n.to){if(n.from==s&&n.to==o&&n.insert.eq(a))return n=this.pendingContextChange=null,e+=h,void(this.to+=h);n=null,this.revertPending(t.state)}if(s+=e,(o+=e)<=this.from)this.from+=h,this.to+=h;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+a.length>3e4)return void(i=!0);this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),a.toString()),this.to+=h}e+=h})),n&&!i&&this.revertPending(t.state),!i}update(t){let e=this.pendingContextChange,i=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(i.from,i.to)&&t.transactions.some((t=>!t.isUserEvent("input.type")&&t.changes.touchesRange(this.from,this.to))))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):this.applyEdits(t)&&this.rangeIsValid(t.state)?(t.docChanged||t.selectionSet||e)&&this.setSelection(t.state):(this.pendingContextChange=null,this.reset(t.state)),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:e}=t.selection.main;this.from=Math.max(0,e-1e4),this.to=Math.min(t.doc.length,e+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let e=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(e.from),this.toContextPos(e.from+e.insert.length),t.doc.sliceString(e.from,e.to))}setSelection(t){let{main:e}=t.selection,i=this.toContextPos(Math.max(this.from,Math.min(this.to,e.anchor))),n=this.toContextPos(e.head);this.editContext.selectionStart==i&&this.editContext.selectionEnd==n||this.editContext.updateSelection(i,n)}rangeIsValid(t){let{head:e}=t.selection.main;return!(this.from>0&&e-this.from<500||this.to<t.doc.length&&this.to-e<500||this.to-this.from>3e4)}toEditorPos(t,e=this.to-this.from){t=Math.min(t,e);let i=this.composing;return i&&i.drifted?i.editorBase+(t-i.contextBase):t+this.from}toContextPos(t){let e=this.composing;return e&&e.drifted?e.contextBase+(t-e.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class oz{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var e;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:i}=t;this.dispatchTransactions=t.dispatchTransactions||i&&(t=>t.forEach((t=>i(t,this))))||(t=>this.update(t)),this.dispatch=this.dispatch.bind(this),this._root=t.root||function(t){for(;t;){if(t&&(9==t.nodeType||11==t.nodeType&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}(t.parent)||document,this.viewState=new VF(t.state||Ci.create(t)),t.scrollTo&&t.scrollTo.is(iq)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(lq).map((t=>new hq(t)));for(let t of this.plugins)t.update(this);this.observer=new ez(this),this.inputState=new zq(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Sq(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),(null===(e=document.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then((()=>this.requestMeasure()))}dispatch(...t){let e=1==t.length&&t[0]instanceof mi?t:1==t.length&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(e,this)}update(t){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e,i=!1,n=!1,s=this.state;for(let e of t){if(e.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=e.state}if(this.destroyed)return void(this.viewState.state=s);let o=this.hasFocus,r=0,l=null;t.some((t=>t.annotation(fF)))?(this.inputState.notifiedFocused=o,r=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=pF(s,o),l||(r=1));let a=this.observer.delayedAndroidKey,h=null;if(a?(this.observer.clearDelayedAndroidKey(),h=this.observer.readChange(),(h&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(h=null)):this.observer.clear(),s.facet(Ci.phrases)!=this.state.facet(Ci.phrases))return this.setState(s);e=yq.create(this,s,t),e.flags|=r;let c=this.viewState.scrollTarget;try{this.updateState=2;for(let e of t){if(c&&(c=c.map(e.changes)),e.scrollIntoView){let{main:t}=e.state.selection;c=new eq(t.empty?t:We.cursor(t.head,t.head>t.anchor?-1:1))}for(let t of e.effects)t.is(iq)&&(c=t.value.clip(this.state))}this.viewState.update(e,c),this.bidiCache=az.update(this.bidiCache,e.changes),e.empty||(this.updatePlugins(e),this.inputState.update(e)),i=this.docView.update(e),this.state.facet(wq)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some((t=>t.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(e.startState.facet(IF)!=e.state.facet(IF)&&(this.viewState.mustMeasureContent=!0),(i||n||c||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!e.empty)for(let t of this.state.facet(XH))try{t(e)}catch(t){sq(this.state,t,"update listener")}(l||h)&&Promise.resolve().then((()=>{l&&this.state==l.startState&&this.dispatch(l),h&&!qq(this,h)&&a.force&&AW(this.contentDOM,a.key,a.keyCode)}))}setState(t){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=t);this.updateState=2;let e=this.hasFocus;try{for(let t of this.plugins)t.destroy(this);this.viewState=new VF(t),this.plugins=t.facet(lq).map((t=>new hq(t))),this.pluginMap.clear();for(let t of this.plugins)t.update(this);this.docView.destroy(),this.docView=new Sq(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(lq),i=t.state.facet(lq);if(e!=i){let n=[];for(let s of i){let i=e.indexOf(s);if(i<0)n.push(new hq(s));else{let e=this.plugins[i];e.mustUpdate=t,n.push(e)}}for(let e of this.plugins)e.mustUpdate!=t&&e.destroy(this);this.plugins=n,this.pluginMap.clear()}else for(let e of this.plugins)e.mustUpdate=t;for(let t=0;t<this.plugins.length;t++)this.plugins[t].update(this);e!=i&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let e=t.value;if(e&&e.docViewUpdate)try{e.docViewUpdate(this)}catch(t){sq(this.state,t,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,i=this.scrollDOM,n=i.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(n-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let t=0;;t++){if(o<0)if(PW(i))s=-1,o=this.viewState.heightMap.height;else{let t=this.viewState.scrollAnchorAt(n);s=t.from,o=t.top}this.updateState=1;let r=this.viewState.measure(this);if(!r&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(t>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let l=[];4&r||([this.measureRequests,l]=[l,this.measureRequests]);let a=l.map((t=>{try{return t.read(this)}catch(t){return sq(this.state,t),lz}})),h=yq.create(this,this.state,[]),c=!1;h.flags|=r,e?e.flags|=r:e=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),c=this.docView.update(h),c&&this.docViewUpdate());for(let t=0;t<l.length;t++)if(a[t]!=lz)try{let e=l[t];e.write&&e.write(a[t],this)}catch(t){sq(this.state,t)}if(c&&this.docView.updateSelection(!0),!h.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}{let t=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(t>1||t<-1){n+=t,i.scrollTop=n/this.scaleY,o=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let t of this.state.facet(XH))t(e)}get themeClasses(){return XF+" "+(this.state.facet(ZF)?YF:jF)+" "+this.state.facet(IF)}updateAttrs(){let t=hz(this,cq,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(oq)?"true":"false",class:"cm-content",style:`${UW.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),hz(this,dq,e);let i=this.observer.ignore((()=>{let i=aH(this.contentDOM,this.contentAttrs,e),n=aH(this.dom,this.editorAttrs,t);return i||n}));return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let t of i.effects)t.is(oz.announce)&&(e&&(this.announceDOM.textContent=""),e=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=t.value)}mountStyles(){this.styleModules=this.state.facet(wq);let t=this.state.facet(oz.cspNonce);Yi.mount(this.root,this.styleModules.concat(GF).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),t){if(this.measureRequests.indexOf(t)>-1)return;if(null!=t.key)for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key)return void(this.measureRequests[e]=t);this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(void 0===e||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find((e=>e.spec==t))||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return $q(this,t,Bq(this,t,e,i))}moveByGroup(t,e){return $q(this,t,Bq(this,t,e,(e=>function(t,e,i){let n=t.state.charCategorizer(e),s=n(i);return t=>{let e=n(t);return s==xi.Space&&(s=e),s==e}}(this,t.head,e))))}visualLineSide(t,e){let i=this.bidiSpans(t),n=this.textDirectionAt(t.from),s=i[e?i.length-1:0];return We.cursor(s.side(e,n)+t.from,s.forward(!e,n)?1:-1)}moveToLineBoundary(t,e,i=!0){return function(t,e,i,n){let s=function(t,e,i){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){let t;for(let s of n.type){if(s.from>e)break;if(!(s.to<e)){if(s.from<e&&s.to>e)return s;t&&(s.type!=dH.Text||t.type==s.type&&!(i<0?s.from<e:s.to>e))||(t=s)}}return t||n}return n}(t,e.head,e.assoc||-1),o=n&&s.type==dH.Text&&(t.lineWrapping||s.widgetLineBreaks)?t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head):null;if(o){let e=t.dom.getBoundingClientRect(),n=t.textDirectionAt(s.from),r=t.posAtCoords({x:i==(n==kH.LTR)?e.right-1:e.left+1,y:(o.top+o.bottom)/2});if(null!=r)return We.cursor(r,i?-1:1)}return We.cursor(i?s.to:s.from,i?-1:1)}(this,t,e,i)}moveVertically(t,e,i){return $q(this,t,function(t,e,i,n){let s=e.head,o=i?1:-1;if(s==(i?t.state.doc.length:0))return We.cursor(s,e.assoc);let r,l=e.goalColumn,a=t.contentDOM.getBoundingClientRect(),h=t.coordsAtPos(s,e.assoc||-1),c=t.documentTop;if(h)null==l&&(l=h.left-a.left),r=o<0?h.top:h.bottom;else{let e=t.viewState.lineBlockAt(s);null==l&&(l=Math.min(a.right-a.left,t.defaultCharacterWidth*(s-e.from))),r=(o<0?e.top:e.bottom)+c}let d=a.left+l,u=null!=n?n:t.viewState.heightOracle.textHeight>>1;for(let e=0;;e+=10){let i=r+(u+e)*o,n=Rq(t,{x:d,y:i},!1,o);if(i<a.top||i>a.bottom||(o<0?n<s:n>s)){let e=t.docView.coordsForChar(n),s=!e||i<e.top?-1:1;return We.cursor(n,s,void 0,l)}}}(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),Rq(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),s=this.bidiSpans(n);return wW(i,s[BH.find(s,t-n.from,-1,e)].dir==kH.LTR==e>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(GH)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>rz)return NH(t.length);let e,i=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==i&&(n.fresh||LH(n.isolates,e=mq(this,t))))return n.order;e||(e=mq(this,t));let n=function(t,e,i){if(!t)return[new BH(0,0,e==CH?1:0)];if(e==MH&&!i.length&&!QH.test(t))return NH(t.length);if(i.length)for(;t.length>$H.length;)$H[$H.length]=256;let n=[],s=e==MH?0:1;return VH(t,s,s,i,0,t.length,n),n}(t.text,i,e);return this.bidiCache.push(new az(t.from,t.to,i,e,!0,n)),n}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||UW.safari&&(null===(t=this.inputState)||void 0===t?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{MW(this.contentDOM),this.docView.updateSelection()}))}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((9==t.nodeType?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return iq.of(new eq("number"==typeof t?We.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:e}=this.scrollDOM,i=this.viewState.scrollAnchorAt(t);return iq.of(new eq(We.cursor(i.from),"start","start",i.top-t,e,!0))}setTabFocusMode(t){null==t?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:"boolean"==typeof t?this.inputState.tabFocusMode=t?0:-1:0!=this.inputState.tabFocusMode&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return aq.define((()=>({})),{eventHandlers:t})}static domEventObservers(t){return aq.define((()=>({})),{eventObservers:t})}static theme(t,e){let i=Yi.newName(),n=[IF.of(i),wq.of(KF(`.${i}`,t))];return e&&e.dark&&n.push(ZF.of(!0)),n}static baseTheme(t){return Ge.lowest(wq.of(KF("."+XF,t,UF)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&BW.get(i)||BW.get(t);return(null===(e=null==n?void 0:n.rootView)||void 0===e?void 0:e.view)||null}}oz.styleModule=wq,oz.inputHandler=jH,oz.clipboardInputFilter=UH,oz.clipboardOutputFilter=KH,oz.scrollHandler=tq,oz.focusChangeEffect=YH,oz.perLineTextDirection=GH,oz.exceptionSink=ZH,oz.updateListener=XH,oz.editable=oq,oz.mouseSelectionStyle=IH,oz.dragMovesSelection=zH,oz.clickAddsSelectionRange=FH,oz.decorations=uq,oz.outerDecorations=fq,oz.atomicRanges=pq,oz.bidiIsolatedRanges=gq,oz.scrollMargins=Oq,oz.darkTheme=ZF,oz.cspNonce=Fe.define({combine:t=>t.length?t[0]:""}),oz.contentAttributes=dq,oz.editorAttributes=cq,oz.lineWrapping=oz.contentAttributes.of({class:"cm-lineWrapping"}),oz.announce=gi.define();const rz=4096,lz={};class az{constructor(t,e,i,n,s,o){this.from=t,this.to=e,this.dir=i,this.isolates=n,this.fresh=s,this.order=o}static update(t,e){if(e.empty&&!t.some((t=>t.fresh)))return t;let i=[],n=t.length?t[t.length-1].dir:kH.LTR;for(let s=Math.max(0,t.length-10);s<t.length;s++){let o=t[s];o.dir!=n||e.touchesRange(o.from,o.to)||i.push(new az(e.mapPos(o.from,1),e.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return i}}function hz(t,e,i){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let e=n[s],o="function"==typeof e?e(t):e;o&&oH(o,i)}return i}class cz extends Ti{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}cz.prototype.elementClass="",cz.prototype.toDOM=void 0,cz.prototype.mapMode=De.TrackBefore,cz.prototype.startSide=cz.prototype.endSide=-1,cz.prototype.point=!0;const dz="#e06c75",uz="#abb2bf",fz="#7d8799",pz="#d19a66",gz="#2c313a",mz="#282c34",Oz="#353a42",vz="#528bff",wz=[oz.theme({"&":{color:uz,backgroundColor:mz},".cm-content":{caretColor:vz},".cm-cursor, .cm-dropCursor":{borderLeftColor:vz},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:"#3E4451"},".cm-panels":{backgroundColor:"#21252b",color:uz},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:mz,color:fz,border:"none"},".cm-activeLineGutter":{backgroundColor:gz},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Oz},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Oz,borderBottomColor:Oz},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:gz,color:uz}}},{dark:!0}),Ta(ka.define([{tag:zt.keyword,color:"#c678dd"},{tag:[zt.name,zt.deleted,zt.character,zt.propertyName,zt.macroName],color:dz},{tag:[zt.function(zt.variableName),zt.labelName],color:"#61afef"},{tag:[zt.color,zt.constant(zt.name),zt.standard(zt.name)],color:pz},{tag:[zt.definition(zt.name),zt.separator],color:uz},{tag:[zt.typeName,zt.className,zt.number,zt.changed,zt.annotation,zt.modifier,zt.self,zt.namespace],color:"#e5c07b"},{tag:[zt.operator,zt.operatorKeyword,zt.url,zt.escape,zt.regexp,zt.link,zt.special(zt.string)],color:"#56b6c2"},{tag:[zt.meta,zt.comment],color:fz},{tag:zt.strong,fontWeight:"bold"},{tag:zt.emphasis,fontStyle:"italic"},{tag:zt.strikethrough,textDecoration:"line-through"},{tag:zt.link,color:fz,textDecoration:"underline"},{tag:zt.heading,fontWeight:"bold",color:dz},{tag:[zt.atom,zt.bool,zt.special(zt.variableName)],color:pz},{tag:[zt.processingInstruction,zt.string,zt.inserted],color:"#98c379"},{tag:zt.invalid,color:"#ffffff"}]))];var bz=ax.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),yz=function(t){void 0===t&&(t={});var{indentWithTab:e=!0,editable:i=!0,readOnly:n=!1,theme:s="light",placeholder:o="",basicSetup:r=!0}=t,l=[];switch(e&&l.unshift(mx.of([YP])),r&&("boolean"==typeof r?l.unshift(hW()):l.unshift(hW(r))),o&&l.unshift(function(t){return cy.fromClass(class{constructor(e){this.view=e,this.placeholder=t?pb.set([pb.widget({widget:new Ux(t),side:1}).range(0)]):pb.none}get decorations(){return this.view.state.doc.length?pb.none:this.placeholder}},{decorations:t=>t.decorations})}(o)),s){case"light":l.push(bz);break;case"dark":l.push(wz);break;case"none":break;default:l.push(s)}return!1===i&&l.push(ax.editable.of(!1)),n&&l.push(Ci.readOnly.of(!0)),[...l]},Sz=ui.define(),xz=[],kz=__webpack_require__(4848),Mz=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Cz=(0,i.forwardRef)(((t,e)=>{var{className:n,value:s="",selection:o,extensions:r=[],onChange:l,onStatistics:a,onCreateEditor:h,onUpdate:c,autoFocus:d,theme:u="light",height:f,minHeight:p,maxHeight:g,width:m,minWidth:O,maxWidth:v,basicSetup:w,placeholder:b,indentWithTab:y,editable:S,readOnly:x,root:k,initialState:M}=t,C=function(t,e){if(null==t)return{};var i={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(-1!==e.indexOf(n))continue;i[n]=t[n]}return i}(t,Mz),A=(0,i.useRef)(null),{state:T,view:P,container:D,setContainer:E}=function(t){var{value:e,selection:n,onChange:s,onStatistics:o,onCreateEditor:r,onUpdate:l,extensions:a=xz,autoFocus:h,theme:c="light",height:d=null,minHeight:u=null,maxHeight:f=null,width:p=null,minWidth:g=null,maxWidth:m=null,placeholder:O="",editable:v=!0,readOnly:w=!1,indentWithTab:b=!0,basicSetup:y=!0,root:S,initialState:x}=t,[k,M]=(0,i.useState)(),[C,A]=(0,i.useState)(),[T,P]=(0,i.useState)(),D=ax.theme({"&":{height:d,minHeight:u,maxHeight:f,width:p,minWidth:g,maxWidth:m},"& .cm-scroller":{height:"100% !important"}}),E=ax.updateListener.of((t=>{if(t.docChanged&&"function"==typeof s&&!t.transactions.some((t=>t.annotation(Sz)))){var e=t.state.doc.toString();s(e,t)}o&&o((t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map((e=>t.state.sliceDoc(e.from,e.to))),selectedText:t.state.selection.ranges.some((t=>!t.empty))}))(t))})),R=[E,D,...yz({theme:c,editable:v,readOnly:w,placeholder:O,indentWithTab:b,basicSetup:y})];return l&&"function"==typeof l&&R.push(ax.updateListener.of(l)),R=R.concat(a),(0,i.useLayoutEffect)((()=>{if(k&&!T){var t={doc:e,selection:n,extensions:R},i=x?Ci.fromJSON(x.json,t,x.fields):Ci.create(t);if(P(i),!C){var s=new ax({state:i,parent:k,root:S});A(s),r&&r(s,i)}}return()=>{C&&(P(void 0),A(void 0))}}),[k,T]),(0,i.useEffect)((()=>{t.container&&M(t.container)}),[t.container]),(0,i.useEffect)((()=>()=>{C&&(C.destroy(),A(void 0))}),[C]),(0,i.useEffect)((()=>{h&&C&&C.focus()}),[h,C]),(0,i.useEffect)((()=>{C&&C.dispatch({effects:gi.reconfigure.of(R)})}),[c,a,d,u,f,p,g,m,O,v,w,b,y,s,l]),(0,i.useEffect)((()=>{if(void 0!==e){var t=C?C.state.doc.toString():"";C&&e!==t&&C.dispatch({changes:{from:0,to:t.length,insert:e||""},annotations:[Sz.of(!0)]})}}),[e,C]),{state:T,setState:P,view:C,setView:A,container:k,setContainer:M}}({root:k,value:s,autoFocus:d,theme:u,height:f,minHeight:p,maxHeight:g,width:m,minWidth:O,maxWidth:v,basicSetup:w,placeholder:b,indentWithTab:y,editable:S,readOnly:x,selection:o,onChange:l,onStatistics:a,onCreateEditor:h,onUpdate:c,extensions:r,initialState:M});(0,i.useImperativeHandle)(e,(()=>({editor:A.current,state:T,view:P})),[A,D,T,P]);var R=(0,i.useCallback)((t=>{A.current=t,E(t)}),[E]);if("string"!=typeof s)throw new Error("value must be typeof string but got "+typeof s);var Q="string"==typeof u?"cm-theme-"+u:"cm-theme";return(0,kz.jsx)("div",uw({ref:R,className:Q+(n?" "+n:"")},C))}));Cz.displayName="CodeMirror";var Az,Tz,Pz=Cz,Dz=(0,n.yz)(s.Mb,s.vo,(function(t,e){return{isVisible:t.isPropsEditorOpen,widgetProps:e,hasPropsError:t.hasPropsError}})),Ez=(0,i.memo)((function(e){var a=e.trigger,h=(0,o.W)(),c=(0,n.GV)(Dz),d=c.isVisible,u=c.widgetProps,f=c.hasPropsError,p=(0,i.useRef)(u),g=(0,n.jL)();return(0,i.useEffect)((function(){f&&(window.alert(h("Bathtub.PropEditor.ValidationError")),g(s.tR.clearPropsError()))}),[f]),(0,t.FD)(t.FK,{children:[a,(0,t.FD)(l.Modal,{open:d,onCancel:function(){return g(s.tR.setIsPropsEditorOpen(!1))},footer:[(0,t.FD)(r.A,{keyName:"esc",onKeyDown:function(){g(s.tR.setIsPropsEditorOpen(!1)),g(s.tR.clearPropsError())},children:[(0,t.Y)(l.Button,{type:"primary",onClick:function(){p.current&&p.current!==u&&g(s.tR.setActiveWidgetProps(p.current))},"data-qa":"props-editor-update",children:h("Bathtub.PropEditor.Update")}),(0,t.Y)(l.Button,{type:"primary",onClick:function(){return g(s.tR.setIsPropsEditorOpen(!1))},children:"Close"})]})],children:[(0,t.Y)(l.Typography.Title,{level:2,children:"Widget props"}),(0,t.Y)(Pz,{theme:"dark",value:u,width:"100%",height:"50vh",extensions:[aw({jsx:!0})],onChange:function(t){p.current=t}})]})]})})),Rz=__webpack_require__(7430),Qz=(0,e.A)(a.az)(Az||(Az=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  // box-shadow: 0px 2px 8px rgba(25, 24, 35, 0.15);\n  grid-area: header;\n"]))),Bz=(0,i.memo)((function(){var e=(0,n.jL)(),h=(0,n.GV)(s.Xj),c=(0,o.W)();return(0,i.useEffect)((function(){var t;document.title=null!==(t=null==h?void 0:h.widgetId)&&void 0!==t?t:"@1fe/bathtub"}),[h]),(0,t.Y)(Qz,{children:(0,t.FD)(a.fI,{css:{gap:"16px",justifyContent:"flex-end",align:"center"},children:[(0,t.Y)(r.A,{keyName:"cmd+shift+c",onKeyDown:function(){h?navigator.clipboard.writeText("https://apps.dev.docusign.net/bathtub/?widget=".concat(h.widgetId)):navigator.clipboard.writeText(window.location.href)},children:(0,t.Y)(r.A,{keyName:"cmd+/",onKeyDown:function(){e(s.tR.setIsWidgetSwitcherOpen(!0))},children:(0,t.Y)(f,{trigger:(0,t.Y)(l.Button,{type:"primary","data-qa":"widget-switcher-launch-button",onClick:function(){e(s.tR.setIsWidgetSwitcherOpen(!0))},children:c("Bathtub.Header.Waffle")})})})}),(0,t.Y)(r.A,{keyName:"cmd+p",onKeyDown:function(t,i){i.preventDefault(),i.stopImmediatePropagation(),e(s.tR.setIsPropsEditorOpen(!0))},children:(0,t.Y)(Ez,{trigger:(0,t.Y)(l.Button,{type:"primary","data-qa":"widget-prop-editor-button",onClick:function(){e(s.tR.setIsPropsEditorOpen(!0))},children:c("Bathtub.Header.Editor")})})}),(0,t.Y)(l.Button,{type:"primary",onClick:function(){e(s.tR.reset())},children:c("Bathtub.Header.Reset")}),(0,t.Y)(l.Button,{type:"primary",onClick:function(){e(s.tR.renderWidget())},children:c("Bathtub.Header.Render")})]})})})),Lz=__webpack_require__(3561),$z=__webpack_require__(5072),_z=__webpack_require__.n($z),Vz=__webpack_require__(7825),Nz=__webpack_require__.n(Vz),Wz=__webpack_require__(7659),Hz=__webpack_require__.n(Wz),qz=__webpack_require__(5056),Fz=__webpack_require__.n(qz),zz=__webpack_require__(540),Iz=__webpack_require__.n(zz),Zz=__webpack_require__(1113),Xz=__webpack_require__.n(Zz),jz=__webpack_require__(6479),Yz={};function Uz(t){return Uz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uz(t)}function Kz(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Gz(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Kz(Object(i),!0).forEach((function(e){Jz(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Kz(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function Jz(t,e,i){return(e=function(t){var e=function(t){if("object"!=Uz(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=Uz(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Uz(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Yz.styleTagTransform=Xz(),Yz.setAttributes=Fz(),Yz.insert=Hz().bind(null,"head"),Yz.domAPI=Nz(),Yz.insertStyleElement=Iz(),_z()(jz.A,Yz),jz.A&&jz.A.locals&&jz.A.locals;var tI,eI,iI=(0,e.A)(a.az)(Tz||(Tz=function(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}(["\n  height: 100%;\n\n  > div {\n    height: 100%;\n  }\n"]))),nI=__webpack_require__(3077),sI=__webpack_require__(5391);function oI(){var e=(0,n.GV)(sI.nG.selectFilteredWidgets);return(0,t.FD)("div",{children:[(0,t.Y)(l.Typography.Title,{level:2,children:"Widget Browser"}),(0,t.Y)(l.Table,{dataSource:e,columns:[{title:"Widget ID",dataIndex:"widgetId",key:"widgetId"},{title:"Route",dataIndex:["plugin","route"],key:"route"},{title:"Version",dataIndex:"version",key:"version"},{title:"Has Auth",dataIndex:["plugin","auth"],key:"auth",render:function(t){return t?"true":"false"}}],rowKey:"widgetId",locale:{emptyText:"No widget configuration found."}})]})}function rI(t){return rI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rI(t)}function lI(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function aI(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?lI(Object(i),!0).forEach((function(e){hI(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):lI(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function hI(t,e,i){return(e=function(t){var e=function(t){if("object"!=rI(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=rI(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==rI(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function cI(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var dI,uI=(0,e.A)(a.az)(tI||(tI=cI(["\n  display: grid;\n  grid-template-rows: auto 1fr;\n  grid-template-columns: 100%;\n  grid-template-areas: 'header' 'content';\n  height: 100%;\n  width: 100%;\n"]))),fI=e.A.main(eI||(eI=cI(["\n  grid-area: content;\n  overflow: auto;\n  height: 100%;\n  width: 100%;\n"]))),pI=(0,i.memo)((function(e){var r=(0,n.GV)(s.Iv),l=(r.isLoading,r.error,(0,n.GV)(s.Ep)),a=((0,o.W)(),(0,n.jL)());return(0,i.useEffect)((function(){a(nI.Z.loadWidgets())}),[a]),(0,t.FD)(uI,{children:[(0,t.Y)(Bz,{}),(0,t.Y)(fI,{id:"main",children:l?(0,t.Y)(Rz.u,aI({},e)):(0,t.Y)(oI,{})})]})})),gI=(dI=pI,function(e){return(0,t.Y)(iI,{"data-qa":"bathtub.provider",children:(0,t.Y)(Lz.Kq,{store:n.M_,children:(0,t.Y)(dI,Gz({},e))})})})}(),__webpack_exports__}())}}}));