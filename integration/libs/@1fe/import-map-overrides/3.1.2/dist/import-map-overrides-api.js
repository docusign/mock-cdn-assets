/* import-map-overrides@3.1.2 */
!function(){"use strict";function e(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function r(r,t){return function(e){if(Array.isArray(e))return e}(r)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a,i,c=[],s=!0,l=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;s=!1}else for(;!(s=(n=a.call(t)).done)&&(c.push(n.value),c.length!==r);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(r,t)||function(r,t){if(r){if("string"==typeof r)return e(r,t);var n={}.toString.call(r).slice(8,-1);return"Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n?Array.from(r):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(r,t):void 0}}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,r){if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(e[n]===r)return!0;return!1}if("string"==typeof e)return e.indexOf(r)>=0;throw Error("Can't call includes on ".concat(t(e)))}var o,a="import-map-override:",i="import-map-overrides-disabled",c="import-map-overrides-external-maps",s="data-is-importmap-override",l="import-map-overrides-domains",u="allowlist:",p="denylist:",m=document.querySelector('meta[name="importmap-type"]'),d=document.querySelector('meta[name="'.concat(l,'"]')),v={},f=m?m.getAttribute("content"):"importmap";if(d){var g=d.getAttribute("content");g||console.warn("Invalid ".concat(l," meta element - content required."));var y=function(e){return new RegExp(function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}(e).replace("\\*",".+")).test(window.location.hostname)};0===g.indexOf(u)?o=!g.slice(10).split(",").some(y):0===g.indexOf(p)?o=g.slice(9).split(",").some(y):console.log("Invalid ".concat(l," meta content attribute - must start with ").concat(u," or ").concat(p))}else o=!1;function h(e,t){return Object.entries(e).reduce((function(e,n){var o=r(n,2),a=o[0],i=o[1];return e[a]=function(e,r){try{return new URL(e,r).href}catch(r){return e}}(i,t),e}),{})}(function(){try{return localStorage.getItem("test"),!0}catch(e){return!1}})()||(console.warn("Disabling import-map-overrides, since local storage is not readable"),o=!0),o||function(){var e,t=!!m&&m.hasAttribute("server-cookie"),o=!!m&&m.hasAttribute("server-only");window.importMapOverrides={addOverride:function(e,r){/^\d+$/g.test(r)&&(r=l.getUrlFromPort(e,r));var n=a+e;return localStorage.setItem(n,r),t&&(document.cookie="".concat(n,"=").concat(r)),p(),l.getOverrideMap()},getOverrideMap:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r={imports:{},scopes:{}},t=l.getDisabledOverrides(),n=0;n<localStorage.length;n++){var o=localStorage.key(n);0===o.indexOf(a)&&(i=o.slice(20),c=localStorage.getItem(o),!e&&t.indexOf(i)>=0||(r.imports[i]=c))}var i,c;return r},removeOverride:function(e){var r=a+e,n=null!==localStorage.getItem(r);return localStorage.removeItem(r),t&&(document.cookie="".concat(r,"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;")),l.enableOverride(e),p(),n},resetOverrides:function(){return Object.keys(l.getOverrideMap(!0).imports).forEach((function(e){l.removeOverride(e)})),localStorage.removeItem(i),localStorage.removeItem(c),p(),l.getOverrideMap()},hasOverrides:function(){return Object.keys(l.getOverrideMap().imports).length>0},getUrlFromPort:function(e,r){var t=e.replace(/@/g,"").replace(/\//g,"-");return"//localhost:".concat(r,"/").concat(t,".js")},enableUI:function(){var e="import-map-overrides-full",r="show-when-local-storage",t=document.querySelector(e);t||((t=document.createElement(e)).setAttribute(r,"true"),document.body.appendChild(t));var n=t.getAttribute(r);n&&(localStorage.setItem(n,!0),t.renderWithPreact())},mergeImportMap:function(e,r){var t={imports:{},scopes:{}};for(var n in e.imports)t.imports[n]=e.imports[n];for(var o in r.imports)t.imports[o]=r.imports[o];for(var a in e.scopes)t.scopes[a]=e.scopes[a];for(var i in r.scopes)t.scopes[i]=r.scopes[i];return t},getDefaultMap:function(){return e||(e=Array.prototype.reduce.call(document.querySelectorAll('script[type="'.concat(f,'"], script[type="overridable-importmap"]')),(function(e,t){return t.hasAttribute(s)?e:(n=t.src?w(t.src):Promise.resolve(JSON.parse(t.textContent)),Promise.all([e,n]).then((function(e){var t=r(e,2),n=t[0],o=t[1];return l.mergeImportMap(n,o)})));var n}),Promise.resolve({imports:{},scopes:{}})))},getCurrentPageMap:function(){return Promise.all([l.getDefaultMap(),l.getExternalOverrideMap(l.getCurrentPageExternalOverrides())]).then((function(e){var t=r(e,2),n=t[0],o=t[1];return l.mergeImportMap(l.mergeImportMap(n,o),y)}))},getCurrentPageExternalOverrides:function(){var e=[];return document.querySelectorAll("[".concat(s,']:not([id="import-map-overrides"])')).forEach((function(r){e.push(r.src)})),e},getNextPageMap:function(){return Promise.all([l.getDefaultMap(),l.getExternalOverrideMap()]).then((function(e){var t=r(e,2),n=t[0],o=t[1];return l.mergeImportMap(l.mergeImportMap(n,o),l.getOverrideMap())}))},disableOverride:function(e){var r=l.getDisabledOverrides();return!n(r,e)&&(localStorage.setItem(i,JSON.stringify(r.concat(e))),p(),!0)},enableOverride:function(e){var r=l.getDisabledOverrides(),t=r.indexOf(e);return t>=0&&(r.splice(t,1),localStorage.setItem(i,JSON.stringify(r)),p(),!0)},getDisabledOverrides:function(){var e=localStorage.getItem(i);return e?JSON.parse(e):[]},isDisabled:function(e){return n(l.getDisabledOverrides(),e)},getExternalOverrides:function(){var e=localStorage.getItem(c);return e?JSON.parse(e).sort():[]},addExternalOverride:function(e){e=new URL(e,document.baseURI).href;var r=l.getExternalOverrides();return!n(r,e)&&(localStorage.setItem(c,JSON.stringify(r.concat(e))),p(),!0)},removeExternalOverride:function(e){var r=l.getExternalOverrides();return!!n(r,e)&&(localStorage.setItem(c,JSON.stringify(r.filter((function(r){return r!==e})))),p(),!0)},getExternalOverrideMap:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.getExternalOverrides()).reduce((function(e,t){var n=v[t]||(v[t]=w(t));return Promise.all([e,n]).then((function(e){var t=r(e,2),n=t[0],o=t[1];return l.mergeImportMap(n,o)}))}),Promise.resolve({imports:{},scopes:{}}))},isExternalMapValid:function(e){return(v[e]||(v[e]=w(e))).then((function(){return!n(l.invalidExternalMaps,e)}))},invalidExternalMaps:[]};var l=window.importMapOverrides,u=!0;try{CustomEvent?new CustomEvent("a"):u=!1}catch(e){u=!1}function p(){d("change")}function d(e){setTimeout((function(){var r="import-map-overrides:".concat(e),t=u?new CustomEvent(r):document.createEvent("CustomEvent");u||t.initCustomEvent(r,!0,!0,null),window.dispatchEvent(t)}))}var g,y=l.getOverrideMap(),O=l.getExternalOverrides();if(!o){var b=document.querySelector('script[type="overridable-importmap"]');if(!(g=b)){var S=document.querySelectorAll('script[type="'.concat(f,'"]'));g=S?S[S.length-1]:null}if(b){if(b.src)throw Error('import-map-overrides: external import maps with type="overridable-importmap" are not supported');var E;try{E=JSON.parse(b.textContent)}catch(e){throw Error('Invalid <script type="overridable-importmap"> - text content must be json')}g=x(l.mergeImportMap(E,y),"import-map-overrides",g),M()}else M(),Object.keys(y.imports).length>0&&(g=x(y,"import-map-overrides",g))}function x(e,r,t){var n=document.createElement("script");return n.type=f,n.id=r,n.setAttribute(s,""),"string"==typeof e?n.src=e:n.textContent=JSON.stringify(e,null,2),t?t.insertAdjacentElement("afterend",n):document.head.appendChild(n),n}function w(e){return fetch(e).then((function(e){return e.ok?e.json().catch((function(r){return console.warn(Error("External override import map contained invalid json, at url ".concat(e.url,". ").concat(r))),l.invalidExternalMaps.push(e.url),{imports:{},scopes:{}}})):(console.warn(Error("Unable to download external override import map from url ".concat(e.url,". Server responded with status ").concat(e.status))),l.invalidExternalMaps.push(e.url),{imports:{},scopes:{}})}),(function(){return console.warn(Error("Unable to download external import map at url '".concat(e,"'"))),l.invalidExternalMaps.push(new URL(e,document.baseURI).href),{imports:{},scopes:{}}})).then((function(r){return function(e,r){return{imports:h(e.imports||{},r),scopes:Object.keys(e.scopes||{}).reduce((function(t,n){return t[n]=h(e.scopes[n],r),t}),{})}}(r,e)}))}function M(){O.length>0&&O.forEach((function(e,r){g=x(e,"import-map-overrides-external-".concat(r))}))}d("init")}()}();
//# sourceMappingURL=import-map-overrides-api.js.map